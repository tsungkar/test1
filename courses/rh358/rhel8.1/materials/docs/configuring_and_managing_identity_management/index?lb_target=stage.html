<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video#" >

<head profile="http://www.w3.org/1999/xhtml/vocab">
	  <!--[if IE]><![endif]-->
<meta charset="utf-8" />
<meta name="revision" title="7410a826-cf0f-4b04-98f9-7828e4aded34" product="f321f43a-4a79-48fe-8aae-117b9d973ec0" revision="7b862323f3c0563c6ce9052daf045b9e3369fbe9:en-us" page="fa1e7813-f6ae-4201-967c-a73d8cfca5d7" />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/index" />
<meta property="og:title" content="Configuring and managing Identity Management Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta property="og:description" content="This documentation collection provides instructions on how to effectively configure, manage and maintain Identity Management on Red Hat Enterprise Linux 8." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/index" />
<meta name="twitter:title" content="Configuring and managing Identity Management Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta name="twitter:description" content="This documentation collection provides instructions on how to effectively configure, manage and maintain Identity Management on Red Hat Enterprise Linux 8." />
<meta name="twitter:image:src" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
  <title>Configuring and managing Identity Management Red Hat Enterprise Linux 8 | Red Hat Customer Portal</title>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="kcs06.web.prod.ext.phx2.redhat.com" />
<meta name="avalon-version" content="2070d6b" />
<meta name="cp-chrome-build-date" content="2020-03-09T20:28:54.189Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />

 

<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en",  
        version   : "2070d6b",
        builddate : "2020-03-09T20:28:54.189Z",
        fetchdate : "2020-03-11T07:53:05-0400",
        nrid      : "14615289",
        nrlk      : "2a497fa56f"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="favicon.ico" />

<link media="all" rel="stylesheet" type="text/css" href="bootstrap.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="main.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="components.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="pages.css%3Fv=2070d6b.css" />

<link href="chosen.css%3Fv=2070d6b.css" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]-->

<noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>

<!-- /cssInclude -->
<script type="text/javascript" src="require.js%3Fv=2070d6b" data-main="/webassets/avalon/j/"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
  <link type="text/css" rel="stylesheet" href="css__c2Nkkx_5vYh8rvZbfBAGB4EMzMtH5ouFJDBlDsnhSR8__-ax0_8bam15ZDJT9j7LilCfJrDyEhGGAgc0KC8HYvJg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__Jy3BSr8TrxptaufAzQDT1skBUlX2CnL_wm6BizzYuGw__-YZvqB8yuA4kK_iKklbk5HdZCoG2qAgz1l-8Qi2NFH4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="messages.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__m76iIFREtc70Nmw5xe1ZwHbNBlwOP2Zjc3DcacNWnFQ__STEh8aY3w8E_bKzhB4Xke2WOQ9XMDQquHIP5B8SeDIY__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__4sM4s6XOQ2Nm0pdkrWRLvrgtwpTmHAFzR_LcdesKYj8__vJ0jjVEhoPh3KBeLZfkqg51T3AFxhQCuXg1reipa__k__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="print" />
  <link rel="stylesheet" type="text/css" media="all" href="list.css" />
  <script src="js__1YIht1y1Jlm9D0PyxEuhS3DlWdYAlEsNpsFDOaUsfRw__ZnC7278ZsqBG-1FOUqflDl8B3Y1kLiAWXAIkoLrHbYg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__5ysXPc5KIyMmizxqRY68ILfrEGrj0P29WBIifnPTJvQ__Cap0DACEVMsefumg1gS1APLLd8stDkdGfp6c1uswMo4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>chrometwo_require(["analytics/attributes"], function(attributes) {
attributes.set('ResourceID',       '7410a826-cf0f-4b04-98f9-7828e4aded34');
attributes.set('ResourceTitle',    'Configuring and managing Identity Management');
attributes.set('Language',         'en-us');
attributes.set('RevisionId',       '7b862323f3c0563c6ce9052daf045b9e3369fbe9:en-us');
attributes.set('PublicationState', ['active','published']);
attributes.set('Product',          'Red Hat Enterprise Linux');
attributes.set('ProductVersion',   '8');
attributes.set('ProductId',        'Red Hat Enterprise Linux 8');
});</script>
<script>breadcrumbs = [ ["Products &amp; Services", "/products/"], ["Product Documentation", "/documentation/"], ["Red Hat Enterprise Linux", "/documentation/en-us/red_hat_enterprise_linux/"], ["8", "/documentation/en-us/red_hat_enterprise_linux/8/"], ["Configuring and managing Identity\u00a0Management", "/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/"] ];</script>
<script>window.siteMapState = "products";</script>
<script src="js__i6ieGBO-OPmIKm_f0srsb6gM7QELIWrBpKh6ub_yj8A__wjRg_duSK4rEZCRV2uwrCIPMl80Z_LJ9ew61H5hE-ZI__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__vGeEtorfXGI3aPAp71YA74N5p8wfpYVhnoIqwaJrOiQ__veGxEiPQW6fkzAPZnAFA23SFz1CyJy2dlu6x8XuHM4s__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"kcs","theme_token":"xiv4157zwPqnSBG-bQiI52sg2LrrkEE6J9l1J8tx-bk","js":{"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.jquery.min.js":1,"modules\/chosen\/chosen.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/prism.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/underscore.js":1,"sites\/all\/themes\/kcs\/js\/kcs_base.js":1,"sites\/all\/themes\/kcs\/js\/showdown.js":1,"sites\/all\/themes\/kcs\/js\/case_links.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/date\/date_api\/date.css":1,"modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/contrib\/user_prune\/css\/user_prune.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/panels\/css\/panels.css":1,"sites\/all\/modules\/custom\/rate\/rate.css":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/plugins\/layouts\/docs_page\/docs_page.css":1,"https:\/\/access.redhat.com\/webassets\/avalon\/s\/messages.css":1,"sites\/all\/themes\/zen\/system.base.css":1,"sites\/all\/themes\/zen\/system.menus.css":1,"sites\/all\/themes\/zen\/system.messages.css":1,"sites\/all\/themes\/zen\/system.theme.css":1,"sites\/all\/themes\/zen\/comment.css":1,"sites\/all\/themes\/zen\/node.css":1,"sites\/all\/themes\/kcs\/css\/html-reset.css":1,"sites\/all\/themes\/kcs\/css\/wireframes.css":1,"sites\/all\/themes\/kcs\/css\/layout-fixed.css":1,"sites\/all\/themes\/kcs\/css\/page-backgrounds.css":1,"sites\/all\/themes\/kcs\/css\/tabs.css":1,"sites\/all\/themes\/kcs\/css\/pages.css":1,"sites\/all\/themes\/kcs\/css\/blocks.css":1,"sites\/all\/themes\/kcs\/css\/navigation.css":1,"sites\/all\/themes\/kcs\/css\/views-styles.css":1,"sites\/all\/themes\/kcs\/css\/nodes.css":1,"sites\/all\/themes\/kcs\/css\/comments.css":1,"sites\/all\/themes\/kcs\/css\/forms.css":1,"sites\/all\/themes\/kcs\/css\/fields.css":1,"sites\/all\/themes\/kcs\/css\/kcs.css":1,"sites\/all\/themes\/kcs\/css\/print.css":1}},"chosen":{"selector":"#edit-field-kcs-component-select-und, #edit-field-kcs-sbr-select-und, #edit-field-kcs-product-select-und, #edit-field-kcs-type-select-und, #edit-language, #edit-field-kcs-a-category-select-und, #edit-field-kcs-state-select-und, #edit-field-kcs-tags-select-und, #edit-field-kcs-state-select-value, #edit-field-vid-reference-product-und, #edit-state, #edit-product, #edit-category, #edit-field-kcs-product-select-tid, #edit-field-kcs-type-select-tid, #edit-field-kcs-a-category-select-tid, #edit-sort-bef-combine, #edit-kcs-state, #edit-field-category-tid, #edit-field-product-tid, #edit-field-tags-tid, #edit-field-category-und, #edit-field-product-und, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-category, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-product, #views-exposed-form-questions-list-questions-filter-block #edit-field-tags, #edit-field-mega-menu-tab-und, #edit-field-internal-tags-tid, #edit-tags, #edit-field-kcs-tags-select-tid, #edit-subscriptions-and-choose-field-select, #edit-subscriptions-and-type, #edit-vid-13, #edit-vid-4, #edit-vid-5, #edit-vid-53, #edit-vid-1, #edit-vid-3, #edit-group-blog, #edit-group-group, #edit-subscriptions-and-choose-field-select-two, #edit-subscriptions-and-type-two, #edit-vid-13-two, #edit-vid-4-two, #edit-vid-5-two, #edit-vid-53-two, #edit-vid-1-two, #edit-vid-3-two, #edit-group-blog-two, #edit-group-group-two, #edit-subscriptions-and-edit-choose-field-select, #edit-subscriptions-and-type-edit, #edit-subscriptions-and-edit-type-two, #edit-vid-13-edit-two, #edit-vid-4-edit-two, #edit-vid-5-edit-two, #edit-vid-53-edit-two, #edit-vid-1-edit-two, #edit-vid-3-edit-two, #edit-group-group-edit-two, #edit-subscriptions-and-edit-choose-field-select-two, #edit-vid-13-edit, #edit-vid-4-edit, #edit-vid-5-edit, #edit-vid-53-edit, #edit-vid-1-edit, #edit-vid-3-edit, #edit-group-group-edit, #edit-group-blog-edit, #edit-field-supported-languages-tid, #edit-field-geography-und, #edit-field-supported-products-und, #edit-field-supported-languages-und, #edit-field-vendor-und, #edit-field-errata-type-text-und, #edit-field-errata-severity-text-und, #edit-field-software-partner-level-und, #edit-field-scert-product-category-und, #edit-field-certifications-und-0-field-product-und, #edit-kcs-article-type, #edit-field-eco-industry-tag-select-tid, #edit-field-eco-software-catego-select-tid, #edit-field-ecosystem-tag-select-und, #edit-field-eco-industry-tag-select-und, #edit-field-eco-software-catego-select-und, #edit-field-vendor-tsanet-member-ref-und, #edit-field-og-vendor-ref-und-0-default, #edit-field-eco-products-enabled-col-und-0-field-eco-subscription-model-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-support-level-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-archite-select-und, #edit-field-eco-certifications-select-und-0-field-eco-certificati-lvl-select-und, #edit-field-eco-certifications-select-und-0-field-eco-hypervisor-str-und, #edit-field-eco-supported-language-ref-und, #edit-field-eco-region-ref-und, #edit-field-cs-product-category-str-und, #edit-field-eco-certifications-select-und-0-field-eco-format-ref-und, #edit-field-eco-group-access-ref-und, #edit-field-hw-category-tag-ref-und, #edit-field-profile-industry-und, #edit-field-profile-tech-interests-und, #edit-field-product-page-features-ref-und, #edit-field-eco-product-select-und, #edit-field-base-product-ref-und, #edit-field-eco-product-archite-select-und, #edit-field-eco-format-ref-und, #edit-field-certification-status-ref-und, #edit-field-certification-result-ref-und, #edit-field-og-certified-product-ref-und-0-default, #edit-field-eco-subscription-model-ref-und, #edit-field-eco-support-level-ref-und, #edit-field-eco-certificati-lvl-select-und, #edit-field-eco-hypervisor-str-und, #edit-field-ccp-thirdparty-cert-select-und, .use_, #edit-field-eco-cert-product-tag-und, #edit-field-documentation-location-ref-und, #edit-field-documentation-title-und, #edit-field-accelerator-products-und","minimum":"0"},"rh_doc_fetcher":{"page_type":"single"},"section":"","kcs":{"nodeType":null,"nodeId":null}});</script>
    <!--[if lt IE 9]>
  <script src="https://access.redhat.com/sites/all/themes/kcs/js/html5shiv.js"></script>
  <![endif]-->
  
      


    <!--kcs07-->
<script type="text/javascript">
  Drupal.portal = {"version":{"redhat_portal":"package drupal7-redhat_portal is not installed"}};
  Drupal.portal.currentUser = {};
  </script>

</head>

<body class="portal-page admin-bar  kcs_external" >

  
  <div id="page-wrap" class="page-wrap">
    <div class="top-page-wrap">

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <!-- Accessibility Nav & Header -->
<div class="accessibility-nav sr-only">
    <a href="https://access.redhat.com/">
        <h1>Red Hat <span>Customer </span><span>Portal</span></h1>
    </a>
    <p><a href="index%3Flb_target=stage.html#cp-main">Skip to main content</a></p>
    <nav aria-labelledby="accessibility-nav-heading">
        <h2 id="accessibility-nav-heading">Main Navigation</h2>
        <ul>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index%3Flb_target=stage.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="accessibility-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="accessibility-accountUser">
                    <div class="account-name"><strong id="accessibility-userFullName"></strong></div>
                    <div class="account-org"><span id="accessibility-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="accessibility-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="accessibility-localesMenu">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="accessibility-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="accessibility-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="accessibility-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="accessibility-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- Mobile Header -->
<nav class="mobile-nav-bar hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <button id="menu-btn" class="menu menu-white" type="button" aria-label="Toggle Navigation">
        <span class="lines"></span>
    </button>
    <a class="logo" href="https://access.redhat.com/">
        <span class="logo-crop">
          <!-- logo -->
          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
            <defs>
              <style>
                .rh-logo-hat {
                  fill: #e00;
                }
                .rh-logo-type {
                  fill: #fff;
                }
              </style>
            </defs>
            <title>Red Hat</title>
            <path
              class="rh-logo-hat"
              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
              <path class="rh-logo-band"
              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
              <path
              class="rh-logo-type"
              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
          </svg>
        </span>
        <span class="site-title"><span>Customer </span><span>Portal</span></span>
    </a>
    <button class="btn btn-search btn-utility" data-target="#site-search">
        <span class="web-icon-search"></span>
        <span class="link-text">Search</span>
    </button>
</nav>

<!-- Mobile Menu Drawer -->
<div class="nav-drawer mobile-nav-drawer hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <nav class="nav-container">
        <ul>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index%3Flb_target=stage.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="mobile-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="mobile-accountUser">
                    <div class="account-name"><strong id="mobile-userFullName"></strong></div>
                    <div class="account-org"><span id="mobile-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="mobile-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index%3Flb_target=stage.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="mobile-localesMenu">
            <li aria-hidden="true"><a href="index%3Flb_target=stage.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="mobile-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="mobile-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="mobile-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="mobile-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- White Utility Menu for large screens -->
<div class="utility-wrap" aria-hidden="true">
    <div class="utility-container">
        <div class="utility-bar hidden-xs">
            <div role="navigation" class="top-nav">
                <ul>
                    <li id="nav-subscription" data-portal-tour-1="1"><a class="top-nav-subscriptions" href="https://access.redhat.com/management/">Subscriptions</a></li>
                    <li id="nav-downloads" data-portal-tour-1="2"><a class="top-nav-downloads" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li id="nav-containers"><a class="top-nav-containers" href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
                    <li id="nav-support" data-portal-tour-1="3"><a class="top-nav-support-cases" href="https://access.redhat.com/support/cases/">Support Cases</a></li>
                </ul>
            </div>

            <div role="navigation" class="utility-nav">
                <ul>
                    <li id="searchABTestHide">
                        <a class="btn-search" data-target="#site-search" title="Search" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-search" aria-label="search"></span>
                            <span class="link-text">Search</span>
                        </a>
                    </li>
                    <!-- AB Test -->
                    <li id="searchABTestShow">
                        <form id="topSearchFormABTest" name="topSearchFormABTest">
                            <label for="topSearchInputABTest" class="sr-only">Search</label>
                            <input id="topSearchInputABTest" name="keyword" placeholder="Search" value="" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="form-control">
                            <button type="submit" class="btn btn-app btn-sm btn-link"><span class="web-icon-search" aria-label="search"></span></button>
                        </form>
                    </li>
                    <!-- End of AB Test -->
                    <li>
                        <a class="btn-profile" data-target="#account-info" data-portal-tour-1="4a" title="Account" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-user" aria-label="log in"></span>
                            <span class="link-text">Log In</span>
                            <span class="account-user" id="accountUserName"></span>
                        </a>
                    </li>
                    <li>
                        <a class="btn-language" data-target="#language" data-portal-tour-1="6" title="Language" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-globe" aria-label="language"></span>
                            <span class="link-text">Language</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Utility Tray -->
        <div class="utility-tray-container">
            <div class="utility-tray">
                <div id="site-search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="https://access.redhat.com/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <div class="input-group push-bottom">

                                <input class="form-control searchField" id="topSearchInput" name="keyword" value="" placeholder="Enter your search term" type="text">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primary">Search</button>
                                </span>
                            </div>
                            <div>Troubleshooting an issue? Try <a href="https://access.redhat.com/solution-engine">Solution Engine</a>&mdash;our new support tool.</div>
                        </form>
                    </div>
                </div>
                <div id="account-info" class="utility-link account-info">
                    <div class="content">

                        <!-- Account Unauthenticated -->
                        <div id="accountLinksLoggedOut" class="unauthenticated">
                            <h2 class="utility-header">Log in to Your Red Hat Account</h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border">
                                    <p><a href="https://access.redhat.com/login" id="accountLogin" class="btn btn-primary">Log In</a></p>
                                    <p>Your Red Hat account gives you access to your profile, preferences, and services, depending on your status.</p>
                                </div>
                                <div class="col-sm-6 col-border col-border-left">
                                    <p><a href="https://www.redhat.com/wapps/ugc/register.html" class="btn btn-primary">Register</a></p>
                                    <p>If you are a new customer, register now for access to product evaluations and purchasing capabilities. </p>

                                    <strong>Need access to an account?</strong><p>If your company has an existing Red Hat account, your organization administrator can grant you access.</p>

                                    <p><a href="https://access.redhat.com/support/contact/customerService/">If you have any questions, please contact customer service.</a></p>
                                </div>
                            </div>
                        </div>

                        <!-- Account Authenticated -->
                        <div id="accountLinksLoggedIn" class="authenticated">
                            <h2 class="utility-header"><span id="userFirstName"></span></h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border col-border-right">
                                    <div class="account-info" id="accountUser">
                                        <div class="avatar"><!-- placeholder--></div>
                                        <div class="account-name"><strong id="userFullName"></strong></div>
                                        <div class="account-org"><span id="userOrg"></span></div>
                                        <div class="account-number accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                                    </div>

                                    <div class="row account-settings">
                                        <div class="col-md-6" data-portal-tour-1="4">
                                            <h3>Red Hat Account</h3>
                                            <ul class="reset">
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
                                                <!-- <li><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
                                                <li><a href="https://access.redhat.com/account-team">Account Team</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6" data-portal-tour-1="5">
                                            <h3>Customer Portal</h3>
                                            <ul class="reset">
                                                <li><a href="https://access.redhat.com/user">My Profile</a></li>
                                                <li><a href="https://access.redhat.com/user" id="userNotificationsLink">Notifications</a></li>
                                                <li><a href="https://access.redhat.com/help/">Help</a></li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-6 col-border">
                                    <p>For your security, if you’re on a public computer and have finished using your Red Hat services, please be sure to log out.</p>
                                    <p><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout" id="accountLogout" class="btn btn-primary">Log Out</a></p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="language" class="utility-link language">
                    <div class="content">
                        <h2 class="utility-header">Select Your Language</h2>
                        <div class="row" id="localesMenu">
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en">English</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko">한국어</a></li>
                                </ul>
                            </div>
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja">日本語</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN">中文 (中国)</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="scroll-anchor"></div>

<!-- Main Menu for large screens -->
<div class="header-nav visible-sm visible-md visible-lg" aria-hidden="true">
    <div id="header-nav">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">

                    <a href="https://access.redhat.com/" class="logo">
                        <span class="logo-crop">
                          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                            <defs>
                              <style>
                                .rh-logo-hat {
                                  fill: #e00;
                                }
                                .rh-logo-type {
                                  fill: #fff;
                                }
                              </style>
                            </defs>
                            <title>Red Hat</title>
                            <path
                              class="rh-logo-hat"
                              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                              <path class="rh-logo-band"
                              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                              <path
                              class="rh-logo-type"
                              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                          </svg>
                        </span>
                        <span class="site-title"><span>Customer </span><span>Portal</span></span>
                    </a>

                    <nav class="primary-nav hidden-sm">
                        <ul>
                            <li id="nav-products"><a class="products" data-link="mega" data-target="products-menu" href="https://access.redhat.com/products/" id="products-menu">Products &amp; Services</a></li>
                            <li id="nav-tools"><a class="tools" data-link="mega" data-target="tools-menu" href="https://access.redhat.com/labs/" id="tools-menu">Tools</a></li>
                            <li id="nav-security"><a class="security" data-link="mega" data-target="security-menu" href="https://access.redhat.com/security/" id="security-menu">Security</a></li>
                            <li id="nav-community"><a class="community" data-link="mega" data-target="community-menu" href="https://access.redhat.com/community/" id="community-menu">Community</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Mega Menu for large screens -->
<div class="mega-wrap visible-sm visible-md visible-lg" aria-hidden="true">
    <nav class="mega">
        <div class="container">
            <div class="mega-menu-wrap">

                <!-- Products Menu -->
                <div aria-labelledby="products-menu" class="products-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-md-6 col-sm-8">
                            <div class="root clearfix" data-portal-tour-1="7">
                                <ul class="subnav subnav-root">
                                    <li data-target="infrastructure-menu" class="active">
                                        <h3>Infrastructure and Management</h3>
                                    </li>
                                    <li data-target="cloud-menu">
                                        <h3>Cloud Computing</h3>
                                    </li>
                                    <li data-target="storage-menu">
                                        <h3>Storage</h3>
                                    </li>
                                    <li data-target="jboss-dev-menu">
                                        <h3>Runtimes</h3>
                                    </li>
                                    <li data-target="jboss-int-menu">
                                        <h3>Integration and Automation</h3>
                                    </li>
                                </ul>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="infrastructure-menu" style="display: block;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="cloud-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="storage-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a>
                                        </li>
                                        <li>
                                          <a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-dev-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                        </li>
                                    </ul>
                                </div> -->
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul class="border-bottom" id="portal-menu-border-bottom">
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                      </li>
                                    </ul>
                                    <ul>
                                      <li>
                                        <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                      </li>
                                    </ul>
                                </div>
                            </div>
                            <a href="https://access.redhat.com/products" class="btn btn-primary">View All Products</a>
                        </div>

                        <div class="col-md-6 col-sm-4 pull-right" data-portal-tour-1="8">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/support" class="cta-link cta-link-darkbg">Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
                                        <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>
                                    </ul>
                                    <h4 class="nav-title">Services</h4>
                                    <ul>
                                        <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
                                        <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/documentation" class="cta-link cta-link-darkbg">Documentation</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>
                                    </ul>
                                    <ul>
                                        <li><a href="https://access.redhat.com/ecosystem/" class="cta-link cta-link-darkbg">Ecosystem</a></li>
                                        <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
                                        <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tools Menu -->
                <div aria-labelledby="tools-menu" class="tools-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row" data-portal-tour-1="9">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h3 class="nav-title">Tools</h3>
                                    <ul>
                                        <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
                                        <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
                                        <li><a href="https://access.redhat.com/errata/">Errata</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <ul class="list-flat">
                                        <li><a href="https://access.redhat.com/labs/" class="cta-link cta-link-darkbg">Customer Portal Labs</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <div class="card card-dark-grey">
                                        <h4 class="card-heading">Red Hat Insights</h4>
                                        <p class="text-white">Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                        <ul class="list-flat rh-l-grid rh-m-gutters rh-m-all-6-col-on-md">
                                          <li><a href="https://www.redhat.com/en/technologies/management/insights" class="cta-link cta-link-md cta-link-darkbg">Learn more</a></li>
                                          <li><a href="https://cloud.redhat.com/insights" class="cta-link cta-link-md cta-link-darkbg">Go to Insights</a></li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <!-- Security Menu -->
                <div aria-labelledby="security-menu" class="security-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="10">

                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Red Hat Product Security Center</h2>
                                    <p class="text-white">Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.</p>
                                    <p><a href="https://access.redhat.com/security/" class="btn btn-primary">Product Security Center</a></p>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Security Updates</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
                                    </ul>
                                    <p class="text-white">Keep your systems secure with Red Hat&#039;s specialized responses for high-priority security vulnerabilities.</p>
                                    <ul>
                                        <li class="more-link"><a href="https://access.redhat.com/security/vulnerability">View Responses</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Resources</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
                                        <li><a href="https://www.redhat.com/en/blog/channel/security">Security Blog</a></li>
                                        <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
                                        <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community Menu -->
                <div aria-labelledby="community-menu" class="community-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="11">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Portal Community</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
                                        <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
                                        <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
                                        <p class="push-top"><a href="https://access.redhat.com/community/" class="btn btn-primary">Community Activity</a></p>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Events</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
                                        <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Stories</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
                                        <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
                                        <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--<a href="https://access.redhat.com/community/" class="btn btn-primary">Explore Community</a>-->
                    </div>
                </div>
            </div>
        </div>
    </nav>
</div>

            <!--[if IE 8]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
            </div>
            <![endif]-->
            <!--[if IE 9]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
            </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">
  <script type="text/javascript">
    chrometwo_require(['jquery-ui']);
  </script>


      <article class="rh_docs">
  <div class="container">
        <!-- Display: Book Page Content -->
    
  

<div class="row">
  <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
  <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
  


<a class="toc-toggle toc-show" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
  <span class="sr-only">Show Table of Contents</span>
  <span class="web-icon-mobile-menu" aria-hidden="true"></span>
</a>
<nav id="toc-main" class="toc-main collapse in">
  <div class="toc-menu affix-top">
    <a class="toc-toggle toc-hide" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
      <span class="sr-only">Hide Table of Contents</span>
      <span class="icon-remove" aria-hidden="true"></span>
    </a>
    <div class="doc-options">
      <div class="doc-language btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          English <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="index%3Flb_target=stage.html">English</a></li>
                      <li><a href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/">日本語</a></li>
                  </ul>
      </div>
      <div class="doc-format btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          Single-page HTML <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/">Multi-page HTML</a></li>
                                <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/pdf/configuring_and_managing_identity_management/Red_Hat_Enterprise_Linux-8-Configuring_and_managing_Identity_Management-en-US.pdf">PDF</a></li>
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/epub/configuring_and_managing_identity_management/Red_Hat_Enterprise_Linux-8-Configuring_and_managing_Identity_Management-en-US.epub">ePub</a></li>
                  </ul>
      </div>
    </div>
    <ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html">Configuring and managing Identity Management</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#proc_providing-feedback-on-red-hat-documentation_configuring-and-managing-idm">Providing feedback on Red Hat documentation</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#logging-in-to-ipa-from-the-command-line_configuring-and-managing-idm">1. Logging in to Identity Management from the command line</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#using-kinit-to-log-in-to-ipa_logging-in-to-ipa-from-the-command-line">1.1. Using kinit to log in to IdM manually</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#destroying-the-users-active-kerberos-ticket-idm_logging-in-to-ipa-from-the-command-line">1.2. Destroying a user’s active Kerberos ticket</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-an-external-system-for-kerberos-authentication-logging-in-to-ipa-from-the-command-line">1.3. Configuring an external system for Kerberos authentication</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-starting-and-stopping-the-ipa-server_configuring-and-managing-idm">2. Viewing, starting and stopping the Identity Management services</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-running-idm-services_start-stop-ipa">2.1. Viewing the status of IdM services</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#starting-and-stopping-the-entire-ipa-server-the-ipactl-utility_start-stop-ipa">2.2. Starting and stopping the entire Identity Management server: the ipactl utility</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#starting-and-stopping-an-individual-ipa-service-the-systemctl-utility_start-stop-ipa">2.3. Starting and stopping an individual Identity Management service: the systemctl utility</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#display-software-version_start-stop-ipa">2.4. Methods for Displaying Identity Management Software Version</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#introduction-to-the-ipa-command-line-utilities_configuring-and-managing-idm">3. Introduction to the IdM command-line utilities</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#what-is-the-ipa-command-line-interface_introduction-to-the-ipa-command-line-utilities">3.1. What is the IPA command line interface</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#what-is-the-ipa-help_introduction-to-the-ipa-command-line-utilities">3.2. What is the IPA help</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-ipa-help-topics_introduction-to-the-ipa-command-line-utilities">3.3. Using IPA help topics</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-ipa-help-commands_introduction-to-the-ipa-command-line-utilities">3.4. Using IPA help commands</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#the-structure-of-ipa-commands_introduction-to-the-ipa-command-line-utilities">3.5. Structure of IPA commands</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-an-ipa-command-to-add-a-user-account-to-idm_introduction-to-the-ipa-command-line-utilities">3.6. Using an IPA command to add a user account to IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-an-ipa-command-to-modify-a-user-account-in-idm_introduction-to-the-ipa-command-line-utilities">3.7. Using an IPA command to modify a user account in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#how-to-supply-a-list-of-values-to-the-ipa-utilities_introduction-to-the-ipa-command-line-utilities">3.8. How to supply a list of values to the IdM utilities</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#how-to-use-special-characters-with-the-ipa-utilities_introduction-to-the-ipa-command-line-utilities">3.9. How to use special characters with the IdM utilities</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#searching-ipa-entries_configuring-and-managing-idm">4. Searching Identity Management entries from the command line</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#overview-of-listing-ipa-entries_search-ipa">4.1. Overview of listing IdM entries</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#showing-details-for-a-particular-entry_search-ipa">4.2. Showing details for a particular entry</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adjusting-the-search-size-and-time-limit_search-ipa">4.3. Adjusting the search size and time limit</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#adjusting-the-search-size-and-time-limit-in-the-command-line_adjusting-the-search-size-and-time-limit">4.3.1. Adjusting the search size and time limit in the command line</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adjusting-the-search-size-and-time-limit-in-the-web-ui_adjusting-the-search-size-and-time-limit">4.3.2. Adjusting the search size and time limit in the Web UI</a></li></ol></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm">5. Accessing the IdM Web UI in a web browser</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#what-is-the-ipa-web-ui_access-web-ui">5.1. What is the IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#web-browsers-supported-for-accessing-the-web-ui_access-web-ui">5.2. Web browsers supported for accessing the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#accessing-the-web-ui_access-web-ui">5.3. Accessing the Web UI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#logging-in-to-ipa-in-the-web-ui-using-a-kerberos-ticket_configuring-and-managing-idm">6. Logging in to IdM in the Web UI: Using a Kerberos ticket</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#kerberos-authentication-in-identity-management_login-web-ui-krb">6.1. Kerberos authentication in Identity Management</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-kinit-to-log-in-to-ipa_login-web-ui-krb">6.2. Using kinit to log in to IdM manually</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-the-browser-for-kerberos-authentication-login-web-ui-krb">6.3. Configuring the browser for Kerberos authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#logging-in-to-the-web-ui-with-a-kerberos-ticket-login-web-ui-krb">6.4. Logging in to the web UI using a Kerberos ticket</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-an-external-system-for-kerberos-authentication-login-web-ui-krb">6.5. Configuring an external system for Kerberos authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#web-ui-login-for-ad-users-login-web-ui-krb">6.6. Web UI login for Active Directory users</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#logging-in-to-the-ipa-web-ui-using-one-time-passwords_configuring-and-managing-idm">7. Logging in to the Identity Management Web UI using one time passwords</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#prerequisites">7.1. Prerequisites</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#one-time-password-authentication-in-identity-management_logging-in-to-ipa-in-the-web-ui-using-a-password">7.2. One time password (OTP) authentication in Identity Management</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#enabling-the-one-time-password-in-the-web-ui_logging-in-to-ipa-in-the-web-ui-using-a-password">7.3. Enabling the one time password in the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-otp-tokens-in-the-web-ui_logging-in-to-ipa-in-the-web-ui-using-a-password">7.4. Adding OTP tokens in the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#logging-in-to-the-web-ui-with-a-one-time-password_logging-in-to-ipa-in-the-web-ui-using-a-password">7.5. Logging into the Web UI with a one time password</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#synchronizing-otp-tokens_logging-in-to-ipa-in-the-web-ui-using-a-password">7.6. Synchronizing OTP tokens using the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#changing-expired-passwords_logging-in-to-ipa-in-the-web-ui-using-a-password">7.7. Changing expired passwords</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#managing-user-accounts-using-the-idm-web-ui_configuring-and-managing-idm">8. Managing user accounts using the IdM Web UI</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#user-life-cycle_managing-user-accounts-using-the-idm-web-ui">8.1. User life cycle</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-users-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui">8.2. Adding users in the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#activating-stage-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui">8.3. Activating stage users in the IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#disabling-user-accounts-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui">8.4. Disabling user accounts in the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#enabling-user-accounts-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui">8.5. Enabling user accounts in the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#preserving-active-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui">8.6. Preserving active users in the IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#restoring-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui">8.7. Restoring users in the IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#deleting-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui">8.8. Deleting users in the IdM Web UI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#managing-user-accounts-using-the-command-line_configuring-and-managing-idm">9. Managing user accounts using the command line</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#user-life-cycle_managing-idm-users-using-the-command-line">9.1. User life cycle</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">9.2. Adding users using the command line</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#activating-users-using-the-command-line_managing-idm-users-using-the-command-line">9.3. Activating users using the command line</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#preserving-users-using-the-command-line_managing-idm-users-using-the-command-line">9.4. Preserving users using the command line</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#deleting-users-using-the-command-line_managing-idm-users-using-the-command-line">9.5. Deleting users using the command line</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#restoring-users-using-the-command-line_managing-idm-users-using-the-command-line">9.6. Restoring users using the command line</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#managing-user-groups-cli_configuring-and-managing-idm">10. Managing user groups in IdM CLI</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups_managing-user-groups-cli">10.1. User groups and group types in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups-direct-indirect_managing-user-groups-cli">10.2. Direct and indirect group members</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups-add-delete-cli_managing-user-groups-cli">10.3. Adding, searching for, and deleting user groups in IdM CLI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups-add-member-cli_managing-user-groups-cli">10.4. Adding a member to a user group using IdM CLI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-users-without-a-user-private-group_managing-user-groups-cli">10.5. Adding users without a user private group</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#users-without-a-user-private-group_adding-users-without-a-user-private-group">10.5.1. Users without a user private group</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-a-user-without-a-user-private-group-when-private-groups-are-globally-enabled_adding-users-without-a-user-private-group">10.5.2. Adding a user without a user private group when private groups are globally enabled</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#disabling-user-private-groups-globally-for-all-users_adding-users-without-a-user-private-group">10.5.3. Disabling user private groups globally for all users</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-a-user-when-user-private-groups-are-globally-disabled_adding-users-without-a-user-private-group">10.5.4. Adding a user when user private groups are globally disabled</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups-view-member-cli_managing-user-groups-cli">10.6. Viewing group members using IdM CLI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups-remove-member-cli_managing-user-groups-cli">10.7. Removing a member from a user group using IdM CLI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#managing-user-groups-in-idm-web-ui_configuring-and-managing-idm">11. Managing user groups in IdM Web UI</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups_managing-user-groups-in-idm-web-ui">11.1. User groups and group types in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#user-groups-direct-indirect_managing-user-groups-in-idm-web-ui">11.2. Direct and indirect group members</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui">11.3. Adding a user group using IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#deleting-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui">11.4. Deleting a user group using IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-a-member-to-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui">11.5. Adding a member to a user group using IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-group-members-using-idm-web-ui_managing-user-groups-in-idm-web-ui">11.6. Viewing group members using IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#removing-a-member-from-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui">11.7. Removing a member from a user group using IdM Web UI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#managing-hosts-cli_configuring-and-managing-idm">12. Managing Hosts in IdM CLI</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#hosts_managing-hosts-cli">12.1. Hosts in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#host-enrollment_managing-hosts-cli">12.2. Host enrollment</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#host-enrollment-privileges_managing-hosts-cli">12.2.1. User privileges required for host enrollment</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#comparing-hosts-and-users_managing-hosts-cli">12.2.2. Enrollment and authentication of IdM hosts and users: comparison</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#alternative-host-authentication_managing-hosts-cli">12.2.3. Alternative authentication options for IdM hosts</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#hosts-actions_managing-hosts-cli">12.3. Host Operations</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#con_host-entry-LDAP_managing-hosts-cli">12.4. Host entry in IdM LDAP</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#host-attributes_managing-hosts-cli">12.4.1. Host entry configuration properties</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-host-entry-cmd_managing-hosts-cli">12.5. Adding IdM host entries from IdM CLI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#deleting-host-entry-cmd_managing-hosts-cli">12.6. Deleting host entries from IdM CLI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#re-enrolling-an-ipa-client_managing-hosts-cli">12.7. Re-enrolling an Identity Management client</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#client-reenrollment-idm_re-enrolling-client">12.7.1. Client re-enrollment in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#re-enrolling-a-client-by-using-user-credentials-interactive-re-enrollment_re-enrolling-client">12.7.2. Re-enrolling a client by using user credentials: Interactive re-enrollment</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#re-enrolling-idm-client-using-keytab-non-interactive_re-enrolling-client">12.7.3. Re-enrolling a client by using the client keytab: Non-interactive re-enrollment</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#testing-an-ipa-client-re-enrolling-client">12.7.4. Testing an Identity Management client after installation</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#renaming-ipa-client-systems_managing-hosts-cli">12.8. Renaming Identity Management client systems</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#prerequisites_renaming-clients">12.8.1. Prerequisites</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#uninstalling-an-ipa-client-procedure_renaming-clients">12.8.2. Uninstalling an Identity Management client</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#renaming-the-ipa-client-system_renaming-clients">12.8.3. Renaming the host system</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#reinstalling-client">12.8.4. Re-installing an Identity Management client</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#re-adding-services-re-generating-certificates-and-re-adding-host-groups_renaming-clients">12.8.5. Re-adding services, re-generating certificates, and re-adding host groups</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#proc_host-disable-reenable_managing-hosts-cli">12.9. Disabling and Re-enabling Host Entries</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#proc_host-disable_managing-hosts-cli">12.9.1. Disabling Hosts</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#proc_reenabling-hosts_managing-hosts-cli">12.9.2. Re-enabling Hosts</a></li></ol></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-hosts-ui_configuring-and-managing-idm">13. Adding host entries from IdM Web UI</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#hosts_managing-hosts-ui">13.1. Hosts in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#host-enrollment_managing-hosts-ui">13.2. Host enrollment</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#host-enrollment-privileges_managing-hosts-ui">13.2.1. User privileges required for host enrollment</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#comparing-hosts-and-users_managing-hosts-ui">13.2.2. Enrollment and authentication of IdM hosts and users: comparison</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#alternative-host-authentication_managing-hosts-ui">13.2.3. Alternative authentication options for IdM hosts</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#con_host-entry-LDAP_managing-hosts-ui">13.3. Host entry in IdM LDAP</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#host-attributes_managing-hosts-ui">13.3.1. Host entry configuration properties</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-host-entry-ui_managing-hosts-ui">13.4. Adding Host Entries from the Web UI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adjusting-id-ranges-manually_configuring-and-managing-idm">14. Adjusting ID ranges manually</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#id-ranges_adjusting-id-ranges-manually">14.1. ID ranges</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#automatic-id-ranges-assignment_adjusting-id-ranges-manually">14.2. Automatic ID ranges assignment</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#assigning-the-idm-id-range-manually-during-server-installation_adjusting-id-ranges-manually">14.3. Assigning the IdM ID range manually during server installation</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-a-new-idm-id-range_adjusting-id-ranges-manually">14.4. Adding a new IdM ID range</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#displaying-currently-assigned-dna-id-ranges_adjusting-id-ranges-manually">14.5. Displaying currently assigned DNA ID ranges</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#automatic-dna-id-range-extension_adjusting-id-ranges-manually">14.6. Automatic DNA ID range extension</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#manual-dna-id-range-adjustment_adjusting-id-ranges-manually">14.7. Manual DNA ID range adjustment</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually">14.8. Adjusting DNA ID ranges manually</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#granting-sudo-access-to-an-IdM-user-on-an-IdM-client_configuring-and-managing-idm">15. Granting sudo access to an IdM user on an IdM client</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client">15.1. Sudo access on an IdM client</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client">15.2. Granting sudo access to an IdM user on an IdM client using IdM Web UI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#cert-intro_configuring-and-managing-idm">16. Public key certificates in Identity Management</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#certificate_authorities_in_idm">16.1. Certificate authorities in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#comparison_of_certificates_and_kerberos">16.2. Comparison of certificates and Kerberos</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#the_pros_and_cons_of_using_certificates_to_authenticate_users_in_idm">16.3. The pros and cons of using certificates to authenticate users in IdM</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#convert-cert-formats-idm_configuring-and-managing-idm">17. Converting certificate formats to work with IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#cert-types-idm_convert-cert-formats-idm">17.1. Certificate formats and encodings in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#convert-cert-to-load-to-user-profile-idm_convert-cert-formats-idm">17.2. Converting an external certificate to load into an IdM user account</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#convert-cert-to-load-to-user-profile-idm-cli">17.2.1. Converting an external certificate in the IdM CLI and loading it into an IdM user account</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#convert-cert-to-load-to-user-profile-idm-webui">17.2.2. Converting an external certificate in the IdM web UI for loading into an IdM user account:</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#prepare-load-cert-into-browser-idm_convert-cert-formats-idm">17.3. Preparing to load a certificate into the browser</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#export-cert-from-nss-to-pkcs12_convert-cert-formats-idm">17.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#combine-cert-private-key-to-pkcs12_convert-cert-formats-idm">17.3.2. Combining certificate and private key PEM files into a PKCS #12 file</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#other-cert-commands_convert-cert-formats-idm">17.4. Certificate-related commands and formats in IdM</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#managing-the-validity-of-certificates-in-idm_configuring-and-managing-idm">18. Managing the validity of certificates in IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-the-expiry-date-of-a-certificate_validity-certificates">18.1. Viewing the expiry date of a certificate</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_validity-certificates">18.1.1. Viewing the expiry date of a certificate in IdM WebUI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-the-expiry-date-of-a-certificate-in-the-CLI_validity-certificates">18.1.2. Viewing the expiry date of a certificate in the CLI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#revoking-certificates-with-the-integrated-IdM-CAs_validity-certificates">18.2. Revoking certificates with the integrated IdM CAs</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#certificate-revocation-reasons_revoking-certificates">18.2.1. Certificate revocation reasons</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates">18.2.2. Revoking certificates with the integrated IdM CAs using IdM WebUI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates">18.2.3. Revoking certificates with the integrated IdM CAs using IdM CLI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#restoring-certificates-with-the-integrated-IdM-CAs_validity-certificates">18.3. Restoring certificates with the integrated IdM CAs</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates">18.3.1. Restoring certificates with the integrated IdM CAs using IdM WebUI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates">18.3.2. Restoring certificates with the integrated IdM CAs using IdM CLI</a></li></ol></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-idm-for-smart-card-auth_configuring-and-managing-idm">19. Configuring Identity Management for smart card authentication</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth">19.1. Configuring the IdM server for smart card authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth">19.2. Configuring the IdM client for smart card authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#add-cert-idm-user_configuring-idm-for-smart-card-auth">19.3. Adding a certificate to a user entry in IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#proc-add-cert-idm-user-webui">19.3.1. Adding a certificate to a user entry in the IdM Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#proc-add-cert-idm-user-cli">19.3.2. Adding a certificate to a user entry in the IdM CLI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#installing-gnutls-utils_configuring-idm-for-smart-card-auth">19.4. Installing gnutls-utils</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth">19.5. Storing a certificate on the smart card</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#proc-conf-browser-for-s-c">19.6. Configuring the browser for smart card authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth">19.7. Logging in to IdM with smart cards</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_configuring-and-managing-idm">20. Configuring certificates issued by ADCS for smart card authentication in IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.1. Smart card authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.2. Windows Server settings required for trust configuration and certificate usage</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.3. Copying certificates from Active Directory using sftp</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.4. Configuring the IdM server and clients for smart card authentication using ADCS certificates</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.5. Converting the PFX file</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#installing-gnutls-utils_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.6. Installing gnutls-utils</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.7. Storing a certificate on the smart card</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.8. Configuring timeouts in sssd.conf</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">20.9. Creating certificate mapping rules for smart card authentication</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#conf-certmap-idm_configuring-and-managing-idm">21. Configuring certificate mapping rules in Identity Management</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#certificate_mapping_rules_for_configuring_authentication_on_smart_cards">21.1. Certificate mapping rules for configuring authentication on smart cards</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#certificate_mapping_rules_for_trusts_with_active_directory_domains">21.1.1. Certificate mapping rules for trusts with Active Directory domains</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#components_of_an_identity_mapping_rule_in_idm">21.1.2. Components of an identity mapping rule in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#obtaining_the_issuer_from_a_certificate_for_use_in_a_matching_rule">21.1.3. Obtaining the issuer from a certificate for use in a matching rule</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#conf-certmap-for-users-in-idm">21.2. Configuring certificate mapping for users stored in IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#adding_a_certificate_mapping_rule_in_idm">21.2.1. Adding a certificate mapping rule in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding_certificate_mapping_data_to_a_user_entry_in_idm">21.2.2. Adding certificate mapping data to a user entry in IdM</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#conf-certmap-for-ad-certs">21.3. Configuring certificate mapping for users whose AD user entry contains the whole certificate</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#adding_a_certificate_mapping_rule_for_users_whose_ad_entry_contains_whole_certificates">21.3.1. Adding a certificate mapping rule for users whose AD entry contains whole certificates</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring_certificate_mapping_if_ad_is_configured_to_map_user_certificates_to_user_accounts">21.4. Configuring certificate mapping if AD is configured to map user certificates to user accounts</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#adding_a_certificate_mapping_rule_if_the_trusted_ad_domain_is_configured_to_map_user_certificates">21.4.1. Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#checking_certificate_mapping_data_on_the_ad_side">21.4.2. Checking certificate mapping data on the AD side</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#conf-certmap-ad-no-cert-no-map">21.5. Configuring certificate mapping if AD user entry contains no certificate or mapping data</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#adding_a_certificate_mapping_rule_if_the_ad_user_entry_contains_no_certificate_or_mapping_data">21.5.1. Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#adding_a_certificate_to_an_ad_user_s_id_override_if_the_user_entry_in_ad_contains_no_certificate_or_mapping_data">21.5.2. Adding a certificate to an AD user’s ID override if the user entry in AD contains no certificate or mapping data</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#combining_several_identity_mapping_rules_into_one">21.6. Combining several identity mapping rules into one</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#dc-web-ui-auth_configuring-and-managing-idm">22. Configuring authentication with a certificate stored on the desktop of an IdM client</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring_the_identity_management_server_for_certificate_authentication_in_the_web_ui">22.1. Configuring the Identity Management Server for Certificate Authentication in the Web UI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_dc-web-ui-auth">22.2. Requesting a new user certificate and exporting it to the client</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#making-sure-cert-and-user-are-linked-idm">22.3. Making sure the certificate and user are linked together</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-browser-for-cert-auth_dc-web-ui-auth">22.4. Configuring a browser to enable certificate authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#authenticating_to_the_identity_management_web_ui_with_a_certificate_as_an_identity_management_user">22.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#authenticating-idm-cli-user-certificate_dc-web-ui-auth">22.6. Configuring an IdM client to enable authenticating to the CLI using a certificate</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#ipa-ca-renewal_configuring-and-managing-idm">23. Using IdM CA renewal master</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#ca-renewal-master_ipa-ca-renewal">23.1. Explanation of IdM CA renewal master</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#changing-ca-renewal_ipa-ca-renewal">23.2. Changing and resetting IdM CA renewal master</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#switch-from-externally-to-self-signed-ca_ipa-ca-renewal">23.3. Switching from an externally to self-signed CA in IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#renew-with-externally-signed-CA_ipa-ca-renewal">23.4. Renewing the IdM CA renewal master with an externally-signed certificate</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#renewing-expired-system-certificates-when-idm-is-offline_configuring-and-managing-idm">24. Renewing expired system certificates when IdM is offline</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline">24.1. Renewing expired system certificates on a CA Renewal Master</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline">24.2. Verifying other IdM servers in the IdM domain after renewal</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#generating-crl-on-the-idm-ca-server_configuring-and-managing-idm">25. Generating CRL on the IdM CA server</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server">25.1. Stopping CRL generation on IdM master server</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server">25.2. Starting CRL generation on IdM replica server</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-certmonger_configuring-and-managing-idm">26. Obtaining an IdM certificate for a service using certmonger</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#certmonger_certmonger-for-issuing-renewing-service-certs">26.1. Certmonger overview</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs">26.2. Obtaining an IdM certificate for a service using certmonger</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs">26.3. Communication flow for certmonger requesting a service certificate</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs">26.4. Viewing the details of a certificate request tracked by certmonger</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs">26.5. Starting and stopping certificate tracking</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#renew-cert_certmonger-for-issuing-renewing-service-certs">26.6. Renewing a certificate manually</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs">26.7. Making certmonger resume tracking of IdM certificates on a CA replica</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#restricting-an-application-to-trust-only-a-subset-of-certificates_configuring-and-managing-idm">27. Restricting an application to trust only a subset of certificates</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs">27.1. Creating a lightweight sub-CA</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs">27.1.1. Creating a sub-CA from IdM WebUI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs">27.1.2. Creating a sub-CA from IdM CLI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs">27.2. Downloading the sub-CA certificate from IdM WebUI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs">27.3. Creating CA ACLs for web server and client authentication</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs">27.3.1. Viewing CA ACLs in IdM CLI</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs">27.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs">27.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs">27.4. Obtaining an IdM certificate for a service using certmonger</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs">27.5. Communication flow for certmonger requesting a service certificate</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs">27.6. Setting up a single-instance Apache HTTP Server</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs">27.7. Adding TLS encryption to an Apache HTTP Server</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs">27.8. Setting the supported TLS protocol versions on an Apache HTTP Server</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs">27.9. Setting the supported ciphers on an Apache HTTP Server</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs">27.10. Configuring TLS client certificate authentication</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs">27.11. Requesting a new user certificate and exporting it to the client</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs">27.12. Configuring a browser to enable certificate authentication</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#invalidating-a-specific-group-of-related-certificates-quickly_configuring-and-managing-idm">28. Invalidating a specific group of related certificates quickly</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly">28.1. Disabling CA ACLs in IdM CLI</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#enabling-ad-user-to-administer-idm_configuring-and-managing-idm">29. Enabling AD users to administer IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#idoverrides-to-allow-ad-user-to-administer-idm-fin">29.1. ID overrides for AD users</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-idoverrides-to-allow-ad-user-to-administer-idm-fin">29.2. Using ID overrides to enable AD users to administer IdM</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-idm-cli-as-ad-user-fin">29.3. Managing IdM Command-Line Interface (CLI) as an AD user</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-canonicalized-dns-host-names-in-idm_configuring-and-managing-idm">30. Using canonicalized DNS host names in IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#adding-an-alias-to-a-host-principal_using-canonicalized-dns-host-names-in-idm">30.1. Adding an alias to a host principal</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#enabling-canonicalization-of-host-names-in-service-principals-on-clients_using-canonicalized-dns-host-names-in-idm">30.2. Enabling canonicalization of host names in service principals on clients</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#options-for-using-host-names-with-dns-host-name-canonicalization-enabled_using-canonicalized-dns-host-names-in-idm">30.3. Options for using host names with DNS host name canonicalization enabled</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#collecting-idm-healthcheck-information_configuring-and-managing-idm">31. Collecting IdM Healthcheck information</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#healthcheck-in-idm_collecting-idm-healthcheck-information">31.1. Healthcheck in IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#modules_are_independent">31.1.1. Modules are Independent</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#two_output_formats">31.1.2. Two output formats</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#results">31.1.3. Results</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#running_idm_healthcheck">31.1.4. Running IdM Healthcheck</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#log-rotation_collecting-idm-healthcheck-information">31.2. Log rotation</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#configuring-log-rotation-using-the-idm-healthcheck_collecting-idm-healthcheck-information">31.3. Configuring log rotation using the IdM Healthcheck</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#checking-services-using-idm-healthcheck_configuring-and-managing-idm">32. Checking services using IdM Healthcheck</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#services-healthcheck-test_checking-services-using-healthcheck">32.1. Services Healthcheck test</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#screening-services-using-healthcheck_checking-services-using-healthcheck">32.2. Screening services using Healthcheck</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#verifying-your-idm-and-ad-trust-configuration-using-idm-healthcheck_configuring-and-managing-idm">33. Verifying your IdM and AD trust configuration using IdM Healthcheck</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#idm-and-ad-trust-healthcheck-tests_verifying-your-idm-and-ad-trust-configuration-using-idm-healthcheck">33.1. IdM and AD trust Healthcheck tests</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#screening-the-trust-with-the-healthcheck-tool_verifying-your-idm-and-ad-trust-configuration-using-idm-healthcheck">33.2. Screening the trust with the Healthcheck tool</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#verifying-certificates-using-idm-healthcheck_configuring-and-managing-idm">34. Verifying certificates using IdM Healthcheck</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck">34.1. IdM certificates Healthcheck tests</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck">34.2. Screening certificates using the Healthcheck tool</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#verifying-system-certificates-using-idm-healthcheck_configuring-and-managing-idm">35. Verifying system certificates using IdM Healthcheck</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck">35.1. System certificates Healthcheck tests</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck">35.2. Screening system certificates using Healthcheck</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#checking-disk-space-using-idm-healthcheck_configuring-and-managing-idm">36. Checking disk space using IdM Healthcheck</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#disk-space-healthcheck-test_checking-disk-space-using-idm-healthcheck">36.1. Disk space healthcheck test</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#screening-disk-space-using-the-healthcheck-tool_checking-disk-space-using-idm-healthcheck">36.2. Screening disk space using the healthcheck tool</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#verifying-permissions-of-idm-configuration-files-using-healthcheck_configuring-and-managing-idm">37. Verifying permissions of IdM configuration files using Healthcheck</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#file-permissions-healthcheck-tests_verifying-permissions-of-idm-configuration-files-using-healthcheck">37.1. File permissions Healthcheck tests</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#screening-configuration-files-using-healthcheck_verifying-permissions-of-idm-configuration-files-using-healthcheck">37.2. Screening configuration files using Healthcheck</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#checking-idm-replication-using-healthcheck_configuring-and-managing-idm">38. Checking IdM replication using Healthcheck</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#replication-healthcheck-tests_checking-idm-replication-using-healthcheck">38.1. Replication healthcheck tests</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#screening-replication-using-healthcheck_checking-idm-replication-using-healthcheck">38.2. Screening replication using Healthcheck</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#demoting-or-promoting-hidden-replicas_configuring-and-managing-idm">39. Demoting or promoting hidden replicas</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#setting-up-samba-on-an-idm-domain-member_configuring-and-managing-idm">40. Setting up Samba on an IdM domain member</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#preparing-the-idm-domain-for-installing-samba-on-domain-members_setting-up-samba-on-an-idm-domain-member">40.1. Preparing the IdM domain for installing Samba on domain members</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#enabling-the-aes-encryption-type-in-active-directory-using-a-gpo_setting-up-samba-on-an-idm-domain-member">40.2. Enabling the AES encryption type in Active Directory using a GPO</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#installing-and-configuring-samba-on-an-idm-client_setting-up-samba-on-an-idm-domain-member">40.3. Installing and configuring a Samba server on an IdM client</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#manually-adding-an-id-mapping-configuration-if-idm-trusts-a-new-domain_setting-up-samba-on-an-idm-domain-member">40.4. Manually adding an ID mapping configuration if IdM trusts a new domain</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#additional_resources">40.5. Additional resources</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#identity-management-security-settings_configuring-and-managing-idm">41. Identity Management security settings</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#how-identity-management-applies-default-security-settings_identity-management-security-settings">41.1. How Identity Management applies default security settings</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#anonymous-ldap-binds-in-identity-management_identity-management-security-settings">41.2. Anonymous LDAP binds in Identity Management</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#using-automount_configuring-and-managing-idm">42. Using automount in IdM</a><ol class="menu"><li class=" leaf"><a href="index%3Flb_target=stage.html#setting-up-a-kerberos-aware-nfs-server_using-automount">42.1. Setting up a Kerberos-aware NFS server</a></li><li class=" leaf"><a href="index%3Flb_target=stage.html#setting-up-a-kerberos-aware-nfs-client_using-automount">42.2. Setting up a Kerberos-aware NFS client</a></li></ol></li><li class=" leaf"><a href="index%3Flb_target=stage.html#idm140406472202496">Legal Notice</a></li></ol>  </div>
</nav>


  <div class="doc-wrapper">
    <div class="panel-pane pane-training-banner"  >
  
      
  
  <div class="card card-light card-md push-bottom">
  <h2 class="card-heading card-heading-red card-heading-sm card-heading-flush">Red Hat Training</h2>
  <p>A Red Hat training course is available for <a href="https://www.redhat.com/en/services/training/courses-by-curriculum?intcmp=701f2000001D4OtAAK&amp;#Red-Hat-Enterprise-Linux" class="cta-link">RHEL 8</a></p>
</div>

  
  </div>
<div class="panel-pane pane-page-title"  >
  
      
  
  <h1 class="title" itemprop="name">Configuring and managing Identity Management</h1>
  
  </div>
<div class="panel-pane pane-page-body"  >
  
      
  
  <div class="body"><div xml:lang="en-US" class="book" id="idm140406495572640"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">8</span></div><div><h2 class="subtitle">Configuring, managing, and maintaining Identity Management in Red Hat Enterprise Linux 8</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="index%3Flb_target=stage.html#idm140406472202496">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This documentation collection provides instructions on how to effectively configure, manage and maintain Identity Management on Red Hat Enterprise Linux 8.
			</div></div></div></div><hr/></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Providing feedback on Red Hat documentation</h1></div></div></div><p>
			We appreciate your input on our documentation. Please let us know how we could make it better. To do so:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					For simple comments on specific passages:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Make sure you are viewing the documentation in the <span class="emphasis"><em>Multi-page HTML</em></span> format. In addition, ensure you see the <span class="strong strong"><strong>Feedback</strong></span> button in the upper right corner of the document.
						</li><li class="listitem">
							Use your mouse cursor to highlight the part of text that you want to comment on.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Add Feedback</strong></span> pop-up that appears below the highlighted text.
						</li><li class="listitem">
							Follow the displayed instructions.
						</li></ol></div></li><li class="listitem"><p class="simpara">
					For submitting more complex feedback, create a Bugzilla ticket:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Go to the <a class="link" href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20Enterprise%20Linux%208">Bugzilla</a> website.
						</li><li class="listitem">
							As the Component, use <span class="strong strong"><strong>Documentation</strong></span>.
						</li><li class="listitem">
							Fill in the <span class="strong strong"><strong>Description</strong></span> field with your suggestion for improvement. Include a link to the relevant part(s) of documentation.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit Bug</strong></span>.
						</li></ol></div></li></ul></div></section><section class="chapter" id="logging-in-to-ipa-from-the-command-line_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Logging in to Identity Management from the command line</h1></div></div></div><p>
			Identity Management (IdM) uses the Kerberos protocol to support single sign-on. Single sign-on means that the user enters the correct user name and password only once, and then accesses IdM services without the system prompting for the credentials again.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				In IdM, the System Security Services Daemon (SSSD) automatically obtains a ticket-granting ticket (TGT) for a user after the user successfully logs in to the desktop environment on an IdM client machine with the corresponding Kerberos principal name. This means that after logging in, the user is not required to use the <span class="strong strong"><strong>kinit</strong></span> utility to access IdM resources.
			</p></div></div><p>
			If you have cleared your Kerberos credential cache or your Kerberos TGT has expired, you need to request a Kerberos ticket manually to access IdM resources. The following sections present basic user operations when using Kerberos in IdM.
		</p><section class="section" id="using-kinit-to-log-in-to-ipa_logging-in-to-ipa-from-the-command-line"><div class="titlepage"><div><div><h2 class="title">1.1. Using <span class="strong strong"><strong>kinit</strong></span> to log in to IdM manually</h2></div></div></div><p>
				This procedure describes using the <span class="strong strong"><strong>kinit</strong></span> utility to authenticate to an Identity Management (IdM) environment manually. The <span class="strong strong"><strong>kinit</strong></span> utility obtains and caches a Kerberos ticket-granting ticket (TGT) on behalf of an IdM user.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Only use this procedure if you have destroyed your initial Kerberos TGT or if it has expired. As an IdM user, when logging onto your local machine you are also automatically logging in to IdM. This means that after logging in, you are not required to use the <span class="strong strong"><strong>kinit</strong></span> utility to access IdM resources.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To log in to IdM
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								under the user name of the user who is currently logged in on the local system, use <span class="strong strong"><strong>kinit</strong></span> without specifying a user name. For example, if you are logged in as <code class="literal">example_user</code> on the local system:
							</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>kinit</strong></span>
Password for example_user@EXAMPLE.COM:
[example_user@server ~]$</pre><p class="simpara">
								If the user name of the local user does not match any user entry in IdM, the authentication attempt fails:
							</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>kinit</strong></span>
kinit: Client 'example_user@EXAMPLE.COM' not found in Kerberos database while getting initial credentials</pre></li><li class="listitem"><p class="simpara">
								using a Kerberos principal that does not correspond to your local user name, pass the required user name to the <code class="literal">kinit</code> utility. For example, to log in as the <code class="literal">admin</code> user:
							</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@EXAMPLE.COM:
[example_user@server ~]$</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, to verify that the login was successful, use the <span class="strong strong"><strong>klist</strong></span> utility to display the cached TGT. In the following example, the cache contains a ticket for the <code class="literal">example_user</code> principal, which means that on this particular host, only <code class="literal">example_user</code> is currently allowed to access IdM services:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>klist</strong></span>
Ticket cache: KEYRING:persistent:0:0
Default principal: <span class="strong strong"><strong>example_user@EXAMPLE.COM</strong></span>

Valid starting     	Expires            	Service principal
11/10/2019 08:35:45  	11/10/2019 18:35:45  	krbtgt/EXAMPLE.COM@EXAMPLE.COM</pre></li></ol></div></section><section class="section" id="destroying-the-users-active-kerberos-ticket-idm_logging-in-to-ipa-from-the-command-line"><div class="titlepage"><div><div><h2 class="title">1.2. Destroying a user’s active Kerberos ticket</h2></div></div></div><p>
				This section describes how to clear the credentials cache that contains the user’s active Kerberos ticket.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To destroy your Kerberos ticket:
					</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>kdestroy</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optionally, to check that the Kerberos ticket has been destroyed:
					</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>klist</strong></span>
<span class="strong strong"><strong>klist: Credentials cache keyring 'persistent:0:0' not found</strong></span></pre></li></ol></div></section><section class="section" id="configuring-an-external-system-for-kerberos-authentication-logging-in-to-ipa-from-the-command-line"><div class="titlepage"><div><div><h2 class="title">1.3. Configuring an external system for Kerberos authentication</h2></div></div></div><p>
				This section describes how to configure an external system so that Identity Management (IdM) users can log in to IdM from the external system using their Kerberos credentials.
			</p><p>
				Enabling Kerberos authentication on external systems is especially useful when your infrastructure includes multiple realms or overlapping domains. It is also useful if the system has not been enrolled into any IdM domain through <code class="literal">ipa-client-install</code>.
			</p><p>
				To enable Kerberos authentication to IdM from a system that is not a member of the IdM domain, define an IdM-specific Kerberos configuration file on the external system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">krb5-workstation</code> package is installed on the external system.
					</p><p class="simpara">
						To find out whether the package is installed, use the following CLI command:
					</p><pre class="literallayout"># <span class="strong strong"><strong>yum list installed krb5-workstation</strong></span>
Installed Packages
krb5-workstation.x86_64    1.16.1-19.el8     @BaseOS</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy the <code class="literal">/etc/krb5.conf</code> file from the IdM server to the external system. For example:
					</p><pre class="literallayout"># <span class="strong strong"><strong>scp /etc/krb5.conf root@<span class="emphasis"><em>externalsystem.example.com</em></span>:/etc/krb5_ipa.conf</strong></span></pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not overwrite the existing <code class="literal">krb5.conf</code> file on the external system.
						</p></div></div></li><li class="listitem"><p class="simpara">
						On the external system, set the terminal session to use the copied IdM Kerberos configuration file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>export KRB5_CONFIG=/etc/krb5_ipa.conf</strong></span></pre><p class="simpara">
						The <code class="literal">KRB5_CONFIG</code> variable exists only temporarily until you log out. To prevent this loss, export the variable with a different file name.
					</p></li><li class="listitem">
						Copy the Kerberos configuration snippets from the <code class="literal">/etc/krb5.conf.d/</code> directory to the external system.
					</li></ol></div><p>
				Users on the external system can now use the <code class="literal">kinit</code> utility to authenticate against the IdM server.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For details on Kerberos, see the <code class="literal">krb5.conf(5)</code>, <code class="literal">kinit(1)</code>, <code class="literal">klist(1)</code>, and <code class="literal">kdestroy(1)</code> man pages.
					</li></ul></div></section></section><section class="chapter" id="viewing-starting-and-stopping-the-ipa-server_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Viewing, starting and stopping the Identity Management services</h1></div></div></div><p>
			Identity Management (IdM) servers are Red Hat Enterprise Linux systems that work as domain controllers (DCs). A number of different services are running on IdM servers, most notably the Directory Server, Certificate Authority (CA), DNS, and Kerberos.
		</p><section class="section" id="viewing-running-idm-services_start-stop-ipa"><div class="titlepage"><div><div><h2 class="title">2.1. Viewing the status of IdM services</h2></div></div></div><p>
				To view the status of the IdM services that are configured on your IdM server:
			</p><pre class="literallayout">[root@server ~]# <code class="literal">ipactl status</code>
Directory Service: RUNNING
krb5kdc Service: RUNNING
kadmin Service: RUNNING
named Service: RUNNING
httpd Service: RUNNING
ntpd Service: RUNNING
pki-tomcatd Service: RUNNING
smb Service: RUNNING
winbind Service: RUNNING
ipa-otpd Service: RUNNING
ipa-dnskeysyncd Service: RUNNING
ipa: INFO: The ipactl command was successful</pre><p>
				In the output above:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The Kerberos service is divided into two parts, <code class="literal">krb5kdc</code> and <code class="literal">kadmin</code>. The <code class="literal">krb5kdc</code> service is the Kerberos version 5 Authentication service and Key Distribution Center (KDC) deamon. The <code class="literal">kadmin</code> service is the Kerberos V5 database administration program.
					</li><li class="listitem">
						The <code class="literal">named</code> service refers to the Internet domain name service (DNS).
					</li><li class="listitem">
						<code class="literal">pki</code> is the Command-Line Interface for accessing Certificate System services. The <code class="literal">pki-tomcatd</code> program handles Identity Management operations related to certificates.
					</li></ul></div><p>
				The output of the <code class="literal">ipactl status</code> command on your server depends on your IdM configuration. For example, if an IdM deployment does not include a DNS server, the <code class="literal">named</code> service is not present in the list.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You cannot use the IdM web UI to view the status of all the IdM services running on a particular IdM server. Kerberized services running on different servers can be viewed in the <code class="literal">Identity</code> → <code class="literal">Services</code> tab of the IdM web UI.
				</p></div></div><p>
				You can start or stop the entire server, or an individual service only.
			</p><p>
				To start, stop, or restart the entire IdM server, see:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#starting-and-stopping-the-entire-ipa-server-the-ipactl-utility_start-stop-ipa" title="2.2. Starting and stopping the entire Identity Management server: the ipactl utility">Section 2.2, “Starting and stopping the entire Identity Management server: the <code class="literal">ipactl</code> utility”</a>
					</li></ul></div><p>
				To start, stop, or restart an individual IdM service, see:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#starting-and-stopping-an-individual-ipa-service-the-systemctl-utility_start-stop-ipa" title="2.3. Starting and stopping an individual Identity Management service: the systemctl utility">Section 2.3, “Starting and stopping an individual Identity Management service: the <code class="literal">systemctl</code> utility”</a>
					</li></ul></div><p>
				To display the version of IdM software, see:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#display-software-version_start-stop-ipa" title="2.4. Methods for Displaying Identity Management Software Version">Section 2.4, “Methods for Displaying Identity Management Software Version”</a>
					</li></ul></div></section><section class="section" id="starting-and-stopping-the-entire-ipa-server-the-ipactl-utility_start-stop-ipa"><div class="titlepage"><div><div><h2 class="title">2.2. Starting and stopping the entire Identity Management server: the <code class="literal">ipactl</code> utility</h2></div></div></div><p>
				Use the <code class="literal">ipactl</code> utility to stop, start, or restart the entire IdM server along with all the installed services. Using the <code class="literal">ipactl</code> utility ensures all services are stopped, started, or restarted in the appropriate order. You do not need to have a valid Kerberos ticket to run the <code class="literal">ipactl</code> commands.
			</p><h4 id="literal_ipactl_literal_commands"><code class="literal">ipactl</code> commands</h4><p>
				To start the entire IdM server:
			</p><pre class="literallayout"># <span class="strong strong"><strong>ipactl start</strong></span></pre><p>
				To stop the entire IdM server:
			</p><pre class="literallayout"># <span class="strong strong"><strong>ipactl stop</strong></span></pre><p>
				To restart the entire IdM server:
			</p><pre class="literallayout"># <span class="strong strong"><strong>ipactl restart</strong></span></pre><p>
				To show the status of all the services that make up IdM:
			</p><pre class="literallayout"># <span class="strong strong"><strong>ipactl status</strong></span></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					You cannot use the IdM web UI to perform the <code class="literal">ipactl</code> commands.
				</p></div></div></section><section class="section" id="starting-and-stopping-an-individual-ipa-service-the-systemctl-utility_start-stop-ipa"><div class="titlepage"><div><div><h2 class="title">2.3. Starting and stopping an individual Identity Management service: the <code class="literal">systemctl</code> utility</h2></div></div></div><p>
				Changing IdM configuration files manually is generally not recommended. However, certain situations require that an administrator performs a manual configuration of specific services. In such situations, use the <code class="literal">systemctl</code> utility to stop, start, or restart an individual IdM service.
			</p><p>
				For example, use <code class="literal">systemctl</code> after customizing the Directory Server behavior, without modifying the other IdM services:
			</p><pre class="literallayout"># <code class="literal">systemctl restart dirsrv@REALM-NAME.service</code></pre><p>
				Also, when initially deploying an IdM trust with Active Directory, modify the <code class="literal">/etc/sssd/sssd.conf</code> file, adding:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						specific parameters to tune the timeout configuration options in an environment where remote servers have a high latency
					</li><li class="listitem">
						specific parameters to tune the Active Directory site affinity
					</li><li class="listitem">
						overrides for certain configuration options that are not provided by the global IdM settings
					</li></ul></div><p>
				To apply the changes you have made in the <code class="literal">/etc/sssd/sssd.conf</code> file:
			</p><pre class="literallayout"># <code class="literal">systemctl restart sssd.service</code></pre><p>
				Running <code class="literal">systemctl restart sssd.service</code> is required because the System Security Services Daemon (SSSD) does not automatically re-read or re-apply its configuration.
			</p><p>
				Note that for changes that affect IdM identity ranges, a complete server reboot is recommended.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					To restart multiple IdM domain services, always use <code class="literal">ipactl</code>. Because of dependencies between the services installed with the IdM server, the order in which they are started and stopped is critical. The <code class="literal">ipactl</code> utility ensures that the services are started and stopped in the appropriate order.
				</p></div></div><h4 id="useful_literal_systemctl_literal_commands">Useful <code class="literal">systemctl</code> commands</h4><p>
				To start a particular IdM service:
			</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl start <span class="emphasis"><em>name</em></span>.service</strong></span></pre><p>
				To stop a particular IdM service:
			</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl stop <span class="emphasis"><em>name</em></span>.service</strong></span></pre><p>
				To restart a particular IdM service:
			</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart <span class="emphasis"><em>name</em></span>.service</strong></span></pre><p>
				To view the status of a particular IdM service:
			</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl status <span class="emphasis"><em>name</em></span>.service</strong></span></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					You cannot use the IdM web UI to start or stop the individual services running on IdM servers. You can only use the web UI to modify the settings of a Kerberized service by navigating to <code class="literal">Identity</code> → <code class="literal">Services</code> and selecting the service.
				</p></div></div></section><section class="section" id="display-software-version_start-stop-ipa"><div class="titlepage"><div><div><h2 class="title">2.4. Methods for Displaying Identity Management Software Version</h2></div></div></div><p>
				You can display the IdM version number with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						the IdM WebUI
					</li><li class="listitem">
						<code class="literal">ipa</code> commands
					</li><li class="listitem"><p class="simpara">
						<code class="literal">rpm</code> commands
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Displaying Version through the WebUI</span></dt><dd><p class="simpara">
									In the IdM WebUI, the software version can be displayed by choosing <code class="literal">About</code> from the username menu at the top-right.
								</p><div class="informalfigure"><div class="mediaobject"><img src="idm-version-check.png" alt="Checking IdM Software Version"/></div></div></dd><dt><span class="term">Displaying Version with <code class="literal">ipa</code> commands</span></dt><dd><p class="simpara">
									From the command line, use the <code class="literal">ipa --version</code> command.
								</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa --version</strong></span>
<span class="strong strong"><strong>VERSION: 4.8.0</strong></span>, API_VERSION: 2.233</pre></dd><dt><span class="term">Displaying Version with rpm commands</span></dt><dd><p class="simpara">
									If IdM services are not operating properly, you can use the <code class="literal">rpm</code> utility to determine the version number of the <code class="literal">ipa-server</code> package that is currently installed.
								</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>rpm -q ipa-server</strong></span>
<span class="strong strong"><strong>ipa-server-4.8.0-11</strong></span>.module+el8.1.0+4247+9f3fd721.x86_64</pre></dd></dl></div></li></ul></div></section></section><section class="chapter" id="introduction-to-the-ipa-command-line-utilities_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Introduction to the IdM command-line utilities</h1></div></div></div><p>
			The following sections describe the basics of using the Identity Management (IdM) command-line utilities.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Installed and accessible IdM server.
				</p><p class="simpara">
					For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management">Installing Identity Management</a>.
				</p></li><li class="listitem"><p class="simpara">
					To use the IPA command line interface, authenticate to IdM with a valid Kerberos ticket.
				</p><p class="simpara">
					For details about obtaining a valid Kerberos ticket, see <a class="link" href="index.html#logging-in-to-ipa-from-the-command-line_getting-started-using-identity-management">Logging in to Identity Management from the command line</a>.
				</p></li></ul></div><section class="section" id="what-is-the-ipa-command-line-interface_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.1. What is the IPA command line interface</h2></div></div></div><p>
				The IPA command line interface (CLI) is the basic command-line interface for Identity Management (IdM) administration.
			</p><p>
				It supports a lot of subcommands that are used to manage IdM, such as the <code class="literal command">ipa user-add</code> command to add a new user.
			</p><p>
				IPA CLI allows you to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Add, manage, or remove users, groups, hosts and other objects in the network.
					</li><li class="listitem">
						Manage certificates.
					</li><li class="listitem">
						Search entries.
					</li><li class="listitem">
						Display and list objects.
					</li><li class="listitem">
						Set access rights.
					</li><li class="listitem">
						Get help with the correct command syntax.
					</li></ul></div></section><section class="section" id="what-is-the-ipa-help_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.2. What is the IPA help</h2></div></div></div><p>
				The IPA help is a built-in documentation system for the IdM server.
			</p><p>
				IPA command line interface (CLI) generates available help topics from loaded IdM plugin modules. If you want to run the IPA help successfully, you need to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Have an IdM server installed and running.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Be authenticated with a valid Kerberos ticket.
					</li></ul></div><p>
				Executing the <code class="literal">ipa help</code> command without options displays information about basic help usage and the most common command examples.
			</p><p>
				Executing help with options has the following syntax:
			</p><pre class="literallayout"><span class="strong strong"><strong>$ ipa help [TOPIC | COMMAND | topics | commands]</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>[]</strong></span></code> — Brackets mean that all parameters are optional and you can write just <code class="literal">ipa help</code> and the command will be executed.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>|</strong></span></code> — The pipe character means <span class="strong strong"><strong>or</strong></span>. Therefore, you can use TOPIC or COMMAND or topics or commands with the basic <code class="literal">ipa help</code> command.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>topics</strong></span></code> — You can run the command <code class="literal">ipa help topics</code> and it will execute correctly. The command displays a list of topics that are covered by IPA help, for example, <code class="literal">user</code>, <code class="literal">cert</code>, <code class="literal">server</code> and many others.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>TOPIC</strong></span></code> — The <span class="strong strong"><strong>TOPIC</strong></span> with capital letters means variable, therefore, you can use the particular topic, for example, <code class="literal">ipa help user</code>
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>commands</strong></span></code> — You can run the command <code class="literal">ipa help commands</code> and it will execute correctly. The command displays a list of commands which are covered by the IPA help, for example, <code class="literal">user-add</code>, <code class="literal">ca-enable</code>, <code class="literal">server-show</code> and many others.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>COMMAND</strong></span></code> — The <span class="strong strong"><strong>COMMAND</strong></span> with capital letters means variable, therefore, you can use the particular command, for example, <code class="literal">ipa help user-add</code>
					</li></ul></div></section><section class="section" id="using-ipa-help-topics_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.3. Using IPA help topics</h2></div></div></div><p>
				The following procedure helps you to understand using the IPA help in the command line interface.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Enter <code class="literal">ipa help topics</code> to display a list of topics covered by help.
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa help topics</strong></span></pre></li><li class="listitem"><p class="simpara">
						Select one of the topics and create a command according to the following pattern: <code class="literal">ipa help [topic_name]</code>, instead of the <code class="literal">topic_name</code> string, add one of the topics you listed in the previous step.
					</p><p class="simpara">
						In the example, we use the following topic: <code class="literal">user</code>
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa help user</strong></span></pre></li><li class="listitem"><p class="simpara">
						If the IPA help command is too long and you cannot see the whole text, use the following syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa help user | less</strong></span></pre><p class="simpara">
						You can then scroll down and read the whole help.
					</p></li></ol></div><p>
				The IPA CLI displays a help page for the <code class="literal">user</code> topic. After reading the overview, you can see many examples with patterns for working with topic commands.
			</p></section><section class="section" id="using-ipa-help-commands_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.4. Using IPA help commands</h2></div></div></div><p>
				The following procedure helps you to understand creating the IPA help commands in the command line interface.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Enter <code class="literal">ipa help commands</code> to display a list of commands covered by help.
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa help commands</strong></span></pre></li><li class="listitem"><p class="simpara">
						Select one of the commands and create a help command according to the following pattern: <code class="literal">ipa help &lt;COMMAND&gt;</code>, instead of the <code class="literal">&lt;COMMAND&gt;</code> string, add one of the commands you listed in the previous step.
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa help user-add</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For details, see <code class="literal">man ipa</code> page.
					</li></ul></div></section><section class="section" id="the-structure-of-ipa-commands_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.5. Structure of IPA commands</h2></div></div></div><p>
				The IPA CLI distinguishes the following types of commands:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Built-in commands — Built-in commands are all available in the IdM server.
					</li><li class="listitem">
						Plug-in provided commands
					</li></ul></div><p>
				Structure of IPA commands allows you to manage various types of objects. For example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users,
					</li><li class="listitem">
						Hosts,
					</li><li class="listitem">
						DNS records,
					</li><li class="listitem">
						Certificates,
					</li></ul></div><p>
				and many others.
			</p><p>
				For most of these objects, the IPA CLI includes commands to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Add (<code class="literal">add</code>)
					</li><li class="listitem">
						Modify (<code class="literal">mod</code>)
					</li><li class="listitem">
						Delete (<code class="literal">del</code>)
					</li><li class="listitem">
						Search (<code class="literal">find</code>)
					</li><li class="listitem">
						Display (<code class="literal">show</code>)
					</li></ul></div><p>
				Commands have the following structure:
			</p><p>
				<code class="literal">ipa user-add</code>, <code class="literal">ipa user-mod</code>, <code class="literal">ipa user-del</code>, <code class="literal">ipa user-find</code>, <code class="literal">ipa user-show</code>
			</p><p>
				<code class="literal">ipa host-add</code>, <code class="literal">ipa host-mod</code>, <code class="literal">ipa host-del</code>, <code class="literal">ipa host-find</code>, <code class="literal">ipa host-show</code>
			</p><p>
				<code class="literal">ipa dnsrecord-add</code>, <code class="literal">ipa dnsrecord-mod</code>, <code class="literal">ipa dnsrecord-del</code>, <code class="literal">ipa dnsrecord-find</code>, <code class="literal">ipa dnrecord-show</code>
			</p><p>
				You can create a user with the <code class="literal">ipa user-add [options]</code>, where <code class="literal">[options]</code> are optional. If you use just the <code class="literal">ipa user-add</code> command, the script asks you for details one by one.
			</p><p>
				To change an existing object, you need to define the object, therefore the command includes also object: <code class="literal">ipa user-mod USER_NAME [options]</code>.
			</p></section><section class="section" id="using-an-ipa-command-to-add-a-user-account-to-idm_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.6. Using an IPA command to add a user account to IdM</h2></div></div></div><p>
				The following describes adding a new user to the Identity Management database using command line.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You need to have administrator privileges to add user accounts to the IdM server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Enter the command for adding a new user:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add</strong></span></pre><p class="simpara">
						The command runs a script where you can add basic data necessary for creating a user account.
					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>First name:</strong></span> field, enter the first name of the new user and press the <span class="strong strong"><strong>Enter</strong></span> key.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Last name:</strong></span> field, enter the last name of the new user and press the <span class="strong strong"><strong>Enter</strong></span> key.
					</li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>User login [suggested user name]:</strong></span> enter the user name or just press the <span class="strong strong"><strong>Enter</strong></span> key if the suggested user name works for you.
					</p><p class="simpara">
						User name must be unique for the whole IdM database. If an error occurs, that the user already exists, you need to start from the beginning with the <code class="literal">ipa user-add</code> command and try a different user name.
					</p></li></ol></div><p>
				After you successfully added the user name, the user account has been added to the IdM database and the IPA CLI prints on the output the following log:
			</p><pre class="literallayout">----------------------
Added user "euser"
----------------------
User login: euser
First name: Example
Last name: User
Full name: Example User
Display name: Example User
Initials: EU
Home directory: /home/euser
GECOS: Example User
Login shell: /bin/sh
Principal name: euser@IDM.EXAMPLE.COM
Principal alias: euser@IDM.EXAMPLE.COM
Email address: euser@idm.example.com
UID: 427200006
GID: 427200006
<span class="strong strong"><strong>Password: False</strong></span>
Member of groups: ipausers
<span class="strong strong"><strong>Kerberos keys available: False</strong></span></pre><p>
				As you can see, a user password is not set to the user account. If you want to add also password, use the <code class="literal">ipa user-add</code> command in the following syntax:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add --first=Example --last=User --password</strong></span></pre><p>
				The IPA CLI then asks you for adding or confirming a user name and password.
			</p><p>
				If the user has been already created, you can add only the password with the `ipa user-mod`command.
			</p><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					For more information about parameters, enter the following help command to the command line:
				</p></div><pre class="literallayout">$ <span class="strong strong"><strong>ipa help user-add</strong></span></pre></section><section class="section" id="using-an-ipa-command-to-modify-a-user-account-in-idm_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.7. Using an IPA command to modify a user account in IdM</h2></div></div></div><p>
				You can change many parameters for each user account. For example, you can add a new password to the user.
			</p><p>
				Basic command syntax is different from the <code class="literal">user-add</code> syntax because you need to define the existing user account for which you want to perform changes, for example, add a password.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You need to have administrator privileges to modify user accounts in the IdM server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Enter the command for adding a password:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-mod euser --password</strong></span></pre><p class="simpara">
						The command runs a script where you can add the new password.
					</p></li><li class="listitem">
						Enter the new password and press the <span class="strong strong"><strong>Enter</strong></span> key.
					</li></ol></div><p>
				After you successfully added the user name, the user account has been added to the IdM database and the IPA CLI prints on the output the following log:
			</p><pre class="literallayout">----------------------
Modified user "euser"
----------------------
User login: euser
First name: Example
Last name: User
Home directory: /home/euser
Principal name: euser@IDM.EXAMPLE.COM
Principal alias: euser@IDM.EXAMPLE.COM
Email address: euser@idm.example.com
UID: 427200006
GID: 427200006
<span class="strong strong"><strong>Password: True</strong></span>
Member of groups: ipausers
<span class="strong strong"><strong>Kerberos keys available: True</strong></span></pre><p>
				The user password is now set for the account and the user can log into IdM.
			</p><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					For more information about parameters, enter the following help command to the command line:
				</p></div><pre class="literallayout">$ <span class="strong strong"><strong>ipa help user-mod</strong></span></pre></section><section class="section" id="how-to-supply-a-list-of-values-to-the-ipa-utilities_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.8. How to supply a list of values to the IdM utilities</h2></div></div></div><p>
				Identity Management (IdM) stores values for multi-valued attributes in lists.
			</p><p>
				IdM supports the following methods of supplying multi-valued lists:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Using the same command-line argument multiple times within the same command invocation:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa permission-add <span class="emphasis"><em>--right=read --permissions=write --permissions=delete ...</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Alternatively, you can enclose the list in curly braces, in which case the shell performs the expansion:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa permission-add <span class="emphasis"><em>--right={read,write,delete} ...</em></span></strong></span></pre></li></ul></div><p>
				Examples above show a command <code class="literal"><span class="strong strong"><strong>permission-add</strong></span></code> which adds permissions to an object. The object is not mentioned in the example. Instead of <code class="literal"><span class="strong strong"><strong>…​</strong></span></code> you need to add the object for which you want to add permissions.
			</p><p>
				When you update such multi-valued attributes from the command line, IdM completely overwrites the previous list of values with a new list. Therefore, when updating a multi-valued attribute, you must specify the whole new list, not just a single value you want to add.
			</p><p>
				In the command above, the list of permissions includes reading, writing and deleting. When you decide to update the list with the <code class="literal"><span class="strong strong"><strong>permission-mod</strong></span></code> command, you must add all values, otherwise those not mentioned will be deleted.
			</p><p>
				<span class="strong strong"><strong>Example 1:</strong></span> — The <code class="literal"><span class="strong strong"><strong>ipa permission-mod</strong></span></code> command updates all previously added permissions.
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa permission-mod <span class="emphasis"><em>--right=read --right=write --right=delete ...</em></span></strong></span></pre><p>
				or
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa permission-mod <span class="emphasis"><em>--right={read,write,delete} ...</em></span></strong></span></pre><p>
				<span class="strong strong"><strong>Example 2</strong></span> — The <code class="literal"><span class="strong strong"><strong>ipa permission-mod</strong></span></code> command deletes the <code class="literal"><span class="strong strong"><strong>--right=delete</strong></span></code> argument because it is not included in the command:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa permission-mod <span class="emphasis"><em>--right=read --right=write ...</em></span></strong></span></pre><p>
				or
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa permission-mod <span class="emphasis"><em>--right={read,write} ...</em></span></strong></span></pre></section><section class="section" id="how-to-use-special-characters-with-the-ipa-utilities_introduction-to-the-ipa-command-line-utilities"><div class="titlepage"><div><div><h2 class="title">3.9. How to use special characters with the IdM utilities</h2></div></div></div><p>
				When passing command-line arguments that include special characters to the <code class="literal">ipa</code> commands, escape these characters with a backslash (\). For example, common special characters include angle brackets (&lt; and &gt;), ampersand (&amp;), asterisk (*), or vertical bar (|).
			</p><p>
				For example, to escape an asterisk (*):
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa certprofile-show certificate_profile --out=<span class="emphasis"><em>exported\*profile.cfg</em></span></strong></span></pre><p>
				Commands containing unescaped special characters do not work as expected because the shell cannot properly parse such characters.
			</p></section></section><section class="chapter" id="searching-ipa-entries_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Searching Identity Management entries from the command line</h1></div></div></div><p>
			The following sections describe how to use IPA commands, which helps you to find or show objects.
		</p><section class="section" id="overview-of-listing-ipa-entries_search-ipa"><div class="titlepage"><div><div><h2 class="title">4.1. Overview of listing IdM entries</h2></div></div></div><p>
				This section describes the <code class="literal">ipa *-find</code> commands, which can help you to search for a particular type of IdM entries.
			</p><p>
				To list all the <code class="literal">find</code> commands, use the following ipa help command:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa help commands | grep find</strong></span></pre><p>
				You may need to check if a particular user is included in the IdM database. You can then list all users with the following command:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-find</strong></span></pre><p>
				To list user groups whose specified attributes contain a keyword:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa group-find <span class="emphasis"><em>keyword</em></span></strong></span></pre><p>
				For example the <code class="literal"><span class="strong strong"><strong>ipa group-find <span class="emphasis"><em>admin</em></span></strong></span></code> command lists all groups whose names or descriptions include string <code class="literal">admin</code>:
			</p><pre class="literallayout">----------------
3 groups matched
----------------
   Group name: <span class="strong strong"><strong>admins</strong></span>
   Description: Account <span class="strong strong"><strong>administrators</strong></span> group
   GID: 427200002

   Group name: editors
   Description: Limited <span class="strong strong"><strong>admins</strong></span> who can edit other users
   GID: 427200002

   Group name: trust <span class="strong strong"><strong>admins</strong></span>
   Description: Trusts <span class="strong strong"><strong>administrators</strong></span> group</pre><p>
				When searching user groups, you can also limit the search results to groups that contain a particular user:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa group-find --user=<span class="emphasis"><em>user_name</em></span></strong></span></pre><p>
				To search for groups that do not contain a particular user:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa group-find --no-user=<span class="emphasis"><em>user_name</em></span></strong></span></pre></section><section class="section" id="showing-details-for-a-particular-entry_search-ipa"><div class="titlepage"><div><div><h2 class="title">4.2. Showing details for a particular entry</h2></div></div></div><p>
				Use the <code class="literal command">ipa *-show</code> command to display details about a particular IdM entry.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To display details about a host named <span class="emphasis"><em>server.example.com</em></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-show <span class="emphasis"><em>server.example.com</em></span></strong></span>

Host name: server.example.com
Principal name: host/server.example.com@EXAMPLE.COM
...</pre></li></ul></div></section><section class="section" id="adjusting-the-search-size-and-time-limit_search-ipa"><div class="titlepage"><div><div><h2 class="title">4.3. Adjusting the search size and time limit</h2></div></div></div><p>
				Some queries, such as requesting a list of IdM users, can return a very large number of entries. By tuning these search operations, you can improve the overall server performance when running the <code class="literal command">ipa *-find</code> commands, such as <code class="literal command">ipa user-find</code>, and when displaying corresponding lists in the Web UI.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Search size limit</span></dt><dd><p class="simpara">
							Defines the maximum number of entries returned for a request sent to the server from a client’s CLI or from a browser accessing the IdM Web UI.
						</p><p class="simpara">
							Default: 100 entries.
						</p></dd><dt><span class="term">Search time limit</span></dt><dd><p class="simpara">
							Defines the maximum time (in seconds) that the server waits for searches to run. Once the search reaches this limit, the server stops the search and returns the entries discovered in that time.
						</p><p class="simpara">
							Default: 2 seconds.
						</p></dd></dl></div><p>
				If you set the values to <code class="literal">-1</code>, IdM will not apply any limits when searching.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Setting search size or time limits too high can negatively affect server performance.
				</p></div></div><section class="section" id="adjusting-the-search-size-and-time-limit-in-the-command-line_adjusting-the-search-size-and-time-limit"><div class="titlepage"><div><div><h3 class="title">4.3.1. Adjusting the search size and time limit in the command line</h3></div></div></div><p>
					The following text describes adjusting search size and time limits in the command line:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Globally
						</li><li class="listitem">
							For a specific entry
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To display current search time and size limits in CLI, use the ipa config-show command:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa config-show</strong></span>

Search time limit: 2
Search size limit: 100</pre></li><li class="listitem"><p class="simpara">
							To adjust the limits globally for all queries, use the <code class="literal command">ipa config-mod</code> command and add the <code class="literal option">--searchrecordslimit</code> and <code class="literal option">--searchtimelimit</code> options. For example:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa config-mod --searchrecordslimit=500 --searchtimelimit=5</strong></span></pre></li><li class="listitem">
							To adjust the limits only for a specific query, add the <code class="literal option">--sizelimit</code> or <code class="literal option">--timelimit</code> options to the command. For example:
						</li></ol></div><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-find --sizelimit=200 --timelimit=120</strong></span></pre></section><section class="section" id="adjusting-the-search-size-and-time-limit-in-the-web-ui_adjusting-the-search-size-and-time-limit"><div class="titlepage"><div><div><h3 class="title">4.3.2. Adjusting the search size and time limit in the Web UI</h3></div></div></div><p>
					The following text describes adjusting search size and time limits in the IdM Web UI:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Globally
						</li><li class="listitem">
							For a specific entry
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To adjust the limits globally for all queries:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the IdM Web UI.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>IPA Server</strong></span>.
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="web-ui-ipaserver.png" alt="web ui ipaserver"/></span>

						</p></li><li class="listitem">
							On the <span class="strong strong"><strong>IPA Server</strong></span> tab, click <span class="strong strong"><strong>Configuration</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Set the required values in the <span class="strong strong"><strong>Search Options</strong></span> area.
						</p><p class="simpara">
							Default values are:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Search size limit: 100 entries
								</li><li class="listitem">
									Search time limit: 2 seconds
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Save</strong></span> at the top of the page.
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="web-ui-search-limits.png" alt="web ui search limits"/></span>

						</p></li></ol></div><p>
					After saving the values, search an entry and verify the result.
				</p></section></section></section><section class="chapter" id="accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Accessing the IdM Web UI in a web browser</h1></div></div></div><p>
			The following sections provide an overview of the IdM (Identity Management) Web UI and describe how to access it.
		</p><section class="section" id="what-is-the-ipa-web-ui_access-web-ui"><div class="titlepage"><div><div><h2 class="title">5.1. What is the IdM Web UI</h2></div></div></div><p>
				The IdM (Identity Management) Web UI is a web application for IdM administration, a graphical alternative to the IdM command line tools.
			</p><p>
				You can access the IdM Web UI as:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>IdM users:</strong></span> A limited set of operations depending on permissions granted to the user in the IdM server. Basically, active IdM users can log in to the IdM server and configure their own account. They cannot change settings of other users or the IdM server settings.
					</li><li class="listitem">
						<span class="strong strong"><strong>Administrators:</strong></span> Full access rights to the IdM server.
					</li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Active Directory users:</strong></span> A limited set of operations depending on permissions granted to the user.
					</p><p class="simpara">
						Active Directory users cannot be administrators for Identity Management.
					</p></li></ul></div></section><section class="section" id="web-browsers-supported-for-accessing-the-web-ui_access-web-ui"><div class="titlepage"><div><div><h2 class="title">5.2. Web browsers supported for accessing the Web UI</h2></div></div></div><p>
				IdM (Identity Management) supports the following browsers for connecting to the Web UI:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mozilla Firefox 38 and later
					</li><li class="listitem">
						Google Chrome 46 and later
					</li></ul></div></section><section class="section" id="accessing-the-web-ui_access-web-ui"><div class="titlepage"><div><div><h2 class="title">5.3. Accessing the Web UI</h2></div></div></div><p>
				The following procedure describes the first logging in to the IdM (Identity Management) Web UI with a password.
			</p><p>
				After the first login you can configure your IdM server to authenticate with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Kerberos ticket
					</p><p class="simpara">
						For details, see <a class="xref" href="index%3Flb_target=stage.html#kerberos-authentication-in-identity-management_login-web-ui-krb" title="6.1. Kerberos authentication in Identity Management">Section 6.1, “Kerberos authentication in Identity Management”</a>.
					</p></li><li class="listitem"><p class="simpara">
						Smart card
					</p><p class="simpara">
						For details, see <a class="xref" href="index%3Flb_target=stage.html#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth" title="19.1. Configuring the IdM server for smart card authentication">Section 19.1, “Configuring the IdM server for smart card authentication”</a>.
					</p></li><li class="listitem"><p class="simpara">
						One time password (OTP) — this can be combined with password and Kerberos authentication.
					</p><p class="simpara">
						For details, see <a class="xref" href="index%3Flb_target=stage.html#one-time-password-authentication-in-identity-management_logging-in-to-ipa-in-the-web-ui-using-a-password" title="7.2. One time password (OTP) authentication in Identity Management">Section 7.2, “One time password (OTP) authentication in Identity Management”</a>.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Type an IdM server URL into the browser address bar. The name will look similarly to the following example:
					</p><pre class="literallayout">https://server.example.com</pre><p class="simpara">
						You just need to change <code class="literal">server.example.com</code> with a DNS name of your IdM server.
					</p><p class="simpara">
						This opens the IdM Web UI login screen in your browser.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="web_ui_login_screen.png" alt="web ui login screen"/></span>

					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								If the server does not respond or the login screen does not open, check the DNS settings on the IdM server to which you are connecting.
							</li><li class="listitem"><p class="simpara">
								If you use a self-signed certificate, the browser issues a warning. Check the certificate and accept the security exception to proceed with the login.
							</p><p class="simpara">
								To avoid security exceptions, install a certificate signed by a certificate authority.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						On the Web UI login screen, enter the administrator account credentials you added during the IdM server installation.
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-an-ipa-server-with-integrated-dns_installing-identity-management">Installing an Identity Management server: With integrated DNS, with an integrated CA</a>.
					</p><p class="simpara">
						You can enter your personal account credentials as well if they are already entered in the IdM server.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="web_ui_login_passwd.png" alt="web ui login passwd"/></span>

					</p></li><li class="listitem">
						Click <span class="guibutton">Log in</span>.
					</li></ol></div><p>
				After the successful login, you can start configuring the IdM server.
			</p><p>
				<span class="inlinemediaobject"><img src="web_ui_users.png" alt="web ui users"/></span>

			</p></section></section><section class="chapter" id="logging-in-to-ipa-in-the-web-ui-using-a-kerberos-ticket_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Logging in to IdM in the Web UI: Using a Kerberos ticket</h1></div></div></div><p>
			The following sections describe the initial configuration of your environment to enable Kerberos login to the IdM Web UI and accessing IdM using Kerberos authentication.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Installed IdM server in your network environment
				</p><p class="simpara">
					For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index">Installing Identity Management in Red Hat Enterprise Linux 8</a>
				</p></li></ul></div><section class="section" id="kerberos-authentication-in-identity-management_login-web-ui-krb"><div class="titlepage"><div><div><h2 class="title">6.1. Kerberos authentication in Identity Management</h2></div></div></div><p>
				Identity Management (IdM) uses the Kerberos protocol to support single sign-on. Single sign-on authentication allows you to provide the correct user name and password only once, and you can then access Identity Management services without the system prompting for credentials again.
			</p><p>
				The IdM server provides Kerberos authentication immediately after the installation if the DNS and certificate settings have been configured properly. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index">Installing Identity Management</a>.
			</p><p>
				To use Kerberos authentication on hosts, install:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						the IdM client
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#preparing-the-system-for-ipa-client-installation_installing-identity-management">Preparing the system for Identity Management client installation</a>.
					</p></li><li class="listitem">
						the krb5conf package
					</li></ul></div></section><section class="section" id="using-kinit-to-log-in-to-ipa_login-web-ui-krb"><div class="titlepage"><div><div><h2 class="title">6.2. Using <span class="strong strong"><strong>kinit</strong></span> to log in to IdM manually</h2></div></div></div><p>
				This procedure describes using the <span class="strong strong"><strong>kinit</strong></span> utility to authenticate to an Identity Management (IdM) environment manually. The <span class="strong strong"><strong>kinit</strong></span> utility obtains and caches a Kerberos ticket-granting ticket (TGT) on behalf of an IdM user.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Only use this procedure if you have destroyed your initial Kerberos TGT or if it has expired. As an IdM user, when logging onto your local machine you are also automatically logging in to IdM. This means that after logging in, you are not required to use the <span class="strong strong"><strong>kinit</strong></span> utility to access IdM resources.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To log in to IdM
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								under the user name of the user who is currently logged in on the local system, use <span class="strong strong"><strong>kinit</strong></span> without specifying a user name. For example, if you are logged in as <code class="literal">example_user</code> on the local system:
							</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>kinit</strong></span>
Password for example_user@EXAMPLE.COM:
[example_user@server ~]$</pre><p class="simpara">
								If the user name of the local user does not match any user entry in IdM, the authentication attempt fails:
							</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>kinit</strong></span>
kinit: Client 'example_user@EXAMPLE.COM' not found in Kerberos database while getting initial credentials</pre></li><li class="listitem"><p class="simpara">
								using a Kerberos principal that does not correspond to your local user name, pass the required user name to the <code class="literal">kinit</code> utility. For example, to log in as the <code class="literal">admin</code> user:
							</p><pre class="literallayout">[example_user@server ~]$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@EXAMPLE.COM:
[example_user@server ~]$</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, to verify that the login was successful, use the <span class="strong strong"><strong>klist</strong></span> utility to display the cached TGT. In the following example, the cache contains a ticket for the <code class="literal">example_user</code> principal, which means that on this particular host, only <code class="literal">example_user</code> is currently allowed to access IdM services:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>klist</strong></span>
Ticket cache: KEYRING:persistent:0:0
Default principal: <span class="strong strong"><strong>example_user@EXAMPLE.COM</strong></span>

Valid starting     	Expires            	Service principal
11/10/2019 08:35:45  	11/10/2019 18:35:45  	krbtgt/EXAMPLE.COM@EXAMPLE.COM</pre></li></ol></div></section><section class="section" id="configuring-the-browser-for-kerberos-authentication-login-web-ui-krb"><div class="titlepage"><div><div><h2 class="title">6.3. Configuring the browser for Kerberos authentication</h2></div></div></div><p>
				To enable authentication with a Kerberos ticket, you may need a browser configuration.
			</p><p>
				The following steps help you to support Kerberos negotiation for accessing the IdM domain.
			</p><p>
				Each browser supports Kerberos in a different way and needs different set up. The IdM Web UI includes guidelines for the following browsers:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Firefox
					</li><li class="listitem">
						Chrome
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the IdM Web UI login dialog in your web browser.
					</li><li class="listitem"><p class="simpara">
						Click the link for browser configuration on the Web UI login screen.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="ipa_browser_config_link.png" alt="ipa browser config link"/></span>

					</p></li><li class="listitem"><p class="simpara">
						Follow the steps on the configuration page.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="ipa_browser_config_page.png" alt="ipa browser config page"/></span>

					</p></li></ol></div><p>
				After the setup, turn back to the IdM Web UI and click <span class="strong strong"><strong>Log in</strong></span>.
			</p></section><section class="section" id="logging-in-to-the-web-ui-with-a-kerberos-ticket-login-web-ui-krb"><div class="titlepage"><div><div><h2 class="title">6.4. Logging in to the web UI using a Kerberos ticket</h2></div></div></div><p>
				This procedure describes logging in to the IdM Web UI using a Kerberos ticket-granting ticket (TGT).
			</p><p>
				The TGT expires at a predefined time. The default time interval is 24 hours and you can change it in the IdM Web UI.
			</p><p>
				After the time interval expires, you need to renew the ticket:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Using the kinit command.
					</li><li class="listitem">
						Using IdM login credentials in the Web UI login dialog.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Open the IdM Web UI.
					</p><p class="simpara">
						If Kerberos authentication works correctly and you have a valid ticket, you will be automatically authenticated and the Web UI opens.
					</p><p class="simpara">
						If the ticket is expired, it is necessary to authenticate yourself with credentials first. However, next time the IdM Web UI will open automatically without opening the login dialog.
					</p><p class="simpara">
						If you see an error message <code class="literal">Authentication with Kerberos failed</code>, verify that your browser is configured for Kerberos authentication. See <a class="xref" href="index%3Flb_target=stage.html#configuring-the-browser-for-kerberos-authentication-login-web-ui-krb" title="6.3. Configuring the browser for Kerberos authentication">Section 6.3, “Configuring the browser for Kerberos authentication”</a>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="firefox_kerb_auth_failed.png" alt="firefox kerb auth failed"/></div></div></li></ul></div></section><section class="section" id="configuring-an-external-system-for-kerberos-authentication-login-web-ui-krb"><div class="titlepage"><div><div><h2 class="title">6.5. Configuring an external system for Kerberos authentication</h2></div></div></div><p>
				This section describes how to configure an external system so that Identity Management (IdM) users can log in to IdM from the external system using their Kerberos credentials.
			</p><p>
				Enabling Kerberos authentication on external systems is especially useful when your infrastructure includes multiple realms or overlapping domains. It is also useful if the system has not been enrolled into any IdM domain through <code class="literal">ipa-client-install</code>.
			</p><p>
				To enable Kerberos authentication to IdM from a system that is not a member of the IdM domain, define an IdM-specific Kerberos configuration file on the external system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">krb5-workstation</code> package is installed on the external system.
					</p><p class="simpara">
						To find out whether the package is installed, use the following CLI command:
					</p><pre class="literallayout"># <span class="strong strong"><strong>yum list installed krb5-workstation</strong></span>
Installed Packages
krb5-workstation.x86_64    1.16.1-19.el8     @BaseOS</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy the <code class="literal">/etc/krb5.conf</code> file from the IdM server to the external system. For example:
					</p><pre class="literallayout"># <span class="strong strong"><strong>scp /etc/krb5.conf root@<span class="emphasis"><em>externalsystem.example.com</em></span>:/etc/krb5_ipa.conf</strong></span></pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not overwrite the existing <code class="literal">krb5.conf</code> file on the external system.
						</p></div></div></li><li class="listitem"><p class="simpara">
						On the external system, set the terminal session to use the copied IdM Kerberos configuration file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>export KRB5_CONFIG=/etc/krb5_ipa.conf</strong></span></pre><p class="simpara">
						The <code class="literal">KRB5_CONFIG</code> variable exists only temporarily until you log out. To prevent this loss, export the variable with a different file name.
					</p></li><li class="listitem">
						Copy the Kerberos configuration snippets from the <code class="literal">/etc/krb5.conf.d/</code> directory to the external system.
					</li><li class="listitem">
						Configure the browser on the external system, as described in <a class="xref" href="index%3Flb_target=stage.html#configuring-the-browser-for-kerberos-authentication-login-web-ui-krb" title="6.3. Configuring the browser for Kerberos authentication">Section 6.3, “Configuring the browser for Kerberos authentication”</a>.
					</li></ol></div><p>
				Users on the external system can now use the <code class="literal">kinit</code> utility to authenticate against the IdM server.
			</p></section><section class="section" id="web-ui-login-for-ad-users-login-web-ui-krb"><div class="titlepage"><div><div><h2 class="title">6.6. Web UI login for Active Directory users</h2></div></div></div><p>
				To enable Web UI login for Active Directory users, define an ID override for each Active Directory user in the default trust view. For example:
			</p><pre class="literallayout">[admin@server ~]$ <span class="strong strong"><strong>ipa idoverrideuser-add 'Default Trust View' <span class="emphasis"><em>ad_user</em></span>@<span class="emphasis"><em>ad.example.com</em></span></strong></span></pre></section></section><section class="chapter" id="logging-in-to-the-ipa-web-ui-using-one-time-passwords_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Logging in to the Identity Management Web UI using one time passwords</h1></div></div></div><p>
			Access to IdM Web UI can be secured using several methods. The basic one is password authentication.
		</p><p>
			To increase the security of password authentication, you can add a second step and require automatically generated one-time passwords (OTPs). The most common usage is to combine password connected with the user account and a time limited one time password generated by a hardware or software token.
		</p><p>
			The following sections help you to:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Understand how the OTP authentication works in IdM.
				</li><li class="listitem">
					Configure OTP authentication on the IdM server.
				</li><li class="listitem">
					Create OTP tokens and synchronize them with the FreeOTP app in your phone.
				</li><li class="listitem">
					Authenticate to the IdM Web UI with the combination of user password and one time password.
				</li><li class="listitem">
					Re-synchronize tokens in the Web UI.
				</li></ul></div><section class="section" id="prerequisites"><div class="titlepage"><div><div><h2 class="title">7.1. Prerequisites</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="index%3Flb_target=stage.html#what-is-the-ipa-web-ui_access-web-ui" title="5.1. What is the IdM Web UI">Accessing the IdM Web UI in a web browser</a>
					</li></ul></div></section><section class="section" id="one-time-password-authentication-in-identity-management_logging-in-to-ipa-in-the-web-ui-using-a-password"><div class="titlepage"><div><div><h2 class="title">7.2. One time password (OTP) authentication in Identity Management</h2></div></div></div><p>
				One-time passwords bring an additional step to your authentication security. The authentication uses your password + an automatically generated one time password.
			</p><p>
				To generate one time passwords, you can use a hardware or software token. IdM supports both software and hardware tokens.
			</p><p>
				Identity Management supports the following two standard OTP mechanisms:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The HMAC-Based One-Time Password (HOTP) algorithm is based on a counter. HMAC stands for Hashed Message Authentication Code.
					</li><li class="listitem">
						The Time-Based One-Time Password (TOTP) algorithm is an extension of HOTP to support time-based moving factor.
					</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					IdM does not support OTP logins for Active Directory trust users.
				</p></div></div></section><section class="section" id="enabling-the-one-time-password-in-the-web-ui_logging-in-to-ipa-in-the-web-ui-using-a-password"><div class="titlepage"><div><div><h2 class="title">7.3. Enabling the one time password in the Web UI</h2></div></div></div><pre class="literallayout">The IdM Web UI allows you to configure hardware or software device to generate one-time passwords.</pre><p>
				The one time password is entered just after the usual password in the dedicated field in the login dialog.
			</p><p>
				Only administrators can enable OTP authentication in the user settings.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administration privileges
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the IdM Web UI with your username and password.
					</li><li class="listitem"><p class="simpara">
						Open the <span class="strong strong"><strong>Identity → Users → Active users</strong></span> tab.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="web_ui-users.png" alt="web ui users"/></span>

					</p></li><li class="listitem">
						Click your username to open the user settings.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>User authentication types</strong></span>, select <span class="strong strong"><strong>Two factor authentication (password + OTP)</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span>.
					</li></ol></div><p>
				At this point, the OTP authentication is enabled on the IdM server.
			</p><p>
				Now you or users themselves need to assign a new token ID to the user account.
			</p></section><section class="section" id="adding-otp-tokens-in-the-web-ui_logging-in-to-ipa-in-the-web-ui-using-a-password"><div class="titlepage"><div><div><h2 class="title">7.4. Adding OTP tokens in the Web UI</h2></div></div></div><p>
				The following section helps you to add token to the IdM Web UI and to your software token generator.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Active user account on the IdM server.
					</li><li class="listitem">
						Administrator has enabled OTP for the particular user account in the IdM Web UI.
					</li><li class="listitem">
						A software device generating OTP tokens, for example FreeOTP.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the IdM Web UI with your user name and password.
					</li><li class="listitem">
						To create the token in your mobile phone, open the <span class="strong strong"><strong>Authentication → OTP Tokens</strong></span> tab.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Add</strong></span>.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="web_ui_tokens_tab.png" alt="web ui tokens tab"/></span>

					</p></li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Add OTP token</strong></span> dialog box, leave everything unfilled and click <span class="strong strong"><strong>Add</strong></span>.
					</p><p class="simpara">
						At this stage, the IdM server creates a token with default parameters at the server and opens a page with a QR code.
					</p></li><li class="listitem">
						Copy the QR code into your mobile phone.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>OK</strong></span> to close the QR code.
					</li></ol></div><p>
				Now you can generate one time passwords and log in with them to the IdM Web UI.
			</p><p>
				<span class="inlinemediaobject"><img src="freeotp_token.png" alt="freeotp token"/></span>

			</p></section><section class="section" id="logging-in-to-the-web-ui-with-a-one-time-password_logging-in-to-ipa-in-the-web-ui-using-a-password"><div class="titlepage"><div><div><h2 class="title">7.5. Logging into the Web UI with a one time password</h2></div></div></div><p>
				This procedure describes the first login into the IdM Web UI using a one time password (OTP).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						OTP configuration enabled on the Identity Management server for the user account you are using for the OTP authentication. Administrators as well as users themselves can enable OTP.
					</p><p class="simpara">
						To enable the OTP configuration, see <a class="xref" href="index%3Flb_target=stage.html#enabling-the-one-time-password-in-the-web-ui_logging-in-to-ipa-in-the-web-ui-using-a-password" title="7.3. Enabling the one time password in the Web UI">Section 7.3, “Enabling the one time password in the Web UI”</a>
					</p></li><li class="listitem">
						A hardware or software device generating OTP tokens configured.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Identity Management login screen, enter your user name or a user name of the IdM server administrator account.
					</li><li class="listitem">
						Add the password for the user name entered above.
					</li><li class="listitem">
						Generate a one time password on your device.
					</li><li class="listitem">
						Enter the one time password right after the password (without space).
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Log in</strong></span>.
					</p><p class="simpara">
						If the authentication fails, synchronize OTP tokens.
					</p><p class="simpara">
						If your CA uses a self-signed certificate, the browser issues a warning. Check the certificate and accept the security exception to proceed with the login.
					</p><p class="simpara">
						If the the IdM Web UI does not open, verify the DNS configuration of your Identity Management server.
					</p></li></ol></div><p>
				After successful login, the IdM Web UI appears.
			</p><p>
				<span class="inlinemediaobject"><img src="web_ui_users.png" alt="web ui users"/></span>

			</p></section><section class="section" id="synchronizing-otp-tokens_logging-in-to-ipa-in-the-web-ui-using-a-password"><div class="titlepage"><div><div><h2 class="title">7.6. Synchronizing OTP tokens using the Web UI</h2></div></div></div><p>
				If the login with OTP (One Time Password) fails, OTP tokens are not synchronized correctly.
			</p><p>
				The following text describes token re-synchronization.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A login screen opened.
					</li><li class="listitem">
						A device generating OTP tokens configured.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM Web UI login screen, click <span class="strong strong"><strong>Sync OTP Token</strong></span>.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="web_ui_login_otp_link.png" alt="web ui login otp link"/></span>

					</p></li><li class="listitem">
						In the login screen, enter your username and the Identity Management password.
					</li><li class="listitem">
						Generate one time password and enter it in the <span class="strong strong"><strong>First OTP</strong></span> field.
					</li><li class="listitem">
						Generate another one time password and enter it in the <span class="strong strong"><strong>Second OTP</strong></span> field.
					</li><li class="listitem"><p class="simpara">
						Optionally, enter the token ID.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="web_ui_login_otp_configuration.png" alt="web ui login otp configuration"/></span>

					</p></li><li class="listitem">
						Click <span class="strong strong"><strong>Sync OTP Token</strong></span>.
					</li></ol></div><p>
				After the successful synchronization, you can log in to the IdM server.
			</p></section><section class="section" id="changing-expired-passwords_logging-in-to-ipa-in-the-web-ui-using-a-password"><div class="titlepage"><div><div><h2 class="title">7.7. Changing expired passwords</h2></div></div></div><p>
				Administrators of Identity Management can enforce you having to change your password at the next login. It means that you cannot successfully log in to the IdM Web UI until you change the password.
			</p><p>
				Password expiration can happen during your first login to the Web UI.
			</p><p>
				If the expiration password dialog appears, follow the instructions in the procedure.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A login screen opened.
					</li><li class="listitem">
						Active account to the IdM server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the password expiration login screen, enter the user name.
					</li><li class="listitem">
						Add the password for the user name entered above.
					</li><li class="listitem"><p class="simpara">
						In the OTP field, generate a one time password, if you use the one time password authentication.
					</p><p class="simpara">
						If you do not have enabled the OTP authentication, leave the field empty.
					</p></li><li class="listitem">
						Enter the new password twice for verification.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Reset Password</strong></span>.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="web_ui_passwd_expiration.png" alt="web ui passwd expiration"/></span>

					</p></li></ol></div><p>
				After the successful password change, the usual login dialog displays. Log in with the new password.
			</p></section></section><section class="chapter" id="managing-user-accounts-using-the-idm-web-ui_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Managing user accounts using the IdM Web UI</h1></div></div></div><p>
			Identity Management (IdM) provides <a class="link" href="index%3Flb_target=stage.html#user-life-cycle_managing-user-accounts-using-the-idm-web-ui" title="8.1. User life cycle">several stages</a> that can help you to manage various user work life situations:
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Creating a user account</span></dt><dd><p class="simpara">
						<a class="link" href="index%3Flb_target=stage.html#adding-users-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.2. Adding users in the Web UI">Creating a stage user account</a> before an employee starts their career in your company and be prepared in advance for the day when the employee appears in the office and want to activate the account.
					</p><p class="simpara">
						You can omit this step and create the active user account directly. The procedure is similar to creating a stage user account.
					</p></dd><dt><span class="term">Activating a user account</span></dt><dd>
						<a class="link" href="index%3Flb_target=stage.html#activating-stage-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.3. Activating stage users in the IdM Web UI">Activating the account</a> the first working day of the employee.
					</dd><dt><span class="term">Disabling a user account</span></dt><dd>
						If the user go to a parental leave for couple of months, you will need <a class="link" href="index%3Flb_target=stage.html#disabling-user-accounts-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.4. Disabling user accounts in the Web UI">to disable the account temporarily</a>.
					</dd><dt><span class="term">Enabling a user account</span></dt><dd>
						When the user returns, you will need <a class="link" href="index%3Flb_target=stage.html#enabling-user-accounts-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.5. Enabling user accounts in the Web UI">to re-enable the account</a>.
					</dd><dt><span class="term">Preserving a user account</span></dt><dd>
						If the user wants to leave the company, you will need <a class="link" href="index%3Flb_target=stage.html#preserving-active-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.6. Preserving active users in the IdM Web UI">to delete the account with a possibility to restore it</a> because people can return to the company after some time.
					</dd><dt><span class="term">Restoring a user account</span></dt><dd>
						Two years later, the user is back and you need <a class="link" href="index%3Flb_target=stage.html#restoring-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.7. Restoring users in the IdM Web UI">to restore the preserved account</a>.
					</dd><dt><span class="term">Deleting a user account</span></dt><dd>
						If the employee the employee is dismissed you will <a class="link" href="index%3Flb_target=stage.html#deleting-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.8. Deleting users in the IdM Web UI">delete the account</a> without a backup.
					</dd></dl></div><section class="section" id="user-life-cycle_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.1. User life cycle</h2></div></div></div><p>
				IdM (Identity Management) supports three user account states:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Stage</strong></span> users are not allowed to authenticate. This is an initial state. Some of the user account properties required for active users cannot be set, for example, group membership.
					</li><li class="listitem">
						<span class="strong strong"><strong>Active</strong></span> users are allowed to authenticate. All required user account properties must be set in this state.
					</li><li class="listitem">
						<span class="strong strong"><strong>Preserved</strong></span> users are former active users that are considered inactive and cannot authenticate to IdM. Preserved users retain most of the account properties they had as active users, but they are not part of any user groups.
					</li></ul></div><p>
				<span class="inlinemediaobject"><img src="idm-user-lifecycle.png" alt="idm user lifecycle"/></span>

			</p><p>
				You can delete user entries permanently from the IdM database.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Deleted user accounts cannot be restored. When you delete a user account, all the information associated with the account is permanently lost.
				</p></div></div><p>
				A new administrator can only be created by a user with administrator rights, such as the default admin user. If you accidentally delete all administrator accounts, the Directory Manager must create a new administrator manually in the Directory Server.
			</p></section><section class="section" id="adding-users-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.2. Adding users in the Web UI</h2></div></div></div><p>
				Usually, you need to create a new user account before a new employee starts to work. Such a stage account is not accessible and you need to activate it later.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Alternatively, you can create an active user account directly. For adding active user, follow the procedure below and add the user account in the <span class="strong strong"><strong>Active users</strong></span> tab.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing IdM or User Administrator role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the IdM Web UI.
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm">Accessing the IdM Web UI in a web browser</a>.
					</p></li><li class="listitem"><p class="simpara">
						Go to <span class="strong strong"><strong>Users → Stage Users</strong></span> tab.
					</p><p class="simpara">
						Alternatively, you can add the user account in the <span class="strong strong"><strong>Users → Active users</strong></span>, however, you cannot add user groups to the account.
					</p></li><li class="listitem">
						Click the <span class="strong strong"><strong>+ Add</strong></span> icon.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Add stage user</strong></span> dialog box, enter <span class="strong strong"><strong>First name</strong></span> and <span class="strong strong"><strong>Last name</strong></span> of the new user.
					</li><li class="listitem"><p class="simpara">
						[Optional] In the <span class="strong strong"><strong>User login</strong></span> field, add a login name.
					</p><p class="simpara">
						If you leave it empty, the IdM server creates the login name in the following pattern: The first letter of the first name and the surname. The whole login name can have up to 32 characters.
					</p></li><li class="listitem">
						[Optional] In the GID drop down menu, select groups in which the user should be included.
					</li><li class="listitem">
						[Optional] In the <span class="strong strong"><strong>Password</strong></span> and <span class="strong strong"><strong>Verify password</strong></span> fields,
					</li><li class="listitem"><p class="simpara">
						Click on the <span class="strong strong"><strong>Add</strong></span> button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="idm-user-add-stage.png" alt="idm user add stage"/></span>

					</p></li></ol></div><p>
				At this point, you can see the user account in the <span class="strong strong"><strong>Stage Users</strong></span> table.
			</p><p>
				<span class="inlinemediaobject"><img src="idm-users-stage.png" alt="idm users stage"/></span>

			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If you click on the user name, you can edit advanced settings, such as adding a phone number, address, or occupation.
				</p></div></div></section><section class="section" id="activating-stage-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.3. Activating stage users in the IdM Web UI</h2></div></div></div><p>
				A stage user account must be activated before the user can log in to IdM and before the user can be added to an IdM group. This section describes how to activate stage user accounts.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing the IdM Web UI or User Administrator role.
					</li><li class="listitem">
						At least one staged user account in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the IdM Web UI.
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm">Accessing the IdM Web UI in a web browser</a>.
					</p></li><li class="listitem">
						Go to <span class="strong strong"><strong>Users → Stage users</strong></span> tab.
					</li><li class="listitem">
						Click the check-box of the user account you want to activate.
					</li><li class="listitem"><p class="simpara">
						Click on the <span class="strong strong"><strong>Activate</strong></span> button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="idm-users-stage.png" alt="idm users stage"/></span>

					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>Confirmation</strong></span> dialog box, click on the <span class="strong strong"><strong>OK</strong></span> button.
					</li></ol></div><p>
				If the activation is successfull, the IdM Web UI displays a green confirmation that the user has been activated and the user account has been moved to <span class="strong strong"><strong>Active users</strong></span>. The account is active and the user can authenticate to the IdM domain and IdM Web UI. The user is prompted to change their password on the first login.
			</p><p>
				<span class="inlinemediaobject"><img src="idm-users-stage-activated.png" alt="idm users stage activated"/></span>

			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					At this stage, you can add the active user account to user groups.
				</p></div></div></section><section class="section" id="disabling-user-accounts-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.4. Disabling user accounts in the Web UI</h2></div></div></div><p>
				You can disable active user accounts. Disabling a user account deactivates the account, therefore, user accounts cannot be used to authenticate and using IdM services, such as Kerberos, or perform any tasks.
			</p><p>
				Disabled user accounts still exist within IdM and all of the associated information remains unchanged. Unlike preserved user accounts, disabled user accounts remain in the active state and can be a member of user groups.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					After disabling a user account, any existing connections remain valid until the user’s Kerberos TGT and other tickets expire. After the ticket expires, the user will not be able to renew it.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing the IdM Web UI or User Administrator role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the IdM Web UI.
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm">Accessing the IdM Web UI in a web browser</a>.
					</p></li><li class="listitem">
						Go to <span class="strong strong"><strong>Users → Active users</strong></span> tab.
					</li><li class="listitem">
						Click the check-box of the user accounts you want to disable.
					</li><li class="listitem"><p class="simpara">
						Click on the <span class="strong strong"><strong>Disable</strong></span> button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="idm-users-disable.png" alt="idm users disable"/></span>

					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>Confirmation</strong></span> dialog box, click on the <span class="strong strong"><strong>OK</strong></span> button.
					</li></ol></div><p>
				If the disabling procedure has been successful, you can verify in the Status column in the <span class="strong strong"><strong>Active users</strong></span> table.
			</p><p>
				<span class="inlinemediaobject"><img src="idm-users-disabled.png" alt="idm users disabled"/></span>

			</p></section><section class="section" id="enabling-user-accounts-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.5. Enabling user accounts in the Web UI</h2></div></div></div><p>
				With IdM you can enable disabled active user accounts. Enabling a user account activates the disabled account.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing the IdM Web UI or User Administrator role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the IdM Web UI.
					</li><li class="listitem">
						Go to <span class="strong strong"><strong>Users → Active users</strong></span> tab.
					</li><li class="listitem">
						Click the check-box of the user accounts you want to enable.
					</li><li class="listitem"><p class="simpara">
						Click on the <span class="strong strong"><strong>Enable</strong></span> button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="idm-users-disable.png" alt="idm users disable"/></span>

					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>Confirmation</strong></span> dialog box, click on the <span class="strong strong"><strong>OK</strong></span> button.
					</li></ol></div><p>
				If the change has been successful, you can verify in the Status column in the <span class="strong strong"><strong>Active users</strong></span> table.
			</p></section><section class="section" id="preserving-active-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.6. Preserving active users in the IdM Web UI</h2></div></div></div><p>
				Preserving user accounts enables you to remove accounts from the <span class="strong strong"><strong>Active users</strong></span> tab, yet keeping these accounts in IdM.
			</p><p>
				Preserve the user account if the employee leaves the company. If you want to disable user accounts for a couple of weeks or months (parental leave, for example), disable the account. For details, see <a class="xref" href="index%3Flb_target=stage.html#disabling-user-accounts-in-the-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.4. Disabling user accounts in the Web UI">Section 8.4, “Disabling user accounts in the Web UI”</a>. The preserved accounts are not active and users cannot use them to access your internal network, however, the account stays in the database with all the data.
			</p><p>
				You can move the restored accounts back to the active mode.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The list of users in the preserved state can provide a history of past user accounts.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing the IdM (Identity Management) Web UI or User Administrator role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the IdM Web UI.
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm">Accessing the IdM Web UI in a web browser</a>.
					</p></li><li class="listitem">
						Go to <span class="strong strong"><strong>Users → Active users</strong></span> tab.
					</li><li class="listitem">
						Click the check-box of the user accounts you want to preserve.
					</li><li class="listitem"><p class="simpara">
						Click on the <span class="strong strong"><strong>Delete</strong></span> button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="idm-users-active-delete.png" alt="idm users active delete"/></span>

					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>Remove users</strong></span> dialog box, switch the <span class="strong strong"><strong>Delete mode</strong></span> radio button to <span class="strong strong"><strong>preserve</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Click on the <span class="strong strong"><strong>Delete</strong></span> button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="idm-users-preserving.png" alt="idm users preserving"/></span>

					</p></li></ol></div><p>
				As a result, the user account is moved to <span class="strong strong"><strong>Preserved users</strong></span>.
			</p><p>
				If you need to restore preserved users, see the <a class="link" href="index%3Flb_target=stage.html#restoring-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.7. Restoring users in the IdM Web UI">Restoring users in the IdM Web UI</a>.
			</p></section><section class="section" id="restoring-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.7. Restoring users in the IdM Web UI</h2></div></div></div><p>
				IdM (Identity Management) enables you to restore preserved user accounts back in the active state.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing the IdM Web UI or User Administrator role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the IdM Web UI.
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm">Accessing the IdM Web UI in a web browser</a>.
					</p></li><li class="listitem">
						Go to <span class="strong strong"><strong>Users → Preserved users</strong></span> tab.
					</li><li class="listitem">
						Click the check-box at the user accounts you want to restore.
					</li><li class="listitem"><p class="simpara">
						Click on the <span class="strong strong"><strong>Restore</strong></span> button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="idm-users-preserved-restore.png" alt="idm users preserved restore"/></span>

					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>Confirmation</strong></span> dialog box, click on the <span class="strong strong"><strong>OK</strong></span> button.
					</li></ol></div><p>
				The IdM Web UI displays a green confirmation and moves the user accounts to the <span class="strong strong"><strong>Active users</strong></span> tab.
			</p></section><section class="section" id="deleting-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">8.8. Deleting users in the IdM Web UI</h2></div></div></div><p>
				Deleting users is an irreversible operation, causing the user accounts to be permanently deleted from the IdM database, including group memberships and passwords. Any external configuration for the user, such as the system account and home directory, is not deleted, but is no longer accessible through IdM.
			</p><p>
				You can delete:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Active users — the IdM Web UI offers you with the options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								Preserving users temporarily
							</p><p class="simpara">
								For details, see the <a class="link" href="index%3Flb_target=stage.html#preserving-active-users-in-the-idm-web-ui_managing-user-accounts-using-the-idm-web-ui" title="8.6. Preserving active users in the IdM Web UI">Preserving active users in the IdM Web UI</a>.
							</p></li><li class="listitem">
								Deleting them permanently
							</li></ul></div></li><li class="listitem">
						Stage users — you can just delete stage users permanently.
					</li><li class="listitem">
						Preserved users — you can delete preserved users permanently.
					</li></ul></div><p>
				The following procedure describes deleting active users. Similarly, you can delete user accounts on:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <span class="strong strong"><strong>Stage users</strong></span> tab
					</li><li class="listitem">
						The <span class="strong strong"><strong>Preserved users</strong></span> tab
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing the IdM Web UI or User Administrator role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the IdM Web UI.
					</p><p class="simpara">
						For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_configuring-and-managing-idm">Accessing the IdM Web UI in a web browser</a>.
					</p></li><li class="listitem"><p class="simpara">
						Go to <span class="strong strong"><strong>Users → Active users</strong></span> tab.
					</p><p class="simpara">
						Alternatively, you can delete the user account in the <span class="strong strong"><strong>Users → Stage users</strong></span> or <span class="strong strong"><strong>Users → Preserved users</strong></span>.
					</p></li><li class="listitem">
						Click the <span class="strong strong"><strong>Delete</strong></span> icon.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Remove users</strong></span> dialog box, switch the <span class="strong strong"><strong>Delete mode</strong></span> radio button to <span class="strong strong"><strong>delete</strong></span>.
					</li><li class="listitem">
						Click on the <span class="strong strong"><strong>Delete</strong></span> button.
					</li></ol></div><p>
				The users accounts have been permanently deleted from IdM.
			</p></section></section><section class="chapter" id="managing-user-accounts-using-the-command-line_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Managing user accounts using the command line</h1></div></div></div><p>
			This chapter includes basic description of user life cycle in IdM (Identity Management). The following sections show you how to:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Create user accounts
				</li><li class="listitem">
					Activate stage user accounts
				</li><li class="listitem">
					Preserve user accounts
				</li><li class="listitem">
					Delete active, stage, or preserved user accounts
				</li><li class="listitem">
					Restore preserved user accounts
				</li></ul></div><section class="section" id="user-life-cycle_managing-idm-users-using-the-command-line"><div class="titlepage"><div><div><h2 class="title">9.1. User life cycle</h2></div></div></div><p>
				IdM (Identity Management) supports three user account states:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Stage</strong></span> users are not allowed to authenticate. This is an initial state. Some of the user account properties required for active users cannot be set, for example, group membership.
					</li><li class="listitem">
						<span class="strong strong"><strong>Active</strong></span> users are allowed to authenticate. All required user account properties must be set in this state.
					</li><li class="listitem">
						<span class="strong strong"><strong>Preserved</strong></span> users are former active users that are considered inactive and cannot authenticate to IdM. Preserved users retain most of the account properties they had as active users, but they are not part of any user groups.
					</li></ul></div><p>
				<span class="inlinemediaobject"><img src="idm-user-lifecycle.png" alt="idm user lifecycle"/></span>

			</p><p>
				You can delete user entries permanently from the IdM database.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Deleted user accounts cannot be restored. When you delete a user account, all the information associated with the account is permanently lost.
				</p></div></div><p>
				A new administrator can only be created by a user with administrator rights, such as the default admin user. If you accidentally delete all administrator accounts, the Directory Manager must create a new administrator manually in the Directory Server.
			</p></section><section class="section" id="adding-users-using-the-command-line_managing-idm-users-using-the-command-line"><div class="titlepage"><div><div><h2 class="title">9.2. Adding users using the command line</h2></div></div></div><p>
				You can add user as:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Active</strong></span> — user accounts which can be actively used by their users.
					</li><li class="listitem">
						<span class="strong strong"><strong>Stage</strong></span> — users cannot use these accounts. Use it if you want to prepare new user accounts. When users are ready to use their accounts, then you can activate them.
					</li></ul></div><p>
				The following procedure describes adding active users to the IdM server with the <code class="literal">ipa user-add</code> command.
			</p><p>
				Similarly, you can create stage user accounts with the <code class="literal">ipa stageuser-add</code> command.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					IdM automatically assigns a unique user ID (UID) to the new user accounts. You can also do this manually, however, the server does not validate whether the UID number is unique. Due to this, multiple user entries might have the same ID number assigned. Red Hat recommends to prevent having multiple entries with the same UID.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing IdM or User Administrator role.
					</li><li class="listitem">
						Obtained a Kerberos ticket. For details, see <a class="link" href="index%3Flb_target=stage.html#using-kinit-to-log-in-to-ipa_logging-in-to-ipa-from-the-command-line" title="1.1. Using kinit to log in to IdM manually">Using kinit to log in to IdM manually</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Add user login, user’s first name, last name and optionally, you can also add their email address.
					</p><pre class="literallayout">$ ipa user-add user_login --first=first_name --last=last_name --email=email_address</pre><p class="simpara">
						IdM supports user names that can be described by the following regular expression:
					</p><pre class="literallayout">[a-zA-Z0-9_.][a-zA-Z0-9_.-]{0,252}[a-zA-Z0-9_.$-]?</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							User names ending with the trailing dollar sign ($) are supported to enable Samba 3.x machine support.
						</p></div></div><p class="simpara">
						If you add a user name containing uppercase characters, IdM automatically converts the name to lowercase when saving it. Therefore, IdM always requires to enter user names in lowercase when logging in. Additionally, it is not possible to add user names which differ only in letter casing, such as <span class="strong strong"><strong>user</strong></span> and <span class="strong strong"><strong>User</strong></span>.
					</p><p class="simpara">
						The default maximum length for user names is 32 characters. To change it, use the <code class="literal">ipa config-mod --maxusername</code> command. For example, to increase the maximum user name length to 64 characters:
					</p><pre class="literallayout">$ ipa config-mod --maxusername=64
 Maximum username length: 64
 ...</pre><p class="simpara">
						The <code class="literal">ipa user-add</code> command includes a lot of parameters. To list them all, use the ipa help command:
					</p><pre class="literallayout">$ ipa help user-add</pre><p class="simpara">
						For details about <code class="literal">ipa help</code> command, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/introduction-to-the-ipa-command-line-utilities_configuring-and-managing-idm#what-is-the-ipa-help_introduction-to-the-ipa-command-line-utilities">What is the IPA help</a>.
					</p></li></ol></div><p>
				You can verify if the new user account is successfully created by listing all IdM user accounts:
			</p><pre class="literallayout">$ ipa $ ipa user-find</pre><p>
				This command lists all user accounts with details.
			</p></section><section class="section" id="activating-users-using-the-command-line_managing-idm-users-using-the-command-line"><div class="titlepage"><div><div><h2 class="title">9.3. Activating users using the command line</h2></div></div></div><p>
				To activate a user account by moving it from stage to active, use the <code class="literal">ipa stageuser-activate</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing IdM or User Administrator role.
					</li><li class="listitem">
						Obtained a Kerberos ticket. For details, see <a class="link" href="index%3Flb_target=stage.html#using-kinit-to-log-in-to-ipa_logging-in-to-ipa-from-the-command-line" title="1.1. Using kinit to log in to IdM manually">Using kinit to log in to IdM manually</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Activate the user account with the following command:
					</p><pre class="literallayout">$ ipa stageuser-activate user_login
-------------------------
Stage user user_login activated
-------------------------
...</pre></li></ol></div><p>
				You can verify if the new user account is successfully created by listing all IdM user accounts:
			</p><pre class="literallayout">$ ipa $ ipa user-find</pre><p>
				This command lists all user accounts with details.
			</p></section><section class="section" id="preserving-users-using-the-command-line_managing-idm-users-using-the-command-line"><div class="titlepage"><div><div><h2 class="title">9.4. Preserving users using the command line</h2></div></div></div><p>
				To preserve a user account, use the <code class="literal">ipa user-del</code> or <code class="literal">ipa stageuser-del</code> commands.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing IdM or User Administrator role.
					</li><li class="listitem">
						Obtained a Kerberos ticket. For details, see <a class="link" href="index%3Flb_target=stage.html#using-kinit-to-log-in-to-ipa_logging-in-to-ipa-from-the-command-line" title="1.1. Using kinit to log in to IdM manually">Using kinit to log in to IdM manually</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Preserve the user account with the following command:
					</p><pre class="literallayout">$ ipa user-del --preserve user_login
--------------------
Deleted user "user_login"
--------------------</pre></li></ol></div></section><section class="section" id="deleting-users-using-the-command-line_managing-idm-users-using-the-command-line"><div class="titlepage"><div><div><h2 class="title">9.5. Deleting users using the command line</h2></div></div></div><p>
				IdM (Identity Management) enables you to delete users permanently. You can delete:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Active users with the following command: <code class="literal">ipa user-del</code>
					</li><li class="listitem">
						Stage users with the following command: <code class="literal">ipa stageuser-del</code>
					</li><li class="listitem">
						Preserved users with the following command: <code class="literal">ipa user-del</code>
					</li></ul></div><p>
				When deleting multiple users, use the <code class="literal">--continue</code> option to force the command to continue regardless of errors. A summary of the successful and failed operations is printed to the <code class="literal">stdout</code> standard output stream when the command completes.
			</p><pre class="literallayout">$ ipa user-del --continue user1 user2 user3</pre><p>
				If you do not use <code class="literal">--continue</code>, the command proceeds with deleting users until it encounters an error, after which it stops and exits.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing IdM or User Administrator role.
					</li><li class="listitem">
						Obtained a Kerberos ticket. For details, see <a class="link" href="index%3Flb_target=stage.html#using-kinit-to-log-in-to-ipa_logging-in-to-ipa-from-the-command-line" title="1.1. Using kinit to log in to IdM manually">Using kinit to log in to IdM manually</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Delete the user account with the following command:
					</p><pre class="literallayout">$ ipa user-del user_login
--------------------
Deleted user "user_login"
--------------------</pre></li></ol></div><p>
				The user account has been permanently deleted from IdM.
			</p></section><section class="section" id="restoring-users-using-the-command-line_managing-idm-users-using-the-command-line"><div class="titlepage"><div><div><h2 class="title">9.6. Restoring users using the command line</h2></div></div></div><p>
				You can restore a preserved users to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Active users: <code class="literal">ipa user-undel</code>
					</li><li class="listitem">
						Stage users: <code class="literal">ipa user-stage</code>
					</li></ul></div><p>
				Restoring a user account does not restore all of the account’s previous attributes. For example, the user’s password is not restored and must be set again.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges for managing IdM or User Administrator role.
					</li><li class="listitem">
						Obtained a Kerberos ticket. For details, see <a class="link" href="index%3Flb_target=stage.html#using-kinit-to-log-in-to-ipa_logging-in-to-ipa-from-the-command-line" title="1.1. Using kinit to log in to IdM manually">Using kinit to log in to IdM manually</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open terminal and connect to the IdM server.
					</li><li class="listitem"><p class="simpara">
						Activate the user account with the following command:
					</p><pre class="literallayout">$ ipa user-undel user_login
------------------------------
Undeleted user account "user_login"
------------------------------</pre><p class="simpara">
						Alternatively, you can restore user accounts as staged:
					</p><pre class="literallayout">$ ipa user-stage user_login
------------------------------
Staged user account "user_login"
------------------------------</pre></li></ol></div><p>
				You can verify if the new user account is successfully created by listing all IdM user accounts:
			</p><pre class="literallayout">$ ipa $ ipa user-find</pre><p>
				This command lists all user accounts with details.
			</p></section></section><section class="chapter" id="managing-user-groups-cli_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Managing user groups in IdM CLI</h1></div></div></div><p>
			This chapter introduces user groups in Identity Management (IdM).
		</p><section class="section" id="user-groups_managing-user-groups-cli"><div class="titlepage"><div><div><h2 class="title">10.1. User groups and group types in IdM</h2></div></div></div><p>
				A user group is a set of users with common privileges, password policies, and other characteristics.
			</p><p>
				A user group in Identity Management (IdM) can include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM users
					</li><li class="listitem">
						other IdM user groups
					</li><li class="listitem">
						external users, which are users that exist outside IdM
					</li></ul></div><h4 id="group_types">Group types</h4><p>
				IdM has three types of groups:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">POSIX groups (the default)</span></dt><dd><p class="simpara">
							POSIX groups support POSIX attributes for their members. Note that groups that interact with Active Directory cannot use POSIX attributes.
						</p><p class="simpara">
							POSIX attributes identify users as separate entities. Examples of POSIX attributes relevant to users include <code class="literal command">uidNumber</code>, a user number (UID), and <code class="literal command">gidNumber</code>, a group number (GID).
						</p></dd><dt><span class="term">Non-POSIX groups</span></dt><dd>
							All members of this type of group must belong to the IdM domain.
						</dd><dt><span class="term">External groups</span></dt><dd>
							You can use external groups to add group members that exist in an identity store outside of the IdM domain. The external store can be a local system, an Active Directory domain, or a directory service.
						</dd></dl></div><p>
				Non-POSIX and external groups do not support POSIX attributes. For example, these groups do not have a GID defined.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In IdM <code class="literal">role</code> is a concept related to the concept of <code class="literal">group</code>. However, the only purpose of a role is to grant rights to users.
				</p></div></div><h4 id="user_groups_created_by_default">User groups created by default</h4><p>
				<span id="tab.default-user-groups_managing-user-groups-cli"><!--Empty--></span> .User groups created by default
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406473017216" scope="col">Group name</th><th align="left" valign="top" id="idm140406473016128" scope="col">Default group members</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406473017216"> <p>
								<code class="literal">ipausers</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473016128"> <p>
								All IdM users
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406473017216"> <p>
								<code class="literal">admins</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473016128"> <p>
								Users with administrative privileges, initially the default <code class="literal">admin</code> user
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406473017216"> <p>
								<code class="literal">editors</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473016128"> <p>
								Users allowed to edit other IdM users in the web UI, without all the rights of an administrative user
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406473017216"> <p>
								<code class="literal">trust admins</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473016128"> <p>
								Users with privileges to manage the Active Directory trusts
							</p>
							 </td></tr></tbody></table></div><p>
				When you add a user to a user group, the user gains the privileges and policies associated with the group. For example, you can grant administrative privileges to a user by adding the user to the <code class="literal">admins</code> group.
			</p><p>
				In addition, IdM creates <span class="emphasis"><em>user private groups</em></span> by default whenever a new user is created in IdM. For more information about private groups, see <a class="xref" href="index%3Flb_target=stage.html#adding-users-without-a-user-private-group_managing-user-groups-cli" title="10.5. Adding users without a user private group">Section 10.5, “Adding users without a user private group”</a>
			</p></section><section class="section" id="user-groups-direct-indirect_managing-user-groups-cli"><div class="titlepage"><div><div><h2 class="title">10.2. Direct and indirect group members</h2></div></div></div><p>
				User group attributes in IdM apply to both direct and indirect members: when group B is a member of group A, all users in group B are considered indirect members of group A.
			</p><p>
				For example, in <a class="xref" href="index%3Flb_target=stage.html#img.user-groups-add-member_managing-user-groups-cli">[img.user-groups-add-member_managing-user-groups-cli]</a>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						User 1 and User 2 are <span class="emphasis"><em>direct members</em></span> of group A.
					</li><li class="listitem">
						User 3, User 4, and User 5 are <span class="emphasis"><em>indirect members</em></span> of group A.
					</li></ul></div><p>
				<span id="img.user-groups-add-member_managing-user-groups-cli"><!--Empty--></span> .Direct and Indirect Group Membership
			</p><div class="informalfigure"><div class="mediaobject"><img src="user_group_members.png" alt="user group members"/></div></div><p>
				If you set a password policy for user group A, the policy also applies to all users in user group B.
			</p></section><section class="section" id="user-groups-add-delete-cli_managing-user-groups-cli"><div class="titlepage"><div><div><h2 class="title">10.3. Adding, searching for, and deleting user groups in IdM CLI</h2></div></div></div><h4 id="adding_a_user_group_using_idm_cli">Adding a user group using IdM CLI</h4><p>
				You can specify a custom GID when adding a user group. If you do this, be careful to avoid ID conflicts.
			</p><p>
				If you do not specify a custom GID, IdM automatically assigns a GID from the available ID range.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in as the administrator:
					</p><pre class="literallayout">$ kinit admin</pre></li><li class="listitem"><p class="simpara">
						Add a user group using the <code class="literal command">ipa group-add <span class="emphasis"><em>group_name</em></span></code> command. For example, to create group_a:
					</p><pre class="literallayout">$ ipa group-add group_a
---------------------
Added group "group_a"
---------------------
  Group name: group_a
  GID: 1133400009</pre><p class="simpara">
						By default, <code class="literal command">ipa group-add</code> adds a POSIX user group. To specify a different group type, add options to <code class="literal command">ipa group-add</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal option">--nonposix</code> to create a non-POSIX group
							</li><li class="listitem"><p class="simpara">
								<code class="literal option">--external</code> to create an external group
							</p><p class="simpara">
								For details on group types, see <a class="xref" href="index%3Flb_target=stage.html#user-groups_managing-user-groups-cli" title="10.1. User groups and group types in IdM">Section 10.1, “User groups and group types in IdM”</a>.
							</p></li></ul></div></li></ol></div><h4 id="searching_for_user_groups_using_idm_cli">Searching for user groups using IdM CLI</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Display all user groups using the <code class="literal command">ipa group-find</code> command.
					</li><li class="listitem">
						Display all POSIX groups using the <code class="literal command">ipa group-find --posix</code> command.
					</li><li class="listitem">
						Display all non-POSIX groups using the <code class="literal command">ipa group-find --nonposix</code> command.
					</li><li class="listitem">
						Display all external groups using the <code class="literal command">ipa group-find --external</code> command.
					</li></ul></div><h4 id="deleting_a_user_group_using_idm_cli">Deleting a user group using IdM CLI</h4><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in as the administrator:
					</p><pre class="literallayout">$ kinit admin</pre></li><li class="listitem"><p class="simpara">
						Delete a user group using the <code class="literal command">ipa group-del <span class="emphasis"><em>group_name</em></span></code> command. For example, to delete group_a:
					</p><pre class="literallayout">$ ipa group-del group_a
--------------------------
Deleted group "group_a"
--------------------------</pre></li></ol></div></section><section class="section" id="user-groups-add-member-cli_managing-user-groups-cli"><div class="titlepage"><div><div><h2 class="title">10.4. Adding a member to a user group using IdM CLI</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Ensure the relevant user group entry exists. For more information, see <a class="xref" href="index%3Flb_target=stage.html#user-groups-add-delete-cli_managing-user-groups-cli" title="10.3. Adding, searching for, and deleting user groups in IdM CLI">Section 10.3, “Adding, searching for, and deleting user groups in IdM CLI”</a>.
					</li><li class="listitem">
						Ensure the relevant user entries exist. Form more information, see <a class="link" href="index.html#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">Adding users using the command line</a>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="discrete"><li class="listitem"><p class="simpara">
						Add a member to a user group using the <code class="literal command">ipa group-add-member</code> command.
					</p><p class="simpara">
						Specify the type of member using these options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal option">--users</code> adds an IdM user
							</li><li class="listitem">
								<code class="literal option">--external</code> adds a user that exists outside the IdM domain, in the format of <code class="literal">DOMAIN\user_name</code> or <code class="literal">user_name@domain</code>
							</li><li class="listitem">
								<code class="literal option">--groups</code> adds an IdM user group
							</li></ul></div><p class="simpara">
						For example, to add group_b as a member of group_a:
					</p><pre class="literallayout">$ ipa group-add-member group_a --groups=group_b
Group name: group_a
GID: 1133400009
Member users: user_a
Member groups: group_b
Indirect Member users: user_b
-------------------------
Number of members added 1
-------------------------</pre><p class="simpara">
						Members of group_b are now indirect members of group_a.
					</p></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					When adding a group as a member of another group, do not create recursive groups. For example, if Group A is a member of Group B, do not add Group B as a member of Group A. Recursive groups can cause unpredictable behavior.
				</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					After you add a member to a user group, the update may take some time to spread to all clients in your Identity Management environment. This is because when any given host resolves users, groups and netgroups, the <code class="literal">System Security Services Daemon</code> (SSSD) first looks into its cache and performs server lookups only for missing or expired records.
				</p></div></div></section><section class="section" id="adding-users-without-a-user-private-group_managing-user-groups-cli"><div class="titlepage"><div><div><h2 class="title">10.5. Adding users without a user private group</h2></div></div></div><p>
				By default, IdM creates user private groups (UPGs) whenever a new user is created in IdM.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The UPG has the same name as the newly created user.
					</li><li class="listitem">
						The user is the only member of the UPG. The UPG cannot contain any other members.
					</li><li class="listitem">
						The GID of the private group matches the UID of the user.
					</li></ul></div><p>
				However, it is possible to add users without creating a UPG.
			</p><section class="section" id="users-without-a-user-private-group_adding-users-without-a-user-private-group"><div class="titlepage"><div><div><h3 class="title">10.5.1. Users without a user private group</h3></div></div></div><p>
					If a NIS group or another system group already uses the GID that would be assigned to a user private group, it is necessary to avoid creating a UPG.
				</p><p>
					You can do this in two ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Add a new user without a UPG, without disabling private groups globally. See <a class="link" href="index%3Flb_target=stage.html#adding-a-user-without-a-user-private-group-when-private-groups-are-globally-enabled_adding-users-without-a-user-private-group" title="10.5.2. Adding a user without a user private group when private groups are globally enabled">Adding a user without a user private group when private groups are globally enabled</a>.
						</li><li class="listitem">
							Disable UPGs globally for all users, then add a new user. See <a class="link" href="index%3Flb_target=stage.html#disabling-user-private-groups-globally-for-all-users_adding-users-without-a-user-private-group" title="10.5.3. Disabling user private groups globally for all users">Disabling user private groups globally for all users</a> and <a class="link" href="index%3Flb_target=stage.html#adding-a-user-when-user-private-groups-are-globally-disabled_adding-users-without-a-user-private-group" title="10.5.4. Adding a user when user private groups are globally disabled">Adding a user when user private groups are globally disabled</a>.
						</li></ul></div><p>
					In both cases, IdM will require specifying a GID when adding new users, otherwise the operation will fail. This is because IdM requires a GID for the new user, but the default user group <code class="literal">ipausers</code> is a non-POSIX group and therefore does not have an associated GID. The GID you specify does not have to correspond to an already existing group.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Specifying the GID does not create a new group. It only sets the GID attribute for the new user, because the attribute is required by IdM.
					</p></div></div></section><section class="section" id="adding-a-user-without-a-user-private-group-when-private-groups-are-globally-enabled_adding-users-without-a-user-private-group"><div class="titlepage"><div><div><h3 class="title">10.5.2. Adding a user without a user private group when private groups are globally enabled</h3></div></div></div><p>
					You can add a user without creating a user private group (UPG) even when UPGs are enabled on the system. This requires manually setting a GID for the new user. For details on why this is needed, see <a class="xref" href="index%3Flb_target=stage.html#users-without-a-user-private-group_adding-users-without-a-user-private-group" title="10.5.1. Users without a user private group">Section 10.5.1, “Users without a user private group”</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To prevent IdM from creating a UPG, add the <code class="literal option">--noprivate</code> option to the <code class="literal command">ipa user-add</code> command.
						</p><p class="simpara">
							Note that for the command to succeed, you must specify a custom GID. For example, to add a new user with GID 10000:
						</p><pre class="literallayout">$ ipa user-add jsmith --first=John --last=Smith --noprivate --gid 10000</pre></li></ul></div></section><section class="section" id="disabling-user-private-groups-globally-for-all-users_adding-users-without-a-user-private-group"><div class="titlepage"><div><div><h3 class="title">10.5.3. Disabling user private groups globally for all users</h3></div></div></div><p>
					You can disable user private groups (UPGs) globally. This prevents the creation of UPGs for all new users. Existing users are unaffected by this change.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Obtain administrator privileges:
						</p><pre class="literallayout">$ kinit admin</pre></li><li class="listitem"><p class="simpara">
							IdM uses the Directory Server Managed Entries Plug-in to manage UPGs. List the instances of the plug-in:
						</p><pre class="literallayout">$ ipa-managed-entries --list</pre></li><li class="listitem"><p class="simpara">
							To ensure IdM does not create UPGs, disable the plug-in instance responsible for managing user private groups:
						</p><pre class="literallayout">$ ipa-managed-entries -e "UPG Definition" disable
Disabling Plugin</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To re-enable the <code class="literal">UPG Definition</code> instance later, use the <code class="literal command">ipa-managed-entries -e "UPG Definition" enable</code> command.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Restart Directory Server to load the new configuration.
						</p><pre class="literallayout">$ sudo systemctl restart dirsrv.target</pre><p class="simpara">
							To add a user after UPGs have been disabled, you need to specify a GID. For more information, see <a class="link" href="index%3Flb_target=stage.html#adding-a-user-when-user-private-groups-are-globally-disabled_adding-users-without-a-user-private-group" title="10.5.4. Adding a user when user private groups are globally disabled">Adding a user when user private groups are globally disabled</a>
						</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To check if UPGs are globally disabled, use the disable command again:
						</p><pre class="literallayout">$ ipa-managed-entries -e "UPG Definition" disable
Plugin already disabled</pre></li></ul></div></section><section class="section" id="adding-a-user-when-user-private-groups-are-globally-disabled_adding-users-without-a-user-private-group"><div class="titlepage"><div><div><h3 class="title">10.5.4. Adding a user when user private groups are globally disabled</h3></div></div></div><p>
					When user private groups (UPGs) are disabled globally, IdM does not assign a GID to a new user automatically. To successfully add a user, you must assign a GID manually or by using an automember rule. For details on why this is required, see <a class="xref" href="index%3Flb_target=stage.html#users-without-a-user-private-group_adding-users-without-a-user-private-group" title="10.5.1. Users without a user private group">Section 10.5.1, “Users without a user private group”</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisities</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							UPGs must be disabled globally for all users. For more information, see <a class="link" href="index%3Flb_target=stage.html#disabling-user-private-groups-globally-for-all-users_adding-users-without-a-user-private-group" title="10.5.3. Disabling user private groups globally for all users">Disabling user private groups globally for all users</a>
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To make sure adding a new user succeeds when creating UPGs is disabled, choose one of the following:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									Specify a custom GID when adding a new user. The GID does not have to correspond to an already existing user group.
								</p><p class="simpara">
									For example, when adding a user from the command line, add the <code class="literal option">--gid</code> option to the <code class="literal command">ipa user-add</code> command.
								</p></li><li class="listitem">
									Use an automember rule to add the user to an existing group with a GID.
								</li></ul></div></li></ul></div></section></section><section class="section" id="user-groups-view-member-cli_managing-user-groups-cli"><div class="titlepage"><div><div><h2 class="title">10.6. Viewing group members using IdM CLI</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To list members of a group, use the <code class="literal command">ipa group-show <span class="emphasis"><em>group_name</em></span></code> command. For example:
					</p><pre class="literallayout">$ ipa group-show group_a
  ...
  Member users: user_a
  Member groups: group_b
  Indirect Member users: user_b</pre><p class="simpara">
						You can see both direct and indirect members of a group in the output. For details on direct and indirect membership, see <a class="link" href="index%3Flb_target=stage.html#user-groups-direct-indirect_managing-user-groups-cli" title="10.2. Direct and indirect group members">Direct and indirect group members</a>.
					</p><p class="simpara">
						The list of indirect members does not include external users from trusted Active Directory domains. The Active Directory trust user objects are not visible in the Identity Management interface because they do not exist as LDAP objects within Identity Management.
					</p></li></ul></div></section><section class="section" id="user-groups-remove-member-cli_managing-user-groups-cli"><div class="titlepage"><div><div><h2 class="title">10.7. Removing a member from a user group using IdM CLI</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						<span class="emphasis"><em>Optional.</em></span> Use the <code class="literal command">ipa group-show</code> command to confirm that the group includes the member you want to remove.
					</li><li class="listitem"><p class="simpara">
						Remove a member from a user group using the <code class="literal command">ipa group-remove-member</code> command.
					</p><p class="simpara">
						You can specify the member using these options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal option">--users</code> removes an IdM user
							</li><li class="listitem">
								<code class="literal option">--external</code> removes a user that exists outside the IdM domain, in the format of <code class="literal">DOMAIN\user_name</code> or <code class="literal">user_name@domain</code>
							</li><li class="listitem">
								<code class="literal option">--groups</code> removes an IdM user group
							</li></ul></div><p class="simpara">
						For example, to remove <span class="emphasis"><em>user1</em></span>, <span class="emphasis"><em>user2</em></span>, and <span class="emphasis"><em>group1</em></span> from a group called <span class="emphasis"><em>group_name</em></span>:
					</p><pre class="literallayout">$ ipa group-remove-member <span class="emphasis"><em>group_name</em></span> --users=<span class="emphasis"><em>user1</em></span> --users=<span class="emphasis"><em>user2</em></span> --groups=<span class="emphasis"><em>group1</em></span></pre></li></ol></div></section></section><section class="chapter" id="managing-user-groups-in-idm-web-ui_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Managing user groups in IdM Web UI</h1></div></div></div><p>
			This chapter introduces user groups management using the IdM web UI.
		</p><section class="section" id="user-groups_managing-user-groups-in-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">11.1. User groups and group types in IdM</h2></div></div></div><p>
				A user group is a set of users with common privileges, password policies, and other characteristics.
			</p><p>
				A user group in Identity Management (IdM) can include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM users
					</li><li class="listitem">
						other IdM user groups
					</li><li class="listitem">
						external users, which are users that exist outside IdM
					</li></ul></div><h4 id="group_types_2">Group types</h4><p>
				IdM has three types of groups:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">POSIX groups (the default)</span></dt><dd><p class="simpara">
							POSIX groups support POSIX attributes for their members. Note that groups that interact with Active Directory cannot use POSIX attributes.
						</p><p class="simpara">
							POSIX attributes identify users as separate entities. Examples of POSIX attributes relevant to users include <code class="literal command">uidNumber</code>, a user number (UID), and <code class="literal command">gidNumber</code>, a group number (GID).
						</p></dd><dt><span class="term">Non-POSIX groups</span></dt><dd>
							All members of this type of group must belong to the IdM domain.
						</dd><dt><span class="term">External groups</span></dt><dd>
							You can use external groups to add group members that exist in an identity store outside of the IdM domain. The external store can be a local system, an Active Directory domain, or a directory service.
						</dd></dl></div><p>
				Non-POSIX and external groups do not support POSIX attributes. For example, these groups do not have a GID defined.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In IdM <code class="literal">role</code> is a concept related to the concept of <code class="literal">group</code>. However, the only purpose of a role is to grant rights to users.
				</p></div></div><h4 id="user_groups_created_by_default_2">User groups created by default</h4><p>
				<span id="tab.default-user-groups_managing-user-groups-in-idm-web-ui"><!--Empty--></span> .User groups created by default
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406481972064" scope="col">Group name</th><th align="left" valign="top" id="idm140406481970976" scope="col">Default group members</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406481972064"> <p>
								<code class="literal">ipausers</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481970976"> <p>
								All IdM users
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406481972064"> <p>
								<code class="literal">admins</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481970976"> <p>
								Users with administrative privileges, initially the default <code class="literal">admin</code> user
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406481972064"> <p>
								<code class="literal">editors</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481970976"> <p>
								Users allowed to edit other IdM users in the web UI, without all the rights of an administrative user
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406481972064"> <p>
								<code class="literal">trust admins</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481970976"> <p>
								Users with privileges to manage the Active Directory trusts
							</p>
							 </td></tr></tbody></table></div><p>
				When you add a user to a user group, the user gains the privileges and policies associated with the group. For example, you can grant administrative privileges to a user by adding the user to the <code class="literal">admins</code> group.
			</p><p>
				In addition, IdM creates <span class="emphasis"><em>user private groups</em></span> by default whenever a new user is created in IdM. For more information about private groups, see <a class="xref" href="index%3Flb_target=stage.html#adding-users-without-a-user-private-group_managing-user-groups-cli" title="10.5. Adding users without a user private group">Section 10.5, “Adding users without a user private group”</a>
			</p></section><section class="section" id="user-groups-direct-indirect_managing-user-groups-in-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">11.2. Direct and indirect group members</h2></div></div></div><p>
				User group attributes in IdM apply to both direct and indirect members: when group B is a member of group A, all users in group B are considered indirect members of group A.
			</p><p>
				For example, in <a class="xref" href="index%3Flb_target=stage.html#img.user-groups-add-member_managing-user-groups-in-idm-web-ui">[img.user-groups-add-member_managing-user-groups-in-idm-web-ui]</a>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						User 1 and User 2 are <span class="emphasis"><em>direct members</em></span> of group A.
					</li><li class="listitem">
						User 3, User 4, and User 5 are <span class="emphasis"><em>indirect members</em></span> of group A.
					</li></ul></div><p>
				<span id="img.user-groups-add-member_managing-user-groups-in-idm-web-ui"><!--Empty--></span> .Direct and Indirect Group Membership
			</p><div class="informalfigure"><div class="mediaobject"><img src="user_group_members.png" alt="user group members"/></div></div><p>
				If you set a password policy for user group A, the policy also applies to all users in user group B.
			</p></section><section class="section" id="adding-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">11.3. Adding a user group using IdM Web UI</h2></div></div></div><p>
				This section describes how to add a user group using the IdM Web UI.
			</p><div class="orderedlist"><p class="title"><strong>Prerequisites</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						You are logged in to the IdM Web UI.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Identity → Groups</strong></span>, and select <span class="strong strong"><strong>User Groups</strong></span> in the left sidebar.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add</strong></span> to start adding the group.
					</li><li class="listitem"><p class="simpara">
						Fill out the information about the group. For more information about user group types, see <a class="link" href="index%3Flb_target=stage.html#user-groups_managing-user-groups-in-idm-web-ui" title="11.1. User groups and group types in IdM">User groups and group types in IdM</a>.
					</p><p class="simpara">
						You can specify a custom GID for the group. If you do this, be careful to avoid ID conflicts. If you do not specify a custom GID, IdM automatically assigns a GID from the available ID range.
					</p><div class="informalfigure"><div class="mediaobject"><img src="user-group-add-dialog.png" alt="user group add dialog"/></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Add</strong></span> to confirm.
					</li></ol></div></section><section class="section" id="deleting-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">11.4. Deleting a user group using IdM Web UI</h2></div></div></div><p>
				This section describes how to delete a user group using the IdM Web UI. Note that deleting a group does not delete the group members from IdM.
			</p><div class="orderedlist"><p class="title"><strong>Prerequisites</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						You are logged in to the IdM Web UI.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Identity → Groups</strong></span> and select <span class="strong strong"><strong>User Groups</strong></span>.
					</li><li class="listitem">
						Select the group to delete.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Delete</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Delete</strong></span> to confirm.
					</li></ol></div></section><section class="section" id="adding-a-member-to-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">11.5. Adding a member to a user group using IdM Web UI</h2></div></div></div><p>
				You can add both users and user groups as members of a user group. For more information, see <a class="link" href="index%3Flb_target=stage.html#user-groups_managing-user-groups-in-idm-web-ui" title="11.1. User groups and group types in IdM">User groups and group types in IdM</a> and <a class="link" href="index%3Flb_target=stage.html#user-groups-direct-indirect_managing-user-groups-in-idm-web-ui" title="11.2. Direct and indirect group members">Direct and indirect group members</a>.
			</p><div class="orderedlist"><p class="title"><strong>Prerequisites</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						You are logged in to the IdM Web UI.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Identity → Groups</strong></span> and select <span class="strong strong"><strong>User Groups</strong></span> in the left sidebar.
					</li><li class="listitem">
						Click the name of the group.
					</li><li class="listitem"><p class="simpara">
						Select the type of group member you want to add: <span class="strong strong"><strong>Users, User Groups,</strong></span> or <span class="strong strong"><strong>External</strong></span>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="groups_add_member_updated.png" alt="groups add member updated"/></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Add</strong></span>.
					</li><li class="listitem">
						Select the check box next to one or more members you want to add.
					</li><li class="listitem"><p class="simpara">
						Click the rightward arrow to move the selected members to the group.
					</p><div class="informalfigure"><div class="mediaobject"><img src="groups_add_member_dialog.png" alt="groups add member dialog"/></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Add</strong></span> to confirm.
					</li></ol></div></section><section class="section" id="viewing-group-members-using-idm-web-ui_managing-user-groups-in-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">11.6. Viewing group members using IdM Web UI</h2></div></div></div><p>
				This section describes how to view members of a group using the IdM Web UI. You can view both direct and indirect group members. For more information, see <a class="link" href="index%3Flb_target=stage.html#user-groups-direct-indirect_managing-user-groups-in-idm-web-ui" title="11.2. Direct and indirect group members">Direct and indirect group members</a>.
			</p><div class="orderedlist"><p class="title"><strong>Prerequisites</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						You are logged in to the IdM Web UI.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Select <span class="strong strong"><strong>Identity → Groups</strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong>User Groups</strong></span> in the left sidebar.
					</li><li class="listitem">
						Click the name of the group you want to view.
					</li><li class="listitem"><p class="simpara">
						Switch between <span class="strong strong"><strong>Direct Membership</strong></span> and <span class="strong strong"><strong>Indirect Membership</strong></span>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="groups-menu-clean.png" alt="groups menu clean"/></div></div></li></ol></div></section><section class="section" id="removing-a-member-from-a-user-group-using-idm-web-ui_managing-user-groups-in-idm-web-ui"><div class="titlepage"><div><div><h2 class="title">11.7. Removing a member from a user group using IdM Web UI</h2></div></div></div><p>
				This section describes how to remove a member from a user group using the IdM Web UI.
			</p><div class="orderedlist"><p class="title"><strong>Prerequisites</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						You are logged in to the IdM Web UI.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Identity → Groups</strong></span> and select <span class="strong strong"><strong>User Groups</strong></span> in the left sidebar.
					</li><li class="listitem">
						Click the name of the group.
					</li><li class="listitem"><p class="simpara">
						Select the type of group member you want to remove: <span class="strong strong"><strong>Users, User Groups</strong></span>, or <span class="strong strong"><strong>External</strong></span>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="groups_add_member_updated.png" alt="groups add member updated"/></div></div></li><li class="listitem">
						Select the check box next to the member you want to remove.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Delete</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Delete</strong></span> to confirm.
					</li></ol></div></section></section><section class="chapter" id="managing-hosts-cli_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Managing Hosts in IdM CLI</h1></div></div></div><p>
			This chapter introduces <a class="link" href="index%3Flb_target=stage.html#hosts_managing-hosts-cli" title="12.1. Hosts in IdM">hosts</a> and <a class="link" href="index%3Flb_target=stage.html#con_host-entry-LDAP_managing-hosts-cli" title="12.4. Host entry in IdM LDAP">host entries</a> in Identity Management (IdM), and the following operations performed when managing hosts and host entries in IdM CLI:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#host-enrollment_managing-hosts-cli" title="12.2. Host enrollment">Host Enrollment</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#adding-host-entry-cmd_managing-hosts-cli" title="12.5. Adding IdM host entries from IdM CLI">Adding IdM host entries</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#deleting-host-entry-cmd_managing-hosts-cli" title="12.6. Deleting host entries from IdM CLI">Deleting IdM host entries</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#re-enrolling-an-ipa-client_managing-hosts-cli" title="12.7. Re-enrolling an Identity Management client">Re-enrolling hosts</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#renaming-ipa-client-systems_managing-hosts-cli" title="12.8. Renaming Identity Management client systems">Renaming hosts</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#proc_host-disable_managing-hosts-cli" title="12.9.1. Disabling Hosts">Disabling hosts</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#proc_reenabling-hosts_managing-hosts-cli" title="12.9.2. Re-enabling Hosts">Re-enabling hosts</a>
				</li></ul></div><p>
			The chapter also contains an <a class="link" href="index%3Flb_target=stage.html#hosts-actions_managing-hosts-cli" title="12.3. Host Operations">overview table</a> of the prerequisites, the context, and the consequences of these operations.
		</p><section class="section" id="hosts_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.1. Hosts in IdM</h2></div></div></div><p>
				Identity Management (IdM) manages these identities:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users
					</li><li class="listitem">
						Services
					</li><li class="listitem">
						Hosts
					</li></ul></div><p>
				A host represents a machine. As an IdM identity, a host has an entry in the IdM LDAP, that is the 389 Directory Server instance of the IdM server.
			</p><p>
				The host entry in IdM LDAP is used to establish relationships between other hosts and even services within the domain. These relationships are part of <span class="emphasis"><em>delegating</em></span> authorization and control to hosts within the domain. Any host can be used in <code class="literal">host-based access control</code> (HBAC) rules.
			</p><p>
				IdM domain establishes a commonality between machines, with common identity information, common policies, and shared services. Any machine that belongs to a domain functions as a client of the domain, which means it uses the services that the domain provides. IdM domain provides three main services specifically for machines:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						DNS
					</li><li class="listitem">
						Kerberos
					</li><li class="listitem">
						Certificate management
					</li></ul></div><p>
				Hosts in IdM are closely connected with the services running on them:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Service entries are associated with a host.
					</li><li class="listitem">
						A host stores both the host and the service Kerberos principals.
					</li></ul></div></section><section class="section" id="host-enrollment_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.2. Host enrollment</h2></div></div></div><p>
				This section describes enrolling hosts as IdM clients and what happens during and after the enrollment. The section compares the enrollment of IdM hosts and IdM users. The section also outlines alternative types of authentication available to hosts.
			</p><p>
				Enrolling a host consists of:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Creating a host entry in IdM LDAP: possibly using the <a class="link" href="index%3Flb_target=stage.html#adding-host-entry-cmd_managing-hosts-cli" title="12.5. Adding IdM host entries from IdM CLI"><code class="literal">ipa host-add</code> command</a> in IdM CLI, or the equivalent <a class="link" href="index%3Flb_target=stage.html#adding-host-entry-ui_managing-hosts-ui" title="13.4. Adding Host Entries from the Web UI">IdM Web UI operation</a>.
					</li><li class="listitem">
						Configuring IdM services on the host, for example the System Security Services Daemon (SSSD), Kerberos, and certmonger, and joining the host to the IdM domain.
					</li></ul></div><p>
				The two actions can be performed separately or together.
			</p><p>
				If performed separately, they allow for dividing the two tasks between two users with different levels of privilege. This is useful for bulk deployments.
			</p><p>
				The <code class="literal">ipa-client-install</code> command can perform the two actions together. The command creates a host entry in IdM LDAP if that entry does not exist yet, and configures both the Kerberos and SSSD services for the host. The command brings the host within the IdM domain and allows it to identify the IdM server it will connect with. If the host belongs to a DNS zone managed by IdM, <code class="literal">ipa-client-install</code> adds DNS records for the host too. The command must be run on the client.
			</p><section class="section" id="host-enrollment-privileges_managing-hosts-cli"><div class="titlepage"><div><div><h3 class="title">12.2.1. User privileges required for host enrollment</h3></div></div></div><p>
					The host enrollment operation requires authentication to prevent an unprivileged user from adding unwanted machines to the IdM domain. The privileges required depend on several factors, for example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If a host entry is created separately from running <code class="literal">ipa-client-install</code>
						</li><li class="listitem">
							If a one-time password (OTP) is used for enrollment
						</li></ul></div><h5 id="user_privileges_for_optionally_manually_creating_a_host_entry_in_idm_ldap">User privileges for optionally manually creating a host entry in IdM LDAP</h5><p>
					The user privilege required for creating a host entry in IdM LDAP using the <code class="literal">ipa host-add</code> CLI command or the IdM Web UI is <code class="literal">Host Administrators</code>. The <code class="literal">Host Administrators</code> privilege can be obtained through the <code class="literal">IT Specialist</code> role.
				</p><h5 id="user_privileges_for_joining_the_client_to_the_idm_domain">User privileges for joining the client to the IdM domain</h5><p>
					Hosts are configured as IdM clients during the execution of the <code class="literal">ipa-client-install</code> command. The level of credentials required for executing the <code class="literal">ipa-client-install</code> command depends on which of the following enrolling scenarios you find yourself in:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The host entry in IdM LDAP does not exist. For this scenario, you need a full administrator’s credentials or the <code class="literal">Host Administrators</code> role. A full administrator is a member of the <code class="literal">admins</code> group. The <code class="literal">Host Administrators</code> role provides privileges to add hosts and enroll hosts. For details about this scenario, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation">Installing a client using user credentials: interactive installation</a>.
						</li><li class="listitem">
							The host entry in IdM LDAP exists. For this scenario, you need a limited administrator’s credentials to execute <code class="literal">ipa-client-install</code> successfully. The limited administrator in this case has the <code class="literal">Enrollment Administrator</code> role, which provides the <code class="literal">Host Enrollment</code> privilege. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation">Installing a client using user credentials: interactive installation</a>.
						</li><li class="listitem">
							The host entry in IdM LDAP exists, and an OTP has been generated for the host by a full or limited administrator. For this scenario, you can install an IdM client as an ordinary user if you run the <code class="literal">ipa-client-install</code> command with the <code class="literal">--password</code> option, supplying the correct OTP. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-client-basic-installing-a-client-by-using-a-one-time-password-interactive-installation">Installing a client by using a one-time password: Interactive installation</a>.
						</li></ul></div><p>
					After enrollment, IdM hosts authenticate every new session to be able to access IdM resources. Machine authentication is required for the IdM server to trust the machine and to accept IdM connections from the client software installed on that machine. After authenticating the client, the IdM server can respond to its requests.
				</p></section><section class="section" id="comparing-hosts-and-users_managing-hosts-cli"><div class="titlepage"><div><div><h3 class="title">12.2.2. Enrollment and authentication of IdM hosts and users: comparison</h3></div></div></div><p>
					There are many similarities between users and hosts in IdM. This section describes some of the similarities that can be observed during the enrollment stage as well as those that concern authentication during the deployment stage.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The enrollment stage (<a class="xref" href="index%3Flb_target=stage.html#user-host-enrollment_managing-hosts-cli" title="Table 12.1. User and host enrollment">Table 12.1, “User and host enrollment”</a>):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									An administrator can create an LDAP entry for both a user and a host before the user or host actually join IdM: for the stage user, the command is <code class="literal">ipa stageuser-add</code>; for the host, the command is <code class="literal">ipa host-add</code>.
								</li><li class="listitem">
									A file containing a <span class="emphasis"><em>key table</em></span> or, abbreviated, keytab, a symmetric key resembling to some extent a user password, is created during the execution of the <code class="literal">ipa-client-install</code> command on the host, resulting in the host joining the IdM realm. Analogically, a user is asked to create a password when they activate their account, thus joining the IdM realm.
								</li><li class="listitem">
									While the user password is the default authentication method for a user, the keytab is the default authentication method for a host. The keytab is stored in a file on the host.
								</li></ul></div><div class="table" id="user-host-enrollment_managing-hosts-cli"><p class="title"><strong>Table 12.1. User and host enrollment</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 38%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406487834880" scope="col">Action</th><th align="left" valign="top" id="idm140406487833792" scope="col">User</th><th align="left" valign="top" id="idm140406487832704" scope="col">Host</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406487834880"> <p>
											Pre-enrollment
										</p>
										 </td><td align="left" valign="top" headers="idm140406487833792"> <p>
											$ <span class="strong strong"><strong>ipa stageuser-add <span class="emphasis"><em>user_name</em></span> [--password]</strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406487832704"> <p>
											$ <span class="strong strong"><strong>ipa host-add <span class="emphasis"><em>host_name</em></span> [--random]</strong></span>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140406487834880"> <p>
											Activating the account
										</p>
										 </td><td align="left" valign="top" headers="idm140406487833792"> <p>
											$ <span class="strong strong"><strong>ipa stageuser-activate <span class="emphasis"><em>user_name</em></span></strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406487832704"> <p>
											$ <span class="strong strong"><strong>ipa-client install [--password]</strong></span> (must be run on the host itself)
										</p>
										 </td></tr></tbody></table></div></div></li><li class="listitem"><p class="simpara">
							The deployment stage (<a class="xref" href="index%3Flb_target=stage.html#user-host-start-session_managing-hosts-cli" title="Table 12.2. User and host session authentication">Table 12.2, “User and host session authentication”</a>):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									When a user starts a new session, the user authenticates using a password; similarly, every time it is switched on, the host authenticates by presenting its keytab file. The System Security Services Daemon (SSSD) manages this process in the background.
								</li><li class="listitem">
									If the authentication is successful, the user or host obtains a Kerberos ticket granting ticket (TGT).
								</li><li class="listitem">
									The TGT is then used to obtain specific tickets for specific services.
								</li></ul></div><div class="table" id="user-host-start-session_managing-hosts-cli"><p class="title"><strong>Table 12.2. User and host session authentication</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 38%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406512826608" scope="col"> </th><th align="left" valign="top" id="idm140406486253056" scope="col">User</th><th align="left" valign="top" id="idm140406486251968" scope="col">Host</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406512826608"> <p>
											Default means of authentication
										</p>
										 </td><td align="left" valign="top" headers="idm140406486253056"> <p>
											<span class="strong strong"><strong>Password</strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406486251968"> <p>
											<span class="strong strong"><strong>Keytabs</strong></span>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140406512826608"> <p>
											Starting a session (ordinary user)
										</p>
										 </td><td align="left" valign="top" headers="idm140406486253056"> <p>
											$ <span class="strong strong"><strong>kinit <span class="emphasis"><em>user_name</em></span></strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406486251968"> <p>
											<span class="emphasis"><em>[switch on the host]</em></span>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140406512826608"> <p>
											The result of successful authentication
										</p>
										 </td><td align="left" valign="top" headers="idm140406486253056"> <p>
											<span class="strong strong"><strong>TGT</strong></span> to be used to obtain access to specific services
										</p>
										 </td><td align="left" valign="top" headers="idm140406486251968"> <p>
											<span class="strong strong"><strong>TGT</strong></span> to be used to obtain access to specific services
										</p>
										 </td></tr></tbody></table></div></div></li></ul></div><p>
					TGTs and other Kerberos tickets are generated as part of the Kerberos services and policies defined by the server. The initial granting of a Kerberos ticket, the renewing of the Kerberos credentials, and even the destroying of the Kerberos session are all handled automatically by the IdM services.
				</p></section><section class="section" id="alternative-host-authentication_managing-hosts-cli"><div class="titlepage"><div><div><h3 class="title">12.2.3. Alternative authentication options for IdM hosts</h3></div></div></div><p>
					Apart from keytabs, IdM supports two other types of machine authentication:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							SSH keys. The SSH public key for the host is created and uploaded to the host entry. From there, the System Security Services Daemon (SSSD) uses IdM as an identity provider and can work in conjunction with OpenSSH and other services to reference the public keys located centrally in IdM.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Machine certificates. In this case, the machine uses an SSL certificate that is issued by the IdM server’s certificate authority and then stored in IdM’s Directory Server. The certificate is then sent to the machine to present when it authenticates to the server. On the client, certificates are managed by a service called <a class="link" href="index.html#certmonger_certmonger-for-issuing-renewing-service-certs">certmonger</a>.
						</li></ul></div></section></section><section class="section" id="hosts-actions_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.3. Host Operations</h2></div></div></div><p>
				This section lists the most common operations related to host enrollment and enablement, and explains the prerequisites, the context, and the consequences of performing them.
			</p><div class="table" id="tab-managing-host-operations"><p class="title"><strong>Table 12.3. Host operations part 1</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 17%; " class="col_1"><!--Empty--></col><col style="width: 17%; " class="col_2"><!--Empty--></col><col style="width: 17%; " class="col_3"><!--Empty--></col><col style="width: 50%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406485229664" scope="col">Action</th><th align="left" valign="top" id="idm140406481652880" scope="col">What are the prerequisites of the action?</th><th align="left" valign="top" id="idm140406481651760" scope="col">When does it make sense to run the command?</th><th align="left" valign="top" id="idm140406481650640" scope="col">How is the action performed by a system administrator? What command(s) does he run?</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406485229664"> <p>
								<code class="literal">Enrolling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481652880"> <p>
								see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#preparing-the-system-for-ipa-client-installation_installing-identity-management">Preparing the system for Identity Management client installation</a> in <span class="emphasis"><em>Installing_Identity_Management</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481651760"> <p>
								When you want the host to join the IdM realm.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481650640"> <p>
								Enrolling machines as clients in the IdM domain is a two-part process. A host entry is created for the client (and stored in the 389 Directory Server instance) when the <code class="literal">ipa host-add</code> command is run, and then a keytab is created to provision the client. Both parts are performed automatically by the <code class="literal">ipa-client-install</code> command. It is also possible to perform those steps separately; this allows for administrators to prepare machines and IdM in advance of actually configuring the clients. This allows more flexible setup scenarios, including bulk deployments.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406485229664"> <p>
								<code class="literal">Disabling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481652880"> <p>
								The host must have an entry in IdM. The host needs to have an active keytab.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481651760"> <p>
								When you want to remove the host from the IdM realm temporarily, perhaps for maintenance purposes.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481650640"> <p>
								<code class="literal">ipa host-disable host_name</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406485229664"> <p>
								<code class="literal">Enabling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481652880"> <p>
								The host must have an entry in IdM.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481651760"> <p>
								When you want the temporarily disabled host to become active again.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481650640"> <p>
								<code class="literal">ipa-getkeytab</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406485229664"> <p>
								<code class="literal">Re-enrolling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481652880"> <p>
								The host must have en entry in IdM.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481651760"> <p>
								When the original host has been lost but you have installed a host with the same host name.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481650640"> <p>
								<code class="literal">ipa-client-install --keytab</code> or <code class="literal">ipa-client-install --force-join</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406485229664"> <p>
								<code class="literal">Un-enrolling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406481652880"> <p>
								The host must have an entry in IdM.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481651760"> <p>
								When you want to remove the host from the IdM realm permanently.
							</p>
							 </td><td align="left" valign="top" headers="idm140406481650640"> <p>
								<code class="literal">ipa-client-install --uninstall</code>
							</p>
							 </td></tr></tbody></table></div></div><div class="table" id="tab-managing-hosts-operations-2"><p class="title"><strong>Table 12.4. Host operations part 2</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col><col style="width: 60%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406512782288" scope="col">Action</th><th align="left" valign="top" id="idm140406512781200" scope="col">On which machine can the administrator run the command(s)?</th><th align="left" valign="top" id="idm140406512780144" scope="col">What happens when the action is performed? What are the consequences for the host’s functioning in IdM? What limitations are introduced/removed?</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406512782288"> <p>
								<code class="literal">Enrolling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406512781200"> <p>
								In the case of a two-step enrollment: <code class="literal">ipa host-add</code> can be run on any IdM client; the second step of <code class="literal">ipa-client-install</code> must be run on the client itself
							</p>
							 </td><td align="left" valign="top" headers="idm140406512780144"> <p>
								By default this configures SSSD to connect to an IdM server for authentication and authorization. Optionally one can instead configure the Pluggable Authentication Module (PAM) and the Name Switching Service (NSS) to work with an IdM server over Kerberos and LDAP.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406512782288"> <p>
								<code class="literal">Disabling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406512781200"> <p>
								Any machine in IdM, even the host itself
							</p>
							 </td><td align="left" valign="top" headers="idm140406512780144"> <p>
								The host’s Kerberos key and SSL certificate are invalidated, and all services running on the host are disabled.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406512782288"> <p>
								<code class="literal">Enabling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406512781200"> <p>
								Any machine in IdM. If run on the disabled host, LDAP credentials need to be supplied.
							</p>
							 </td><td align="left" valign="top" headers="idm140406512780144"> <p>
								The host’s Kerberos key and the SSL certificate are made valid again, and all IdM services running on the host are re-enabled.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406512782288"> <p>
								<code class="literal">Re-enrolling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406512781200"> <p>
								The host to be re-enrolled. LDAP credentials need to be supplied.
							</p>
							 </td><td align="left" valign="top" headers="idm140406512780144"> <p>
								A new Kerberos key is generated for the host, replacing the previous one.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406512782288"> <p>
								<code class="literal">Un-enrolling a client</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406512781200"> <p>
								The host to be un-enrolled.
							</p>
							 </td><td align="left" valign="top" headers="idm140406512780144"> <p>
								The command unconfigures IdM and attempts to return the machine to its previous state. Part of this process is to unenroll the host from the IdM server. Unenrollment consists of disabling the principal key on the IdM server. The machine principal in <code class="literal">/etc/krb5.keytab</code> (<code class="literal">host/&lt;fqdn&gt;@REALM</code>) is used to authenticate to the IdM server to unenroll itself. If this principal does not exist then unenrollment will fail and an administrator will need to disable the host principal (<code class="literal">ipa host-disable &lt;fqdn&gt;</code>).
							</p>
							 </td></tr></tbody></table></div></div></section><section class="section" id="con_host-entry-LDAP_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.4. Host entry in IdM LDAP</h2></div></div></div><p>
				This section describes what a host entry in Identity Management (IdM) looks like and what attributes it can contain.
			</p><p>
				An LDAP host entry contains all relevant information about the client within IdM:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Service entries associated with the host
					</li><li class="listitem">
						The host and service principal
					</li><li class="listitem">
						Access control rules
					</li><li class="listitem">
						Machine information, such as its physical location and operating system
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Note that the IdM Web UI <code class="literal">Identity</code> → <code class="literal">Hosts</code> tab does not show all the information about a particular host stored in the IdM LDAP.
				</p></div></div><section class="section" id="host-attributes_managing-hosts-cli"><div class="titlepage"><div><div><h3 class="title">12.4.1. Host entry configuration properties</h3></div></div></div><p>
					A host entry can contain information about the host that is outside its system configuration, such as its physical location, MAC address, keys, and certificates.
				</p><p>
					This information can be set when the host entry is created if it is created manually. Alternatively, most of this information can be added to the host entry after the host is enrolled in the domain.
				</p><div class="table" id="tab.host-attr_managing-hosts-cli"><p class="title"><strong>Table 12.5. Host Configuration Properties</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406477182048" scope="col">UI Field</th><th align="left" valign="top" id="idm140406477180960" scope="col">Command-Line Option</th><th align="left" valign="top" id="idm140406477179872" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									Description
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--desc</code>=<span class="emphasis"><em>description</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									A description of the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									Locality
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--locality</code>=<span class="emphasis"><em>locality</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									The geographic location of the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									Location
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--location</code>=<span class="emphasis"><em>location</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									The physical location of the host, such as its data center rack.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									Platform
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--platform</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									The host hardware or architecture.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									Operating system
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--os</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									The operating system and version for the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									MAC address
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--macaddress</code>=<span class="emphasis"><em>address</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									The MAC address for the host. This is a multi-valued attribute. The MAC address is used by the NIS plug-in to create a NIS <code class="literal">ethers</code> map for the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									SSH public keys
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--sshpubkey</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									The full SSH public key for the host. This is a multi-valued attribute, so multiple keys can be set.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									Principal name (not editable)
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--principalname</code>=<span class="emphasis"><em>principal</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									The Kerberos principal name for the host. This defaults to the host name during the client installation, unless a different principal is explicitly set in the <code class="literal option">-p</code>. This can be changed using the command-line tools, but cannot be changed in the UI.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									Set One-Time Password
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--password</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									This option sets a password for the host which can be used in bulk enrollment.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									-
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--random</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									This option generates a random password to be used in bulk enrollment.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									-
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--certificate</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									A certificate blob for the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406477182048"> <p>
									-
								</p>
								 </td><td align="left" valign="top" headers="idm140406477180960"> <p>
									<code class="literal option">--updatedns</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140406477179872"> <p>
									This sets whether the host can dynamically update its DNS entries if its IP address changes.
								</p>
								 </td></tr></tbody></table></div></div></section></section><section class="section" id="adding-host-entry-cmd_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.5. Adding IdM host entries from IdM CLI</h2></div></div></div><p>
				This section describes how to add host entries in Identity Management (IdM) using the command-line interface (CLI).
			</p><p>
				Host entries are created using the <code class="literal command">host-add</code> command. This commands adds the host entry to the IdM Directory Server. Consult the <code class="literal">ipa host</code> manpage by typing <code class="literal">ipa help host</code> in your CLI to get the full list of options available with <code class="literal command">host-add</code>.
			</p><p>
				There are a few different scenarios when adding a host to IdM:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						At its most basic, specify only the client host name to add the client to the Kerberos realm and to create an entry in the IdM LDAP server:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-add client1.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						If the IdM server is configured to manage DNS, add the host to the DNS resource records using the <code class="literal option">--ip-address</code> option.
					</p><div class="example" id="ex.host-dns"><p class="title"><strong>Example 12.1. Creating Host Entries with Static IP Addresses</strong></p><div class="example-contents"><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-add --ip-address=192.168.166.31 client1.example.com</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						If the host to be added does not have a static IP address or if the IP address is not known at the time the client is configured, use the <code class="literal">--force</code> option with the <code class="literal">ipa host-add</code> command.
					</p><div class="example" id="ex.host-dns-dhcp"><p class="title"><strong>Example 12.2. Creating Host Entries with DHCP</strong></p><div class="example-contents"><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-add --force client1.example.com</strong></span></pre></div></div><p class="simpara">
						For example, laptops may be preconfigured as IdM clients, but they do not have IP addresses at the time they are configured. Using <code class="literal option">--force</code> essentially creates a placeholder entry in the IdM DNS service. When the DNS service dynamically updates its records, the host’s current IP address is detected and its DNS record is updated.
					</p></li></ul></div></section><section class="section" id="deleting-host-entry-cmd_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.6. Deleting host entries from IdM CLI</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Use the <code class="literal command">host-del</code> command to delete host records. If your IdM domain has integrated DNS, use the <code class="literal option">--updatedns</code> option to remove the associated records of any kind for the host from the DNS:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-del --updatedns client1.example.com</strong></span></pre></li></ul></div></section><section class="section" id="re-enrolling-an-ipa-client_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.7. Re-enrolling an Identity Management client</h2></div></div></div><section class="section" id="client-reenrollment-idm_re-enrolling-client"><div class="titlepage"><div><div><h3 class="title">12.7.1. Client re-enrollment in IdM</h3></div></div></div><p>
					This section describes how to re-enroll an Identity Management (IdM) client.
				</p><p>
					If a client machine has been destroyed and lost connection with the IdM servers, for example due to the client’s hardware failure, and you still have its keytab, you can re-enroll the client. In this scenario, you want to get the client back in the IdM environment with the same hostname.
				</p><p>
					During the re-enrollment, the client generates a new Kerberos key and SSH keys, but the identity of the client in the LDAP database remains unchanged. After the re-enrollment, the host has its keys and other information in the same LDAP object with the same <code class="literal">FQDN</code> as previously, before the machine’s loss of connection with the IdM servers.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You can only re-enroll clients whose domain entry is still active. If you uninstalled a client (using <code class="literal command">ipa-client-install --uninstall</code>) or disabled its host entry (using <code class="literal command">ipa host-disable</code>), you cannot re-enroll it.
					</p></div></div><p>
					You cannot re-enroll a client after you have renamed it. This is because in Identity Management, the key attribute of the client’s entry in LDAP is the client’s hostname, its <code class="literal">FQDN</code>. As opposed to re-enrolling a client, during which the client’s LDAP object remains unchanged, the outcome of renaming a client is that the client has its keys and other information in a different LDAP object with a new <code class="literal">FQDN</code>. Thus the only way to rename a client is to uninstall the host from IdM, change the host’s hostname, and install it as an IdM client with a new name. For details on how to rename a client, see <a class="xref" href="index%3Flb_target=stage.html#renaming-ipa-client-systems_managing-hosts-cli" title="12.8. Renaming Identity Management client systems">Section 12.8, “Renaming Identity Management client systems”</a>.
				</p><section class="section" id="what-happens-during-client-re-enrollment_re-enrolling-client"><div class="titlepage"><div><div><h4 class="title">12.7.1.1. What happens during client re-enrollment</h4></div></div></div><p>
						During re-enrollment, Identity Management:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Revokes the original host certificate
							</li><li class="listitem">
								Creates new SSH keys
							</li><li class="listitem">
								Generates a new keytab
							</li></ul></div></section></section><section class="section" id="re-enrolling-a-client-by-using-user-credentials-interactive-re-enrollment_re-enrolling-client"><div class="titlepage"><div><div><h3 class="title">12.7.2. Re-enrolling a client by using user credentials: Interactive re-enrollment</h3></div></div></div><p>
					This procedure describes re-enrolling an Identity Management client interactively by using the credentials of an authorized user.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Re-create the client machine with the same host name.
						</li><li class="listitem"><p class="simpara">
							Run the <code class="literal command">ipa-client-install --force-join</code> command on the client machine:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --force-join</strong></span></pre></li><li class="listitem"><p class="simpara">
							The script prompts for a user whose identity will be used to re-enroll the client. This could be, for example, a <code class="literal">hostadmin</code> user with the Enrollment Administrator role:
						</p><pre class="literallayout">User authorized to enroll computers: <code class="literal">hostadmin</code>
Password for <code class="literal">hostadmin</code>@<code class="literal">EXAMPLE.COM</code>:</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For a more detailed procedure on enrolling clients by using an authorized user’s credentials, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation">Installing a client by using user credentials: Interactive installation</a> in <span class="emphasis"><em>Installing Identity Management</em></span>.
						</li></ul></div></section><section class="section" id="re-enrolling-idm-client-using-keytab-non-interactive_re-enrolling-client"><div class="titlepage"><div><div><h3 class="title">12.7.3. Re-enrolling a client by using the client keytab: Non-interactive re-enrollment</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Back up the original client keytab file, for example in the <code class="literal">/tmp</code> or <code class="literal">/root</code> directory.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						This procedure describes re-enrolling an Identity Management (IdM) client non-interactively by using the keytab of the client system. For example, re-enrollment using the client keytab is appropriate for an automated installation.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Re-create the client machine with the same host name.
						</li><li class="listitem">
							Copy the keytab file from the backup location to the <code class="literal">/etc/</code> directory on the re-created client machine.
						</li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa-client-install</code> utility to re-enroll the client, and specify the keytab location with the <code class="literal option">--keytab</code> option:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --keytab /etc/krb5.keytab</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The keytab specified in the <code class="literal option">--keytab</code> option is only used when authenticating to initiate the enrollment. During the re-enrollment, IdM generates a new keytab for the client.
							</p></div></div></li></ol></div></section><section class="section" id="testing-an-ipa-client-re-enrolling-client"><div class="titlepage"><div><div><h3 class="title">12.7.4. Testing an Identity Management client after installation</h3></div></div></div><p>
					The Command-Line Interface informs you that the <code class="literal command">ipa-client-install</code> was successful, but you can also do your own test.
				</p><p>
					To test that the Identity Management client can obtain information about users defined on the server, check that you are able to resolve a user defined on the server. For example, to check the default <code class="literal">admin</code> user:
				</p><pre class="literallayout">[user@client1 ~]$ <span class="strong strong"><strong>id admin</strong></span>
uid=1254400000(admin) gid=1254400000(admins) groups=1254400000(admins)</pre><p>
					To test that authentication works correctly, <code class="literal command">su -</code> as another IdM user:
				</p><pre class="literallayout">[user@client1 ~]$ <span class="strong strong"><strong>su - idm_user</strong></span>
Last login: Thu Oct 18 18:39:11 CEST 2018 from 192.168.122.1 on pts/0
[idm_user@client1 ~]$</pre></section></section><section class="section" id="renaming-ipa-client-systems_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.8. Renaming Identity Management client systems</h2></div></div></div><p>
				The following sections describe how to change the host name of an Identity Management client system.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Renaming a client is a manual procedure. Do not perform it unless changing the host name is absolutely required.
				</p></div></div><p>
				Renaming an Identity Management client involves:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Preparing the host. For details, see <a class="xref" href="index%3Flb_target=stage.html#prerequisites_renaming-clients" title="12.8.1. Prerequisites">Section 12.8.1, “Prerequisites”</a>
					</li><li class="listitem">
						Uninstalling the IdM client from the host. For details, see <a class="xref" href="index%3Flb_target=stage.html#uninstalling-an-ipa-client-procedure_renaming-clients" title="12.8.2. Uninstalling an Identity Management client">Section 12.8.2, “Uninstalling an Identity Management client”</a>
					</li><li class="listitem">
						Renaming the host. For details, see <a class="xref" href="index%3Flb_target=stage.html#renaming-the-ipa-client-system_renaming-clients" title="12.8.3. Renaming the host system">Section 12.8.3, “Renaming the host system”</a>
					</li><li class="listitem">
						Installing the IdM client on the host with the new name. For details, see <a class="xref" href="index%3Flb_target=stage.html#reinstalling-client" title="12.8.4. Re-installing an Identity Management client">Section 12.8.4, “Re-installing an Identity Management client”</a>
					</li><li class="listitem">
						Configuring the host after the IdM client installation. For details, see <a class="xref" href="index%3Flb_target=stage.html#re-adding-services-re-generating-certificates-and-re-adding-host-groups_renaming-clients" title="12.8.5. Re-adding services, re-generating certificates, and re-adding host groups">Section 12.8.5, “Re-adding services, re-generating certificates, and re-adding host groups”</a>
					</li></ol></div><section class="section" id="prerequisites_renaming-clients"><div class="titlepage"><div><div><h3 class="title">12.8.1. Prerequisites</h3></div></div></div><p>
					Before uninstalling the current client, make note of certain settings for the client. You will apply this configuration after re-enrolling the machine with a new host name.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Identify which services are running on the machine:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									Use the <code class="literal command">ipa service-find</code> command, and identify services with certificates in the output:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa service-find <span class="emphasis"><em>old-client-name.example.com</em></span></strong></span></pre></li><li class="listitem">
									In addition, each host has a default <span class="emphasis"><em>host service</em></span> which does not appear in the <code class="literal command">ipa service-find</code> output. The service principal for the host service, also called a <span class="emphasis"><em>host principal</em></span>, is <code class="literal">host/<span class="emphasis"><em>old-client-name.example.com</em></span></code>.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							For all service principals displayed by <code class="literal command">ipa service-find <span class="emphasis"><em>old-client-name.example.com</em></span></code>, determine the location of the corresponding keytabs on the <code class="literal"><span class="emphasis"><em>old-client-name.example.com</em></span></code> system:
						</p><pre class="literallayout"># <span class="strong strong"><strong>find / -name "*.keytab"</strong></span></pre><p class="simpara">
							Each service on the client system has a Kerberos principal in the form <span class="emphasis"><em>service_name/host_name@REALM</em></span>, such as <code class="literal">ldap/<span class="emphasis"><em>old-client-name.example.com@EXAMPLE.COM</em></span></code>.
						</p></li><li class="listitem"><p class="simpara">
							Identify all host groups to which the machine belongs.
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa hostgroup-find <span class="emphasis"><em>old-client-name.example.com</em></span></strong></span></pre></li></ul></div></section><section class="section" id="uninstalling-an-ipa-client-procedure_renaming-clients"><div class="titlepage"><div><div><h3 class="title">12.8.2. Uninstalling an Identity Management client</h3></div></div></div><p>
					Uninstalling a client removes the client from the Identity Management domain, along with all of the specific Identity Management configuration of system services, such as System Security Services Daemon (SSSD). This restores the previous configuration of the client system.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal command">ipa-client-install --uninstall</code> command:
						</p><pre class="literallayout">[root@client]# <span class="strong strong"><strong>ipa-client-install --uninstall</strong></span></pre></li><li class="listitem"><p class="simpara">
							Remove the DNS entries for the client host manually from the server:
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ipa dnsrecord-del</strong></span>
Record name: old-client-client
Zone name: idm.example.com
No option to delete specific record provided.
Delete all? Yes/No (default No): yes
------------------------
Deleted record "old-client-name"</pre></li><li class="listitem"><p class="simpara">
							For each identified keytab other than <code class="literal">/etc/krb5.keytab</code>, remove the old principals:
						</p><pre class="literallayout">[root@client ~]# <span class="strong strong"><strong>ipa-rmkeytab -k <span class="emphasis"><em>/path/to/keytab</em></span> -r EXAMPLE.COM</strong></span></pre></li><li class="listitem"><p class="simpara">
							On an IdM server, remove the host entry. This removes all services and revokes all certificates issued for that host:
						</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa host-del client.example.com</strong></span></pre></li></ol></div></section><section class="section" id="renaming-the-ipa-client-system_renaming-clients"><div class="titlepage"><div><div><h3 class="title">12.8.3. Renaming the host system</h3></div></div></div><p>
					Rename the machine as required. For example:
				</p><pre class="literallayout">[root@client]# <span class="strong strong"><strong>hostnamectl set-hostname <span class="emphasis"><em>new-client-name.example.com</em></span></strong></span></pre><p>
					You can now re-install the Identity Management client to the Identity Management domain with the new host name.
				</p></section><section class="section" id="reinstalling-client"><div class="titlepage"><div><div><h3 class="title">12.8.4. Re-installing an Identity Management client</h3></div></div></div><p>
					Install an client on your renamed host following the procedure described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-an-ipa-client-basic-scenario_installing-identity-management">Installing an Identity Management client: Basic scenario</a> in <span class="emphasis"><em>Installing Identity Management</em></span>.
				</p></section><section class="section" id="re-adding-services-re-generating-certificates-and-re-adding-host-groups_renaming-clients"><div class="titlepage"><div><div><h3 class="title">12.8.5. Re-adding services, re-generating certificates, and re-adding host groups</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On the Identity Management (IdM) server, add a new keytab for every service identified in <a class="xref" href="index%3Flb_target=stage.html#prerequisites_renaming-clients" title="12.8.1. Prerequisites">Section 12.8.1, “Prerequisites”</a>.
						</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa service-add <span class="emphasis"><em>service_name/new-client-name</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
							Generate certificates for services that had a certificate assigned in <a class="xref" href="index%3Flb_target=stage.html#prerequisites_renaming-clients" title="12.8.1. Prerequisites">Section 12.8.1, “Prerequisites”</a>. You can do this:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Using the IdM administration tools
								</li><li class="listitem">
									Using the <code class="literal">certmonger</code> utility
								</li></ul></div></li><li class="listitem">
							Re-add the client to the host groups identified in <a class="xref" href="index%3Flb_target=stage.html#prerequisites_renaming-clients" title="12.8.1. Prerequisites">Section 12.8.1, “Prerequisites”</a>.
						</li></ol></div></section></section><section class="section" id="proc_host-disable-reenable_managing-hosts-cli"><div class="titlepage"><div><div><h2 class="title">12.9. Disabling and Re-enabling Host Entries</h2></div></div></div><p>
				This section describes how to disable and re-enable hosts in Identity Management (IdM).
			</p><section class="section" id="proc_host-disable_managing-hosts-cli"><div class="titlepage"><div><div><h3 class="title">12.9.1. Disabling Hosts</h3></div></div></div><p>
					Complete this procedure to disable a host entry in IdM.
				</p><p>
					Domain services, hosts, and users can access an active host. There can be situations when it is necessary to remove an active host temporarily, for maintenance reasons, for example. Deleting the host in such situations is not desired as it removes the host entry and all the associated configuration permanently. Instead, choose the option of disabling the host.
				</p><p>
					Disabling a host prevents domain users from accessing it without permanently removing it from the domain. This can be done by using the <code class="literal command">host-disable</code> command. Disabling a host kills the host’s current, active keytabs.
				</p><p>
					For example:
				</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
$ <span class="strong strong"><strong>ipa host-disable client.example.com</strong></span></pre><p>
					As a result of disabling a host, the host becomes unavailable to all IdM users, hosts and services.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Disabling a host entry not only disables that host. It disables every configured service on that host as well.
					</p></div></div></section><section class="section" id="proc_reenabling-hosts_managing-hosts-cli"><div class="titlepage"><div><div><h3 class="title">12.9.2. Re-enabling Hosts</h3></div></div></div><p>
					This section describes how to re-enable a disabled IdM host.
				</p><p>
					Disabling a host killed its active keytabs, which removed the host from the IdM domain without otherwise touching its configuration entry.
				</p><p>
					To re-enable a host, use the <code class="literal command">ipa-getkeytab</code> command, adding:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							the <code class="literal option">-s</code> option to specify which IdM server to request the keytab from
						</li><li class="listitem">
							the <code class="literal option">-p</code> option to specify the principal name
						</li><li class="listitem">
							the <code class="literal option">-k</code> option to specify the file to which to save the keytab.
						</li></ul></div><p>
					For example, to request a new host keytab from <code class="literal">server.example.com</code> for <code class="literal">client.example.com</code>, and store the keytab in the <code class="literal">/etc/krb5.keytab</code> file:
				</p><pre class="literallayout">$  <span class="strong strong"><strong>ipa-getkeytab -s server.example.com -p host/client.example.com -k /etc/krb5.keytab -D "cn=directory manager" -w password</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You can also use the administrator’s credentials, specifying <code class="literal">-D "uid=admin,cn=users,cn=accounts,dc=example,dc=com"</code>. It is important that the credentials correspond to a user allowed to create the keytab for the host.
					</p></div></div><p>
					If the <code class="literal command">ipa-getkeytab</code> command is run on an active IdM client or server, then it can be run without any LDAP credentials (<code class="literal option">-D</code> and <code class="literal option">-w</code>) if the user has a TGT obtained using, for example, <code class="literal">kinit admin</code>. To run the command directly on the disabled host, supply LDAP credentials to authenticate to the IdM server.
				</p></section></section></section><section class="chapter" id="adding-hosts-ui_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 13. Adding host entries from IdM Web UI</h1></div></div></div><p>
			This chapter introduces hosts in Identity Management (IdM) and the operation of adding a host entry in the IdM Web UI.
		</p><section class="section" id="hosts_managing-hosts-ui"><div class="titlepage"><div><div><h2 class="title">13.1. Hosts in IdM</h2></div></div></div><p>
				Identity Management (IdM) manages these identities:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users
					</li><li class="listitem">
						Services
					</li><li class="listitem">
						Hosts
					</li></ul></div><p>
				A host represents a machine. As an IdM identity, a host has an entry in the IdM LDAP, that is the 389 Directory Server instance of the IdM server.
			</p><p>
				The host entry in IdM LDAP is used to establish relationships between other hosts and even services within the domain. These relationships are part of <span class="emphasis"><em>delegating</em></span> authorization and control to hosts within the domain. Any host can be used in <code class="literal">host-based access control</code> (HBAC) rules.
			</p><p>
				IdM domain establishes a commonality between machines, with common identity information, common policies, and shared services. Any machine that belongs to a domain functions as a client of the domain, which means it uses the services that the domain provides. IdM domain provides three main services specifically for machines:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						DNS
					</li><li class="listitem">
						Kerberos
					</li><li class="listitem">
						Certificate management
					</li></ul></div><p>
				Hosts in IdM are closely connected with the services running on them:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Service entries are associated with a host.
					</li><li class="listitem">
						A host stores both the host and the service Kerberos principals.
					</li></ul></div></section><section class="section" id="host-enrollment_managing-hosts-ui"><div class="titlepage"><div><div><h2 class="title">13.2. Host enrollment</h2></div></div></div><p>
				This section describes enrolling hosts as IdM clients and what happens during and after the enrollment. The section compares the enrollment of IdM hosts and IdM users. The section also outlines alternative types of authentication available to hosts.
			</p><p>
				Enrolling a host consists of:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Creating a host entry in IdM LDAP: possibly using the <a class="link" href="index%3Flb_target=stage.html#adding-host-entry-cmd_managing-hosts-cli" title="12.5. Adding IdM host entries from IdM CLI"><code class="literal">ipa host-add</code> command</a> in IdM CLI, or the equivalent <a class="link" href="index%3Flb_target=stage.html#adding-host-entry-ui_managing-hosts-ui" title="13.4. Adding Host Entries from the Web UI">IdM Web UI operation</a>.
					</li><li class="listitem">
						Configuring IdM services on the host, for example the System Security Services Daemon (SSSD), Kerberos, and certmonger, and joining the host to the IdM domain.
					</li></ul></div><p>
				The two actions can be performed separately or together.
			</p><p>
				If performed separately, they allow for dividing the two tasks between two users with different levels of privilege. This is useful for bulk deployments.
			</p><p>
				The <code class="literal">ipa-client-install</code> command can perform the two actions together. The command creates a host entry in IdM LDAP if that entry does not exist yet, and configures both the Kerberos and SSSD services for the host. The command brings the host within the IdM domain and allows it to identify the IdM server it will connect with. If the host belongs to a DNS zone managed by IdM, <code class="literal">ipa-client-install</code> adds DNS records for the host too. The command must be run on the client.
			</p><section class="section" id="host-enrollment-privileges_managing-hosts-ui"><div class="titlepage"><div><div><h3 class="title">13.2.1. User privileges required for host enrollment</h3></div></div></div><p>
					The host enrollment operation requires authentication to prevent an unprivileged user from adding unwanted machines to the IdM domain. The privileges required depend on several factors, for example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If a host entry is created separately from running <code class="literal">ipa-client-install</code>
						</li><li class="listitem">
							If a one-time password (OTP) is used for enrollment
						</li></ul></div><h5 id="user_privileges_for_optionally_manually_creating_a_host_entry_in_idm_ldap_2">User privileges for optionally manually creating a host entry in IdM LDAP</h5><p>
					The user privilege required for creating a host entry in IdM LDAP using the <code class="literal">ipa host-add</code> CLI command or the IdM Web UI is <code class="literal">Host Administrators</code>. The <code class="literal">Host Administrators</code> privilege can be obtained through the <code class="literal">IT Specialist</code> role.
				</p><h5 id="user_privileges_for_joining_the_client_to_the_idm_domain_2">User privileges for joining the client to the IdM domain</h5><p>
					Hosts are configured as IdM clients during the execution of the <code class="literal">ipa-client-install</code> command. The level of credentials required for executing the <code class="literal">ipa-client-install</code> command depends on which of the following enrolling scenarios you find yourself in:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The host entry in IdM LDAP does not exist. For this scenario, you need a full administrator’s credentials or the <code class="literal">Host Administrators</code> role. A full administrator is a member of the <code class="literal">admins</code> group. The <code class="literal">Host Administrators</code> role provides privileges to add hosts and enroll hosts. For details about this scenario, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation">Installing a client using user credentials: interactive installation</a>.
						</li><li class="listitem">
							The host entry in IdM LDAP exists. For this scenario, you need a limited administrator’s credentials to execute <code class="literal">ipa-client-install</code> successfully. The limited administrator in this case has the <code class="literal">Enrollment Administrator</code> role, which provides the <code class="literal">Host Enrollment</code> privilege. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation">Installing a client using user credentials: interactive installation</a>.
						</li><li class="listitem">
							The host entry in IdM LDAP exists, and an OTP has been generated for the host by a full or limited administrator. For this scenario, you can install an IdM client as an ordinary user if you run the <code class="literal">ipa-client-install</code> command with the <code class="literal">--password</code> option, supplying the correct OTP. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index?lb_target=stage#installing-client-basic-installing-a-client-by-using-a-one-time-password-interactive-installation">Installing a client by using a one-time password: Interactive installation</a>.
						</li></ul></div><p>
					After enrollment, IdM hosts authenticate every new session to be able to access IdM resources. Machine authentication is required for the IdM server to trust the machine and to accept IdM connections from the client software installed on that machine. After authenticating the client, the IdM server can respond to its requests.
				</p></section><section class="section" id="comparing-hosts-and-users_managing-hosts-ui"><div class="titlepage"><div><div><h3 class="title">13.2.2. Enrollment and authentication of IdM hosts and users: comparison</h3></div></div></div><p>
					There are many similarities between users and hosts in IdM. This section describes some of the similarities that can be observed during the enrollment stage as well as those that concern authentication during the deployment stage.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The enrollment stage (<a class="xref" href="index%3Flb_target=stage.html#user-host-enrollment_managing-hosts-ui" title="Table 13.1. User and host enrollment">Table 13.1, “User and host enrollment”</a>):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									An administrator can create an LDAP entry for both a user and a host before the user or host actually join IdM: for the stage user, the command is <code class="literal">ipa stageuser-add</code>; for the host, the command is <code class="literal">ipa host-add</code>.
								</li><li class="listitem">
									A file containing a <span class="emphasis"><em>key table</em></span> or, abbreviated, keytab, a symmetric key resembling to some extent a user password, is created during the execution of the <code class="literal">ipa-client-install</code> command on the host, resulting in the host joining the IdM realm. Analogically, a user is asked to create a password when they activate their account, thus joining the IdM realm.
								</li><li class="listitem">
									While the user password is the default authentication method for a user, the keytab is the default authentication method for a host. The keytab is stored in a file on the host.
								</li></ul></div><div class="table" id="user-host-enrollment_managing-hosts-ui"><p class="title"><strong>Table 13.1. User and host enrollment</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 38%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406484951216" scope="col">Action</th><th align="left" valign="top" id="idm140406484950128" scope="col">User</th><th align="left" valign="top" id="idm140406484949040" scope="col">Host</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406484951216"> <p>
											Pre-enrollment
										</p>
										 </td><td align="left" valign="top" headers="idm140406484950128"> <p>
											$ <span class="strong strong"><strong>ipa stageuser-add <span class="emphasis"><em>user_name</em></span> [--password]</strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406484949040"> <p>
											$ <span class="strong strong"><strong>ipa host-add <span class="emphasis"><em>host_name</em></span> [--random]</strong></span>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140406484951216"> <p>
											Activating the account
										</p>
										 </td><td align="left" valign="top" headers="idm140406484950128"> <p>
											$ <span class="strong strong"><strong>ipa stageuser-activate <span class="emphasis"><em>user_name</em></span></strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406484949040"> <p>
											$ <span class="strong strong"><strong>ipa-client install [--password]</strong></span> (must be run on the host itself)
										</p>
										 </td></tr></tbody></table></div></div></li><li class="listitem"><p class="simpara">
							The deployment stage (<a class="xref" href="index%3Flb_target=stage.html#user-host-start-session_managing-hosts-ui" title="Table 13.2. User and host session authentication">Table 13.2, “User and host session authentication”</a>):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									When a user starts a new session, the user authenticates using a password; similarly, every time it is switched on, the host authenticates by presenting its keytab file. The System Security Services Daemon (SSSD) manages this process in the background.
								</li><li class="listitem">
									If the authentication is successful, the user or host obtains a Kerberos ticket granting ticket (TGT).
								</li><li class="listitem">
									The TGT is then used to obtain specific tickets for specific services.
								</li></ul></div><div class="table" id="user-host-start-session_managing-hosts-ui"><p class="title"><strong>Table 13.2. User and host session authentication</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 38%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406487288592" scope="col"> </th><th align="left" valign="top" id="idm140406487287664" scope="col">User</th><th align="left" valign="top" id="idm140406487286576" scope="col">Host</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406487288592"> <p>
											Default means of authentication
										</p>
										 </td><td align="left" valign="top" headers="idm140406487287664"> <p>
											<span class="strong strong"><strong>Password</strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406487286576"> <p>
											<span class="strong strong"><strong>Keytabs</strong></span>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140406487288592"> <p>
											Starting a session (ordinary user)
										</p>
										 </td><td align="left" valign="top" headers="idm140406487287664"> <p>
											$ <span class="strong strong"><strong>kinit <span class="emphasis"><em>user_name</em></span></strong></span>
										</p>
										 </td><td align="left" valign="top" headers="idm140406487286576"> <p>
											<span class="emphasis"><em>[switch on the host]</em></span>
										</p>
										 </td></tr><tr><td align="left" valign="top" headers="idm140406487288592"> <p>
											The result of successful authentication
										</p>
										 </td><td align="left" valign="top" headers="idm140406487287664"> <p>
											<span class="strong strong"><strong>TGT</strong></span> to be used to obtain access to specific services
										</p>
										 </td><td align="left" valign="top" headers="idm140406487286576"> <p>
											<span class="strong strong"><strong>TGT</strong></span> to be used to obtain access to specific services
										</p>
										 </td></tr></tbody></table></div></div></li></ul></div><p>
					TGTs and other Kerberos tickets are generated as part of the Kerberos services and policies defined by the server. The initial granting of a Kerberos ticket, the renewing of the Kerberos credentials, and even the destroying of the Kerberos session are all handled automatically by the IdM services.
				</p></section><section class="section" id="alternative-host-authentication_managing-hosts-ui"><div class="titlepage"><div><div><h3 class="title">13.2.3. Alternative authentication options for IdM hosts</h3></div></div></div><p>
					Apart from keytabs, IdM supports two other types of machine authentication:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							SSH keys. The SSH public key for the host is created and uploaded to the host entry. From there, the System Security Services Daemon (SSSD) uses IdM as an identity provider and can work in conjunction with OpenSSH and other services to reference the public keys located centrally in IdM.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Machine certificates. In this case, the machine uses an SSL certificate that is issued by the IdM server’s certificate authority and then stored in IdM’s Directory Server. The certificate is then sent to the machine to present when it authenticates to the server. On the client, certificates are managed by a service called <a class="link" href="index.html#certmonger_certmonger-for-issuing-renewing-service-certs">certmonger</a>.
						</li></ul></div></section></section><section class="section" id="con_host-entry-LDAP_managing-hosts-ui"><div class="titlepage"><div><div><h2 class="title">13.3. Host entry in IdM LDAP</h2></div></div></div><p>
				This section describes what a host entry in Identity Management (IdM) looks like and what attributes it can contain.
			</p><p>
				An LDAP host entry contains all relevant information about the client within IdM:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Service entries associated with the host
					</li><li class="listitem">
						The host and service principal
					</li><li class="listitem">
						Access control rules
					</li><li class="listitem">
						Machine information, such as its physical location and operating system
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Note that the IdM Web UI <code class="literal">Identity</code> → <code class="literal">Hosts</code> tab does not show all the information about a particular host stored in the IdM LDAP.
				</p></div></div><section class="section" id="host-attributes_managing-hosts-ui"><div class="titlepage"><div><div><h3 class="title">13.3.1. Host entry configuration properties</h3></div></div></div><p>
					A host entry can contain information about the host that is outside its system configuration, such as its physical location, MAC address, keys, and certificates.
				</p><p>
					This information can be set when the host entry is created if it is created manually. Alternatively, most of this information can be added to the host entry after the host is enrolled in the domain.
				</p><div class="table" id="tab.host-attr_managing-hosts-ui"><p class="title"><strong>Table 13.3. Host Configuration Properties</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406512814736" scope="col">UI Field</th><th align="left" valign="top" id="idm140406484057136" scope="col">Command-Line Option</th><th align="left" valign="top" id="idm140406484056048" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									Description
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--desc</code>=<span class="emphasis"><em>description</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									A description of the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									Locality
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--locality</code>=<span class="emphasis"><em>locality</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									The geographic location of the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									Location
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--location</code>=<span class="emphasis"><em>location</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									The physical location of the host, such as its data center rack.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									Platform
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--platform</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									The host hardware or architecture.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									Operating system
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--os</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									The operating system and version for the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									MAC address
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--macaddress</code>=<span class="emphasis"><em>address</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									The MAC address for the host. This is a multi-valued attribute. The MAC address is used by the NIS plug-in to create a NIS <code class="literal">ethers</code> map for the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									SSH public keys
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--sshpubkey</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									The full SSH public key for the host. This is a multi-valued attribute, so multiple keys can be set.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									Principal name (not editable)
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--principalname</code>=<span class="emphasis"><em>principal</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									The Kerberos principal name for the host. This defaults to the host name during the client installation, unless a different principal is explicitly set in the <code class="literal option">-p</code>. This can be changed using the command-line tools, but cannot be changed in the UI.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									Set One-Time Password
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--password</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									This option sets a password for the host which can be used in bulk enrollment.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									-
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--random</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									This option generates a random password to be used in bulk enrollment.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									-
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--certificate</code>=<span class="emphasis"><em>string</em></span>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									A certificate blob for the host.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406512814736"> <p>
									-
								</p>
								 </td><td align="left" valign="top" headers="idm140406484057136"> <p>
									<code class="literal option">--updatedns</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140406484056048"> <p>
									This sets whether the host can dynamically update its DNS entries if its IP address changes.
								</p>
								 </td></tr></tbody></table></div></div></section></section><section class="section" id="adding-host-entry-ui_managing-hosts-ui"><div class="titlepage"><div><div><h2 class="title">13.4. Adding Host Entries from the Web UI</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Open the <code class="literal">Identity</code> tab, and select the <code class="literal">Hosts</code> subtab.
					</li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">Add</span> at the top of the hosts list.
					</p><div class="figure" id="hosts-entries"><p class="title"><strong>Figure 13.1. Adding Host Entries</strong></p><div class="figure-contents"><div class="mediaobject"><img src="hosts-list.png" alt="hosts list"/></div></div></div></li><li class="listitem"><p class="simpara">
						Enter the machine name and select the domain from the configured zones in the drop-down list. If the host has already been assigned a static IP address, then include that with the host entry so that the DNS entry is fully created.
					</p><p class="simpara">
						The <code class="literal">Class</code> field has no specific purpose at the moment.
					</p><div class="figure" id="hosts-add"><p class="title"><strong>Figure 13.2. Add Host Wizard</strong></p><div class="figure-contents"><div class="mediaobject"><img src="host-add.png" alt="host add"/></div></div></div><p class="simpara">
						DNS zones can be created in IdM. If the IdM server does not manage the DNS server, the zone can be entered manually in the menu area, like a regular text field.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Select the <code class="literal">Force</code> check box if you want to skip checking whether the host is resolvable via DNS.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Click the <code class="literal">Add and Edit</code> button to go directly to the expanded entry page and enter more attribute information. Information about the host hardware and physical location can be included with the host entry.
					</p><div class="figure" id="hosts-attr1"><p class="title"><strong>Figure 13.3. Expanded Entry Page</strong></p><div class="figure-contents"><div class="mediaobject"><img src="host-attr.png" alt="host attr"/></div></div></div></li></ol></div></section></section><section class="chapter" id="adjusting-id-ranges-manually_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 14. Adjusting ID ranges manually</h1></div></div></div><p>
			An IdM master generates unique user ID (UID) and group ID (GID) numbers. By creating and assigning different ID ranges to replicas, it also ensures that they never generate the same ID numbers. By default, this process is automatic. However, you can manually adjust the IdM ID range during the IdM master installation, or manually define a replica’s DNA ID range.
		</p><section class="section" id="id-ranges_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.1. ID ranges</h2></div></div></div><p>
				ID numbers are divided into <span class="emphasis"><em>ID ranges</em></span>. Keeping separate numeric ranges for individual servers and replicas eliminates the chance that an ID number issued for an entry is already used by another entry on another server or replica.
			</p><p>
				Note that there are two distinct types of ID ranges:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The IdM ID range, which is assigned during the IdM master installation. This range cannot be modified after it is created. However, if you need to, you can create a new IdM ID range in addition to the original one. For more information, see <a class="link" href="index%3Flb_target=stage.html#automatic-id-ranges-assignment_adjusting-id-ranges-manually" title="14.2. Automatic ID ranges assignment">Automatic ID ranges assignment</a> and <a class="link" href="index%3Flb_target=stage.html#adding-a-new-idm-id-range_adjusting-id-ranges-manually" title="14.4. Adding a new IdM ID range">Adding a new IdM ID range</a>.
					</li><li class="listitem"><p class="simpara">
						The Distributed Numeric Assignment (DNA) ID ranges, which can be modified by the user. These have to fit within an existing IdM ID range. For more information, see <a class="link" href="index%3Flb_target=stage.html#adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually" title="14.8. Adjusting DNA ID ranges manually">Adjusting DNA ID ranges manually</a>.
					</p><p class="simpara">
						Replicas can also have a <span class="strong strong"><strong>next</strong></span> DNA ID range assigned. A replica uses its next range when it runs out of IDs in its current range. Next ranges are <a class="link" href="index%3Flb_target=stage.html#automatic-dna-id-range-extension_adjusting-id-ranges-manually" title="14.6. Automatic DNA ID range extension">assigned automatically</a> when a replica is deleted or you can <a class="link" href="index%3Flb_target=stage.html#adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually" title="14.8. Adjusting DNA ID ranges manually">set them manually</a>.
					</p></li></ul></div><p>
				The ranges are updated and shared between the master and replicas by the DNA plug-in, as part of the back end 389 Directory Server instance for the domain.
			</p><p>
				The DNA range definition is set by two attributes: the server’s next available number (the low end of the DNA range) and its maximum value (the top end of the DNA range). The initial bottom range is set during the plug-in instance configuration. After that, the plug-in updates the bottom value. Breaking the available numbers into ranges allows the servers to continually assign numbers without overlapping with each other.
			</p></section><section class="section" id="automatic-id-ranges-assignment_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.2. Automatic ID ranges assignment</h2></div></div></div><p>
				By default, an IdM ID range is automatically assigned during the IdM master installation. The <code class="literal command">ipa-server-install</code> command randomly selects and assigns a range of 200,000 IDs from a total of 10,000 possible ranges. Selecting a random range in this way significantly reduces the probability of conflicting IDs in case you decide to merge two separate IdM domains in the future.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This IdM ID range cannot be modified after it is created. You can only manually adjust the Distributed Numeric Assignment (DNA) ID ranges, using the commands described in <a class="link" href="index%3Flb_target=stage.html#adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually" title="14.8. Adjusting DNA ID ranges manually">Adjusting DNA ID ranges manually</a>. A DNA range matching the IdM ID range is automatically created during installation.
				</p></div></div><p>
				If you have a single IdM server installed, it controls the whole DNA ID range. When you install a new replica and the replica requests its own DNA ID range, the initial ID range for the master splits and is distributed between the master and replica: the replica receives half of the remaining DNA ID range that is available on the initial master. The master and replica then use their respective portions of the original ID range for new user or group entries. Also, if the replica is close to depleting its allocated ID range and fewer than 100 IDs remain, the replica contacts the other available servers to request a new DNA ID range.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					When you install a replica, it <span class="strong strong"><strong>does not</strong></span> immediately receive an ID range. A replica receives an ID range the first time the DNA plug-in is used, for example when you first add a user. Until then, the replica has no ID range defined.
				</p></div></div><p>
				If the initial master stops functioning before the replica requests a DNA ID range from it, the replica is unable to contact the master to request the ID range. Attempting to add a new user on the replica then fails. In such situations, <a class="link" href="index%3Flb_target=stage.html#displaying-currently-assigned-dna-id-ranges_adjusting-id-ranges-manually" title="14.5. Displaying currently assigned DNA ID ranges">you can find out what ID range is assigned to the disabled master</a>, and <a class="link" href="index%3Flb_target=stage.html#adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually" title="14.8. Adjusting DNA ID ranges manually">assign an ID range to the replica manually</a>.
			</p></section><section class="section" id="assigning-the-idm-id-range-manually-during-server-installation_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.3. Assigning the IdM ID range manually during server installation</h2></div></div></div><p>
				You can override the default behavior and set an IdM ID range manually instead of having it assigned randomly.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Do not set ID ranges that include UID values of 1000 and lower; these values are reserved for system use. Also, do not set an ID range that would include the 0 value; the SSSD service does not handle the 0 ID value.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You can define the IdM ID range manually during server installation by using the following two options with <code class="literal command">ipa-server-install</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">--idstart</code> gives the starting value for UID and GID numbers.
							</li><li class="listitem">
								<code class="literal">--idmax</code> gives the maximum UID and GID number; by default, the value is the <code class="literal">--idstart</code> starting value plus 199,999.
							</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To check if the ID range was assigned correctly, you can display the assigned IdM ID range by using the <code class="literal command">ipa idrange-find</code> command:
					</p><pre class="literallayout"># ipa idrange-find
---------------
1 range matched
---------------
  Range name: IDM.EXAMPLE.COM_id_range
  First Posix ID of the range: 882200000
  Number of IDs in the range: 200000
  Range type: local domain range
----------------------------
Number of entries returned 1
----------------------------</pre></li></ul></div></section><section class="section" id="adding-a-new-idm-id-range_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.4. Adding a new IdM ID range</h2></div></div></div><p>
				In some cases, you may want to create a new IdM ID range in addition to the original one; for example, when a replica has run out of IDs and the original IdM ID range is depleted.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Adding a new IdM ID range does not create new DNA ID ranges automatically. You need to assign new DNA ID ranges manually as needed. For more information on how to do this, see <a class="link" href="index%3Flb_target=stage.html#adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually" title="14.8. Adjusting DNA ID ranges manually">Adjusting DNA ID ranges manually</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To create a new IdM ID range, use the <code class="literal command">ipa idrange-add</code> command. You need to specify the new range name, the first ID number of the range and the range size:
					</li></ul></div><pre class="literallayout"># ipa idrange-add IDM.EXAMPLE.COM_new_range --base-id=1000000 --range-size=200000
------------------------------------------
Added ID range "IDM.EXAMPLE.COM_new_range"
------------------------------------------
  Range name: IDM.EXAMPLE.COM_new_range
  First Posix ID of the range: 1000000
  Number of IDs in the range: 200000
  Range type: local domain range</pre><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You can check if the new range is set correctly by using the <code class="literal command">ipa idrange-find</code> command:
					</li></ul></div><pre class="literallayout"># ipa idrange-find
----------------
2 ranges matched
----------------
  Range name: IDM.EXAMPLE.COM_id_range
  First Posix ID of the range: 882200000
  Number of IDs in the range: 200000
  Range type: local domain range

  Range name: IDM.EXAMPLE.COM_new_range
  First Posix ID of the range: 1000000
  Number of IDs in the range: 200000
  Range type: local domain range
----------------------------
Number of entries returned 2
----------------------------</pre></section><section class="section" id="displaying-currently-assigned-dna-id-ranges_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.5. Displaying currently assigned DNA ID ranges</h2></div></div></div><p>
				You can display both the currently active Distributed Numeric Assignment (DNA) ID range on a server, as well as its next DNA range if it has one assigned.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To display which DNA ID ranges are configured for the servers in the topology, use the following commands:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								<code class="literal command">ipa-replica-manage dnarange-show</code> displays the current DNA ID range that is set on all servers or, if you specify a server, only on the specified server, for example:
							</p><pre class="literallayout"># ipa-replica-manage dnarange-show
masterA.example.com: 1001-1500
masterB.example.com: 1501-2000
masterC.example.com: No range set

# ipa-replica-manage dnarange-show masterA.example.com
masterA.example.com: 1001-1500</pre></li><li class="listitem"><p class="simpara">
								<code class="literal command">ipa-replica-manage dnanextrange-show</code> displays the next DNA ID range currently set on all servers or, if you specify a server, only on the specified server, for example:
							</p><pre class="literallayout"># ipa-replica-manage dnanextrange-show
masterA.example.com: 2001-2500
masterB.example.com: No on-deck range set
masterC.example.com: No on-deck range set

# ipa-replica-manage dnanextrange-show masterA.example.com
masterA.example.com: 2001-2500</pre></li></ul></div></li></ul></div></section><section class="section" id="automatic-dna-id-range-extension_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.6. Automatic DNA ID range extension</h2></div></div></div><p>
				When you delete a functioning replica, the <code class="literal command">ipa-replica-manage del</code> command retrieves the DNA ID ranges that were assigned to the replica and adds them as a next range to another available IdM replica. This ensures that DNA ID ranges are used efficiently.
			</p><p>
				After you delete a replica, you can verify which DNA ID ranges are configured for other servers by using the commands described in <a class="link" href="index%3Flb_target=stage.html#displaying-currently-assigned-dna-id-ranges_adjusting-id-ranges-manually" title="14.5. Displaying currently assigned DNA ID ranges">Displaying currently assigned DNA ID ranges</a>.
			</p></section><section class="section" id="manual-dna-id-range-adjustment_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.7. Manual DNA ID range adjustment</h2></div></div></div><p>
				In certain situations, it is necessary to manually adjust a Distributed Numeric Assignment (DNA) ID range, for example when:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						A replica has run out of IDs and the IdM ID range is depleted
					</p><p class="simpara">
						A replica has exhausted the DNA ID range that was assigned to it, and requesting additional IDs failed because no more free IDs are available in the IdM range.
					</p><p class="simpara">
						To solve this situation, extend the DNA ID range assigned to the replica. You can do this in two ways:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Shorten the DNA ID range assigned to a different replica, then assign the newly available values to the depleted replica.
							</li><li class="listitem"><p class="simpara">
								Create a new IdM ID range, then set a new DNA ID range for the replica within this created IdM range.
							</p><p class="simpara">
								For information on how to create a new IdM ID range, see <a class="link" href="index%3Flb_target=stage.html#adding-a-new-idm-id-range_adjusting-id-ranges-manually" title="14.4. Adding a new IdM ID range">Adding a new IdM ID range</a>.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						A replica stopped functioning
					</p><p class="simpara">
						A replica’s DNA ID range is not automatically retrieved when the replica dies and needs to be deleted, which means the DNA ID range previously assigned to the replica becomes unavailable. You want to recover the DNA ID range and make it available for other replicas.
					</p><p class="simpara">
						If you want to recover a DNA ID range belonging to a replica that stopped functioning and assign it to another server, you first need to <a class="link" href="index%3Flb_target=stage.html#displaying-currently-assigned-dna-id-ranges_adjusting-id-ranges-manually" title="14.5. Displaying currently assigned DNA ID ranges">find out what the ID range values are</a>, before manually assigning that range to a different server. Also, to avoid duplicate UIDs or GIDs, make sure that no ID value from the recovered range was previously assigned to a user or group; you can do this by examining the UIDs and GIDs of existing users and groups.
					</p></li></ul></div><p>
				You can manually adjust a DNA ID range for a replica using the commands in <a class="link" href="index%3Flb_target=stage.html#adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually" title="14.8. Adjusting DNA ID ranges manually">Adjusting DNA ID ranges manually</a>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If you assign a new DNA ID range, the UIDs of the already existing entries on the server or replica stay the same. This does not pose a problem because even if you change the current DNA ID range, IdM keeps a record of what ranges were assigned in the past.
				</p></div></div></section><section class="section" id="adjusting-dna-id-ranges-manually_adjusting-id-ranges-manually"><div class="titlepage"><div><div><h2 class="title">14.8. Adjusting DNA ID ranges manually</h2></div></div></div><p>
				In some cases, you may need to manually adjust Distributed Numeric Assignment (DNA) ID ranges for existing replicas, for example to reassign a DNA ID range assigned to a non-functioning replica. For more information, see <a class="link" href="index%3Flb_target=stage.html#manual-dna-id-range-adjustment_adjusting-id-ranges-manually" title="14.7. Manual DNA ID range adjustment">Manual DNA ID range adjustment</a>.
			</p><p>
				When adjusting a DNA ID range manually, make sure that the newly adjusted range is included in the IdM ID range; you can check this using the <code class="literal commmand">ipa idrange-find</code> command. Otherwise, the command will fail.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Be careful not to create overlapping ID ranges. If any of the ID ranges you assign to servers or replicas overlap, it could result in two different servers assigning the same ID value to different entries.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="emphasis"><em>Optional.</em></span> If you are recovering a DNA ID range from a non-functioning replica, first find the ID range using the commands described in <a class="link" href="index%3Flb_target=stage.html#displaying-currently-assigned-dna-id-ranges_adjusting-id-ranges-manually" title="14.5. Displaying currently assigned DNA ID ranges">Displaying currently assigned DNA ID ranges</a>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To define the current DNA ID range for a specified server, use the <code class="literal command">ipa-replica-manage dnarange-set</code>:
					</p><pre class="literallayout"># ipa-replica-manage dnarange-set masterA.example.com 1250-1499</pre></li><li class="listitem"><p class="simpara">
						To define the next DNA ID range for a specified server, use the <code class="literal command">ipa-replica-manage dnanextrange-set</code>:
					</p><pre class="literallayout"># ipa-replica-manage dnanextrange-set masterB.example.com 1500-5000</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You can check that the new DNA ranges are set correctly by using the commands described in <a class="link" href="index%3Flb_target=stage.html#displaying-currently-assigned-dna-id-ranges_adjusting-id-ranges-manually" title="14.5. Displaying currently assigned DNA ID ranges">Displaying the currently assigned DNA ID ranges</a>.
					</li></ul></div></section></section><section class="chapter" id="granting-sudo-access-to-an-IdM-user-on-an-IdM-client_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 15. Granting sudo access to an IdM user on an IdM client</h1></div></div></div><section class="section" id="sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h2 class="title">15.1. Sudo access on an IdM client</h2></div></div></div><p>
				System administrators can grant <code class="literal">sudo</code> access to allow non-root users to execute administrative commands that are normally reserved for the <code class="literal">root</code> user. Consequently, when users need to perform an administrative command normally reserved for the <code class="literal">root</code> user, they precede that command with <code class="literal">sudo</code>. After entering their password, the command is executed as if they were the <code class="literal">root</code> user.
			</p><p>
				If a Red Hat Enterprise Linux (RHEL) 8 host is enrolled as an Identity Management (IdM) client, you can specify <code class="literal">sudo</code> rules defining which IdM users can perform which commands on the host in the following ways:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Locally in the <code class="literal">/etc/sudoers</code> file
					</li><li class="listitem">
						Centrally in IdM
					</li></ul></div><p>
				This chapter describes creating a central <code class="literal">sudo</code> rule for an IdM client using IdM Web UI. For details on creating local sudo rules on a RHEL 8 host, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/managing-users-groups-permissions_configuring-basic-system-settings#managing-sudo-access_managing-users-groups-permissions">Managing sudo access</a>.
			</p><p>
				Note that you can also define central IdM <code class="literal">sudo</code> rules using the IdM command-line interface.
			</p></section><section class="section" id="using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h2 class="title">15.2. Granting sudo access to an IdM user on an IdM client using IdM Web UI</h2></div></div></div><p>
				In Identity Management (IdM), you can grant <code class="literal">sudo</code> access for a specific command to an IdM user account on a specific IdM host. First, add a <code class="literal">sudo</code> command and then create a <code class="literal">sudo</code> rule for one or more commands.
			</p><p>
				Complete this procedure to create the <span class="strong strong"><strong>idm_user_reboot</strong></span> sudo rule to grant <span class="strong strong"><strong>idm_user</strong></span> the permission to run the <code class="literal">/usr/sbin/reboot</code> command on the <span class="strong strong"><strong>idmclient</strong></span> machine.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You have created a user account for <span class="strong strong"><strong>idm_user</strong></span> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the command-line interface, see <a class="link" href="https://doc-stage.usersys.redhat.com/documentation/en-us/red_hat_enterprise_linux/8_test/html-single/configuring_and_managing_identity_management_sub-cas/index?lb_target=stage#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">Adding users using the command line</a>.
					</li><li class="listitem">
						No local <span class="strong strong"><strong>idm_user</strong></span> account has been created on <span class="strong strong"><strong>idmclient</strong></span>. The <span class="strong strong"><strong>idm_user</strong></span> user is not listed in the local <code class="literal">/etc/passwd</code> file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the <code class="literal">/usr/sbin/reboot</code> command to the IdM database of <code class="literal">sudo</code> commands:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Policy</strong></span> → <span class="strong strong"><strong>Sudo</strong></span> → <span class="strong strong"><strong>Sudo Commands</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span> in the upper right corner to open the <span class="strong strong"><strong>Add sudo command</strong></span> dialog box.
							</li><li class="listitem"><p class="simpara">
								Enter the command you want the user to be able to perform using <code class="literal">sudo</code>: <code class="literal">/usr/sbin/reboot</code>.
							</p><div class="figure" id="adding-IdM-sudo-command_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><p class="title"><strong>Figure 15.1. Adding IdM sudo command</strong></p><div class="figure-contents"><div class="mediaobject"><img src="adding-IdM-sudo-command.png" alt="adding IdM sudo command"/></div></div></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span>.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Use the new <code class="literal">sudo</code> command entry to create a sudo rule to allow <span class="strong strong"><strong>idm_user</strong></span> to reboot the <span class="strong strong"><strong>idmclient</strong></span> machine:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Policy</strong></span> → <span class="strong strong"><strong>Sudo</strong></span> → <span class="strong strong"><strong>Sudo rules</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span> in the upper right corner to open the <span class="strong strong"><strong>Add sudo rule</strong></span> dialog box.
							</li><li class="listitem">
								Enter the name of the <code class="literal">sudo</code> rule: <span class="strong strong"><strong>idm_user_reboot</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add and Edit</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Specify the user:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Who</strong></span> section, check the <span class="strong strong"><strong>Specified Users and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>User category the rule applies to</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add users into sudo rule "idm_user_reboot"</strong></span> dialog box.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Add users into sudo rule "idm_user_reboot"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <span class="strong strong"><strong>idm_user</strong></span> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Specify the host:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Access this host</strong></span> section, check the <span class="strong strong"><strong>Specified Hosts and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Host category this rule applies to</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add hosts into sudo rule "idm_user_reboot"</strong></span> dialog box.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Add hosts into sudo rule "idm_user_reboot"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <span class="strong strong"><strong>idmclient.idm.example.com</strong></span> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li></ol></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Specify the commands:
									</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
												In the <span class="strong strong"><strong>Command category the rule applies to</strong></span> subsection of the <span class="strong strong"><strong>Run Commands</strong></span> section, check the <span class="strong strong"><strong>Specified Commands and Groups</strong></span> radio button.
											</li><li class="listitem">
												In the <span class="strong strong"><strong>Sudo Allow Commands</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add allow sudo commands into sudo rule "idm_user_reboot"</strong></span> dialog box.
											</li><li class="listitem">
												In the <span class="strong strong"><strong>Add allow sudo commands into sudo rule "idm_user_reboot"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <code class="literal">/usr/sbin/reboot</code> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
											</li><li class="listitem"><p class="simpara">
												Click <span class="strong strong"><strong>Add</strong></span> to return to the <span class="strong strong"><strong>idm_sudo_reboot</strong></span> page.
											</p><div class="figure" id="adding-IdM-sudo-rule_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><p class="title"><strong>Figure 15.2. Adding IdM sudo rule</strong></p><div class="figure-contents"><div class="mediaobject"><img src="IdM-sudo-rule-WebUI.png" alt="IdM sudo rule WebUI"/></div></div></div></li></ol></div></li></ol></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span> in the top left corner.
							</li></ol></div></li></ol></div><p>
				The new rule is enabled by default.
			</p><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					Test that the sudo rule that you have set up on the IdM server works on <span class="strong strong"><strong>idmclient</strong></span> by verifying that <span class="strong strong"><strong>idm_user</strong></span> can now reboot <span class="strong strong"><strong>idmclient</strong></span> using <code class="literal">sudo</code>. Note that propagating the changes from the server to the client can take a few minutes.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Log in to <span class="strong strong"><strong>idmclient</strong></span> as <span class="strong strong"><strong>idm_user</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Reboot the machine using <code class="literal">sudo</code>. Enter the password for <span class="strong strong"><strong>idm_user</strong></span> when prompted:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>sudo /usr/sbin/reboot</strong></span>
[sudo] password for idm_user:</pre></li></ol></div><p>
				If sudo is configured correctly, the machine reboots.
			</p></section></section><section class="chapter" id="cert-intro_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 16. Public key certificates in Identity Management</h1></div></div></div><p>
			This chapter introduces X.509 public key certificates, which are used to authenticate users, hosts and services in Identity Management (IdM). In addition to authentication, X.509 certificates also enable digital signing and encryption to provide privacy, integrity and non-repudiation.
		</p><p>
			A certificate contains information about
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					the subject that the certificate authenticates
				</li><li class="listitem">
					who has signed (validated) the certificate, that is the issuer
				</li><li class="listitem">
					the start and end of the validity of the certificate
				</li><li class="listitem">
					the valid uses of the certificate
				</li><li class="listitem">
					the public key of the subject
				</li></ul></div><p>
			A message encrypted by the public key can only be decrypted by a corresponding private key. Although a certificate and the public key it includes can be made freely available, a user, host or machine must keep their private key secret.
		</p><p>
			<span id="con-cert-authority-idm_cert-intro"><!--Empty--></span>
		</p><section class="section" id="certificate_authorities_in_idm"><div class="titlepage"><div><div><h2 class="title">16.1. Certificate authorities in IdM</h2></div></div></div><p>
				Certificate authorities operate in a hierarchy of trust. In an IdM environment with an internal Certificate Authority (CA), all the IdM hosts, users and services trust certificates that have been signed by the CA. Apart from this root CA, IdM supports sub-CAs to which the root CA has granted the ability to sign certificates in their turn. Frequently, the certificates that such sub-CAs are able to sign are certificates of a specific kind, for example VPN certificates.
			</p><p>
				From the certificate point of view, there is no difference between being signed by a self-signed IdM CA and being signed externally.
			</p><p>
				The role of the CA is the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						It issues and verifies digital certificates
					</li><li class="listitem">
						It signs the certificate to prove that the certificate belongs to the user, host or service that presents it
					</li><li class="listitem">
						In an IdM environment with an internal CA, the CA which is the Certificate Renewal Master and which maintains the Certificate Revocation List (CRL) is the highest authority
					</li></ul></div><p>
				<span id="compare-certs-kerberos_cert-intro"><!--Empty--></span>
			</p></section><section class="section" id="comparison_of_certificates_and_kerberos"><div class="titlepage"><div><div><h2 class="title">16.2. Comparison of certificates and Kerberos</h2></div></div></div><p>
				Certificates perform a similar function to that performed by Kerberos tickets. Kerberos is a computer network authentication protocol that works on the basis of tickets to allow nodes communicating over a non-secure network to prove their identity to one another in a secure manner. The following table shows a comparison of Kerberos and X.509 certificates:
			</p><div class="table" id="tab-compare-cert-kerberos_cert-intro"><p class="title"><strong>Table 16.1. Comparison of certificates and Kerberos</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><tbody><tr><td align="left" valign="top"> <p>
								<span class="strong strong"><strong>Characteristic</strong></span>
							</p>
							 </td><td align="left" valign="top"> <p>
								<span class="strong strong"><strong>Kerberos</strong></span>
							</p>
							 </td><td align="left" valign="top"> <p>
								<span class="strong strong"><strong>X.509</strong></span>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Authentication</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Privacy</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Optional
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Integrity</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Optional
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Type of cryptography involved</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Symmetrical
							</p>
							 </td><td align="left" valign="top"> <p>
								Asymmetrical
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Default validity</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Short (1 day)
							</p>
							 </td><td align="left" valign="top"> <p>
								Long(2 years)
							</p>
							 </td></tr></tbody></table></div></div><p>
				By default, Kerberos in Identity Management only ensures the identity of the communicating parties.
			</p><p>
				<span id="using-certs-to-authenticate-users_cert-intro"><!--Empty--></span>
			</p></section><section class="section" id="the_pros_and_cons_of_using_certificates_to_authenticate_users_in_idm"><div class="titlepage"><div><div><h2 class="title">16.3. The pros and cons of using certificates to authenticate users in IdM</h2></div></div></div><p>
				The advantages of using certificates to authenticate users in IdM include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A PIN that protects the private key on a smart card is typically less complex and easier to remember than a regular password.
					</li><li class="listitem">
						Depending on the device, a private key stored on a smart card cannot be exported. This provides additional security.
					</li><li class="listitem">
						Smart cards can make logout automatic: IdM can be configured to log out users when they remove the smart card from the reader.
					</li><li class="listitem">
						Stealing the private key requires actual physical access to a smart card, making smart cards secure against hacking attacks.
					</li><li class="listitem">
						Smart card authentication is two-factor authentication: it requires both something you have (the card) and something you know (the PIN).
					</li><li class="listitem">
						Smart cards are more flexible than passwords because they provide the keys that can be used for other purposes, such as encrypting email.
					</li><li class="listitem">
						Using smart cards use on shared machines that are IdM clients does not typically pose additional configuration problems for system administrators. In fact, smart card authentication is an ideal choice for shared machines.
					</li></ul></div><p>
				The disadvantages of using certificates to authenticate users in IdM include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users might lose or forget to bring their smart card or certificate and be effectively locked out.
					</li><li class="listitem">
						Mistyping a PIN multiple times might result in a card becoming locked.
					</li><li class="listitem">
						There is generally an intermediate step between request and authorization by some sort of security officer or approver. In IdM, the security officer or administrator must run the <span class="strong strong"><strong>ipa cert-request</strong></span> command.
					</li><li class="listitem">
						Smart cards and readers tend to be vendor and driver specific: although a lot of readers can be used for different cards, a smart card of a specific vendor might not work in the reader of another vendor or in the type of a reader for which it was not designed.
					</li><li class="listitem">
						The learning curve to certificates and smart cards might seem daunting to admininstrators with no experience in the area.
					</li></ul></div></section></section><section class="chapter" id="convert-cert-formats-idm_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 17. Converting certificate formats to work with IdM</h1></div></div></div><p>
			This user story describes how to make sure that you as an IdM system administrator are using the correct format of a certificate with specific IdM commands. This is useful, for example, in the following situations:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					You are loading an external certificate into a user profile. For details, see <a class="xref" href="index%3Flb_target=stage.html#convert-cert-to-load-to-user-profile-idm_convert-cert-formats-idm" title="17.2. Converting an external certificate to load into an IdM user account">Section 17.2, “Converting an external certificate to load into an IdM user account”</a>.
				</li><li class="listitem">
					You are using an external CA certificate when <a class="link" href="index%3Flb_target=stage.html#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth" title="19.1. Configuring the IdM server for smart card authentication">configuring the IdM server for smart card authentication</a> or <a class="link" href="index%3Flb_target=stage.html#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth" title="19.2. Configuring the IdM client for smart card authentication">configuring the IdM client for smart card authentication</a> so that users can authenticate to IdM using smart cards with certificates on them that have been issued by the external certificate authority.
				</li><li class="listitem">
					You are exporting a certificate from an NSS database into a pkcs #12 format that includes both the certificate and the private key. For details, see <a class="xref" href="index%3Flb_target=stage.html#export-cert-from-nss-to-pkcs12_convert-cert-formats-idm" title="17.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file">Section 17.3.1, “Exporting a certificate and private key from an NSS database into a PKCS #12 file”</a>.
				</li></ul></div><section class="section" id="cert-types-idm_convert-cert-formats-idm"><div class="titlepage"><div><div><h2 class="title">17.1. Certificate formats and encodings in IdM</h2></div></div></div><p>
				Certificate authentication including smart card authentication in IdM proceeds by comparing the certificate that the user presents with the certificate, or certificate data, that are stored in the user’s IdM profile.
			</p><h4 id="system_configuration">System configuration</h4><p>
				What is stored in the IdM profile is only the certificate, not the corresponding private key. During authentication, the user must also show that he is in possession of the corresponding private key. The user does that by either presenting a PKCS #12 file that contains both the certificate and the private key or by presenting two files: one that contains the certificate and the other containing the private key.
			</p><p>
				Therefore, processes such as loading a certificate into a user profile only accept certificate files that do not contain the private key.
			</p><p>
				Similarly, when a system administrator provides you with an external CA certificate, he will provide only the public data: the certificate without the private key. The <code class="literal">ipa-advise</code> utility for configuring the IdM server or the IdM client for smart card authentication expects the input file to contain the certificate of the external CA but not the private key.
			</p><h4 id="certificate_encodings">Certificate encodings</h4><p>
				There are two common certificate encodings: Privacy-enhanced Electronic Mail (<code class="literal">PEM</code>) and Distinguished Encoding Rules (<code class="literal">DER</code>). The <code class="literal">base64</code> format is almost identical to the <code class="literal">PEM</code> format but it does not contain the <code class="literal">-----BEGIN CERTIFICATE-----/-----END CERTIFICATE-----</code> header and footer.
			</p><p>
				A certificate that has been encoded using <code class="literal">DER</code> is a binary X509 digital certificate file. As a binary file, the certificate is not human-readable. <code class="literal">DER</code> files sometimes use the <code class="literal">.der</code> filename extension, but files with the <code class="literal">.crt</code> and <code class="literal">.cer</code> filename extensions also sometimes contain <code class="literal">DER</code> certificates. <code class="literal">DER</code> files containing keys can be named <code class="literal">.key</code>.
			</p><p>
				A certificate that has been encoded using <code class="literal">PEM</code> Base64 is a human-readable file. The file contains ASCII (Base64) armored data prefixed with a “-----BEGIN …” line. <code class="literal">PEM</code> files sometimes use the <code class="literal">.pem</code> filename extension, but files with the <code class="literal">.crt</code> and <code class="literal">.cer</code> filename extensions also sometimes contain <code class="literal">PEM</code> certificates. <code class="literal">PEM</code> files containing keys can be named <code class="literal">.key</code>.
			</p><p>
				Different <code class="literal">ipa</code> commands have different limitations regarding the types of certificates that they accept. For example, the <code class="literal">ipa user-add-cert</code> command only accepts certificates encoded in the <code class="literal">base64</code> format but <code class="literal">ipa-server-certinstall</code> accepts <code class="literal">PEM, DER, PKCS #7, PKCS #8</code> and <code class="literal">PKCS #12</code> certificates.
			</p><div class="table" id="tab.cert-encodings_convert-cert-formats-idm"><p class="title"><strong>Table 17.1. Certificate encodings</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 25%; " class="col_3"><!--Empty--></col><col style="width: 25%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406476779008" scope="col">Encoding format</th><th align="left" valign="top" id="idm140406476777920" scope="col">Human-readable</th><th align="left" valign="top" id="idm140406476776832" scope="col">Common filename extensions</th><th align="left" valign="top" id="idm140406476775728" scope="col">Sample IdM commands accepting the encoding format</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406476779008"> <p>
								PEM/base64
							</p>
							 </td><td align="left" valign="top" headers="idm140406476777920"> <p>
								Yes
							</p>
							 </td><td align="left" valign="top" headers="idm140406476776832"> <p>
								.pem, .crt, .cer
							</p>
							 </td><td align="left" valign="top" headers="idm140406476775728"> <p>
								ipa user-add-cert, ipa-server-certinstall, …​
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406476779008"> <p>
								DER
							</p>
							 </td><td align="left" valign="top" headers="idm140406476777920"> <p>
								No
							</p>
							 </td><td align="left" valign="top" headers="idm140406476776832"> <p>
								.der, .crt, .cer
							</p>
							 </td><td align="left" valign="top" headers="idm140406476775728"> <p>
								ipa-server-certinstall, …​
							</p>
							 </td></tr></tbody></table></div></div><p>
				<a class="xref" href="index%3Flb_target=stage.html#other-cert-commands_convert-cert-formats-idm" title="17.4. Certificate-related commands and formats in IdM">Section 17.4, “Certificate-related commands and formats in IdM”</a> lists further <code class="literal">ipa</code> commands with the certificate formats that the commands accept.
			</p><h4 id="user_authentication">User authentication</h4><p>
				When using the web UI to access IdM, the user proves that he is in possession of the private key corresponding to the certificate by having both stored in the browser’s database.
			</p><p>
				When using the CLI to access IdM, the user proves that he is in possession of the private key corresponding to the certificate by one of the following methods:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The user adds, as the value of the <code class="literal">X509_user_identity</code> parameter of the <code class="literal">kinit -X</code> command, the path to the smart card module that is connected to the smart card that contains both the certificate and the key:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit -X X509_user_identity='PKCS11:opensc-pkcs11.so' <code class="literal">idm_user</code></strong></span></pre></li><li class="listitem"><p class="simpara">
						The user adds two files as the values of the <code class="literal">X509_user_identity</code> parameter of the <code class="literal">kinit -X</code> command, one containing the certificate and the other the private key:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit -X X509_user_identity='FILE:`/path/to/cert.pem,/path/to/cert.key`' <code class="literal">idm_user</code></strong></span></pre></li></ul></div><h4 id="useful_certificate_commands">Useful certificate commands</h4><p>
				To view the certificate data, such as the subject and the issuer:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl x509 -noout -text -in ca.pem</strong></span></pre><p>
				To compare in which lines two certificates differ:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>diff cert1.crt cert2.crt</strong></span></pre><p>
				To compare in which lines two certificates differ with the output displayed in two columns:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>diff cert1.crt cert2.crt -y</strong></span></pre></section><section class="section" id="convert-cert-to-load-to-user-profile-idm_convert-cert-formats-idm"><div class="titlepage"><div><div><h2 class="title">17.2. Converting an external certificate to load into an IdM user account</h2></div></div></div><p>
				This section describes how to make sure that an external certificate is correctly encoded and formatted before adding it to a user entry.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						If your certificate was issued by an Active Directory certificate authority and uses the <code class="literal">PEM</code> encoding, make sure that the <code class="literal">PEM</code> file has been converted into the <code class="literal">UNIX</code> format. To convert a file, use the <code class="literal">dos2unix</code> utility provided by the eponymous package.
					</li></ul></div><section class="section" id="convert-cert-to-load-to-user-profile-idm-cli"><div class="titlepage"><div><div><h3 class="title">17.2.1. Converting an external certificate in the IdM CLI and loading it into an IdM user account</h3></div></div></div><p>
					The <code class="literal">IdM CLI</code> only accepts a <code class="literal">PEM</code> certificate from which the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) have been removed.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Convert the certificate to the <code class="literal">PEM</code> format:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If your certificate is in the <code class="literal">DER</code> format:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl x509 -in cert.crt -inform der -outform pem -out cert.pem</strong></span></pre></li><li class="listitem"><p class="simpara">
									If your file is in the <code class="literal">PKCS #12</code> format, whose common filename extensions are <code class="literal">.pfx</code> and <code class="literal">.p12</code>, and contains a certificate, a private key, and possibly other data, extract the certificate using the <code class="literal">openssl pkcs12</code> utility. When prompted, enter the password protecting the private key stored in the file:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl pkcs12 -in cert_and_key.p12 -clcerts -nokeys -out cert.pem</strong></span>
Enter Import Password:</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Add the certificate to the user account using the <code class="literal">IdM CLI</code> following one of the following methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Remove the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) of the <code class="literal">PEM</code> file using the <code class="literal">sed</code> utility before adding the string to the <code class="literal">ipa user-add-cert</code> command:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert some_user --certificate="$(sed -e '/BEGIN CERTIFICATE/d;/END CERTIFICATE/d' cert.pem)"</strong></span></pre></li><li class="listitem"><p class="simpara">
									Copy and paste the contents of the certificate file without the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) into the <code class="literal">ipa user-add-cert</code> command:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert some_user --certificate=MIIDlzCCAn+gAwIBAgIBATANBgkqhki...</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										You cannot pass a <code class="literal">PEM</code> file containing the certificate as input to the <code class="literal">ipa user-add-cert</code> command directly, without first removing the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----):
									</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert some_user --cert=some_user_cert.pem</strong></span></pre><p>
										This command results in the "ipa: ERROR: Base64 decoding failed: Incorrect padding" error message.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Optionally, to check if the certificate was accepted by the system:
						</p><pre class="literallayout">[idm_user@r8server]$ <span class="strong strong"><strong>ipa user-show some_user</strong></span></pre></li></ol></div></section><section class="section" id="convert-cert-to-load-to-user-profile-idm-webui"><div class="titlepage"><div><div><h3 class="title">17.2.2. Converting an external certificate in the IdM web UI for loading into an IdM user account:</h3></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Using the <code class="literal">CLI</code>, convert the certificate to the <code class="literal">PEM</code> format:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If your certificate is in the <code class="literal">DER</code> format:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl x509 -in cert.crt -inform der -outform pem -out cert.pem</strong></span></pre></li><li class="listitem"><p class="simpara">
									If your file is in the <code class="literal">PKCS #12</code> format, whose common filename extensions are <code class="literal">.pfx</code> and <code class="literal">.p12</code>, and contains a certificate, a private key, and possibly other data, extract the certificate using the <code class="literal">openssl pkcs12</code> utility. When prompted, enter the password protecting the private key stored in the file:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl pkcs12 -in cert_and_key.p12 -clcerts -nokeys -out cert.pem</strong></span>
Enter Import Password:</pre></li></ul></div></li><li class="listitem">
							Open the certificate in an editor and copy the contents. You can include the "-----BEGIN CERTIFICATE-----" and "-----END CERTIFICATE-----" header and footer lines but you do not have to, as both the <code class="literal">PEM</code> and <code class="literal">base64</code> formats are accepted by the IdM web UI.
						</li><li class="listitem">
							In the IdM web UI, log in as security officer.
						</li><li class="listitem">
							Go to <code class="literal">Identity</code> → <code class="literal">Users</code> → <code class="literal">some_user</code>.
						</li><li class="listitem">
							Click <code class="literal">Add</code> next to <code class="literal">Certificates</code>.
						</li><li class="listitem">
							Paste the PEM-formatted contents of the certificate into the window that opens.
						</li><li class="listitem">
							Click <code class="literal">Add</code>.
						</li></ol></div><p>
					If the certificate was accepted by the system, you can see it listed among the <code class="literal">Certificates</code> in the user profile.
				</p></section></section><section class="section" id="prepare-load-cert-into-browser-idm_convert-cert-formats-idm"><div class="titlepage"><div><div><h2 class="title">17.3. Preparing to load a certificate into the browser</h2></div></div></div><p>
				Before importing a user certificate into the browser, make sure that the certificate and the corresponding private key are in a <code class="literal">PKCS #12</code> format. There are two common situations requiring extra preparatory work:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The certificate is located in an NSS database. For details how to proceed in this situation, see <a class="xref" href="index%3Flb_target=stage.html#export-cert-from-nss-to-pkcs12_convert-cert-formats-idm" title="17.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file">Section 17.3.1, “Exporting a certificate and private key from an NSS database into a PKCS #12 file”</a>.
					</li><li class="listitem">
						The certificate and the private key are in two separate <code class="literal">PEM</code> files. For details how to proceed in this situation, see <a class="xref" href="index%3Flb_target=stage.html#combine-cert-private-key-to-pkcs12_convert-cert-formats-idm" title="17.3.2. Combining certificate and private key PEM files into a PKCS #12 file">Section 17.3.2, “Combining certificate and private key PEM files into a PKCS #12 file”</a>.
					</li></ul></div><p>
				Afterwards, to import both the CA certificate in the <code class="literal">PEM</code> format and the user certificate in the <code class="literal">PKCS #12</code> format into the browser, follow the procedures in <a class="xref" href="index%3Flb_target=stage.html#configuring-browser-for-cert-auth_dc-web-ui-auth" title="22.4. Configuring a browser to enable certificate authentication">Section 22.4, “Configuring a browser to enable certificate authentication”</a> and <a class="xref" href="index%3Flb_target=stage.html#authenticating_to_the_identity_management_web_ui_with_a_certificate_as_an_identity_management_user" title="22.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User">Section 22.5, “Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User”</a>.
			</p><section class="section" id="export-cert-from-nss-to-pkcs12_convert-cert-formats-idm"><div class="titlepage"><div><div><h3 class="title">17.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file</h3></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the <code class="literal command">pk12util</code> command to export the certificate from the NSS database to the <code class="literal">PKCS12</code> format. For example, to export the certificate with the <code class="literal replaceable">some_user</code> nickname from the NSS database stored in the <code class="literal filename">~/certdb</code> directory into the <code class="literal replaceable">~/some_user.p12</code> file:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>pk12util -d <code class="literal filename">~/certdb</code> -o <code class="literal replaceable">~/some_user.p12</code> -n some_user</strong></span>
Enter Password or Pin for "NSS Certificate DB":
Enter password for PKCS12 file:
Re-enter password:
pk12util: PKCS12 EXPORT SUCCESSFUL</pre></li><li class="listitem"><p class="simpara">
							Set appropriate permissions for the <code class="literal">.p12</code> file:
						</p><pre class="literallayout"># <span class="strong strong"><strong>chmod 600 ~/some_user.p12</strong></span></pre><p class="simpara">
							Because the <code class="literal">PKCS #12</code> file also contains the private key, it must be protected to prevent other users from using the file. Otherwise, they would be able to impersonate the user.
						</p></li></ol></div></section><section class="section" id="combine-cert-private-key-to-pkcs12_convert-cert-formats-idm"><div class="titlepage"><div><div><h3 class="title">17.3.2. Combining certificate and private key PEM files into a PKCS #12 file</h3></div></div></div><p>
					This section describes how to combine a certificate and the corresponding key stored in separate <code class="literal">PEM</code> files into a <code class="literal">PKCS #12</code> file.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To combine a certificate stored in <code class="literal">certfile.cer</code> and a key stored in <code class="literal">certfile.key</code> into a <code class="literal">certfile.p12</code> file that contains both the certificate and the key:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl pkcs12 -export -in certfile.cer -inkey certfile.key -out certfile.p12</strong></span></pre></li></ul></div></section></section><section class="section" id="other-cert-commands_convert-cert-formats-idm"><div class="titlepage"><div><div><h2 class="title">17.4. Certificate-related commands and formats in IdM</h2></div></div></div><p>
				Table <a class="link" href="index%3Flb_target=stage.html#tab.cert-commands-formats_convert-cert-formats-idm" title="Table 17.2. IdM certificate commands and formats">IdM certificate commands and formats</a> displays certificate-related commands in IdM with acceptable formats.
			</p><div class="table" id="tab.cert-commands-formats_convert-cert-formats-idm"><p class="title"><strong>Table 17.2. IdM certificate commands and formats</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406473584880" scope="col">Command</th><th align="left" valign="top" id="idm140406473583792" scope="col">Acceptable formats</th><th align="left" valign="top" id="idm140406473582704" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa user-add-cert some_user --certificate</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								base64 PEM certificate
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa-server-certinstall</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								PEM and DER certificate; PKCS#7 certificate chain; PKCS#8 and raw private key; PKCS#12 certificate and private key
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa-cacert-manage install</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								DER; PEM; PKCS#7
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa-cacert-manage renew --external-cert-file</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								PEM and DER certificate; PKCS#7 certificate chain
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa-ca-install --external-cert-file</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								PEM and DER certificate; PKCS#7 certificate chain
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa cert-show &lt;cert serial&gt; --certificate-out /path/to/file.pem</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> <p>
								Creates the PEM-encoded <code class="literal">file.pem</code> file with the certificate having the <code class="literal">&lt;cert_serial&gt;</code> serial number.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa cert-show &lt;cert serial&gt; --certificate-out /path/to/file.pem</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> <p>
								Creates the PEM-encoded <code class="literal">file.pem</code> file with the certificate having the <code class="literal">&lt;cert_serial&gt;</code> serial number. If the <code class="literal">--chain</code> option is used, the PEM file contains the certificate including the certificate chain.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa cert-request --certificate-out=FILE /path/to/req.csr</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> <p>
								Creates the <code class="literal">req.csr</code> file in the PEM format with the new certificate.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406473584880"> <p>
								<code class="literal">ipa cert-request --certificate-out=FILE /path/to/req.csr</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406473583792"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140406473582704"> <p>
								Creates the <code class="literal">req.csr</code> file in the PEM format with the new certificate. If the <code class="literal">--chain</code> option is used, the PEM file contains the certificate including the certificate chain.
							</p>
							 </td></tr></tbody></table></div></div></section></section><section class="chapter" id="managing-the-validity-of-certificates-in-idm_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 18. Managing the validity of certificates in IdM</h1></div></div></div><p>
			In Identity Management (IdM), you can manage the validity of both already existing certificates and certificates you want to issue in the future, but the methods are different.
		</p><h3 id="managing_the_validity_of_an_existing_certificate_that_was_issued_by_idm_ca">Managing the validity of an existing certificate that was issued by IdM CA</h3><p>
			In IdM, the following methods of viewing the expiry date of a certificate are available:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_validity-certificates" title="18.1.1. Viewing the expiry date of a certificate in IdM WebUI">Viewing the expiry date in IdM WebUI</a>;
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#viewing-the-expiry-date-of-a-certificate-in-the-CLI_validity-certificates" title="18.1.2. Viewing the expiry date of a certificate in the CLI">Viewing the expiry date in the CLI</a>.
				</li></ul></div><p>
			You can manage the validity of an already existing certificate that was issued by IdM CA in the following ways:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Renew a certificate by requesting a new certificate using either the original certificate signing request (CSR) or a new CSR generated from the private key. You can request a new certificate using the following utilities:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">certmonger</span></dt><dd>
								You can use <code class="literal">certmonger</code> to request a service certificate. Before the certificate is due to expire, <code class="literal">certmonger</code> will automatically renew the certificate, thereby ensuring a continuing validity of the service certificate. For details, see <a class="link" href="index.html#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs">Obtaining an IdM certificate for a service using certmonger</a>;
							</dd><dt><span class="term">certutil</span></dt><dd>
								You can use <code class="literal">certutil</code> to renew user, host, and service certificates. For details on requesting a user certificate, see <a class="link" href="index.html#requesting-and-exporting-a-user-certificate_dc-web-ui-auth">Requesting a new user certificate and exporting it to the client</a>;
							</dd><dt><span class="term">openssl</span></dt><dd>
								You can use <code class="literal">openssl</code> to renew user, host, and service certificates.
							</dd></dl></div></li><li class="listitem"><p class="simpara">
					Revoke a certificate. For details, see:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="index%3Flb_target=stage.html#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates" title="18.2.2. Revoking certificates with the integrated IdM CAs using IdM WebUI">Revoking certificates with the integrated IdM CAs using IdM WebUI</a>;
						</li><li class="listitem">
							<a class="link" href="index%3Flb_target=stage.html#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates" title="18.2.3. Revoking certificates with the integrated IdM CAs using IdM CLI">Revoking certificates with the integrated IdM CAs using IdM CLI</a>;
						</li></ul></div></li><li class="listitem"><p class="simpara">
					Restore a certificate if it has been temporarily revoked. For details, see:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="index%3Flb_target=stage.html#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" title="18.3.1. Restoring certificates with the integrated IdM CAs using IdM WebUI">Restoring certificates with the integrated IdM CAs using IdM WebUI</a>;
						</li><li class="listitem">
							<a class="link" href="index%3Flb_target=stage.html#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" title="18.3.1. Restoring certificates with the integrated IdM CAs using IdM WebUI">Restoring certificates with the integrated IdM CAs using IdM CLI</a>.
						</li></ul></div></li></ul></div><h3 id="managing_the_validity_of_future_certificates_issued_by_idm_ca">Managing the validity of future certificates issued by IdM CA</h3><p>
			To manage the validity of future certificates issued by IdM CA, modify, import, or create a certificate profile. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/linux_domain_identity_authentication_and_policy_guide/index#certificate-profiles">Certificate profiles</a> in RHEL 7 documentation.
		</p><section class="section" id="viewing-the-expiry-date-of-a-certificate_validity-certificates"><div class="titlepage"><div><div><h2 class="title">18.1. Viewing the expiry date of a certificate</h2></div></div></div><section class="section" id="viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_validity-certificates"><div class="titlepage"><div><div><h3 class="title">18.1.1. Viewing the expiry date of a certificate in IdM WebUI</h3></div></div></div><p>
					You can use IdM WebUI to view the expiry date of all the certificates that have been issued by IdM CA.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that you have obtained the administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <code class="literal">Authentication</code> menu, click <code class="literal">Certificates</code> &gt; <code class="literal">Certificates</code>.
						</li><li class="listitem"><p class="simpara">
							Click the serial number of the certificate to open the certificate information page.
						</p><div class="figure" id="list-of-certificates_validity-certificates"><p class="title"><strong>Figure 18.1. List of Certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="host_cert_list.png" alt="host cert list"/></div></div></div></li><li class="listitem">
							In the certificate information page, locate the <code class="literal">Expires On</code> information.
						</li></ol></div></section><section class="section" id="viewing-the-expiry-date-of-a-certificate-in-the-CLI_validity-certificates"><div class="titlepage"><div><div><h3 class="title">18.1.2. Viewing the expiry date of a certificate in the CLI</h3></div></div></div><p>
					You can use the command-line interface (CLI) to view the expiry date of a certificate.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the <code class="literal">openssl</code> utility to open the file in a human-readable format:
						</p><pre class="literallayout">$ openssl x509 -noout -text -in ca.pem
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1 (0x1)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: O = IDM.EXAMPLE.COM, CN = Certificate Authority
        Validity
            Not Before: Oct 30 19:39:14 2017 GMT
            Not After : Oct 30 19:39:14 2037 GMT</pre></li></ul></div></section></section><section class="section" id="revoking-certificates-with-the-integrated-IdM-CAs_validity-certificates"><div class="titlepage"><div><div><h2 class="title">18.2. Revoking certificates with the integrated IdM CAs</h2></div></div></div><section class="section" id="certificate-revocation-reasons_revoking-certificates"><div class="titlepage"><div><div><h3 class="title">18.2.1. Certificate revocation reasons</h3></div></div></div><p>
					A revoked certificate is invalid and cannot be used for authentication. All revocations are permanent, except for reason 6: <code class="literal">Certificate Hold</code>.
				</p><p>
					The default revocation reason is 0: <code class="literal">unspecified</code>.
				</p><div class="table" id="tab.revoke-reasons_revoking-certificates"><p class="title"><strong>Table 18.1. Revocation Reasons</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 8%; " class="col_1"><!--Empty--></col><col style="width: 31%; " class="col_2"><!--Empty--></col><col style="width: 61%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406474680528" scope="col">ID</th><th align="left" valign="top" id="idm140406474679440" scope="col">Reason</th><th align="left" valign="top" id="idm140406474395744" scope="col">Explanation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									0
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Unspecified
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									1
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Key Compromised
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									The key that issued the certificate is no longer trusted.
								</p>
								 <p>
									Possible causes: lost token, improperly accessed file.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									2
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									CA Compromised
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									The CA that issued the certificate is no longer trusted.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									3
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Affiliation Changed
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									Possible causes:
								</p>
								 <p>
									* A person has left the company or moved to another department.
								</p>
								 <p>
									* A host or service is being retired.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									4
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Superseded
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									A newer certificate has replaced the current certificate.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									5
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Cessation of Operation
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									The host or service is being decommissioned.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									6
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Certificate Hold
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									The certificate is temporarily revoked. You can restore the certificate later.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									8
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Remove from CRL
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									The certificate is not included in the certificate revocation list (CRL).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									9
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Privilege Withdrawn
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									The user, host, or service is no longer permitted to use the certificate.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140406474680528"> <p>
									10
								</p>
								 </td><td align="left" valign="top" headers="idm140406474679440"> <p>
									Attribute Authority (AA) Compromise
								</p>
								 </td><td align="left" valign="top" headers="idm140406474395744"> <p>
									The AA certificate is no longer trusted.
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates"><div class="titlepage"><div><div><h3 class="title">18.2.2. Revoking certificates with the integrated IdM CAs using IdM WebUI</h3></div></div></div><p>
					If you know you have lost the private key for your certificate, you must revoke the certificate to prevent its abuse. Complete this procedure to use the IdM WebUI to revoke a certificate issued by the IdM CA.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Click <code class="literal">Authentication</code> &gt; <code class="literal">Certificates</code> &gt; <code class="literal">Certificates</code>.
						</li><li class="listitem"><p class="simpara">
							Click the serial number of the certificate to open the certificate information page.
						</p><div class="figure" id="host-cert-list-revoke_revoking-certificates"><p class="title"><strong>Figure 18.2. List of Certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="host_cert_list.png" alt="host cert list"/></div></div></div></li><li class="listitem">
							In the certificate information page, click <span class="guimenu">Actions</span> → <span class="guimenuitem">Revoke Certificate</span>.
						</li><li class="listitem">
							Select the reason for revoking and click <span class="guibutton">Revoke</span>. See <a class="xref" href="index%3Flb_target=stage.html#certificate-revocation-reasons_revoking-certificates" title="18.2.1. Certificate revocation reasons">Section 18.2.1, “Certificate revocation reasons”</a> for details.
						</li></ol></div></section><section class="section" id="revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates"><div class="titlepage"><div><div><h3 class="title">18.2.3. Revoking certificates with the integrated IdM CAs using IdM CLI</h3></div></div></div><p>
					If you know you have lost the private key for your certificate, you must revoke the certificate to prevent its abuse. Complete this procedure to use the IdM CLI to revoke a certificate issued by the IdM CA.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the <code class="literal command">ipa cert-revoke</code> command, and specify:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									the certificate serial number
								</li><li class="listitem">
									the ID number for the revocation reason; see <a class="xref" href="index%3Flb_target=stage.html#certificate-revocation-reasons_revoking-certificates" title="18.2.1. Certificate revocation reasons">Section 18.2.1, “Certificate revocation reasons”</a> for details
								</li></ul></div></li></ul></div><p>
					For example, to revoke the certificate with serial number <code class="literal">1032</code> because of reason 1: <code class="literal">Key Compromised</code>, enter:
				</p><pre class="literallayout">$ ipa cert-revoke 1032 --revocation-reason=1</pre><p>
					For details on requesting a new certificate, see the following documentation:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="index.html#requesting-and-exporting-a-user-certificate_dc-web-ui-auth">Requesting a new user certificate and exporting it to the client</a>;
						</li><li class="listitem">
							<a class="link" href="index.html#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs">Obtaining an IdM certificate for a service using certmonger</a>.
						</li></ul></div></section></section><section class="section" id="restoring-certificates-with-the-integrated-IdM-CAs_validity-certificates"><div class="titlepage"><div><div><h2 class="title">18.3. Restoring certificates with the integrated IdM CAs</h2></div></div></div><p>
				If you have revoked a certificate because of reason 6: <code class="literal">Certificate Hold</code>, you can restore it again if the private key for the certificate has not been compromised. To restore a certificate, use one of the following procedures:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="index%3Flb_target=stage.html#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" title="18.3.1. Restoring certificates with the integrated IdM CAs using IdM WebUI">Restore certificates with the integrated IdM CAs using IdM WebUI</a>;
					</li><li class="listitem">
						<a class="link" href="index%3Flb_target=stage.html#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates" title="18.3.2. Restoring certificates with the integrated IdM CAs using IdM CLI">Restore certificates with the integrated IdM CAs using IdM CLI</a>.
					</li></ul></div><section class="section" id="restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates"><div class="titlepage"><div><div><h3 class="title">18.3.1. Restoring certificates with the integrated IdM CAs using IdM WebUI</h3></div></div></div><p>
					Complete this procedure to use the IdM WebUI to restore an IdM certificate that has been revoked because of Reason 6: <code class="literal">Certificate Hold</code>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <code class="literal">Authentication</code> menu, click <code class="literal">Certificates</code> &gt; <code class="literal">Certificates</code>.
						</li><li class="listitem"><p class="simpara">
							Click the serial number of the certificate to open the certificate information page.
						</p><div class="figure" id="list-of-certificates_restoring-certificates"><p class="title"><strong>Figure 18.3. List of Certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="host_cert_list.png" alt="host cert list"/></div></div></div></li><li class="listitem">
							In the certificate information page, click <span class="guimenu">Actions</span> → <span class="guimenuitem">Restore Certificate</span>.
						</li></ol></div></section><section class="section" id="restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates"><div class="titlepage"><div><div><h3 class="title">18.3.2. Restoring certificates with the integrated IdM CAs using IdM CLI</h3></div></div></div><p>
					Complete this procedure to use the IdM CLI to restore an IdM certificate that has been revoked because of Reason 6: <code class="literal">Certificate Hold</code>.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the <code class="literal command">ipa cert-remove-hold</code> command and specify the certificate serial number. For example:
						</p><pre class="literallayout">$ ipa cert-remove-hold 1032</pre></li></ul></div></section></section></section><section class="chapter" id="configuring-idm-for-smart-card-auth_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 19. Configuring Identity Management for smart card authentication</h1></div></div></div><p>
			Authentication based on smart cards is an alternative to passwords. User credentials are stored on the smart card in the form of a private key and a certificate, and special software and hardware is used to access them. The user places the smart card into a reader or a USB socket and supplies the PIN code for the smart card instead of providing his password.
		</p><p>
			Identity Management (IdM) supports smart card authentication with:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					User certificates issued by the IdM certificate authority
				</li><li class="listitem">
					User certificates issued by an external certificate authority
				</li></ul></div><p>
			This user story shows how to set up smart card authentication in IdM for both types of certificates. In the user story, the <code class="literal">smartcard_ca.pem</code> CA certificate is the file containing the certificate of a trusted external certificate authority.
		</p><p>
			The user story contains the following modules:
		</p><p>
			<a class="xref" href="index%3Flb_target=stage.html#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth" title="19.1. Configuring the IdM server for smart card authentication">Section 19.1, “Configuring the IdM server for smart card authentication”</a>
		</p><p>
			<a class="xref" href="index%3Flb_target=stage.html#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth" title="19.2. Configuring the IdM client for smart card authentication">Section 19.2, “Configuring the IdM client for smart card authentication”</a>
		</p><p>
			<a class="xref" href="index%3Flb_target=stage.html#add-cert-idm-user_configuring-idm-for-smart-card-auth" title="19.3. Adding a certificate to a user entry in IdM">Section 19.3, “Adding a certificate to a user entry in IdM”</a>
		</p><p>
			<a class="xref" href="index%3Flb_target=stage.html#installing-gnutls-utils_configuring-idm-for-smart-card-auth" title="19.4. Installing gnutls-utils">Section 19.4, “Installing gnutls-utils”</a>
		</p><p>
			<a class="xref" href="index%3Flb_target=stage.html#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth" title="19.5. Storing a certificate on the smart card">Section 19.5, “Storing a certificate on the smart card”</a>
		</p><p>
			<a class="xref" href="index%3Flb_target=stage.html#proc-conf-browser-for-s-c" title="19.6. Configuring the browser for smart card authentication">Section 19.6, “Configuring the browser for smart card authentication”</a>
		</p><p>
			<a class="xref" href="index%3Flb_target=stage.html#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth" title="19.7. Logging in to IdM with smart cards">Section 19.7, “Logging in to IdM with smart cards”</a>
		</p><section class="section" id="conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h2 class="title">19.1. Configuring the IdM server for smart card authentication</h2></div></div></div><p>
				If you want to enable smart card authentication for users whose certificates have been issued by the certificate authority of the <code class="literal">EXAMPLE.ORG</code> domain, whose LDAP distinguished name (DN) is <code class="literal">CN=Certificate Authority,DC=EXAMPLE,DC=ORG</code>, then you need to obtain the certificate of the authority so that you can run it with the script configuring the IdM server. You can, for example, download the certificate from a web page whose certificate has been issued by the authority. For details, see Steps 1 - 4a in <a class="xref" href="index%3Flb_target=stage.html#configuring-browser-for-cert-auth_dc-web-ui-auth" title="22.4. Configuring a browser to enable certificate authentication">Section 22.4, “Configuring a browser to enable certificate authentication”</a>.
			</p><p>
				To enable smart card authentication for IdM users who have been issued a certificate by the IdM Certificate Authority, obtain the CA certificate from the <code class="literal">/etc/ipa/ca.crt</code> file on the IdM server on which the IdM CA is running.
			</p><p>
				This section describes how to configure an IdM server for smart card authentication. First, obtain files with the CA certificates in the PEM format, then run the in-built <code class="literal">ipa-advise</code> script. Finally, reload the system configuration.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root access to the IdM server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a directory in which you will do the configuration:
					</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>mkdir ~/SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Navigate to the directory:
					</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>cd ~/SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Obtain the relevant CA certificates stored in files in the PEM format: <code class="literal">.pem</code>, <code class="literal">.crt</code> and <code class="literal">.cer</code>. The IdM Certificate Authority certificate is located in the <code class="literal">/etc/ipa/ca.crt</code> file. For convenience, copy the certificates to the directory in which you want to do the configuration:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>cp /etc/ipa/ca.crt ~/SmartCard/</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>cp /tmp/smartcard_ca.pem ~/SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optionally, if you use certificates of external certificate authorities, use the <code class="literal">openssl x509</code> utility to view the contents of the files in the <code class="literal">PEM</code> format to check that the <code class="literal">Issuer</code> and <code class="literal">Subject</code> values are correct:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>openssl x509 -noout -text -in smartcard_ca.pem | more</strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate a configuration script with the in-built <code class="literal">ipa-advise</code> utility, using the administrator’s privileges:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>kinit admin</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>sudo ipa-advise config-server-for-smart-card-auth &gt; config-server-for-smart-card-auth.sh</strong></span></pre><p class="simpara">
						The <code class="literal">config-server-for-smart-card-auth.sh</code> script performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the IdM Apache HTTP Server.
							</li><li class="listitem">
								It enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).
							</li><li class="listitem">
								It configures the IdM Web UI to accept smart card authorization requests.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Execute the script, adding the PEM files containing the CA certificates as arguments:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>chmod +x config-server-for-smart-card-auth.sh</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>./config-server-for-smart-card-auth.sh smartcard_ca.pem ca.crt</strong></span>
Ticket cache:KEYRING:persistent:0:0
Default principal: admin@IDM.EXAMPLE.COM
[...]
Systemwide CA database updated.
The ipa-certupdate command was successful</pre></li><li class="listitem"><p class="simpara">
						Optionally, if the certificate authority that issued the user certificate does not provide any Online Certificate Status Protocol (OCSP) responder, you may need to disable OCSP check for authentication to the IdM Web UI:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Set the <code class="literal">SSLOCSPEnable</code> parameter to <code class="literal">off</code> in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> file:
							</p><pre class="literallayout"><span class="strong strong"><strong>SSLOCSPEnable off</strong></span></pre></li><li class="listitem"><p class="simpara">
								Restart the Apache daemon (httpd) for the changes to take effect immediately:
							</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>sudo systemctl restart httpd</strong></span></pre></li></ol></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not disable the OCSP check if you only use user certificates issued by the IdM CA. OCSP responders are part of IdM.
						</p></div></div><p class="simpara">
						For instructions on how to keep the OCSP check enabled, and yet prevent a user certificate from being rejected by the IdM server if it does not contain the information about the location at which the CA that issued the user certificate listens for OCSP service requests, see the <code class="literal">SSLOCSPDefaultResponder</code> directive in <a class="link" href="http://httpd.apache.org/docs/trunk/en/mod/mod_ssl.html">Apache mod_ssl configuration options</a>.
					</p></li></ol></div><p>
				The server is now configured for smart card authentication.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To enable smart card authentication in the whole topology, run the procedure on each IdM server.
				</p></div></div></section><section class="section" id="conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h2 class="title">19.2. Configuring the IdM client for smart card authentication</h2></div></div></div><p>
				This section describes how to configure IdM clients for smart card authentication. The procedure needs to be run on each IdM system, a client or a server, to which you want to connect while using a smart card for authentication. For example, to enable an <code class="literal">ssh</code> connection from host A to host B, the script needs to be run on host B.
			</p><p>
				As an administrator, run this procedure to enable smart card authentication using
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						the <code class="literal">ssh</code> protocol
					</p><p class="simpara">
						For details see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_authselect_on_a_red_hat_enterprise_linux_host/configuring-and-importing-local-certificates-to-a-smart-card_configuring-user-authentication-using-authselect#configuring-ssh-access-using-smart-card-authentication_configuring-and-importing-local-certificates-to-a-smart-card">Configuring SSH access using smart card authentication</a>.
					</p></li><li class="listitem">
						the console login
					</li><li class="listitem">
						the Gnome Display Manager (GDM)
					</li><li class="listitem">
						the <code class="literal">su</code> command
					</li></ul></div><p>
				This procedure is not required for authenticating to the IdM Web UI. Authenticating to the IdM Web UI involves two hosts, neither of which needs to be an IdM client:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						the machine - possibly outside of the IdM domain - on which the browser is running
					</li><li class="listitem">
						the IdM server on which <code class="literal">httpd</code> is running
					</li></ul></div><p>
				The following procedure assumes that you are configuring smart card authentication on an IdM client that is not also an IdM master. For this reason you need two computers: an IdM master to generate the configuration script, and the IdM client on which to run the script.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM server has been configured for smart card authentication, as described in <a class="xref" href="index%3Flb_target=stage.html#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth" title="19.1. Configuring the IdM server for smart card authentication">Section 19.1, “Configuring the IdM server for smart card authentication”</a>.
					</li><li class="listitem">
						You have root access to the IdM server and the IdM client.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On an IdM master, generate a configuration script with <code class="literal">ipa-advise</code> using the administrator’s privileges:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>kinit admin</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>ipa-advise config-client-for-smart-card-auth &gt; config-client-for-smart-card-auth.sh</strong></span></pre><p class="simpara">
						The <code class="literal">config-client-for-smart-card-auth.sh</code> script performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the smart card daemon.
							</li><li class="listitem">
								It sets the system-wide trust store.
							</li><li class="listitem">
								It configures the System Security Services Daemon (SSSD) to allow smart card logins to the desktop.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						From the IdM master, copy the script to a directory of your choice on the IdM client machine:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>scp config-client-for-smart-card-auth.sh root<span class="strong strong"><strong>@</strong></span>client.idm.example.com:/root/SmartCard/</strong></span>
Password:
config-client-for-smart-card-auth.sh        100%   2419       3.5MB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						From the IdM master, copy the CA certificate files in the PEM format for convenience to the same directory on the IdM client machine as used in the previous step:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>scp {smartcard_ca.pem,ca.crt} root<span class="strong strong"><strong>@</strong></span>client.idm.example.com:/root/SmartCard/</strong></span>
Password:
smartcard_ca.pem                    100%   1237     9.6KB/s   00:00
ca.crt                              100%   2514    19.6KB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						On the client machine, execute the script, adding the PEM files containing the CA certificates as arguments:
					</p><pre class="literallayout">[root@client SmartCard]# <span class="strong strong"><strong>kinit admin</strong></span>
[root@client SmartCard]# <span class="strong strong"><strong>chmod +x config-client-for-smart-card-auth.sh</strong></span>
[root@client SmartCard]# <span class="strong strong"><strong>./config-client-for-smart-card-auth.sh smartcard_ca.pem ca.crt</strong></span>
Ticket cache:KEYRING:persistent:0:0
Default principal: admin@IDM.EXAMPLE.COM
[...]
Systemwide CA database updated.
The ipa-certupdate command was successful</pre></li></ol></div><p>
				The client is now configured for smart card authentication.
			</p></section><section class="section" id="add-cert-idm-user_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h2 class="title">19.3. Adding a certificate to a user entry in IdM</h2></div></div></div><p>
				This procedure describes how to add an external certificate to a user entry in IdM.
			</p><p>
				Instead of uploading the whole certificate, it is also possible to upload certificate mapping data to a user entry in IdM. User entries containing either full certificates or certificate mapping data can be used in conjunction with corresponding certificate mapping rules to facilitate the configuration of smart card authentication for system administrators. For details, see <a class="xref" href="index%3Flb_target=stage.html#conf-certmap-idm_configuring-and-managing-idm" title="Chapter 21. Configuring certificate mapping rules in Identity Management">Chapter 21, <em>Configuring certificate mapping rules in Identity Management</em></a>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If the user’s certificate has been issued by the IdM Certificate Authority, the certificate is already stored in the user entry, and you can skip this section.
				</p></div></div><section class="section" id="proc-add-cert-idm-user-webui"><div class="titlepage"><div><div><h3 class="title">19.3.1. Adding a certificate to a user entry in the IdM Web UI</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have the certificate that you want to add to the user entry at your disposal.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log into the IdM Web UI as an administrator if you want to add a certificate to another user. For adding a certificate to your own profile, you do not need the administrator’s credentials.
						</li><li class="listitem">
							Navigate to <code class="literal">Users</code> → <code class="literal">Active users</code> → <code class="literal">sc_user</code>.
						</li><li class="listitem">
							Find the <code class="literal">Certificate</code> option and click <code class="literal">Add</code>.
						</li><li class="listitem"><p class="simpara">
							In the <code class="literal">Command-Line Interface</code>, display the certificate in the <code class="literal">PEM</code> format using the <code class="literal">cat</code> utility or a text editor:
						</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>cat testuser.crt</strong></span></pre></li><li class="listitem">
							Copy and paste the certificate from the CLI into the window that has opened in the Web UI.
						</li><li class="listitem"><p class="simpara">
							Click <code class="literal">Add</code>.
						</p><div class="figure" id="configuring-idm-for-smart-card-auth-new-certmaprule-add"><p class="title"><strong>Figure 19.1. Adding a new certificate in the IdM Web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="idm-add-cert.png" alt="idm add cert"/></div></div></div></li></ol></div><p>
					The <code class="literal">sc_user</code> entry now contains an external certificate.
				</p></section><section class="section" id="proc-add-cert-idm-user-cli"><div class="titlepage"><div><div><h3 class="title">19.3.2. Adding a certificate to a user entry in the IdM CLI</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have the certificate that you want to add to the user entry at your disposal.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Log into the IdM Web UI as an administrator if you want to add a certificate to another user:
						</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>kinit admin</strong></span></pre><p class="simpara">
							For adding a certificate to your own profile, you do not need the administrator’s credentials:
						</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>kinit sc_user</strong></span></pre></li><li class="listitem"><p class="simpara">
							Create an environment variable containing the certificate with the header and footer removed and concatenated into a single line, which is the format expected by the <code class="literal">ipa user-add-cert</code> command:
						</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>export CERT=`openssl x509 -outform der -in testuser.crt | base64 -w0 -`</strong></span></pre><p class="simpara">
							Note that certificate in the <code class="literal">testuser.crt</code> file must be in the <code class="literal">PEM</code> format.
						</p></li><li class="listitem"><p class="simpara">
							Add the certificate to the profile of sc_user using the <code class="literal">ipa user-add-cert</code> command:
						</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>ipa user-add-cert sc_user --certificate=$CERT</strong></span></pre></li></ol></div><p>
					The <code class="literal">sc_user</code> entry now contains an external certificate.
				</p></section></section><section class="section" id="installing-gnutls-utils_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h2 class="title">19.4. Installing gnutls-utils</h2></div></div></div><p>
				To configure your smart card, you need a tool that can generate certificates and store them in the smart card.
			</p><p>
				You must:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the <code class="literal">gnutls-utils</code> program which helps you to manage certificates.
					</li><li class="listitem">
						Start the <code class="literal">pcscd</code> service which communicates with the smart card reader.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the the <code class="literal">gnutls-utils</code> package which allows you to manage smart card settings for reading and writing from the smart card:
					</p><pre class="literallayout"># dnf -y install opensc gnutls-utils</pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">pcscd</code> service.
					</p><pre class="literallayout"># systemctl start pcscd</pre></li></ol></div><p>
				Verify that the <code class="literal">pcscd</code> service is up and running.
			</p></section><section class="section" id="storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h2 class="title">19.5. Storing a certificate on the smart card</h2></div></div></div><p>
				This section describes smart card configuration with <code class="literal">gnutls-utils</code> which helps you to configure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Erasing your smart card
					</li><li class="listitem">
						Setting a new PIN and PUK
					</li><li class="listitem">
						Creating a new slot in the smart card
					</li><li class="listitem">
						Storing the certificate and private key in the slot
					</li><li class="listitem">
						Locking the smart card settings (some smart cards need this type of finalization)
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">gnutls-utils</code> package is installed.
					</p><p class="simpara">
						For details, see <a class="link" href="index%3Flb_target=stage.html#installing-gnutls-utils_configuring-idm-for-smart-card-auth" title="19.4. Installing gnutls-utils">Installing gnutls-utils</a>.
					</p></li><li class="listitem">
						The card is inserted in the reader and connected to the computer.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Erase your smart card and authenticate yourself with PIN:
					</p><pre class="literallayout"># spawn pkcs15-init --erase-card --use-default-transport-keys
Using reader with a card: Smart Card name
PIN [Security Officer PIN] required.
Please enter PIN [Security Officer PIN]:</pre><p class="simpara">
						The card has been erased.
					</p></li><li class="listitem"><p class="simpara">
						Set your PIN and PUK — both twice for verification:
					</p><pre class="literallayout"># pkcs15-init --create-pkcs15 --use-default-transport-keys \
    --pin redhat --puk redhat --so-pin redhat --so-puk redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre><p class="simpara">
						The <code class="literal">pcks15-init</code> creates a new slot in the smart card and marks it with a label and an authentication ID.
					</p></li><li class="listitem"><p class="simpara">
						Add a label that is the name of the slot and the authentication ID:
					</p><pre class="literallayout"># pkcs15-init --store-pin --label testuser \
    --auth-id 01 --so-pin redhat --pin redhat --puk redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre><p class="simpara">
						The label auth-id is set to 01.
					</p></li><li class="listitem"><p class="simpara">
						Store the private key in the new slot of the smart card:
					</p><pre class="literallayout"># pkcs15-init --store-private-key testuser.key --label testuser_key \
    --auth-id 01 --id 01 --so-pin redhat --pin redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre></li><li class="listitem"><p class="simpara">
						Store the certificate in the new slot of the smart card:
					</p><pre class="literallayout"># pkcs15-init --store-certificate testuser.crt --label testuser_crt \
    --auth-id 01 --id 01 --format pem --so-pin redhat --pin redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre></li><li class="listitem"><p class="simpara">
						Optionally finalize the card settings with locking the settings:
					</p><pre class="literallayout"># pkcs15-init -F</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Some smart cards require this step.
						</p></div></div></li></ol></div><p>
				At this stage, your smart card includes the certificate and private key in the newly created slot. PIN and PUK has been successfully created.
			</p></section><section class="section" id="proc-conf-browser-for-s-c"><div class="titlepage"><div><div><h2 class="title">19.6. Configuring the browser for smart card authentication</h2></div></div></div><p>
				This module describes how to configure the Firefox browser for smart card authentication.
			</p><p>
				Identity Management supports the following browsers for connecting to the web UI:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mozilla Firefox 38 and later
					</li><li class="listitem">
						Google Chrome 46 and later
					</li></ul></div><p>
				The following procedure shows how to configure the Mozilla Firefox 57.0.1 browser.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM server has been configured for smart card authentication, as described in <a class="xref" href="index%3Flb_target=stage.html#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth" title="19.1. Configuring the IdM server for smart card authentication">Section 19.1, “Configuring the IdM server for smart card authentication”</a>.
					</li><li class="listitem">
						A smart card is inserted into the USB slot of the host on which you want to configure the browser for smart card authentication.
					</li><li class="listitem">
						On the smart card, both the certificate and the private key of the IdM user are stored. For details about importing the certificate and the key on to the smart card, see <a class="xref" href="index%3Flb_target=stage.html#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth" title="19.5. Storing a certificate on the smart card">Section 19.5, “Storing a certificate on the smart card”</a>.
					</li><li class="listitem">
						The user entry in IdM contains the certificate that is stored on the smart card. For details about uploading a certificate into an IdM user’s user entry, see <a class="xref" href="index%3Flb_target=stage.html#add-cert-idm-user_configuring-idm-for-smart-card-auth" title="19.3. Adding a certificate to a user entry in IdM">Section 19.3, “Adding a certificate to a user entry in IdM”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open Firefox, click on <code class="literal">Preferences</code>.
					</p><div class="figure" id="configuring-idm-for-smart-card-auth-firefox-preferences"><p class="title"><strong>Figure 19.2. Firefox preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="firefox-preferences.png" alt="firefox preferences"/></div></div></div></li><li class="listitem">
						Navigate to <code class="literal">Privacy &amp; Security</code>.
					</li><li class="listitem"><p class="simpara">
						Click on <code class="literal">Security Devices</code>.
					</p><div class="figure" id="configuring-idm-for-smart-card-auth-security-devices"><p class="title"><strong>Figure 19.3. Security devices</strong></p><div class="figure-contents"><div class="mediaobject"><img src="security-devices.png" alt="security devices"/></div></div></div></li><li class="listitem"><p class="simpara">
						In the new <code class="literal">Device Manager</code> dialogue window, click on <code class="literal">Load</code>.
					</p><div class="figure" id="configuring-idm-for-smart-card-auth-load-module"><p class="title"><strong>Figure 19.4. Loading a security device</strong></p><div class="figure-contents"><div class="mediaobject"><img src="load-module.png" alt="load module"/></div></div></div></li><li class="listitem"><p class="simpara">
						In the new <code class="literal">Load PKCS#11 Device Driver</code> dialogue window, enter the module name, for example <code class="literal">OpenSC</code>. Enter the module filename. The module for OpenSC is located in the <code class="literal">/usr/lib64/opensc-pkcs11.so</code> file.
					</p><div class="figure" id="configuring-idm-for-smart-card-auth-pkcs11-module-name"><p class="title"><strong>Figure 19.5. Entering the security device information</strong></p><div class="figure-contents"><div class="mediaobject"><img src="pkcs11-module-name.png" alt="pkcs11 module name"/></div></div></div></li><li class="listitem"><p class="simpara">
						Optionally, check that module can log in to Firefox.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Click on <code class="literal">PIV Card Holder pin (PIV_II)</code> in the left pane and click <code class="literal">Log In</code> in the right pane.
							</p><div class="figure" id="configuring-idm-for-smart-card-auth-log-in-pkcs11-module"><p class="title"><strong>Figure 19.6. Logging in with the security device</strong></p><div class="figure-contents"><div class="mediaobject"><img src="log-in-pkcs11-module.png" alt="log in pkcs11 module"/></div></div></div></li><li class="listitem"><p class="simpara">
								Enter the PIN of the smart card and click <code class="literal">OK</code>.
							</p><div class="figure" id="configuring-idm-for-smart-card-auth-idm-PIN-dialogue"><p class="title"><strong>Figure 19.7. Entering the smart card PIN</strong></p><div class="figure-contents"><div class="mediaobject"><img src="idm-PIN-dialogue.png" alt="idm PIN dialogue"/></div></div></div><p class="simpara">
								If successful, you will see the <code class="literal">Log In</code> button grayed out.
							</p><div class="figure" id="configuring-idm-for-smart-card-auth-pkcs11-module-loaded"><p class="title"><strong>Figure 19.8. Security device module loaded</strong></p><div class="figure-contents"><div class="mediaobject"><img src="pkcs11-module-loaded.png" alt="pkcs11 module loaded"/></div></div></div></li></ol></div></li><li class="listitem">
						Click <code class="literal">OK</code>.
					</li></ol></div><p>
				Now your browser is ready for smart card authentication using the loaded security device.
			</p></section><section class="section" id="logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h2 class="title">19.7. Logging in to IdM with smart cards</h2></div></div></div><p>
				This section provides information about using smart cards for logging in to IdM Web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The web browser is configured for using smart card authentication.
					</li><li class="listitem">
						The IdM server has been configured for smart card authentication.
					</li><li class="listitem">
						The certificate installed on your smart card is known to the IdM server.
					</li><li class="listitem">
						You need the PIN for the certificate access.
					</li><li class="listitem">
						The smart card has been plugged to the reader.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the IdM Web UI in the browser.
					</li><li class="listitem"><p class="simpara">
						Click on <span class="strong strong"><strong>Log In Using Certificate</strong></span>.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="ipa-login-smart-card.png" alt="ipa login smart card"/></span>

					</p></li><li class="listitem"><p class="simpara">
						If the <span class="strong strong"><strong>Password Required</strong></span> dialog box opens, add the PIN to unlock the certificate and click the <span class="strong strong"><strong>OK</strong></span> button.
					</p><p class="simpara">
						The <span class="strong strong"><strong>User Identification Request</strong></span> dialog box opens.
					</p><p class="simpara">
						If the smart card contains more than one certificate, select the certificate you want to use for authentication in the drop down list below <span class="strong strong"><strong>Choose a certificate to present as identification</strong></span>.
					</p></li><li class="listitem">
						Click the <span class="strong strong"><strong>OK</strong></span> button.
					</li></ol></div><p>
				Now you are successfully logged in to the IdM Web UI.
			</p><p>
				<span class="inlinemediaobject"><img src="web_ui_users.png" alt="web ui users"/></span>

			</p></section></section><section class="chapter" id="configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 20. Configuring certificates issued by ADCS for smart card authentication in IdM</h1></div></div></div><p>
			This scenario describes the following situation:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Your deployment is based on cross-forest trust between Identity Management (IdM) and Active Directory (AD).
				</li><li class="listitem">
					You want to allow smart card authentication for users whose accounts are stored in AD.
				</li><li class="listitem">
					Certificates are created and stored in Active Directory Certificate Services (ADCS).
				</li></ul></div><p>
			Configuration will be accomplished in the following steps:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" title="20.3. Copying certificates from Active Directory using sftp">Copying CA and user certificates from Active Directory to the IdM server and client</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" title="20.4. Configuring the IdM server and clients for smart card authentication using ADCS certificates">Configuring the IdM server and clients for smart card authentication using ADCS certificates</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" title="20.5. Converting the PFX file">Converting a PFX (PKCS#12) file to be able to store the certificate and private key into the smart card</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" title="20.8. Configuring timeouts in sssd.conf">Configuring timeouts in the sssd.conf file</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" title="20.9. Creating certificate mapping rules for smart card authentication">Creating certificate mapping rules for smart card authentication</a>
				</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Identity Management (IdM) and Active Directory (AD) trust is installed
				</p><p class="simpara">
					For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-trust-between-idm-and-ad_installing-identity-management">Installing trust between IdM and AD</a>.
				</p></li><li class="listitem">
					Active Directory Certificate Services (ADCS) is installed and certificates for users are generated
				</li></ul></div><section class="section" id="smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.1. Smart card authentication</h2></div></div></div><p>
				A smart card is a physical device which can provide personal authentication using certificates stored on the card. Personal authentication means that you can use smart cards in the same way as user passwords.
			</p><p>
				User credentials are stored on the smart card in the form of a private key and a certificate, and special software and hardware is used to access them. The user places the smart card into a reader or a USB socket and supplies the PIN code for the smart card instead of providing his password.
			</p><p>
				You can configure how you want smart card authentication to work in a particular IdM client:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users can authenticate with the user name and password or with their smart cards
					</li><li class="listitem">
						Users can authenticate with their smart cards, and passwords are not allowed
					</li><li class="listitem">
						Users can use the smart card for logout with a function lock on removal, and passwords are not allowed
					</li></ul></div><p>
				If the default smart card setup done by the <code class="literal">ipa-advise</code> script does not work, you can find further details about smart card configuration with <code class="literal">authselect</code>, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/using_authselect_on_a_red_hat_enterprise_linux_host/index?lb_target=production#configuring-smart-cards-using-authselect_configuring-authentication-using-authselect">Configuring smart cards using authselect</a>.
			</p><p>
				Identity Management (IdM) supports smart card authentication with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						User certificates issued by the IdM certificate authority. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/configuring-idm-for-smart-card-auth_configuring-and-managing-idm">Configuring Identity Management for smart card authentication</a>.
					</li><li class="listitem">
						User certificates issued by the ADCS certificate authority.
					</li><li class="listitem">
						User certificates issued by local certification authority generated on a RHEL system. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_authselect_on_a_red_hat_enterprise_linux_host/configuring-and-importing-local-certificates-to-a-smart-card_configuring-user-authentication-using-authselect">Configuring and importing local certificates to a smart card</a>.
					</li><li class="listitem">
						User certificates issued by an external certificate authority.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If you want to start to use smart card authentication, see the hardware requirements: <a class="link" href="https://access.redhat.com/articles/4253861">Smart Card support in RHEL8</a>.
				</p></div></div></section><section class="section" id="windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.2. Windows Server settings required for trust configuration and certificate usage</h2></div></div></div><p>
				This section summarizes what must be configured on Windows Server:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Active Directory Certificate Services (ADCS) is installed
					</li><li class="listitem">
						Certificate Authority is created
					</li><li class="listitem">
						[Optional] If you are using Certificate Authority Web Enrollment, the Internet Information Services (IIS) must be configured
					</li></ul></div><p>
				Export the certificate:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Key must have <code class="literal">2048</code> bits or more
					</li><li class="listitem">
						Include a private key
					</li><li class="listitem"><p class="simpara">
						You will need a certificate in the following format: Personal Information Exchange — <code class="literal">PKCS #12(.PFX)</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Enable certificate privacy
							</li></ul></div></li></ul></div></section><section class="section" id="copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.3. Copying certificates from Active Directory using sftp</h2></div></div></div><p>
				To be able to use smart card authetication, you need to copy the following certificate files:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A root CA certificate in the <code class="literal">CER</code> format: <code class="literal">adcs-winserver-ca.cer</code> on your IdM server.
					</li><li class="listitem">
						A user certificate with a private key in the <code class="literal">PFX</code> format: <code class="literal">aduser1.pfx</code> on an IdM client.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This procedure expects SSH access is allowed. If SSH is unavailable the user must copy the file from the AD Server to the IdM server and client.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Connect from <span class="strong strong"><strong>the IdM server</strong></span> and copy the <code class="literal">adcs-winserver-ca.cer</code> root certificate to the IdM server:
					</p><pre class="literallayout">root@idmserver ~]# sftp Administrator@winserver.ad.example.com
Administrator@winserver.ad.example.com's password:
Connected to Administrator@winserver.ad.example.com.
sftp&gt; cd &lt;Path to certificates&gt;
sftp&gt; ls
adcs-winserver-ca.cer    aduser1.pfx
sftp&gt;
sftp&gt; get adcs-winserver-ca.cer
Fetching &lt;Path to certificates&gt;/adcs-winserver-ca.cer to adcs-winserver-ca.cer
&lt;Path to certificates&gt;/adcs-winserver-ca.cer                 100%  1254    15KB/s 00:00
sftp quit</pre></li><li class="listitem"><p class="simpara">
						Connect from <span class="strong strong"><strong>the IdM client</strong></span> and copy the <code class="literal">aduser1.pfx</code> user certificate to the client:
					</p><pre class="literallayout">[root@client1 ~]# sftp Administrator@winserver.ad.example.com
Administrator@winserver.ad.example.com's password:
Connected to Administrator@winserver.ad.example.com.
sftp&gt; cd /&lt;Path to certificates&gt;
sftp&gt; get aduser1.pfx
Fetching &lt;Path to certificates&gt;/aduser1.pfx to aduser1.pfx
&lt;Path to certificates&gt;/aduser1.pfx                 100%  1254    15KB/s 00:00
sftp quit</pre></li></ol></div><p>
				Now the CA certificate is stored in the IdM server and the user certificates is stored on the client machine.
			</p></section><section class="section" id="configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.4. Configuring the IdM server and clients for smart card authentication using ADCS certificates</h2></div></div></div><p>
				You must configure the IdM (Identity Management) server and clients to be able to use smart card authentication in the IdM environment. IdM includes the <code class="literal">ipa-advise</code> scripts which makes all necessary changes:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						install necessary packages
					</li><li class="listitem">
						it configures IdM server and clients
					</li><li class="listitem">
						copy the CA certificates into expected locations
					</li></ul></div><p>
				You can run <code class="literal">ipa-advise</code> on your IdM server.
			</p><p>
				This procedure describes:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						On an IdM server: Preparing the <code class="literal">ipa-advise</code> script to configure your IdM server for smart card authentication.
					</li><li class="listitem">
						On an IdM server: Preparing the <code class="literal">ipa-advise</code> script to configure your IdM client for smart card authentication.
					</li><li class="listitem">
						On an IdM server: Applying the the <code class="literal">ipa-advise</code> server script on the IdM server using the AD certificate.
					</li><li class="listitem">
						Moving the client script to the IdM client machine.
					</li><li class="listitem">
						On an IdM client: Applying the the <code class="literal">ipa-advise</code> client script on the IdM client using the AD certificate.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The certificate has been copied to the IdM server.
					</li><li class="listitem">
						Obtain the Kerberos ticket.
					</li><li class="listitem">
						Log in as a user with administration rights.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM server, use the <code class="literal">ipa-advise</code> script for configuring a client:
					</p><pre class="literallayout">[root@idmserver ~]# ipa-advise config-client-for-smart-card-auth &gt; sc_client.sh</pre></li><li class="listitem"><p class="simpara">
						On the IdM server, use the <code class="literal">ipa-advise</code> script for configuring a server:
					</p><pre class="literallayout">[root@idmserver ~]# ipa-advise config-server-for-smart-card-auth &gt; sc_server.sh</pre></li><li class="listitem"><p class="simpara">
						On the IdM server, execute the script:
					</p><pre class="literallayout">[root@idmserver ~]# sh -x sc_server.sh adcs-winserver-ca.cer</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the IdM Apache HTTP Server.
							</li><li class="listitem">
								It enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).
							</li><li class="listitem">
								It configures the IdM Web UI to accept smart card authorization requests.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">sc_client.sh</code> script to the client system:
					</p><pre class="literallayout">[root@idmserver ~]# scp sc_client.sh root@client1.idm.example.com:/root
Password:
sc_client.sh                  100%  2857   1.6MB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						Copy the Windows certificate to the client system:
					</p><pre class="literallayout">[root@idmserver ~]# scp adcs-winserver-ca.cer root@client1.idm.example.com:/root
Password:
adcs-winserver-ca.cer                 100%  1254   952.0KB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						On the client system, run the client script:
					</p><pre class="literallayout">[root@idmclient1 ~]# sh -x sc_client.sh adcs-winserver-ca.cer</pre></li></ol></div><p>
				The CA certificate is installed in the correct format on the IdM server and client systems and next step is to copy the user certificates onto the smart card itself.
			</p></section><section class="section" id="converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.5. Converting the PFX file</h2></div></div></div><p>
				Before you store the PFX (PKCS#12) file into the smart card, you must:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						convert the file to the PEM format
					</li><li class="listitem">
						extract the private key and the certificate to two different files
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The PFX file is copied into the IdM client machine.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM client, into the PEM format:
					</p><pre class="literallayout">[root@idmclient1 ~]# openssl pkcs12 -in aduser1.pfx -out aduser1_cert_only.pem -clcerts -nodes
Enter Import Password:</pre></li><li class="listitem"><p class="simpara">
						Extract the key into the separate file:
					</p><pre class="literallayout">[root@idmclient1 ~]# openssl pkcs12 -in adduser1.pfx -nocerts -out adduser1.pem &gt; aduser1.key</pre></li><li class="listitem"><p class="simpara">
						Extract the public certificate into the separate file:
					</p><pre class="literallayout">[root@idmclient1 ~]# openssl pkcs12 -in adduser1.pfx -clcerts -nokeys -out aduser1_cert_only.pem &gt; aduser1.crt</pre></li></ol></div><p>
				At this point, you can store the <code class="literal">aduser1.key</code> and <code class="literal">aduser1.crt</code> into the smart card.
			</p></section><section class="section" id="installing-gnutls-utils_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.6. Installing gnutls-utils</h2></div></div></div><p>
				To configure your smart card, you need a tool that can generate certificates and store them in the smart card.
			</p><p>
				You must:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the <code class="literal">gnutls-utils</code> program which helps you to manage certificates.
					</li><li class="listitem">
						Start the <code class="literal">pcscd</code> service which communicates with the smart card reader.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the the <code class="literal">gnutls-utils</code> package which allows you to manage smart card settings for reading and writing from the smart card:
					</p><pre class="literallayout"># dnf -y install opensc gnutls-utils</pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">pcscd</code> service.
					</p><pre class="literallayout"># systemctl start pcscd</pre></li></ol></div><p>
				Verify that the <code class="literal">pcscd</code> service is up and running.
			</p></section><section class="section" id="storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.7. Storing a certificate on the smart card</h2></div></div></div><p>
				This section describes smart card configuration with <code class="literal">gnutls-utils</code> which helps you to configure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Erasing your smart card
					</li><li class="listitem">
						Setting a new PIN and PUK
					</li><li class="listitem">
						Creating a new slot in the smart card
					</li><li class="listitem">
						Storing the certificate and private key in the slot
					</li><li class="listitem">
						Locking the smart card settings (some smart cards need this type of finalization)
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">gnutls-utils</code> package is installed.
					</p><p class="simpara">
						For details, see <a class="link" href="index%3Flb_target=stage.html#installing-gnutls-utils_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" title="20.6. Installing gnutls-utils">Installing gnutls-utils</a>.
					</p></li><li class="listitem">
						The card is inserted in the reader and connected to the computer.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Erase your smart card and authenticate yourself with PIN:
					</p><pre class="literallayout"># spawn pkcs15-init --erase-card --use-default-transport-keys
Using reader with a card: Smart Card name
PIN [Security Officer PIN] required.
Please enter PIN [Security Officer PIN]:</pre><p class="simpara">
						The card has been erased.
					</p></li><li class="listitem"><p class="simpara">
						Set your PIN and PUK — both twice for verification:
					</p><pre class="literallayout"># pkcs15-init --create-pkcs15 --use-default-transport-keys \
    --pin redhat --puk redhat --so-pin redhat --so-puk redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre><p class="simpara">
						The <code class="literal">pcks15-init</code> creates a new slot in the smart card and marks it with a label and an authentication ID.
					</p></li><li class="listitem"><p class="simpara">
						Add a label that is the name of the slot and the authentication ID:
					</p><pre class="literallayout"># pkcs15-init --store-pin --label testuser \
    --auth-id 01 --so-pin redhat --pin redhat --puk redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre><p class="simpara">
						The label auth-id is set to 01.
					</p></li><li class="listitem"><p class="simpara">
						Store the private key in the new slot of the smart card:
					</p><pre class="literallayout"># pkcs15-init --store-private-key testuser.key --label testuser_key \
    --auth-id 01 --id 01 --so-pin redhat --pin redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre></li><li class="listitem"><p class="simpara">
						Store the certificate in the new slot of the smart card:
					</p><pre class="literallayout"># pkcs15-init --store-certificate testuser.crt --label testuser_crt \
    --auth-id 01 --id 01 --format pem --so-pin redhat --pin redhat
Using reader with a card: SCM Microsystems Inc. SCR 3320 [CCID Interface] (53311657131456) 00 00</pre></li><li class="listitem"><p class="simpara">
						Optionally finalize the card settings with locking the settings:
					</p><pre class="literallayout"># pkcs15-init -F</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Some smart cards require this step.
						</p></div></div></li></ol></div><p>
				At this stage, your smart card includes the certificate and private key in the newly created slot. PIN and PUK has been successfully created.
			</p></section><section class="section" id="configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.8. Configuring timeouts in sssd.conf</h2></div></div></div><p>
				Authentication with a smart card certificate might take longer than the default timeouts used by SSSD. Time out expiration can be caused by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						slow reader
					</li><li class="listitem">
						a forwarding form a physical device into a virtual environment
					</li><li class="listitem">
						too many certificates stored on the smart card
					</li><li class="listitem">
						slow response from the OCSP (Online Certificate Status Protocol) responder if OCSP is used to verify the certificates
					</li></ul></div><p>
				In this case you can prolong the following timeouts in the <code class="literal">sssd.conf</code> file, for example, to 60 seconds:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">p11_child_timeout</code>
					</li><li class="listitem">
						<code class="literal">krb5_auth_timeout</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must be logged in as root.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">sssd.conf</code> file:
					</p><pre class="literallayout">[root@idmclient1 ~]# vim /etc/sssd/sssd.conf</pre></li><li class="listitem"><p class="simpara">
						Change the value of <code class="literal">p11_child_timeout</code>:
					</p><pre class="literallayout">[pam]
p11_child_timeout = 60</pre></li><li class="listitem"><p class="simpara">
						Change the value of <code class="literal">krb5_auth_timeout</code>:
					</p><pre class="literallayout">[domain/IDM.EXAMPLE.COM]
krb5_auth_timeout = 60</pre></li><li class="listitem">
						Save the settings.
					</li></ol></div><p>
				Now, the interaction with the smart card is allowed to run for 1 minute (60 seconds) before authentication will fail with a timeout.
			</p></section><section class="section" id="certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h2 class="title">20.9. Creating certificate mapping rules for smart card authentication</h2></div></div></div><p>
				If you want to use one certificate for the same user who has accounts in AD (Active Directory) and in IdM (Identity Management) too, you can create a certificate mapping rule on the IdM server. After creating such a rule, the user is able to authenticate with their smart card in both domains.
			</p><p>
				For details about certificate mapping rules, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/conf-certmap-idm_configuring-and-managing-idm">Certificate mapping rules for configuring authentication on smart cards</a>.
			</p></section></section><section class="chapter" id="conf-certmap-idm_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 21. Configuring certificate mapping rules in Identity Management</h1></div></div></div><p>
			<span id="con-idm-certmapdata_conf-certmap-idm"><!--Empty--></span>
		</p><section class="section" id="certificate_mapping_rules_for_configuring_authentication_on_smart_cards"><div class="titlepage"><div><div><h2 class="title">21.1. Certificate mapping rules for configuring authentication on smart cards</h2></div></div></div><p>
				Certificate mapping rules are a convenient way of allowing users to authenticate using certificates in scenarios when the Identity Management (IdM) administrator does not have access to certain users' certificates. This lack of access is typically caused by the fact that the certificates have been issued by an external certificate authority. A special use case is represented by certificates issued by the Certificate System of an Active Directory (AD) with which the IdM domain is in a trust relationship.
			</p><p>
				Certificate mapping rules are also convenient if the IdM environment is large with a lot of users using smart cards. In this situation, adding full certificates can be complicated. The subject and issuer are predictable in most scenarios and thus easier to add ahead of time than the full certificate. As a system administrator, you can create a certificate mapping rule and add certificate mapping data to a user entry even before a certificate is issued to a particular user. Once the certificate is issued, the user will be able to log in using the certificate even though the full certificate is not uploaded into his entry.
			</p><p>
				In addition, as certificates have to be renewed at regular intervals, certificate mapping rules reduce administrative overhead. When a user’s certificate gets renewed, the administrator does not have to update the user entry. For example, if the mapping is based on the <code class="literal">Subject</code> and <code class="literal">Issuer</code> values, and if the new certificate has the same subject and issuer as the old one, the mapping still applies. If, in contrast, the full certificate was used, then the administrator would have to upload the new certificate to the user entry to replace the old one.
			</p><p>
				To set up certificate mapping:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						An administrator has to load the certificate mapping data (typically the issuer and subject) or the full certificate into a user account.
					</li><li class="listitem"><p class="simpara">
						An administrator has to create a certificate mapping rule to allow successful logging into IdM for a user
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								whose account contains a certificate mapping data entry
							</li><li class="listitem">
								whose certificate mapping data entry matches the information on the certificate
							</li></ol></div><p class="simpara">
						For details on the individual components that make up a mapping rule and how to obtain and use them, see <a class="link" href="index%3Flb_target=stage.html#sc-id-mapping_conf-certmap-idm">Components of an identity mapping rule in IdM</a> and <a class="link" href="index%3Flb_target=stage.html#sc-id-issuer-obtain-example_conf-certmap-idm">Obtaining the issuer from a certificate for use in a matching rule</a>.
					</p></li></ol></div><p>
				Afterwards, when the end-user presents his certificate, stored either in the <a class="link" href="index%3Flb_target=stage.html#cert-idm-users-auth-procedure_dc-web-ui-auth">filesystem</a> or on a <a class="link" href="index%3Flb_target=stage.html#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth" title="19.7. Logging in to IdM with smart cards">smart card</a>, he authenticates successfully.
			</p><p>
				<span id="con-idm-ad-certmapdata_conf-certmap-idm"><!--Empty--></span>
			</p><section class="section" id="certificate_mapping_rules_for_trusts_with_active_directory_domains"><div class="titlepage"><div><div><h3 class="title">21.1.1. Certificate mapping rules for trusts with Active Directory domains</h3></div></div></div><p>
					This section outlines the different certificate mapping use cases that are possible if an IdM deployment is in a trust relationship with an Active Directory (AD) domain.
				</p><p>
					Certificate mapping rules are a convenient way to enable access to IdM resources for users who have smart card certificates that were issued by the trusted AD Certificate System. Depending on the AD configuration, the following scenarios are possible:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If the certificate is issued by AD but the user and the certificate are stored in IdM, the mapping and the whole processing of the authentication request takes place on the IdM side. For details of configuring this scenario, see <a class="link" href="index%3Flb_target=stage.html#conf-certmap-for-users-in-idm" title="21.2. Configuring certificate mapping for users stored in IdM">Configuring certificate mapping for users stored in IdM</a>.
						</li><li class="listitem"><p class="simpara">
							If the user is stored in AD, the processing of the authentication request takes place in AD. There are three different subcases:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									The AD user entry contains the whole certificate. For details how to configure IdM in this scenario, see <a class="link" href="index%3Flb_target=stage.html#conf-certmap-for-ad-certs" title="21.3. Configuring certificate mapping for users whose AD user entry contains the whole certificate">Configuring certificate mapping for users whose AD user entry contains the whole certificate</a>.
								</li><li class="listitem">
									AD is configured to map user certificates to user accounts. In this case, the AD user entry does not contain the whole certificate but instead contains an attribute called <code class="literal">altSecurityIdentities</code>. For details how to configure IdM in this scenario, see <a class="link" href="index%3Flb_target=stage.html#conf-certmap-for-ad-map_conf-certmap-idm">Configuring certificate mapping if AD is configured to map user certificates to user accounts</a>.
								</li><li class="listitem">
									The AD user entry contains neither the whole certificate nor the mapping data. In this case, the only solution is to use the <code class="literal">ipa idoverrideuser-add</code> command to add the whole certificate to the AD user’s ID override in IdM. For details, see <a class="link" href="index%3Flb_target=stage.html#conf-certmap-ad-no-cert-no-map" title="21.5. Configuring certificate mapping if AD user entry contains no certificate or mapping data">Configuring certificate mapping if AD user entry contains no certificate or mapping data</a>.
								</li></ul></div></li></ul></div><p>
					<span id="sc-id-mapping_conf-certmap-idm"><!--Empty--></span>
				</p></section><section class="section" id="components_of_an_identity_mapping_rule_in_idm"><div class="titlepage"><div><div><h3 class="title">21.1.2. Components of an identity mapping rule in IdM</h3></div></div></div><p>
					This section describes the components of an <span class="emphasis"><em>identity mapping rule</em></span> in IdM and how to configure them. Each component has a default value that you can override. You can define the components in either the web UI or the CLI. In the CLI, the identity mapping rule is created using the <code class="literal">ipa certmaprule-add</code> command.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Mapping rule</span></dt><dd><p class="simpara">
								The mapping rule component associates (or <span class="emphasis"><em>maps</em></span>) a certificate with one or more user accounts. The rule defines an LDAP search filter that associates a certificate with the intended user account.
							</p><p class="simpara">
								Certificates issued by different certificate authorities (CAs) might have different properties and might be used in different domains. Therefore, IdM does not apply mapping rules unconditionally, but only to the appropriate certificates. The appropriate certificates are defined using <span class="emphasis"><em>matching rules</em></span>.
							</p><p class="simpara">
								Note that if you leave the mapping rule option empty, the certificates are searched in the <code class="literal">userCertificate</code> attribute as a DER encoded binary file.
							</p><p class="simpara">
								Define the mapping rule in the CLI using the <code class="literal">--maprule</code> option.
							</p></dd><dt><span class="term">Matching rule</span></dt><dd><p class="simpara">
								The matching rule component selects a certificate to which you want to apply the mapping rule. The default matching rule matches certificates with the <code class="literal">digitalSignature key</code> usage and <code class="literal">clientAuth extended key</code> usage.
							</p><p class="simpara">
								Define the matching rule in the CLI using the <code class="literal">--matchrule</code> option.
							</p></dd><dt><span class="term">Domain list</span></dt><dd><p class="simpara">
								The domain list specifies the identity domains in which you want IdM to search the users when processing identity mapping rules. If you leave the option unspecified, IdM searches the users only in the local domain to which the IdM client belongs.
							</p><p class="simpara">
								Define the domain in the CLI using the <code class="literal">--domain</code> option.
							</p></dd><dt><span class="term">Priority</span></dt><dd><p class="simpara">
								When multiple rules are applicable to a certificate, the rule with the highest priority takes precedence. All other rules are ignored.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The lower the numerical value, the higher the priority of the identity mapping rule. For example, a rule with a priority 1 has higher priority than a rule with a priority 2.
									</li><li class="listitem">
										If a rule has no priority value defined, it has the lowest priority.
									</li></ul></div><p class="simpara">
								Define the mapping rule priority in the CLI using the <code class="literal">--priority</code> option.
							</p></dd></dl></div><div class="formalpara"><p class="title"><strong>Certificate mapping rule example</strong></p><p>
						To define, using the CLI, a certificate mapping rule called <code class="literal">simple_rule</code> that allows authentication for a certificate issued by the <code class="literal">Smart Card CA</code> of the <code class="literal">EXAMPLE.ORG</code> organisation as long as the <code class="literal">Subject</code> on that certificate matches a <code class="literal">certmapdata</code> entry in a user account in IdM:
					</p></div><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add simple_rule --matchrule '&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG' --maprule '(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})'</strong></span></pre><p>
					<span id="sc-id-issuer-obtain-example_conf-certmap-idm"><!--Empty--></span>
				</p></section><section class="section" id="obtaining_the_issuer_from_a_certificate_for_use_in_a_matching_rule"><div class="titlepage"><div><div><h3 class="title">21.1.3. Obtaining the issuer from a certificate for use in a matching rule</h3></div></div></div><p>
					This procedure describes how to obtain the issuer information from a certificate so that you can copy and paste it into the matching rule of a certificate mapping rule. To get the issuer format required by a matching rule, use the <code class="literal">openssl x509</code> utility.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have the user certificate in a <code class="literal">.pem</code> or <code class="literal">.crt</code> format
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Obtain the user information from the certificate. Use the <code class="literal">openssl x509</code> certificate display and signing utility with:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									the <code class="literal">-noout</code> option to prevent the output of an encoded version of the request
								</li><li class="listitem">
									the <code class="literal">-issuer</code> option to output the issuer name
								</li><li class="listitem">
									the <code class="literal">-in</code> option to specify the input file name to read the certificate from
								</li><li class="listitem"><p class="simpara">
									the <code class="literal">-nameopt</code> option with the <code class="literal">RFC2253</code> value to display the output with the most specific relative distinguished name (RDN) first
								</p><p class="simpara">
									If the input file contains an Identity Management certificate, the output of the command shows that the Issuer is defined using the <code class="literal">Organisation</code> information:
								</p><pre class="literallayout"># <span class="strong strong"><strong>openssl x509 -noout -issuer -in idm_user.crt -nameopt RFC2253</strong></span>
issuer=CN=Certificate Authority,O=REALM.EXAMPLE.COM</pre><p class="simpara">
									If the input file contains an Active Directory certificate, the output of the command shows that the Issuer is defined using the <code class="literal">Domain Component</code> information:
								</p><pre class="literallayout"># <span class="strong strong"><strong>openssl x509 -noout -issuer -in ad_user.crt -nameopt RFC2253</strong></span>
issuer=CN=AD-WIN2012R2-CA,DC=AD,DC=EXAMPLE,DC=COM</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							Optionally, to create a new mapping rule in the CLI based on a matching rule which specifies that the certificate issuer must be the extracted <code class="literal">AD-WIN2012R2-CA</code> of the <code class="literal">ad.example.com</code> domain and the subject on the certificate must match the <code class="literal">certmapdata</code> entry in a user account in IdM:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add simple_rule --matchrule '&lt;ISSUER&gt;CN=AD-WIN2012R2-CA,DC=AD,DC=EXAMPLE,DC=COM' --maprule '(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})'</strong></span></pre></li></ol></div><h4 id="additional_information">Additional information</h4><p>
					For details about the supported formats for the matching rule and the mapping rule, and an explanation of the priority and domain fields, see the <code class="literal">sss-certmap(5)</code> man page.
				</p></section></section><section class="section" id="conf-certmap-for-users-in-idm"><div class="titlepage"><div><div><h2 class="title">21.2. Configuring certificate mapping for users stored in IdM</h2></div></div></div><p>
				This user story describes the steps a system administrator must take to enable certificate mapping in IdM if the user for whom certificate authentication is being configured is stored in IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user has an account in IdM.
					</li><li class="listitem">
						The administrator has either the whole certificate or the certificate mapping data to add to the user entry.
					</li></ul></div><p>
				<span id="proc-add-maprule_conf-certmap-for-users-in-idm"><!--Empty--></span>
			</p><section class="section" id="adding_a_certificate_mapping_rule_in_idm"><div class="titlepage"><div><div><h3 class="title">21.2.1. Adding a certificate mapping rule in IdM</h3></div></div></div><p>
					This section describes how to set up a certificate mapping rule so that IdM users with certificates that match the conditions specified in the mapping rule and in their certificate mapping data entries can authenticate to IdM.
				</p><p>
					<span id="proc-add-maprule-webui_proc-add-maprule"><!--Empty--></span>
				</p><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_web_ui"><div class="titlepage"><div><div><h4 class="title">21.2.1.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the IdM web UI as an administrator.
							</li><li class="listitem">
								Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
							</li><li class="listitem"><p class="simpara">
								Click <code class="literal">Add</code>.
							</p><div class="figure" id="proc-add-maprule-new-certmaprule-add"><p class="title"><strong>Figure 21.1. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="new-certmaprule-add.png" alt="new certmaprule add"/></div></div></div></li><li class="listitem">
								Enter the rule name.
							</li><li class="listitem"><p class="simpara">
								Enter the mapping rule. For example, to make IdM search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented to them, and base its decision to authenticate or not on the information found in these two entries of the presented certificate:
							</p><pre class="literallayout"><span class="strong strong"><strong>(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">Smart Card CA</code> of the <code class="literal">EXAMPLE.ORG</code> organization to authenticate users to IdM:
							</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG</strong></span></pre><div class="figure" id="proc-add-maprule-certmaprule-add-details"><p class="title"><strong>Figure 21.2. Entering the details for a certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="certmaprule-add-details1.png" alt="certmaprule add details1"/></div></div></div></li><li class="listitem">
								Click <code class="literal">Add</code> at the bottom of the dialog box to add the rule and close the box.
							</li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						Now you have a certificate mapping rule set up that compares the type of data specified in the mapping rule that it finds on a smart card certificate with the certificate mapping data in your IdM user entries. Once it finds a match, it authenticates the matching user.
					</p><p>
						<span id="proc-add-maprule-cli_proc-add-maprule"><!--Empty--></span>
					</p></section><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_cli"><div class="titlepage"><div><div><h4 class="title">21.2.1.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the administrator’s credentials:
							</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the mapping rule and the matching rule the mapping rule is based on. For example, to make IdM search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented, and base its decision to authenticate or not on the information found in these two entries of the presented certificate, recognizing only certificates issued by the <code class="literal">Smart Card CA</code> of the <code class="literal">EXAMPLE.ORG</code> organization:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add <code class="literal">rule_name</code> --matchrule '&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG' --maprule '(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})'</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "rule_name"
-------------------------------------------------------
  Rule name: rule_name
  Mapping rule: (ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})
  Matching rule: &lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						Now you have a certificate mapping rule set up that compares the type of data specified in the mapping rule that it finds on a smart card certificate with the certificate mapping data in your IdM user entries. Once it finds a match, it authenticates the matching user.
					</p><p>
						<span id="proc-add-certmapdata-to-user_conf-certmap-for-users-in-idm"><!--Empty--></span>
					</p></section></section><section class="section" id="adding_certificate_mapping_data_to_a_user_entry_in_idm"><div class="titlepage"><div><div><h3 class="title">21.2.2. Adding certificate mapping data to a user entry in IdM</h3></div></div></div><p>
					This section describes how to enter certificate mapping data to an IdM user entry so that the user can authenticate using multiple certificates as long as they all contain the values specified in the certificate mapping data entry.
				</p><p>
					<span id="proc-add-certmapdata-to-user-webui_conf-certmap-for-users-in-idm"><!--Empty--></span>
				</p><section class="section" id="adding_certificate_mapping_data_to_a_user_entry_in_the_idm_web_ui"><div class="titlepage"><div><div><h4 class="title">21.2.2.1. Adding certificate mapping data to a user entry in the IdM web UI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Log into the IdM web UI as an administrator.
							</li><li class="listitem">
								Navigate to <code class="literal">Users</code> → <code class="literal">Active users</code> → <code class="literal">idm_user</code>.
							</li><li class="listitem">
								Find the <code class="literal">Certificate mapping data</code> option and click <code class="literal">Add</code>.
							</li><li class="listitem"><p class="simpara">
								If you have the certificate of <code class="literal">idm_user</code> at your disposal:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										In the Command-Line Interface, display the certificate using the <code class="literal">cat</code> utility or a text editor:
									</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>cat idm_user_certificate.pem</strong></span>
-----BEGIN CERTIFICATE-----
MIIFFTCCA/2gAwIBAgIBEjANBgkqhkiG9w0BAQsFADA6MRgwFgYDVQQKDA9JRE0u
RVhBTVBMRS5DT00xHjAcBgNVBAMMFUNlcnRpZmljYXRlIEF1dGhvcml0eTAeFw0x
ODA5MDIxODE1MzlaFw0yMDA5MDIxODE1MzlaMCwxGDAWBgNVBAoMD0lETS5FWEFN
[...output truncated...]</pre></li><li class="listitem">
										Copy the certificate.
									</li><li class="listitem"><p class="simpara">
										In the IdM web UI, click <code class="literal">Add</code> next to <code class="literal">Certificate</code> and paste the certificate into the window that opens up.
									</p><div class="figure" id="conf-certmap-for-users-in-idm-add-user-certmapdata-cert"><p class="title"><strong>Figure 21.3. Adding a user’s certificate mapping data: certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="user-add-cert.png" alt="user add cert"/></div></div></div><p class="simpara">
										Alternatively, if you do not have the certificate of <code class="literal">idm_user</code> at your disposal but know the <code class="literal">Issuer</code> and the <code class="literal">Subject</code> of the certificate, check the radio button of <code class="literal">Issuer and subject</code> and enter the values in the two respective boxes.
									</p><div class="figure" id="conf-certmap-for-users-in-idm-add-user-certmapdata-data"><p class="title"><strong>Figure 21.4. Adding a user’s certificate mapping data: issuer and subject</strong></p><div class="figure-contents"><div class="mediaobject"><img src="user-add-certdata.png" alt="user add certdata"/></div></div></div></li></ol></div></li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li><li class="listitem"><p class="simpara">
								Optionally, if you have access to the whole certificate in the <code class="literal">.pem</code> format, verify that the user and certificate are linked:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">idm_user</code> in the SSSD cache and force a reload of the <code class="literal">idm_user</code> information:
									</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the IdM user:
									</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match idm_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: IDM.EXAMPLE.COM
 User logins: idm_user
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
										The output confirms that now you have certificate mapping data added to <code class="literal">idm_user</code> and that a corresponding mapping rule defined in <a class="link" href="index%3Flb_target=stage.html#proc-add-maprule_conf-certmap-for-users-in-idm">Adding a certificate mapping rule in IdM</a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">idm_user</code>.
									</p></li></ol></div></li></ol></div><p>
						<span id="proc-add-certmapdata-to-user-cli_conf-certmap-for-users-in-idm"><!--Empty--></span>
					</p></section><section class="section" id="adding_certificate_mapping_data_to_a_user_entry_in_the_idm_cli"><div class="titlepage"><div><div><h4 class="title">21.2.2.2. Adding certificate mapping data to a user entry in the IdM CLI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the administrator’s credentials:
							</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
								If you have the certificate of <code class="literal">idm_user</code> at your disposal, add the certificate to the user account using the <code class="literal">ipa user-add-cert</code> command:
							</p><pre class="literallayout"># <span class="strong strong"><strong>CERT=`cat idm_user_cert.pem | tail -n +2| head -n -1 | tr -d '\r\n'\`</strong></span>
# <span class="strong strong"><strong>ipa user-add-certmapdata idm_user --certificate $CERT</strong></span></pre><p class="simpara">
								Alternatively, if you do not have the certificate of <code class="literal">idm_user</code> at your disposal but know the <code class="literal">Issuer</code> and the <code class="literal">Subject</code> of idm_user’s certificate:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa user-add-certmapdata idm_user --subject "O=EXAMPLE.ORG,CN=test" --issuer "CN=Smart Card CA,O=EXAMPLE.ORG"</strong></span>
--------------------------------------------
Added certificate mappings to user "idm_user"
--------------------------------------------
  User login: idm_user
  Certificate mapping data: X509:&lt;I&gt;O=EXAMPLE.ORG,CN=Smart Card CA&lt;S&gt;CN=test,O=EXAMPLE.ORG</pre></li><li class="listitem"><p class="simpara">
								Optionally, if you have access to the whole certificate in the <code class="literal">.pem</code> format, verify that the user and certificate are linked:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">idm_user</code> in the SSSD cache and force a reload of the <code class="literal">idm_user</code> information:
									</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the IdM user:
									</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match idm_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: IDM.EXAMPLE.COM
 User logins: idm_user
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
										The output confirms that now you have certificate mapping data added to <code class="literal">idm_user</code> and that a corresponding mapping rule defined in <a class="link" href="index%3Flb_target=stage.html#proc-add-maprule_conf-certmap-for-users-in-idm">Adding a certificate mapping rule in IdM</a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">idm_user</code>.
									</p></li></ol></div></li></ol></div></section></section></section><section class="section" id="conf-certmap-for-ad-certs"><div class="titlepage"><div><div><h2 class="title">21.3. Configuring certificate mapping for users whose AD user entry contains the whole certificate</h2></div></div></div><p>
				This user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD and the user entry in AD contains the whole certificate.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user does not have an account in IdM.
					</li><li class="listitem">
						The user has an account in AD which contains a certificate.
					</li><li class="listitem">
						The IdM administrator has access to data on which the IdM certificate mapping rule can be based.
					</li></ul></div><p>
				<span id="proc-add-maprule-ad-cert_conf-certmap-for-ad-certs"><!--Empty--></span>
			</p><section class="section" id="adding_a_certificate_mapping_rule_for_users_whose_ad_entry_contains_whole_certificates"><div class="titlepage"><div><div><h3 class="title">21.3.1. Adding a certificate mapping rule for users whose AD entry contains whole certificates</h3></div></div></div><p>
					<span id="proc-add-maprule-webui-ad-cert_proc-add-maprule-ad-cert"><!--Empty--></span>
				</p><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_web_ui_2"><div class="titlepage"><div><div><h4 class="title">21.3.1.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Log into the IdM web UI as an administrator.
							</li><li class="listitem">
								Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
							</li><li class="listitem"><p class="simpara">
								Click <code class="literal">Add</code>.
							</p><div class="figure" id="proc-add-maprule-ad-cert-new-certmaprule-add-ad-cert"><p class="title"><strong>Figure 21.5. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="new-certmaprule-add.png" alt="new certmaprule add"/></div></div></div></li><li class="listitem">
								Enter the rule name.
							</li><li class="listitem"><p class="simpara">
								Enter the mapping rule. To have the whole certificate that is presented to IdM for authentication compared to what is available in AD:
							</p><pre class="literallayout"><span class="strong strong"><strong>(userCertificate;binary={cert!bin})</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
							</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com</strong></span></pre><div class="figure" id="proc-add-maprule-ad-cert-certmaprule-add-details-ad-cert"><p class="title"><strong>Figure 21.6. Certificate mapping rule for a user with a certificate stored in AD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="certmaprule-add-details-ad-cert.png" alt="certmaprule add details ad cert"/></div></div></div></li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI::
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						<span id="proc-add-maprule-cli-ad-cert_proc-add-maprule-ad-cert"><!--Empty--></span>
					</p></section><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_cli_2"><div class="titlepage"><div><div><h4 class="title">21.3.1.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the administrator’s credentials:
							</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the mapping rule and the matching rule the mapping rule is based on. To have the whole certificate that is presented for authentication compared to what is available in AD, only allowing certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add <code class="literal">simpleADrule</code> --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(userCertificate;binary={cert!bin})' --domain ad.example.com</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "simpleADrule"
-------------------------------------------------------
  Rule name: simpleADrule
  Mapping rule: (userCertificate;binary={cert!bin})
  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com
  Domain name: ad.example.com
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						<span id="conf-certmap-for-ad-map_conf-certmap-idm"><!--Empty--></span>
					</p></section></section></section><section class="section" id="configuring_certificate_mapping_if_ad_is_configured_to_map_user_certificates_to_user_accounts"><div class="titlepage"><div><div><h2 class="title">21.4. Configuring certificate mapping if AD is configured to map user certificates to user accounts</h2></div></div></div><p>
				This user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD and the user entry in AD contains certificate mapping data.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user does not have an account in IdM.
					</li><li class="listitem">
						The user has an account in AD which contains the <code class="literal">altSecurityIdentities</code> attribute, the AD equivalent of the IdM <code class="literal">certmapdata</code> attribute.
					</li><li class="listitem">
						The IdM administrator has access to data on which the IdM certificate mapping rule can be based.
					</li></ul></div><p>
				<span id="add-ad-maprule_conf-certmap-for-ad-map"><!--Empty--></span>
			</p><section class="section" id="adding_a_certificate_mapping_rule_if_the_trusted_ad_domain_is_configured_to_map_user_certificates"><div class="titlepage"><div><div><h3 class="title">21.4.1. Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates</h3></div></div></div><p>
					<span id="proc-add-ad-maprule-webui_conf-certmap-for-ad-map"><!--Empty--></span>
				</p><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_web_ui_3"><div class="titlepage"><div><div><h4 class="title">21.4.1.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Log into the IdM web UI as an administrator.
							</li><li class="listitem">
								Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
							</li><li class="listitem"><p class="simpara">
								Click <code class="literal">Add</code>.
							</p><div class="figure" id="conf-certmap-for-ad-map-new-certmaprule-add-ad-map"><p class="title"><strong>Figure 21.7. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="new-certmaprule-add.png" alt="new certmaprule add"/></div></div></div></li><li class="listitem">
								Enter the rule name.
							</li><li class="listitem"><p class="simpara">
								Enter the mapping rule. For example, to make AD DC search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented, and base its decision to authenticate or not on the information found in these two entries of the presented certificate:
							</p><pre class="literallayout"><span class="strong strong"><strong>(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate users to IdM:
							</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the domain:
							</p><pre class="literallayout"><span class="strong strong"><strong>ad.example.com</strong></span></pre><div class="figure" id="conf-certmap-for-ad-map-certmaprule-add-details-ad-map"><p class="title"><strong>Figure 21.8. Certificate mapping rule if AD is configured for mapping</strong></p><div class="figure-contents"><div class="mediaobject"><img src="certmaprule-add-details-ad-map.png" alt="certmaprule add details ad map"/></div></div></div></li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI::
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						<span id="proc-add-ad-maprule-cli_conf-certmap-for-ad-map"><!--Empty--></span>
					</p></section><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_cli_3"><div class="titlepage"><div><div><h4 class="title">21.4.1.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the administrator’s credentials:
							</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the mapping rule and the matching rule the mapping rule is based on. For example, to make AD search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented, and only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add ad_configured_for_mapping_rule --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})' --domain=ad.example.com</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "ad_configured_for_mapping_rule"
-------------------------------------------------------
  Rule name: ad_configured_for_mapping_rule
  Mapping rule: (altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})
  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com
  Domain name: ad.example.com
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						<span id="check-if-ad-maprule-exists_conf-certmap-for-ad-map"><!--Empty--></span>
					</p></section></section><section class="section" id="checking_certificate_mapping_data_on_the_ad_side"><div class="titlepage"><div><div><h3 class="title">21.4.2. Checking certificate mapping data on the AD side</h3></div></div></div><p>
					The <code class="literal">altSecurityIdentities</code> attribute is the Active Directory (AD) equivalent of <code class="literal">certmapdata</code> user attribute in IdM. When configuring certificate mapping in IdM in the scenario when a trusted AD domain is configured to map user certificates to user accounts, the IdM system administrator needs to check that the <code class="literal">altSecurityIdentities</code> attribute is set correctly in the user entries in AD.
				</p><p>
					To check that AD contains the right information for the user stored in AD, use the <code class="literal">ldapsearch</code> command.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							For example, to check with the <code class="literal">adserver.ad.example.com</code> server that the <code class="literal">altSecurityIdentities</code> attribute is set in the user entry of <code class="literal">ad_user</code> and that the matchrule stipulates that the certificate that <code class="literal">ad_user</code> uses to authenticate to AD was issued by <code class="literal">AD-ROOT-CA</code> of the <code class="literal">ad.example.com</code> domain and that the subject is <code class="literal">&lt;S&gt;DC=com,DC=example,DC=ad,CN=Users,CN=ad_user</code>:
						</p><pre class="literallayout"><span class="strong strong"><strong>$ ldapsearch -o ldif-wrap=no -LLL -h adserver.ad.example.com</strong></span> \
<span class="strong strong"><strong>-p 389 -D cn=Administrator,cn=users,dc=ad,dc=example,dc=com</strong></span> \
<span class="strong strong"><strong>-W -b cn=users,dc=ad,dc=example,dc=com "(cn=ad_user)"</strong></span> \
<span class="strong strong"><strong>altSecurityIdentities</strong></span>
Enter LDAP Password:
dn: CN=ad_user,CN=Users,DC=ad,DC=example,DC=com
altSecurityIdentities: X509:&lt;I&gt;DC=com,DC=example,DC=ad,CN=AD-ROOT-CA&lt;S&gt;DC=com,DC=example,DC=ad,CN=Users,CN=ad_user</pre></li></ul></div></section></section><section class="section" id="conf-certmap-ad-no-cert-no-map"><div class="titlepage"><div><div><h2 class="title">21.5. Configuring certificate mapping if AD user entry contains no certificate or mapping data</h2></div></div></div><p>
				This user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD and the user entry in AD contains neither the whole certificate nor certificate mapping data.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user does not have an account in IdM.
					</li><li class="listitem">
						The user has an account in AD which contains neither the whole certificate nor the <code class="literal">altSecurityIdentities</code> attribute, the AD equivalent of the IdM <code class="literal">certmapdata</code> attribute.
					</li><li class="listitem">
						The IdM administrator has the whole AD user certificate to add to the AD user’s <code class="literal">user ID override</code> in IdM.
					</li></ul></div><p>
				<span id="add-certmaprule-ad-no-cert-no-map_conf-certmap-ad-no-cert-no-map"><!--Empty--></span>
			</p><section class="section" id="adding_a_certificate_mapping_rule_if_the_ad_user_entry_contains_no_certificate_or_mapping_data"><div class="titlepage"><div><div><h3 class="title">21.5.1. Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</h3></div></div></div><p>
					<span id="proc-add-certmaprule-ad-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map"><!--Empty--></span>
				</p><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_web_ui_4"><div class="titlepage"><div><div><h4 class="title">21.5.1.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Log into the IdM web UI as an administrator.
							</li><li class="listitem">
								Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
							</li><li class="listitem"><p class="simpara">
								Click <code class="literal">Add</code>.
							</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-new-certmaprule-add-ad-no-cert-no-map"><p class="title"><strong>Figure 21.9. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="new-certmaprule-add.png" alt="new certmaprule add"/></div></div></div></li><li class="listitem">
								Enter the rule name.
							</li><li class="listitem"><p class="simpara">
								Enter the mapping rule. To have the whole certificate that is presented to IdM for authentication compared to the certificate stored in the user ID override entry of the AD user entry in IdM:
							</p><pre class="literallayout"><span class="strong strong"><strong>(userCertificate;binary={cert!bin})</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
							</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the domain name. For example, to search for users in the <code class="literal">ad.example.com</code> domain:
							</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-certmaprule-add-details-ad-no-cert-no-map"><p class="title"><strong>Figure 21.10. Certificate mapping rule for a user with no certificate or mapping data stored in AD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="certmaprule-add-details-ad-cert.png" alt="certmaprule add details ad cert"/></div></div></div></li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI:
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						<span id="proc-add-certmaprule-ad-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map"><!--Empty--></span>
					</p></section><section class="section" id="adding_a_certificate_mapping_rule_in_the_idm_cli_4"><div class="titlepage"><div><div><h4 class="title">21.5.1.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the administrator’s credentials:
							</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enter the mapping rule and the matching rule the mapping rule is based on. To have the whole certificate that is presented for authentication compared to the certificate stored in the user ID override entry of the AD user entry in IdM, only allowing certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add <code class="literal">simpleADrule</code> --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(userCertificate;binary={cert!bin})' --domain ad.example.com</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "simpleADrule"
-------------------------------------------------------
  Rule name: simpleADrule
  Mapping rule: (userCertificate;binary={cert!bin})
  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com
  Domain name: ad.example.com
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
								The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
						<span id="add-certmapdata-no-cert-no-map_conf-certmap-ad-no-cert-no-map"><!--Empty--></span>
					</p></section></section><section class="section" id="adding_a_certificate_to_an_ad_user_s_id_override_if_the_user_entry_in_ad_contains_no_certificate_or_mapping_data"><div class="titlepage"><div><div><h3 class="title">21.5.2. Adding a certificate to an AD user’s ID override if the user entry in AD contains no certificate or mapping data</h3></div></div></div><p>
					<span id="proc-add-certmapdata-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map"><!--Empty--></span>
				</p><section class="section" id="adding_a_certificate_to_an_ad_user_s_id_override_in_the_idm_web_ui"><div class="titlepage"><div><div><h4 class="title">21.5.2.1. Adding a certificate to an AD user’s ID override in the IdM web UI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Navigate to <code class="literal">Identity</code> → <code class="literal">ID Views</code> → <code class="literal">Default Trust View</code>.
							</li><li class="listitem"><p class="simpara">
								Click <code class="literal">Add</code>.
							</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-new-useridoverride-add"><p class="title"><strong>Figure 21.11. Adding a new user ID override in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="new-useridoverride-add.png" alt="new useridoverride add"/></div></div></div></li><li class="listitem">
								In the <code class="literal">User to override</code> field, enter <code class="literal">ad_user@ad.example.com</code>.
							</li><li class="listitem"><p class="simpara">
								Copy and paste the certificate of <code class="literal">ad_user</code> into the <code class="literal">Certificate</code> field.
							</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-useridoverride-add-details"><p class="title"><strong>Figure 21.12. Configuring the User ID override for an AD user</strong></p><div class="figure-contents"><div class="mediaobject"><img src="useridoverride-add-details.png" alt="useridoverride add details"/></div></div></div></li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li><li class="listitem"><p class="simpara">
								Optionally, verify that the user and certificate are linked:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">ad_user@ad.example.com</code> in the SSSD cache and force a reload of the <code class="literal">ad_user@ad.example.com</code> information:
									</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u ad_user@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the AD user:
									</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match ad_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: AD.EXAMPLE.COM
 User logins: ad_user@ad.example.com
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
										The output confirms that you have certificate mapping data added to <code class="literal">ad_user@ad.example.com</code> and that a corresponding mapping rule defined in <a class="link" href="index%3Flb_target=stage.html#add-certmaprule-ad-no-cert-no-map_conf-certmap-ad-no-cert-no-map">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">ad_user@ad.example.com</code>.
									</p></li></ol></div></li></ol></div><p>
						<span id="proc-add-certmapdata-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map"><!--Empty--></span>
					</p></section><section class="section" id="adding_a_certificate_to_an_ad_user_s_id_override_in_the_idm_cli"><div class="titlepage"><div><div><h4 class="title">21.5.2.2. Adding a certificate to an AD user’s ID override in the IdM CLI</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Obtain the administrator’s credentials:
							</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
								Add the certificate of <code class="literal">ad_user@ad.example.com</code> to the user account using the <code class="literal">ipa idoverrideuser-add-cert</code> command:
							</p><pre class="literallayout"># <span class="strong strong"><strong>CERT=`cat ad_user_cert.pem | tail -n +2| head -n -1 | tr -d '\r\n'\`</strong></span>
# <span class="strong strong"><strong>ipa idoverrideuser-add-cert ad_user@ad.example.com --certificate $CERT</strong></span></pre></li><li class="listitem"><p class="simpara">
								Optionally, verify that the user and certificate are linked:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">ad_user@ad.example.com</code> in the SSSD cache and force a reload of the <code class="literal">ad_user@ad.example.com</code> information:
									</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u ad_user@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
										Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the AD user:
									</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match ad_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: AD.EXAMPLE.COM
 User logins: ad_user@ad.example.com
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
										The output confirms that you have certificate mapping data added to <code class="literal">ad_user@ad.example.com</code> and that a corresponding mapping rule defined in <a class="link" href="index%3Flb_target=stage.html#add-certmaprule-ad-no-cert-no-map_conf-certmap-ad-no-cert-no-map">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">ad_user@ad.example.com</code>.
									</p></li></ol></div></li></ol></div><p>
						<span id="sc-cert-mapping-rule-examples_conf-certmap-ad-no-cert-no-map"><!--Empty--></span>
					</p></section></section></section><section class="section" id="combining_several_identity_mapping_rules_into_one"><div class="titlepage"><div><div><h2 class="title">21.6. Combining several identity mapping rules into one</h2></div></div></div><p>
				To combine several identity mapping rules into one combined rule, use the <code class="literal">|</code> (or) character to precede the individual mapping rules, and separate them using <code class="literal">()</code> brackets, for example:
			</p><div class="formalpara"><p class="title"><strong>Certificate mapping filter example 1</strong></p><p>
					
<pre class="literallayout">$ <span class="strong strong"><strong>ipa certmaprule-add ad_cert_for_ipa_and_ad_users \ --maprule='(|(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}))' \ --matchrule='&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' \ --domain=ad.example.com</strong></span></pre>

				</p></div><p>
				In the above example, the filter definition in the <code class="literal option">--maprule</code> option includes these criteria:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">ipacertmapdata</code> attribute in an IdM user account, as described in <a class="link" href="index%3Flb_target=stage.html#proc-add-maprule_conf-certmap-for-users-in-idm">Adding a certificate mapping rule in IdM</a>
					</li><li class="listitem">
						<code class="literal">altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">altSecurityIdentities</code> attribute in an AD user account, as described in <a class="link" href="index%3Flb_target=stage.html#add-ad-maprule_conf-certmap-for-ad-map">Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates</a>
					</li><li class="listitem">
						The addition of the <code class="literal">--domain=ad.example.com</code> option means that users mapped to a given certificate are not only searched in the local <code class="literal">idm.example.com</code> domain but also in the <code class="literal">ad.example.com</code> domain
					</li></ul></div><p>
				The filter definition in the <code class="literal option">--maprule</code> option accepts the logical operator <code class="literal">|</code> (or), so that you can specify multiple criteria. In this case, the rule maps all user accounts that meet at least one of the criteria.
			</p><div class="formalpara"><p class="title"><strong>Certificate mapping filter example 2</strong></p><p>
					
<pre class="literallayout">$ <span class="strong strong"><strong>ipa certmaprule-add ipa_cert_for_ad_users</strong></span> \
  <span class="strong strong"><strong>--maprule='(|(userCertificate;binary={cert!bin})(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}))'</strong></span> \
  <span class="strong strong"><strong>--matchrule='&lt;ISSUER&gt;CN=Certificate Authority,O=REALM.EXAMPLE.COM'</strong></span> \
  <span class="strong strong"><strong>--domain=idm.example.com --domain=ad.example.com</strong></span></pre>

				</p></div><p>
				In the above example, the filter definition in the <code class="literal option">--maprule</code> option includes these criteria:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">userCertificate;binary={cert!bin}</code> is a filter that returns user entries that include the whole certificate. For AD users, creating this type of filter is described in detail in <a class="link" href="index%3Flb_target=stage.html#add-certmaprule-ad-no-cert-no-map_conf-certmap-ad-no-cert-no-map">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</a>.
					</li><li class="listitem">
						<code class="literal">ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">ipacertmapdata</code> attribute in an IdM user account, as described in <a class="link" href="index%3Flb_target=stage.html#proc-add-maprule_conf-certmap-for-users-in-idm">Adding a certificate mapping rule in IdM</a>.
					</li><li class="listitem">
						<code class="literal">altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">altSecurityIdentities</code> attribute in an AD user account, as described in <a class="link" href="index%3Flb_target=stage.html#add-ad-maprule_conf-certmap-for-ad-map">Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates</a>.
					</li></ul></div><p>
				The filter definition in the <code class="literal option">--maprule</code> option accepts the logical operator <code class="literal">|</code> (or), so that you can specify multiple criteria. In this case, the rule maps all user accounts that meet at least one of the criteria.
			</p></section></section><section class="chapter" id="dc-web-ui-auth_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 22. Configuring authentication with a certificate stored on the desktop of an IdM client</h1></div></div></div><p>
			By configuring Identity Management (IdM), IdM system administrators can enable users to authenticate to the IdM web UI and command-line interface (CLI) using a certificate that a Certificate Authority (CA) has issued to the users.
		</p><p>
			The web browser can run on a system that is not part of the IdM domain.
		</p><p>
			This user story provides instructions on how to effectively configure and test logging into Identity Management web UI and CLI with a certificate stored on the desktop of an IdM client. In following this user story,
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					you can skip <a class="xref" href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="22.2. Requesting a new user certificate and exporting it to the client">Section 22.2, “Requesting a new user certificate and exporting it to the client”</a> if the user you want to authenticate using a certificate already has a certificate;
				</li><li class="listitem">
					you can skip <a class="xref" href="index%3Flb_target=stage.html#making-sure-cert-and-user-are-linked-idm" title="22.3. Making sure the certificate and user are linked together">Section 22.3, “Making sure the certificate and user are linked together”</a> if the user’s certificate has been issued by the IdM CA.
				</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Only Identity Management users can log into the web UI using a certificate. Active Directory users can log in with their user name and password.
			</p></div></div><p>
			<span id="cert-idm-users-auth-preparing-the-server_dc-web-ui-auth"><!--Empty--></span>
		</p><section class="section" id="configuring_the_identity_management_server_for_certificate_authentication_in_the_web_ui"><div class="titlepage"><div><div><h2 class="title">22.1. Configuring the Identity Management Server for Certificate Authentication in the Web UI</h2></div></div></div><p>
				As an Identity Management (IdM) administrator, you can allow users to use certificates to authenticate to your IdM environment.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					As the Identity Management administrator:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On an Identity Management server, obtain administrator privileges and create a shell script to configure the server.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Run the <code class="literal command">ipa-advise config-server-for-smart-card-auth</code> command, and save its output to a file, for example <code class="literal replaceable">server_certificate_script.sh</code>:
							</p><pre class="literallayout"># kinit admin
# ipa-advise config-server-for-smart-card-auth &gt; <code class="literal replaceable">server_certificate_script.sh</code></pre></li><li class="listitem"><p class="simpara">
								Add execute permissions to the file using the <code class="literal">chmod</code> utility:
							</p><pre class="literallayout"># chmod +x <code class="literal replaceable">server_certificate_script.sh</code></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						On all the servers in the Identity Management domain, run the <code class="literal replaceable">server_certificate_script.sh</code> script
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								with the path of the IdM Certificate Authority certificate, <code class="literal filename">/etc/ipa/ca.crt</code>, as input if the IdM CA is the only certificate authority that has issued the certificates of the users you want to enable certificate authentication for:
							</p><pre class="literallayout"># <code class="literal replaceable">./server_certificate_script.sh</code> <code class="literal filename">/etc/ipa/ca.crt</code></pre></li><li class="listitem"><p class="simpara">
								with the paths leading to the relevant CA certificates as input if different external CAs signed the certificates of the users who you want to enable certificate authentication for:
							</p><pre class="literallayout"># <code class="literal replaceable">./server_certificate_script.sh</code> <code class="literal replaceable">/tmp/ca1.pem</code> <code class="literal replaceable">/tmp/ca2.pem</code></pre></li></ol></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Do not forget to run the script on each new replica that you add to the system in the future if you want to have certificate authentication for users enabled in the whole topology.
				</p></div></div></section><section class="section" id="requesting-and-exporting-a-user-certificate_dc-web-ui-auth"><div class="titlepage"><div><div><h2 class="title">22.2. Requesting a new user certificate and exporting it to the client</h2></div></div></div><p>
				As an Identity Management (IdM) administrator, you can create certificates for users in your IdM environment and export them to the IdM clients on which you want to enable certificate authentication for users.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can skip this section if the user you want to authenticate using a certificate already has a certificate.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, create a new directory, for example <code class="literal replaceable">~/certdb/</code>, and make it a temporary certificate database. When asked, create an NSS Certificate DB password to encrypt the keys to the certificate to be generated in a subsequent step:
					</p><pre class="literallayout"># mkdir <code class="literal replaceable">~/certdb/</code>
# certutil -N -d <code class="literal replaceable">~/certdb/</code>
Enter a password which will be used to encrypt your keys.
The password should be at least 8 characters long,
and should contain at least one non-alphabetic character.

Enter new password:
Re-enter password:</pre></li><li class="listitem"><p class="simpara">
						Create the certificate signing request (CSR) and redirect the output to a file. For example, to create a CSR with the name <code class="literal replaceable">certificate_request.csr</code> for a <code class="literal replaceable">4096</code> bit certificate for the <code class="literal replaceable">idm_user</code> user in the <code class="literal replaceable">IDM.EXAMPLE.COM</code> realm, setting the nickname of the certificate private keys to <code class="literal replaceable">idm_user</code> for easy findability, and setting the subject to <code class="literal replaceable">CN=idm_user,O=IDM.EXAMPLE.COM</code>:
					</p><pre class="literallayout"># certutil -R -d <code class="literal replaceable">~/certdb/</code> -a -g <code class="literal replaceable">4096</code> -n <code class="literal replaceable">idm_user</code> -s "CN=<code class="literal replaceable">idm_user</code>,O=IDM.EXAMPLE.COM" &gt; <code class="literal replaceable">certificate_request.csr</code></pre></li><li class="listitem"><p class="simpara">
						When prompted, enter the same password that you entered when using <code class="literal systemitem">certutil</code> to create the temporary database. Then continue typing randlomly until told to stop:
					</p><pre class="literallayout">Enter Password or Pin for "NSS Certificate DB":

A random seed must be generated that will be used in the
creation of your key.  One of the easiest ways to create a
random seed is to use the timing of keystrokes on a keyboard.

To begin, type keys on the keyboard until this progress meter
is full.  DO NOT USE THE AUTOREPEAT FUNCTION ON YOUR KEYBOARD!


Continue typing until the progress meter is full:</pre></li><li class="listitem"><p class="simpara">
						Submit the certificate request file to the server. Specify the Kerberos principal to associate with the newly-issued certificate, the output file to store the certificate, and optionally the certificate profile. For example, to obtain a certificate of the <code class="literal replaceable">IECUserRoles</code> profile, a profile with added user roles extension, for the <code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> principal, and save it in the <code class="literal replaceable">~/idm_user.pem</code> file:
					</p><pre class="literallayout"># ipa cert-request <code class="literal replaceable">certificate_request.csr</code> --principal=<code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> --profile-id=<code class="literal replaceable">IECUserRoles</code> --certificate-out=<code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Add the certificate to the NSS database. Use the <code class="literal option">-n</code> option to set the same nickname that you used when creating the CSR previously so that the certificate matches the private key in the NSS database. The <code class="literal option">-t</code> option sets the trust level. For details, see the certutil(1) man page. The <code class="literal option">-i</code> option specifies the input certificate file. For example, to add to the NSS database a certificate with the <code class="literal replaceable">idm_user</code> nickname that is stored in the <code class="literal replaceable">~/idm_user.pem</code> file in the <code class="literal replaceable">~/certdb/</code> database:
					</p><pre class="literallayout"># certutil -A -d <code class="literal replaceable">~/certdb/</code> -n <code class="literal replaceable">idm_user</code> -t "P,," -i <code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Verify that the key in the NSS database does not show <code class="literal replaceable">(orphan)</code> as its nickname. For example, to verify that the certificate stored in the <code class="literal replaceable">~/certdb/</code> database is not orphaned:
					</p><pre class="literallayout"># certutil -K -d <code class="literal replaceable">~/certdb/</code>
&lt; 0&gt; rsa      5ad14d41463b87a095b1896cf0068ccc467df395   <span class="strong strong"><strong>NSS Certificate DB:idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal command">pk12util</code> command to export the certificate from the NSS database to the PKCS12 format. For example, to export the certificate with the <code class="literal replaceable">idm_user</code> nickname from the <code class="literal filename">/root/certdb</code> NSS database into the <code class="literal replaceable">~/idm_user.p12</code> file:
					</p><pre class="literallayout"># pk12util -d <code class="literal filename">~/certdb</code> -o <code class="literal replaceable">~/idm_user.p12</code> -n <code class="literal replaceable">idm_user</code>
Enter Password or Pin for "NSS Certificate DB":
Enter password for PKCS12 file:
Re-enter password:
pk12util: PKCS12 EXPORT SUCCESSFUL</pre></li><li class="listitem"><p class="simpara">
						Transfer the certificate to the host on which you want the certificate authentication for <code class="literal replaceable">idm_user</code> to be enabled:
					</p><pre class="literallayout"># scp <code class="literal replaceable">~/idm_user.p12</code> <code class="literal replaceable">idm_user@client.idm.example.com:/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						On the host to which the certificate has been transferred, make the directory in which the .pkcs12 file is stored inaccessible to the 'other' group for security reasons:
					</p><pre class="literallayout"># chmod o-rwx <code class="literal replaceable">/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						For security reasons, remove the temporary NSS database and the .pkcs12 file from the server:
					</p><pre class="literallayout"># rm <code class="literal replaceable">~/certdb/</code>
# rm <code class="literal replaceable">~/idm_user.p12</code></pre></li></ol></div></section><section class="section" id="making-sure-cert-and-user-are-linked-idm"><div class="titlepage"><div><div><h2 class="title">22.3. Making sure the certificate and user are linked together</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can skip this section if the user’s certificate has been issued by the IdM CA.
				</p></div></div><p>
				For certificate authentication to work, you need to make sure that the certificate is linked to the user that will use it to authenticate to Identity Management (IdM).
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If the certificate is provided by a Certificate Authority that is not part of your Identity Management environment, link the user and the certificate following the procedure described in <a class="link" href="index%3Flb_target=stage.html#adding_certificate_mapping_data_to_a_user_entry_in_idm" title="21.2.2. Adding certificate mapping data to a user entry in IdM">Linking User Accounts to Certificates</a>.
					</li><li class="listitem">
						If the certificate is provided by Identity Management CA, the certificate is already automatically added in the user entry and you do not have to link the certificate to the user account. For details on creating a new certificate in IdM, see <a class="xref" href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="22.2. Requesting a new user certificate and exporting it to the client">Section 22.2, “Requesting a new user certificate and exporting it to the client”</a>.
					</li></ul></div></section><section class="section" id="configuring-browser-for-cert-auth_dc-web-ui-auth"><div class="titlepage"><div><div><h2 class="title">22.4. Configuring a browser to enable certificate authentication</h2></div></div></div><p>
				To be able to authenticate with a certificate when using the WebUI to log into Identity Management (IdM), you need to import the user and the relevant certificate authority (CA) certificates into the Mozilla Firefox or Google Chrome browser. The host itself on which the browser is running does not have to be part of the IdM domain.
			</p><p>
				IdM supports the following browsers for connecting to the WebUI:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mozilla Firefox 38 and later
					</li><li class="listitem">
						Google Chrome 46 and later
					</li></ul></div><p>
				The following procedure shows how to configure the Mozilla Firefox 57.0.1 browser.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the <a class="link" href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="22.2. Requesting a new user certificate and exporting it to the client">user certificate</a> that you want to import to the browser at your disposal in the PKCS#12 format.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open Firefox, then navigate to <code class="literal gui">Preferences</code> → <code class="literal gui">Privacy &amp; Security</code>.
					</p><div class="figure" id="privacy-security_dc-web-ui-auth"><p class="title"><strong>Figure 22.1. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="privacy_and_security.png" alt="privacy and security"/></div></div></div></li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">View Certificates</span>.
					</p><div class="figure" id="view-certificates_dc-web-ui-auth"><p class="title"><strong>Figure 22.2. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="view_certificates.png" alt="view certificates"/></div></div></div></li><li class="listitem">
						In the <code class="literal gui">Your Certificates</code> tab, click <span class="guibutton">Import</span>. Locate and open the certificate of the user in the PKCS12 format, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
					</li><li class="listitem"><p class="simpara">
						Make sure that the Identity Management Certificate Authority is recognized by Firefox as a trusted authority:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Save the IdM CA certificate locally:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Navigate to the IdM web UI by writing the name of your IdM server in the Firefox address bar. Click <code class="literal gui">Advanced</code> on the Insecure Connection warning page.
									</p><div class="figure" id="connection-not-secure-idm_dc-web-ui-auth"><p class="title"><strong>Figure 22.3. Insecure Connection</strong></p><div class="figure-contents"><div class="mediaobject"><img src="connection-not-secure-idm.png" alt="connection not secure idm"/></div></div></div></li><li class="listitem"><p class="simpara">
										<code class="literal gui">Add Exception</code>. Click <code class="literal gui">View</code>.
									</p><div class="figure" id="view-ca-certificate-idm_dc-web-ui-auth"><p class="title"><strong>Figure 22.4. View the Details of a Certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="view-ca-certificate-idm.png" alt="view ca certificate idm"/></div></div></div></li><li class="listitem"><p class="simpara">
										In the <code class="literal gui">Details</code> tab, highlight the <code class="literal gui">Certificate Authority</code> fields.
									</p><div class="figure" id="exporting-ca-cert-idm_dc-web-ui-auth"><p class="title"><strong>Figure 22.5. Exporting the CA Certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="exporting-ca-cert-idm.png" alt="exporting ca cert idm"/></div></div></div></li><li class="listitem">
										Click <span class="guibutton">Export</span>. Save the CA certificate, for example as the <code class="literal filename">CertificateAuthority.crt</code> file, then click <span class="guibutton">Close</span>, and <span class="guibutton">Cancel</span>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Import the IdM CA certificate to Firefox as a trusted certificate authority certificate:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Open Firefox, navigate to Preferences and click <span class="guibutton">Privacy &amp; Security</span>.
									</p><div class="figure" id="privacy-security-2_dc-web-ui-auth"><p class="title"><strong>Figure 22.6. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="privacy_and_security.png" alt="privacy and security"/></div></div></div></li><li class="listitem"><p class="simpara">
										Click <span class="guibutton">View Certificates</span>.
									</p><div class="figure" id="view-certificates-2_dc-web-ui-auth"><p class="title"><strong>Figure 22.7. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="view_certificates.png" alt="view certificates"/></div></div></div></li><li class="listitem">
										In the <code class="literal gui">Authorities</code> tab, click <span class="guibutton">Import</span>. Locate and open the CA certificate that you saved in the previous step in the <code class="literal filename">CertificateAuthority.crt</code> file. Trust the certificate to identify websites, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
									</li></ul></div></li></ol></div></li><li class="listitem">
						Continue to <a class="link" href="index%3Flb_target=stage.html#cert-idm-users-auth-procedure_dc-web-ui-auth">Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User</a>.
					</li></ol></div><p>
				<span id="cert-idm-users-auth-procedure_dc-web-ui-auth"><!--Empty--></span>
			</p></section><section class="section" id="authenticating_to_the_identity_management_web_ui_with_a_certificate_as_an_identity_management_user"><div class="titlepage"><div><div><h2 class="title">22.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User</h2></div></div></div><p>
				This procedure describes authenticating as a user to the Identity Management (IdM) web UI using a certificate stored on the desktop of an Identity Management client.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the browser, navigate to the Identity Management web UI at, for example, <code class="literal">https:</code>//<code class="literal">server.idm.example.com/ipa/ui</code>.
					</li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">Login Using Certificate</span>.
					</p><p class="simpara">
						<span id="fig.cert-login_dc-web-ui-auth"><!--Empty--></span> .<span class="guibutton">Login Using Certificate</span> in the Identity Management web UI
					</p><div class="informalfigure"><div class="mediaobject"><img src="smart_card_login.png" alt="smart card login"/></div></div></li><li class="listitem">
						The user’s certificate should already be selected. Uncheck <span class="guibutton">Remember this decision</span>, then click <span class="guibutton">OK</span>.
					</li></ol></div><p>
				You are now authenticated as the user who corresponds to the certificate.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For information about authenticating to the IdM web UI using a certificate stored on a smart card, see
					</li></ul></div></section><section class="section" id="authenticating-idm-cli-user-certificate_dc-web-ui-auth"><div class="titlepage"><div><div><h2 class="title">22.6. Configuring an IdM client to enable authenticating to the CLI using a certificate</h2></div></div></div><p>
				To make certificate authentication work for an IdM user in the Command Line Interface (CLI) of your IdM client, import the IdM user’s certificate and the private key to the IdM client. For details on creating and transferring the user certificate, see <a class="xref" href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="22.2. Requesting a new user certificate and exporting it to the client">Section 22.2, “Requesting a new user certificate and exporting it to the client”</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Log into the IdM client and have the .p12 file containing the user’s certificate and the private key ready. To obtain and cache the Kerberos ticket granting ticket (TGT), run the <code class="literal command">kinit</code> command with the user’s principal, using the <code class="literal replaceable">-X</code> option with the <code class="literal replaceable">X509_username:/path/to/file.p12</code> attribute to specify where to find the user’s X509 identity information. For example, to obtain the TGT for <code class="literal replaceable">idm_user</code> using the user’s identity information stored in the <code class="literal replaceable">~/idm_user.p12</code> file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit -X X509_idm_user='PKCS12:~/idm_user.p12' idm_user</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The command also supports the .pem file format: <span class="strong strong"><strong>kinit -X X509_username='FILE:/path/to/cert.pem,/path/to/key' user_principal</strong></span>
						</p></div></div></li></ul></div></section></section><section class="chapter" id="ipa-ca-renewal_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 23. Using IdM CA renewal master</h1></div></div></div><section class="section" id="ca-renewal-master_ipa-ca-renewal"><div class="titlepage"><div><div><h2 class="title">23.1. Explanation of IdM CA renewal master</h2></div></div></div><p>
				In an Identity Management (IdM) deployment that uses an embedded certificate authority (CA), the CA renewal master server maintains and renews IdM system certificates. It ensures nondisruptive IdM deployments.
			</p><p>
				IdM system certificates include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">IdM CA</code> certificate
					</li><li class="listitem">
						<code class="literal">OCSP</code> signing certificate
					</li><li class="listitem">
						<code class="literal">IdM CA subsystem</code> certificates
					</li><li class="listitem">
						<code class="literal">IdM CA audit signing</code> certificate
					</li><li class="listitem">
						<code class="literal">IdM renewal agent</code> (RA) certificate
					</li><li class="listitem">
						<code class="literal">KRA</code> transport and storage certificates
					</li></ul></div><p>
				What characterizes system certificates is that their keys are shared by all CA replicas. In contrast, the IdM service certificates (for example, <code class="literal">LDAP</code>, <code class="literal">HTTP</code> and <code class="literal">PKINIT</code> certificates), have different keypairs and subject names on different IdM CA servers.
			</p><p>
				In IdM topology, by default, the first master IdM CA server is the CA renewal master.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In upstream documentation, the IdM CA is called <code class="literal">Dogtag</code>.
				</p></div></div><h4 id="the_role_of_the_ca_renewal_master_server">The role of the CA renewal master server</h4><p>
				The <code class="literal">IdM CA</code>, <code class="literal">IdM CA subsystem</code>, and <code class="literal">IdM RA</code> certificates are crucial for IdM deployment. Each certificate is stored in an NSS database in the <code class="literal">/etc/pki/pki-tomcat/</code> directory and also as an LDAP database entry. The certificate stored in LDAP must match the certificate stored in the NSS database. If they do not match, authentication failures occur between the IdM framework and IdM CA, and between IdM CA and LDAP.
			</p><p>
				All IdM CA replicas have tracking requests for every system certificate. If an IdM deployment with integrated CA does not contain a CA renewal master, each IdM CA server requests the renewal of system certificates independently. This results in different CA replicas having various system certificates and authentication failures occurring.
			</p><p>
				Appointing one CA replica as the renewal master allows the system certificates to be renewed exactly once, when required, and thus prevents authentication failures.
			</p><h4 id="the_role_of_literal_certmonger_literal_on_ca_replicas">The role of <code class="literal">certmonger</code> on CA replicas</h4><p>
				The <code class="literal">certmonger</code> service running on all IdM CA replicas uses the <code class="literal">dogtag-ipa-ca-renew-agent</code> renewal helper to keep track of IdM system certificates. The renewal helper program reads the CA renewal master configuration. On each CA replica that is not the CA renewal master, the renewal helper programme retrieves the latest system certificates from the <code class="literal">ca_renewal</code> LDAP entries. Due to non-determinism in when exactly <code class="literal">certmonger</code> renewal attempts occur, the <code class="literal">dogtag-ipa-ca-renew-agent</code> helper sometimes attempts to update a system certificate before the CA renewal master has actually renewed the certificate. If this happens, the old, soon-to-expire certificate is returned to the <code class="literal">certmonger</code> on the CA replica. The <code class="literal">certmonger</code>, realizing it is the same certificate that is already stored in its database, keeps attempting to renew the certificate with some delay between individual attempts until it can retrieve the updated certificate from the CA renewal master.
			</p><h4 id="the_correct_functioning_of_idm_ca_renewal_master">The correct functioning of IdM CA renewal master</h4><p>
				An IdM deployment with an embedded CA is an IdM deployment that was installed with an IdM CA - or whose IdM CA master server was installed later. An IdM deployment with an embedded CA must at all times have exactly one CA replica configured as the renewal master. The renewal master server must be online and fully functional, and must replicate properly with the other servers.
			</p><p>
				If the current CA renewal master server is being deleted using the <code class="literal">ipa server-del</code>, <code class="literal">ipa-replica-manage del</code>, <code class="literal">ipa-csreplica-manage del</code> or <code class="literal">ipa-server-install --uninstall</code> commands, a CA replica is automatically assigned as the CA renewal master server. This policy ensures that the renewal master configuration remains valid.
			</p><p>
				This policy does not cover the following situations:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">Offline renewal master</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								If the renewal master is offline for an extended duration, it may miss a renewal window. In this situation, all nonrenewal master servers keep reinstalling the current system certificates until the certificates expire. When this occurs, the IdM deployment is disrupted because even one expired certificate can cause renewal failures for other certificates. To prevent this situation: if your current renewal master is offline and unavailable for an extended period of time, consider <a class="link" href="index%3Flb_target=stage.html#changing-ca-renewal_ipa-ca-renewal" title="23.2. Changing and resetting IdM CA renewal master">assigning a new CA renewal master manually</a>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">Replication problems</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								If replication problems exist between the renewal master and other CA replicas, renewal might succeed, but the other CA replicas might not be able to retrieve the updated certificates before they expire. To prevent this situation, make sure that your replication agreements are working correctly. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/linux_domain_identity_authentication_and_policy_guide/index#trouble-gen-replication">general</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/linux_domain_identity_authentication_and_policy_guide/index#trouble-replica">specific</a> replication troubleshooting guidelines in the RHEL 7 <span class="emphasis"><em>Linux Domain Identity, Authentication, and Policy Guide</em></span>.
							</li></ul></div></li></ul></div></section><section class="section" id="changing-ca-renewal_ipa-ca-renewal"><div class="titlepage"><div><div><h2 class="title">23.2. Changing and resetting IdM CA renewal master</h2></div></div></div><p>
				When a CA renewal master is being decommissioned, IdM automatically selects a new CA renewal master from the list of IdM CA servers. The system administrator cannot influence the selection.
			</p><p>
				To be able to select the new IdM CA renewal master server, the system administrator must perform the replacement manually. Select the master before starting the process of decommissioning the current renewal master.
			</p><p>
				If the current CA renewal master configuration is invalid, reset the IdM CA renewal master.
			</p><p>
				Complete this procedure to change or reset the CA renewal master.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the IdM administrator credentials.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Obtain the IdM administrator credentials:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Optionally, to find out which IdM servers in the deployment have the CA role necessary to be eligible to become the new CA renewal master:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>ipa server-role-find --role 'CA server'</strong></span>
----------------------
2 server roles matched
----------------------
  Server name: server.idm.example.com
  Role name: CA server
  Role status: enabled

  Server name: replica.idm.example.com
  Role name: CA server
  Role status: enabled
----------------------------
Number of entries returned 2
----------------------------</pre><p class="simpara">
						There are two CA servers in the deployment.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, to find out which CA server is the current CA renewal master:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>ipa config-show | grep 'CA renewal master'</strong></span>
  IPA CA renewal master: server.idm.example.com</pre><p class="simpara">
						The current renewal master is <code class="literal">server.idm.example.com</code>.
					</p></li><li class="listitem"><p class="simpara">
						To change the renewal master configuration, use the <code class="literal">ipa config-mod</code> utility with the <code class="literal">--ca-renewal-master-server</code> option:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>ipa config-mod --ca-renewal-master-server replica.idm.example.com | grep 'CA renewal master'</strong></span>
  IPA CA renewal master: replica.idm.example.com</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You can also switch to a new CA renewal master using:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									the <code class="literal">ipa-cacert-manage --renew</code> command. This command both renews the CA certificate <span class="emphasis"><em>and</em></span> makes the CA server on which you execute the command the new CA renewal master.
								</li><li class="listitem"><p class="simpara">
									the <code class="literal">ipa-cert-fix</code> command. This command recovers the deployment when expired certificates are causing failures. It also makes the CA server on which you execute the command the new CA renewal master.
								</p><p class="simpara">
									For details, see <a class="link" href="index%3Flb_target=stage.html#renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline" title="24.1. Renewing expired system certificates on a CA Renewal Master">Renewing expired system certificates when IdM is offline</a>.
								</p></li></ul></div></div></div></li></ol></div></section><section class="section" id="switch-from-externally-to-self-signed-ca_ipa-ca-renewal"><div class="titlepage"><div><div><h2 class="title">23.3. Switching from an externally to self-signed CA in IdM</h2></div></div></div><p>
				Complete this procedure to switch from an externally-signed to a self-signed certificate of the IdM certificate authority (CA). With a self-signed CA, the renewal of the CA certificate is managed automatically: a system administrator does not need to submit a CSR to an external authority.
			</p><p>
				Switching from an externally-signed to a self-signed CA replaces only the CA certificate. The certificates signed by the previous CA are still valid and still in use. For example, the certificate chain for the <code class="literal">LDAP</code> certificate remains unchanged even after you have moved to a self-signed CA:
			</p><pre class="literallayout"><code class="literal">external_CA</code> certificate &gt; <code class="literal">IdM CA</code> certificate &gt; <code class="literal">LDAP</code> certificate</pre><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root access to the IdM CA renewal master.
					</li><li class="listitem">
						You have the IdM administrator credentials.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM CA renewal master, renew the CA certificate as self-signed:
					</p><pre class="literallayout">~]# <span class="strong strong"><strong>ipa-cacert-manage renew --self-signed</strong></span>
Renewing CA certificate, please wait
CA certificate successfully renewed
The ipa-cacert-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						On all the IdM servers and clients, update the local IdM certificate databases with the certificates from the server:
					</p><pre class="literallayout">[client ~]$ <span class="strong strong"><strong>kinit admin</strong></span>
[client ~]$ <span class="strong strong"><strong>ipa-certupdate</strong></span>
Systemwide CA database updated.
Systemwide CA database updated.
The ipa-certupdate command was successful</pre></li><li class="listitem"><p class="simpara">
						Optionally, to check if your update has been successful and the new CA certificate has been added to the <code class="literal">/etc/ipa/ca.crt</code> file:
					</p><pre class="literallayout">[client ~]$ <span class="strong strong"><strong>openssl crl2pkcs7 -nocrl -certfile /etc/ipa/ca.crt | openssl pkcs7 -print_certs -text -noout</strong></span>
[...]
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 39 (0x27)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: O=IDM.EXAMPLE.COM, CN=Certificate Authority
        Validity
            Not Before: Jul  1 16:32:45 2019 GMT
            Not After : Jul  1 16:32:45 2039 GMT
        Subject: O=IDM.EXAMPLE.COM, CN=Certificate Authority
[...]</pre><p class="simpara">
						The output shows that the update has been successful as the new CA certificate is listed with the older CA certificates.
					</p></li></ol></div></section><section class="section" id="renew-with-externally-signed-CA_ipa-ca-renewal"><div class="titlepage"><div><div><h2 class="title">23.4. Renewing the IdM CA renewal master with an externally-signed certificate</h2></div></div></div><p>
				This section describes how to renew the IdM CA certificate using an external certificate authority to sign the certificate signing request (CSR). In this configuration, your IdM CA server is a subCA of the external CA. The external CA can, but does not have to, be an Active Directory Certificate Server (AD CS).
			</p><p>
				If the external certificate authority is AD CS, you can specify the template you want for the IdM CA certificate in the CSR. A certificate template defines the policies and rules that a CA uses when a certificate request is received. Certificate templates in AD correspond to certificate profiles in IdM.
			</p><p>
				You can define a specific AD CS template by its Object Identifier (OID). OIDs are unique numeric values issued by various issuing authorities to uniquely identify data elements, syntaxes, and other parts of distributed applications.
			</p><p>
				Alternatively, you can define a specific AD CS template by its name. For example, the name of the default profile used in a CSR submitted by an IdM CA to an AD CS is <code class="literal">subCA</code>.
			</p><p>
				To define a profile by specifying its OID or name in the CSR, use the <code class="literal">external-ca-profile</code> option. For details, see the <code class="literal">ipa-cacert-manage</code> man page.
			</p><p>
				Apart from using a ready-made certificate template, you can also create a custom certificate template in the AD CS, and use it in the CSR.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root access to the IdM CA renewal master.
					</li><li class="listitem">
						You have the IdM administrator credentials.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					Complete this procedure to renew the certificate of the IdM CA with external signing, regardless of whether current CA certificate is self-signed or externally-signed.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a CSR to be submitted to the external CA:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If the external CA is an AD CS, use the <code class="literal">--external-ca-type=ms-cs</code> option. If you want a different template than the default <code class="literal">subCA</code> template, specify it using the <code class="literal">--external-ca-profile</code> option:
							</p><pre class="literallayout">~]# <code class="literal">ipa-cacert-manage renew --external-ca --external-ca-type=ms-cs [--external-ca-profile=PROFILE]</code>
Exporting CA certificate signing request, please wait
The next step is to get /var/lib/ipa/ca.csr signed by your CA and re-run ipa-cacert-manage as:
ipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate
The ipa-cacert-manage command was successful</pre></li><li class="listitem"><p class="simpara">
								If the external CA is not an AD CS:
							</p><pre class="literallayout">~]# <code class="literal">ipa-cacert-manage renew --external-ca</code>
Exporting CA certificate signing request, please wait
The next step is to get /var/lib/ipa/ca.csr signed by your CA and re-run ipa-cacert-manage as:
ipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate
The ipa-cacert-manage command was successful</pre><p class="simpara">
								The output shows that a CSR has been created and is stored in the <code class="literal">/var/lib/ipa/ca.csr</code> file.
							</p></li></ul></div></li><li class="listitem">
						Submit the CSR located in <code class="literal">/var/lib/ipa/ca.csr</code> to the external CA. The process differs depending on the service to be used as the external CA.
					</li><li class="listitem"><p class="simpara">
						Retrieve the issued certificate and the CA certificate chain for the issuing CA in a base 64-encoded blob, which is:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								a PEM file if the external CA is not an AD CS.
							</li><li class="listitem"><p class="simpara">
								a Base_64 certificate if the external CA is an AD CS.
							</p><p class="simpara">
								The process differs for every certificate service. Usually, a download link on a web page or in the notification email allows the administrator to download all the required certificates.
							</p><p class="simpara">
								If the external CA is an AD CS and you have submitted the CSR with a known template through the Microsoft Windows Certification Authority management window, the AD CS issues the certificate immediately and the Save Certificate dialog appears in the AD CS web interface, asking where to save the issued certificate.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Run the <code class="literal">ipa-cacert-manage renew</code> command again, adding all the CA certificate files required to supply a full certificate chain. Specify as many files as you need, using the <code class="literal">--external-cert-file</code> option multiple times:
					</p><pre class="literallayout">~]# <code class="literal">ipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate_1 --external-cert-file=/path/to/external_ca_certificate_2</code></pre></li><li class="listitem"><p class="simpara">
						On all the IdM servers and clients, update the local IdM certificate databases with the certificates from the server:
					</p><pre class="literallayout">[client ~]$ <span class="strong strong"><strong>kinit admin</strong></span>
[client ~]$ <span class="strong strong"><strong>ipa-certupdate</strong></span>
Systemwide CA database updated.
Systemwide CA database updated.
The ipa-certupdate command was successful</pre></li><li class="listitem"><p class="simpara">
						Optionally, to check if your update has been successful and the new CA certificate has been added to the <code class="literal">/etc/ipa/ca.crt</code> file:
					</p><pre class="literallayout">[client ~]$ <span class="strong strong"><strong>openssl crl2pkcs7 -nocrl -certfile /etc/ipa/ca.crt | openssl pkcs7 -print_certs -text -noout</strong></span>
[...]
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 39 (0x27)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: O=IDM.EXAMPLE.COM, CN=Certificate Authority
        Validity
            Not Before: Jul  1 16:32:45 2019 GMT
            Not After : Jul  1 16:32:45 2039 GMT
        Subject: O=IDM.EXAMPLE.COM, CN=Certificate Authority
[...]</pre><p class="simpara">
						The output shows that the update has been successful as the new CA certificate is listed with the older CA certificates.
					</p></li></ol></div></section></section><section class="chapter" id="renewing-expired-system-certificates-when-idm-is-offline_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 24. Renewing expired system certificates when IdM is offline</h1></div></div></div><p>
			When a system certificate has expired, Identity Management (IdM) fails to start. IdM supports renewing system certificates when IdM is offline using the <code class="literal">ipa-cert-fix</code> tool.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					IdM is installed only on Red Hat Enterprise Linux 8.1 or later
				</li></ul></div><section class="section" id="renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline"><div class="titlepage"><div><div><h2 class="title">24.1. Renewing expired system certificates on a CA Renewal Master</h2></div></div></div><p>
				This section describes how to apply the <code class="literal">ipa-cert-fix</code> tool on expired IdM certificates.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					If you run the <code class="literal">ipa-cert-fix</code> tool on a CA (Certificate Authority) host that is not the CA Renewal Master, and the utility renews shared certificates, that host automatically becomes the new CA Renewal Master in the domain. There must be always only one CA Renewal Master in the domain to avoid inconsistencies.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Log in to the server with administration rights
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Start the <code class="literal">ipa-cert-fix</code> tool to analyze the system and list expired certificates that require renewal:
					</p><pre class="literallayout"># ipa-cert-fix
...
The following certificates will be renewed:

Dogtag sslserver certificate:
  Subject: CN=ca1.example.com,O=EXAMPLE.COM 201905222205
  Serial:  13
  Expires: 2019-05-12 05:55:47
...
Enter "yes" to proceed:</pre></li><li class="listitem"><p class="simpara">
						Enter <code class="literal">yes</code> to start the renewal process:
					</p><pre class="literallayout">Enter "yes" to proceed: yes
Proceeding.
Renewed Dogtag sslserver certificate:
  Subject: CN=ca1.example.com,O=EXAMPLE.COM 201905222205
  Serial:  268369925
  Expires: 2021-08-14 02:19:33
...

Becoming renewal master.
The ipa-cert-fix command was successful</pre><p class="simpara">
						It can take up to one minute before <code class="literal">ipa-cert-fix</code> renews all expired certificates.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, verify that all services are now running:
					</p><pre class="literallayout"># ipactl status
Directory Service: RUNNING
krb5kdc Service: RUNNING
kadmin Service: RUNNING
httpd Service: RUNNING
ipa-custodia Service: RUNNING
pki-tomcatd Service: RUNNING
ipa-otpd Service: RUNNING
ipa: INFO: The ipactl command was successful</pre></li></ol></div><p>
				At this point, certificates have been renewed and services are running. The next step is to check other servers in the IdM domain.
			</p></section><section class="section" id="verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline"><div class="titlepage"><div><div><h2 class="title">24.2. Verifying other IdM servers in the IdM domain after renewal</h2></div></div></div><p>
				After the renewing the CA Renewal Master’s certificates with the <code class="literal">ipa-cert-fix</code> tool, you must:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Restart all other Identity Management (IdM) servers in the domain.
					</li><li class="listitem">
						Check if certmonger renewed certificates.
					</li><li class="listitem">
						If there are other Certificate Authority (CA) replicas with expired system certificates, renew those certificates with the <code class="literal">ipa-cert-fix</code> tool as well.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Log in to the server with administration rights.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Restart IdM with the <code class="literal">--force</code> parameter:
					</p><pre class="literallayout"># ipactl restart --force</pre><p class="simpara">
						With the <code class="literal">--force</code> parameter, the <code class="literal">ipactl</code> utility ignores individual service startup failures. For example, if the server is also a CA with expired certificates, the <code class="literal">pki-tomcat</code> service fails to start. This is expected and ignored because of using the <code class="literal">--force</code> parameter.
					</p></li><li class="listitem"><p class="simpara">
						After the restart, verify that the <code class="literal">certmonger</code> service renewed the certificates (certificate status says MONITORING):
					</p><pre class="literallayout"># getcert list | egrep '^Request|status:|subject:'
Request ID '20190522120745':
        status: MONITORING
        subject: CN=IPA RA,O=EXAMPLE.COM 201905222205
Request ID '20190522120834':
        status: MONITORING
        subject: CN=Certificate Authority,O=EXAMPLE.COM 201905222205
...</pre><p class="simpara">
						It can take some time before <code class="literal">certmonger</code> renews the shared certificates on the replica.
					</p></li><li class="listitem"><p class="simpara">
						If the server is also a CA, the previous command reports <code class="literal">CA_UNREACHABLE</code> for the certificate the <code class="literal">pki-tomcat</code> service uses:
					</p><pre class="literallayout">Request ID '20190522120835':
        status: CA_UNREACHABLE
        subject: CN=ca2.example.com,O=EXAMPLE.COM 201905222205
...</pre></li><li class="listitem"><p class="simpara">
						To renew this certificate, use the <code class="literal">ipa-cert-fix</code> utility:
					</p><pre class="literallayout"># ipa-cert-fix
Dogtag sslserver certificate:
  Subject: CN=ca2.example.com,O=EXAMPLE.COM
  Serial:  3
  Expires: 2019-05-11 12:07:11

Enter "yes" to proceed: yes
Proceeding.
Renewed Dogtag sslserver certificate:
  Subject: CN=ca2.example.com,O=EXAMPLE.COM 201905222205
  Serial:  15
  Expires: 2019-08-14 04:25:05

The ipa-cert-fix command was successful</pre></li></ol></div><p>
				Now, all IdM certificates have been renewed and work correctly.
			</p></section></section><section class="chapter" id="generating-crl-on-the-idm-ca-server_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 25. Generating CRL on the IdM CA server</h1></div></div></div><p>
			If your IdM deployment uses an embedded certificate authority (CA), you may need to move generating the Certificate Revocation List (CRL) from one Identity Management (IdM) server to another. It can be necessary, for example, when you want to migrate the server to another system.
		</p><p>
			Only one server must generate CRL. The CRL generation role is usually co-located with the IdM CA Renewal Master, but this is not mandatory. Before the CRL Generation Master is decommissioned, a new CRL Generation Master must be selected by the administrator and configured.
		</p><p>
			This chapter describes:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Stopping CRL generation on the IdM master.
				</li><li class="listitem">
					Starting to generate CRL on the IdM replica.
				</li></ul></div><section class="section" id="stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server"><div class="titlepage"><div><div><h2 class="title">25.1. Stopping CRL generation on IdM master server</h2></div></div></div><p>
				To stop the Certificate Revocation List (CRL) generation on the IdM master server, use the <code class="literal">ipa-crlgen-manage</code> command. Before you disable the generation, verify that the server really generates CRL. You can then disable it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Identity Management (IdM) server is installed on the RHEL 8.1 system or newer.
					</li><li class="listitem">
						You must be logged in as root.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check if your master server is generating the CRL:
					</p><pre class="literallayout">[root@master ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span>
CRL generation: <span class="strong strong"><strong>enabled</strong></span>
Last CRL update: 2019-10-31 12:00:00
Last CRL Number: 6
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						Stop generating CRL on the master server:
					</p><pre class="literallayout">[root@master ~]# <span class="strong strong"><strong>ipa-crlgen-manage disable</strong></span>
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
CRL generation disabled on the local host. Please make sure to configure CRL generation on another master with ipa-crlgen-manage enable.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						Check if the master server stopped generating CRL:
					</p><pre class="literallayout">[root@master ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span></pre></li></ol></div><p>
				The master server stopped generating CRL. The next step is to enable CRL generation on the new master server.
			</p></section><section class="section" id="starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server"><div class="titlepage"><div><div><h2 class="title">25.2. Starting CRL generation on IdM replica server</h2></div></div></div><p>
				You can start the Certificate Revocation List (CRL) generation with the following command: <code class="literal">ipa-crlgen-manage</code>
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Identity Management (IdM) server is installed on the RHEL 8.1 system or newer.
					</li><li class="listitem">
						The RHEL system must be an IdM Certificate Authority server.
					</li><li class="listitem">
						You must be logged in as root.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To start with generating CRL:
					</p><pre class="literallayout">[root@replica1 ~]# <span class="strong strong"><strong>ipa-crlgen-manage enable</strong></span>
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
Forcing CRL update
CRL generation enabled on the local host. Please make sure to have only a single CRL generation master.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						To check if CRL is generated:
					</p><pre class="literallayout">[root@replica1 ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span>
CRL generation: <span class="strong strong"><strong>enabled</strong></span>
Last CRL update: 2019-10-31 12:10:00
Last CRL Number: 7
The ipa-crlgen-manage command was successful</pre></li></ol></div></section></section><section class="chapter" id="using-certmonger_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 26. Obtaining an IdM certificate for a service using certmonger</h1></div></div></div><section class="section" id="certmonger_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h2 class="title">26.1. Certmonger overview</h2></div></div></div><h4 id="what_literal_certmonger_literal_does">What <code class="literal">certmonger</code> does</h4><p>
				When Identity Management (IdM) is installed with an integrated IdM Certificate Authority (CA), it uses the <code class="literal">certmonger</code> service to track and renew system and service certificates. When the certificate is reaching its expiration date, <code class="literal">certmonger</code> manages the renewal process by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						regenerating a certificate-signing request (CSR) using the options provided in the original request.
					</li><li class="listitem">
						submitting the CSR to the IdM CA using the IdM API <code class="literal">cert-request</code> command.
					</li><li class="listitem">
						receiving the certificate from the IdM CA.
					</li><li class="listitem">
						executing a pre-save command if specified by the original request.
					</li><li class="listitem">
						installing the new certificate in the location specified in the renewal request: either in an <code class="literal">NSS</code> database or in a file.
					</li><li class="listitem">
						executing a post-save command if specified by the original request. For example, the post-save command can instruct <code class="literal">certmonger</code> to restart a relevant service, so that the service picks up the new certificate.
					</li></ul></div><h4 id="types_of_certificates_literal_certmonger_literal_tracks">Types of certificates <code class="literal">certmonger</code> tracks</h4><p>
				Certificates can be divided into system and service certificates.
			</p><p>
				Unlike service certificates (for example, for <code class="literal">HTTP</code>, <code class="literal">LDAP</code> and <code class="literal">PKINIT</code>), which have different keypairs and subject names on different servers, IdM system certificates and their keys are shared by all CA replicas. The IdM system certificates include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">IdM CA</code> certificate
					</li><li class="listitem">
						<code class="literal">OCSP</code> signing certificate
					</li><li class="listitem">
						<code class="literal">IdM CA subsystem</code> certificates
					</li><li class="listitem">
						<code class="literal">IdM CA audit signing</code> certificate
					</li><li class="listitem">
						<code class="literal">IdM renewal agent</code> (RA) certificate
					</li><li class="listitem">
						<code class="literal">KRA</code> transport and storage certificates
					</li></ul></div><p>
				The <code class="literal">certmonger</code> service tracks the IdM system and service certificates that were requested during the installation of IdM environment with an integrated CA. <code class="literal">Certmonger</code> also tracks certificates that have been requested manually by the system administrator for other services running on the IdM host. <code class="literal">Certmonger</code> does not track external certificate authority certificates or user certificates.
			</p><h4 id="certmonger_components">Certmonger components</h4><p>
				The <code class="literal">certmonger</code> service consists of two main components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">certmonger daemon</code>, which is the engine tracking the list of certificates and launching renewal commands
					</li><li class="listitem">
						The <code class="literal">getcert</code> utility for the <code class="literal">command-line interface</code> (CLI), which allows the system administrator to actively send commands to the <code class="literal">certmonger</code> daemon.
					</li></ul></div><p>
				More specifically, the system administrator can use the <code class="literal">getcert</code> utility to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="index%3Flb_target=stage.html#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs" title="26.2. Obtaining an IdM certificate for a service using certmonger">Request a new certificate</a>
					</li><li class="listitem">
						<a class="link" href="index%3Flb_target=stage.html#viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs" title="26.4. Viewing the details of a certificate request tracked by certmonger">View the list of certificates that <code class="literal">certmonger</code> tracks</a>
					</li><li class="listitem">
						<a class="link" href="index%3Flb_target=stage.html#start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs" title="26.5. Starting and stopping certificate tracking">Start or stop tracking a certificate</a>
					</li><li class="listitem">
						<a class="link" href="index%3Flb_target=stage.html#renew-cert_certmonger-for-issuing-renewing-service-certs" title="26.6. Renewing a certificate manually">Renew a certificate</a>
					</li></ul></div></section><section class="section" id="obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h2 class="title">26.2. Obtaining an IdM certificate for a service using certmonger</h2></div></div></div><p>
				To ensure that communication between browsers and the web service running on your IdM client is secure and encrypted, use a TLS certificate. Obtain the TLS certificate for your web service from the IdM CA.
			</p><p>
				This section describes how to use <code class="literal">certmonger</code> to obtain an IdM certificate for a service (<code class="literal">HTTP/my_company.idm.example.com</code>@<code class="literal">IDM.EXAMPLE.COM</code>) running on an IdM client.
			</p><p>
				Using <code class="literal">certmonger</code> to request the certificate automatically means that <code class="literal">certmonger</code> manages and renews the certificate when it is due for a renewal.
			</p><p>
				For a visual representation of what happens when <code class="literal">certmonger</code> requests a service certificate, see <a class="xref" href="index%3Flb_target=stage.html#communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs" title="26.3. Communication flow for certmonger requesting a service certificate">Section 26.3, “Communication flow for certmonger requesting a service certificate”</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The web server is enrolled as an IdM client.
					</li><li class="listitem">
						You have root access to the IdM client on which you are running the procedure.
					</li><li class="listitem">
						The service for which you are requesting a certificate does not have to pre-exist in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the <code class="literal">my_company.idm.example.com</code> IdM client on which the <code class="literal">HTTP</code> service is running, request a certificate for the service corresponding to the <code class="literal">HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</code> principal, and specify that
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The certificate is to be stored in the local <code class="literal">/etc/pki/tls/certs/httpd.pem</code> file
							</li><li class="listitem">
								The private key is to be stored in the local <code class="literal">/etc/pki/tls/private/httpd.key</code> file
							</li><li class="listitem"><p class="simpara">
								That an extensionRequest for a <code class="literal">SubjectAltName</code> be added to the signing request with the DNS name of <code class="literal">my_company.idm.example.com</code>:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert request -K HTTP/my_company.idm.example.com -k /etc/pki/tls/private/httpd.key -f /etc/pki/tls/certs/httpd.pem -D my_company.idm.example.com -C "systemctl restart httpd"</strong></span>
New signing request "20190604065735" added.</pre><p class="simpara">
								In the command above:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <code class="literal">ipa-getcert request</code> command specifies that the certificate is to be obtained from the IdM CA. The <code class="literal">ipa-getcert request</code> command is a shortcut for <code class="literal">getcert request -c IPA</code>.
									</li><li class="listitem">
										The <code class="literal">-C</code> option instructs <code class="literal">certmonger</code> to restart the <code class="literal">httpd</code> service after obtaining the certificate.
									</li><li class="listitem">
										The <code class="literal">-D</code> option specifies the <code class="literal">SubjectAltName</code> DNS value to be added to the request.
									</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										To specify that the certificate be issued with a particular profile, use the <code class="literal">-T</code> option.
									</li><li class="listitem">
										To request a certificate using the named issuer from the specified CA, use the <code class="literal">-X ISSUER</code> option.
									</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									RHEL 8 uses a different SSL module in Apache than the one used in RHEL 7. The SSL module relies on OpenSSL rather than NSS. For this reason, in RHEL 8 you cannot use an NSS database to store the <code class="literal">HTTPS</code> certificate and the private key.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, to check the status of your request:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert list -f /etc/pki/tls/certs/httpd.pem</strong></span>
Number of certificates and requests being tracked: 3.
Request ID '20190604065735':
    status: MONITORING
    stuck: no
    key pair storage: type=FILE,location='/etc/pki/tls/private/httpd.key'
    certificate: type=FILE,location='/etc/pki/tls/certs/httpd.crt'
    CA: IPA
[...]</pre><p class="simpara">
						The output shows that the request is in the <code class="literal">MONITORING</code> status, which means that a certificate has been obtained. The locations of the key pair and the certificate are those requested.
					</p></li></ol></div></section><section class="section" id="communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h2 class="title">26.3. Communication flow for certmonger requesting a service certificate</h2></div></div></div><p>
				The diagrams in this section show the stages of what happens when <code class="literal">certmonger</code> requests a service certificate from IdM CA server. The sequence consists of these diagrams:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1" title="Figure 26.1. Unencrypted communication">Figure 26.1, “Unencrypted communication”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2" title="Figure 26.2. Certmonger requesting a service certificate">Figure 26.2, “Certmonger requesting a service certificate”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3" title="Figure 26.3. IdM CA issuing the service certificate">Figure 26.3, “IdM CA issuing the service certificate”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4" title="Figure 26.4. Certmonger applying the service certificate">Figure 26.4, “Certmonger applying the service certificate”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5" title="Figure 26.5. Certmonger requesting a new certificate when the old one is nearing expiration">Figure 26.5, “Certmonger requesting a new certificate when the old one is nearing expiration”</a>
					</li></ul></div><p>
				<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1" title="Figure 26.1. Unencrypted communication">Figure 26.1, “Unencrypted communication”</a> shows the initial situation: without an HTTPS certificate, the communication between the web server and the browser is unencrypted.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1"><p class="title"><strong>Figure 26.1. Unencrypted communication</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-1.png" alt="Certmonger service cert 1"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2" title="Figure 26.2. Certmonger requesting a service certificate">Figure 26.2, “Certmonger requesting a service certificate”</a> shows the system administrator using <code class="literal">certmonger</code> to manually request an HTTPS certificate for the Apache web server. Note that when requesting a web server certificate, certmonger does not communicate directly with the CA. It proxies through IdM.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2"><p class="title"><strong>Figure 26.2. Certmonger requesting a service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-2.png" alt="Certmonger service cert 2"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3" title="Figure 26.3. IdM CA issuing the service certificate">Figure 26.3, “IdM CA issuing the service certificate”</a> shows an IdM CA issuing an HTTPS certificate for the web server.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3"><p class="title"><strong>Figure 26.3. IdM CA issuing the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-3.png" alt="Certmonger service cert 3"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4" title="Figure 26.4. Certmonger applying the service certificate">Figure 26.4, “Certmonger applying the service certificate”</a> shows <code class="literal">certmonger</code> placing the HTTPS certificate in appropriate locations on the IdM client and, if instructed to do so, restarting the <code class="literal">httpd</code> service. The Apache server subsequently uses the HTTPS certificate to encrypt the traffic between itself and the browser.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4"><p class="title"><strong>Figure 26.4. Certmonger applying the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-4.png" alt="Certmonger service cert 4"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5" title="Figure 26.5. Certmonger requesting a new certificate when the old one is nearing expiration">Figure 26.5, “Certmonger requesting a new certificate when the old one is nearing expiration”</a> shows <code class="literal">certmonger</code> automatically requesting a renewal of the service certificate from the IdM CA before the expiration of the certificate. The IdM CA issues a new certificate.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5"><p class="title"><strong>Figure 26.5. Certmonger requesting a new certificate when the old one is nearing expiration</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-5.png" alt="Certmonger service cert 5"/></div></div></div><p>
				<br/>
			</p></section><section class="section" id="viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h2 class="title">26.4. Viewing the details of a certificate request tracked by certmonger</h2></div></div></div><p>
				The <code class="literal">certmonger</code> service monitors certificate requests. When a request for a certificate is successfully signed, it results in a certificate. <code class="literal">Certmonger</code> manages certificate requests including the resulting certificates. This section describes how to view the details of a particular certificate request managed by <code class="literal">certmonger</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If you know how to specify the certificate request, list the details of only that particular certificate request. You can, for example, specify:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The request ID
							</li><li class="listitem">
								The location of the certificate
							</li><li class="listitem"><p class="simpara">
								The certificate nickname
							</p><p class="simpara">
								For example, to view the details of the certificate whose request ID is 20190408143846, using the <code class="literal">-v</code> option to view all the details of errors in case your request for a certificate was unsuccessful:
							</p><pre class="literallayout"># <span class="strong strong"><strong>getcert list -i 20190408143846 -v</strong></span>
Number of certificates and requests being tracked: 16.
Request ID '20190408143846':
	status: MONITORING
	stuck: no
	key pair storage: type=NSSDB,location='/etc/dirsrv/slapd-IDM-EXAMPLE-COM',nickname='Server-Cert',token='NSS Certificate DB',pinfile='/etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt'
	certificate: type=NSSDB,location='/etc/dirsrv/slapd-IDM-EXAMPLE-COM',nickname='Server-Cert',token='NSS Certificate DB'
	CA: IPA
	issuer: CN=Certificate Authority,O=IDM.EXAMPLE.COM
	subject: CN=r8server.idm.example.com,O=IDM.EXAMPLE.COM
	expires: 2021-04-08 16:38:47 CEST
	dns: r8server.idm.example.com
	principal name: ldap/server.idm.example.com@IDM.EXAMPLE.COM
	key usage: digitalSignature,nonRepudiation,keyEncipherment,dataEncipherment
	eku: id-kp-serverAuth,id-kp-clientAuth
	pre-save command:
	post-save command: /usr/libexec/ipa/certmonger/restart_dirsrv IDM-EXAMPLE-COM
	track: yes
	auto-renew: yes</pre></li></ul></div><p class="simpara">
						The output displays several pieces of information about the certificate, for example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								the certificate location; in the example above, it is the NSS database in the <code class="literal">/etc/dirsrv/slapd-IDM-EXAMPLE-COM</code> directory
							</li><li class="listitem">
								the certificate nickname; in the example above, it is <code class="literal">Server-Cert</code>
							</li><li class="listitem">
								the file storing the pin; in the example above, it is <code class="literal">/etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt</code>
							</li><li class="listitem">
								the Certificate Authority that will be used to renew the certificate; in the example above, it is the <code class="literal">IPA</code> CA
							</li><li class="listitem">
								the expiration date; in the example above, it is <code class="literal">2021-04-08 16:38:47 CEST</code>
							</li><li class="listitem">
								the status of the certificate; in the example above, the <code class="literal">MONITORING</code> status means that the certificate is valid and it is being tracked
							</li><li class="listitem">
								the post-save command; in the example above, it is the restart of the <code class="literal">LDAP</code> service
							</li></ul></div></li><li class="listitem"><p class="simpara">
						If you do not know how to specify the certificate request, list the details of all the certificates that <code class="literal">certmonger</code> is monitoring or attempting to obtain:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert list</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional information</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To view the different options how to specify the certificate request displayed, see the <code class="literal">getcert list</code> man page.
					</li></ul></div></section><section class="section" id="start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h2 class="title">26.5. Starting and stopping certificate tracking</h2></div></div></div><p>
				This section describes how you can use the <code class="literal">getcert stop-tracking</code> and <code class="literal">getcert start-tracking</code> commands to monitor certificates. The two commands are provided by the <code class="literal">certmonger</code> service. Enabling certificate tracking is especially useful if you have imported a certificate issued by the IdM CA onto the machine from a different IdM client. Enabling certificate tracking can also be the final step of the following provisioning scenario:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						On the IdM server, you create a certificate for a system that does not exist yet.
					</li><li class="listitem">
						You create the new system.
					</li><li class="listitem">
						You enroll the new system as an IdM client.
					</li><li class="listitem">
						You import the certificate and the key from the IdM server on to the IdM client.
					</li><li class="listitem">
						You start tracking the certificate using <code class="literal">certmonger</code> to ensure that it gets renewed when it is due to expire.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To disable the monitoring of a certificate with the Request ID of 20190408143846:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert stop-tracking -i 20190408143846</strong></span></pre><p class="simpara">
						For more options, see the <code class="literal">getcert stop-tracking</code> man page.
					</p></li><li class="listitem"><p class="simpara">
						To enable the monitoring of a certificate stored in the <code class="literal">/tmp/some_cert.crt</code> file, whose private key is stored in the <code class="literal">/tmp/some_key.key</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert start-tracking -c IPA -f /tmp/some_cert.crt -k /tmp/some_key.key</strong></span></pre><p class="simpara">
						<code class="literal">Certmonger</code> cannot automatically identify the CA type that issued the certificate. For this reason, add the <code class="literal">-c</code> option with the <code class="literal">IPA</code> value to the <code class="literal">getcert start-tracking</code> command if the certificate was issued by the IdM CA. Omitting to add the <code class="literal">-c</code> option results in <code class="literal">certmonger</code> entering the NEED_CA state.
					</p><p class="simpara">
						For more options, see the <code class="literal">getcert start-tracking</code> man page.
					</p></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The two commands do not manipulate the certificate. For example, <code class="literal">getcert stop-tracking</code> does not delete the certificate or remove it from the NSS database or from the filesystem but simply removes the certificate from the list of monitored certificates. Similarly, <code class="literal">getcert start-tracking</code> only adds a certificate to the list of monitored certificates.
				</p></div></div></section><section class="section" id="renew-cert_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h2 class="title">26.6. Renewing a certificate manually</h2></div></div></div><p>
				When a certificate is near its expiration date, the <code class="literal">certmonger</code> daemon automatically issues a renewal command using the CA helper, obtains a renewed certificate and replaces the previous certificate with the new one.
			</p><p>
				It is also possible to manually renew a certificate in advance by using the <code class="literal">getcert resubmit</code> command. This way, you can update the information the certificate contains, e.g. by adding a Subject Alternative Name (SAN).
			</p><p>
				This section describes how to renew a certificate manually.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To renew a certificate with the Request ID of 20190408143846:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert resubmit -i 20190408143846</strong></span></pre><p class="simpara">
						To obtain the Request ID for a specific certificate, use the <code class="literal">getcert list</code> command. For details, see the <code class="literal">getcert list</code> man page.
					</p></li></ul></div></section><section class="section" id="add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h2 class="title">26.7. Making certmonger resume tracking of IdM certificates on a CA replica</h2></div></div></div><p>
				This procedure shows how to make <code class="literal">certmonger</code> resume the tracking of IdM system certificates that are crucial for an IdM deployment with an integrated certificate authority after the tracking of certificates was interrupted. The interruption may have been caused by the IdM host being unenrolled from IdM during the renewal of the system certificates or by replication topology not working properly. The procedure also shows how to make <code class="literal">certmonger</code> resume the tracking of the IdM service certificates, namely the <code class="literal">HTTP</code>, <code class="literal">LDAP</code> and <code class="literal">PKINIT</code> certificates.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The host on which you want to resume tracking system certificates is an IdM server that is also an IdM CA but not the IdM CA renewal master.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Get the PIN for the subsystem CA certificates:
					</p><pre class="literallayout"># <span class="strong strong"><strong>grep 'internal=' /var/lib/pki/pki-tomcat/conf/password.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add tracking to the subsystem CA certificates, replacing <code class="literal">[internal PIN]</code> in the commands below with the PIN obtained in the previous step:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "caSigningCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "caSigningCert cert-pki-ca"'</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "auditSigningCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "auditSigningCert cert-pki-ca"'</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "ocspSigningCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "ocspSigningCert cert-pki-ca"'</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "subsystemCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "subsystemCert cert-pki-ca"'</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "Server-Cert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "Server-Cert cert-pki-ca"'</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add tracking for the remaining IdM certificates, the <code class="literal">HTTP</code>, <code class="literal">LDAP</code>, <code class="literal">IPA renewal agent</code> and <code class="literal">PKINIT</code> certificates:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert start-tracking -f /var/lib/ipa/certs/httpd.crt -k /var/lib/ipa/private/httpd.key -p /var/lib/ipa/passwds/idm.example.com-443-RSA -c IPA -C /usr/libexec/ipa/certmonger/restart_httpd</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/dirsrv/slapd-IDM-EXAMPLE-COM -n "Server-Cert" -c IPA -p /etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt -C '/usr/libexec/ipa/certmonger/restart_dirsrv "IDM-EXAMPLE-COM"'</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -f /var/lib/ipa/ra-agent.pem -k /var/lib/ipa/ra-agent.key -c dogtag-ipa-ca-renew-agent -B /usr/libexec/ipa/certmonger/renew_ra_cert_pre -C /usr/libexec/ipa/certmonger/renew_ra_cert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -f /var/kerberos/krb5kdc/kdc.crt -k /var/kerberos/krb5kdc/kdc.key -c dogtag-ipa-ca-renew-agent -B /usr/libexec/ipa/certmonger/renew_ra_cert_pre -C /usr/libexec/ipa/certmonger/renew_kdc_cert</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart <code class="literal">certmonger</code>:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart certmonger</strong></span></pre></li><li class="listitem"><p class="simpara">
						Wait for one minute after <code class="literal">certmonger</code> has started and then check the statuses of the new certificates:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert list</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						If your IdM system certificates have all expired, follow the procedure described in <a class="link" href="https://access.redhat.com/solutions/3357261">this Knowledge Centered Support (KCS) solution</a> to manually renew IdM system certificates on the IdM CA master that is also the CA renewal master and the CRL generation master. Then follow the procedure described in <a class="link" href="https://access.redhat.com/solutions/3357331">this KCS solution</a> to manually renew IdM system certificates on all the other CA servers in the topology.
					</li></ul></div></section></section><section class="chapter" id="restricting-an-application-to-trust-only-a-subset-of-certificates_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 27. Restricting an application to trust only a subset of certificates</h1></div></div></div><p>
			If your Identity Management (IdM) installation is configured with the integrated Certificate System (CS) certificate authority (CA), you are able to create lightweight sub-CAs. All sub-CAs you create are subordinated to the primary CA of the certificate system, the <span class="strong strong"><strong>ipa</strong></span> CA.
		</p><p>
			A <span class="emphasis"><em>lightweight sub-CA</em></span> in this context means <span class="emphasis"><em>a sub-CA issuing certificates for a specific purpose</em></span>. For example, a lightweight sub-CA enables you to configure a service, such as a virtual private network (VPN) gateway and a web browser, to accept only certificates issued by <span class="emphasis"><em>sub-CA A</em></span>. By configuring other services to accept certificates only issued by <span class="emphasis"><em>sub-CA B</em></span>, you prevent them from accepting certificates issued by <span class="emphasis"><em>sub-CA A</em></span>, the primary CA, that is the <code class="literal">ipa</code> CA, and any intermediate sub-CA between the two.
		</p><p>
			If you revoke the intermediate certificate of a sub-CA, all certificates issued by this sub-CA are automatically considered invalid by correctly configured clients. All the other certificates issued directly by the root CA, <span class="strong strong"><strong>ipa</strong></span>, or another sub-CA, remain valid.
		</p><p>
			This section uses the example of the Apache web server to illustrate how to restrict an application to trust only a subset of certificates. Complete this section to restrict the web server running on your IdM client to use a certificate issued by the <span class="strong strong"><strong>webserver-ca</strong></span> IdM sub-CA, and to require the users to authenticate to the web server using user certificates issued by the <span class="strong strong"><strong>webclient-ca</strong></span> IdM sub-CA.
		</p><p>
			The steps you need to take are:
		</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs" title="27.1. Creating a lightweight sub-CA">Create an IdM sub-CA</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="27.2. Downloading the sub-CA certificate from IdM WebUI">Download the sub-CA certificate from IdM WebUI</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs" title="27.3. Creating CA ACLs for web server and client authentication">Create a CA ACL specifying the correct combination of users, services and CAs, and the certificate profile used</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs" title="27.4. Obtaining an IdM certificate for a service using certmonger">Request a certificate for the web service running on an IdM client from the IdM sub-CA</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" title="27.6. Setting up a single-instance Apache HTTP Server">Set up a single-instance Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="27.7. Adding TLS encryption to an Apache HTTP Server">Add TLS encryption to the Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" title="27.8. Setting the supported TLS protocol versions on an Apache HTTP Server">Set the supported TLS protocol versions on an Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" title="27.9. Setting the supported ciphers on an Apache HTTP Server">Set the supported ciphers on the Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs" title="27.10. Configuring TLS client certificate authentication">Configure TLS client certificate authentication on the web server</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs" title="27.11. Requesting a new user certificate and exporting it to the client">Request a certificate for the user from the IdM sub-CA and export it to the client</a>
				</li><li class="listitem">
					<a class="link" href="index%3Flb_target=stage.html#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs" title="27.12. Configuring a browser to enable certificate authentication">Import the user certificate into the browser and configure the browser to trust the sub-CA certificate</a>
				</li></ol></div><section class="section" id="creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.1. Creating a lightweight sub-CA</h2></div></div></div><p>
				For details on creating a sub-CA, see:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="27.1.1. Creating a sub-CA from IdM WebUI">Section 27.1.1, “Creating a sub-CA from IdM WebUI”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs" title="27.1.2. Creating a sub-CA from IdM CLI">Section 27.1.2, “Creating a sub-CA from IdM CLI”</a>
					</li></ul></div><section class="section" id="creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">27.1.1. Creating a sub-CA from IdM WebUI</h3></div></div></div><p>
					This procedure describes how to use IdM WebUI to create new sub-CAs named <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure you have obtained the administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Authentication</strong></span> menu, click <span class="strong strong"><strong>Certificates</strong></span>.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Certificate Authorities</strong></span> and click <span class="strong strong"><strong>Add</strong></span>.
						</li><li class="listitem">
							Enter the name of the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA. Enter the Subject DN, for example <span class="strong strong"><strong>CN=WEBSERVER,O=IDM.EXAMPLE.COM</strong></span>, in the Subject DN field. Note that the Subject DN must be unique in the IdM CA infrastructure.
						</li><li class="listitem">
							Enter the name of the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA. Enter the Subject DN <span class="strong strong"><strong>CN=WEBCLIENT,O=IDM.EXAMPLE.COM</strong></span> in the Subject DN field.
						</li><li class="listitem"><p class="simpara">
							In the command-line interface, run the <code class="literal">ipa-certupdate</code> command to create a <span class="strong strong"><strong>certmonger</strong></span> tracking request for the <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span> sub-CAs certificates:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa-certupdate</code></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Forgetting to run the <code class="literal">ipa-certupdate</code> command after creating a sub-CA means that if the sub-CA certificate expires, end-entity certificates issued by the sub-CA are considered invalid even if the end-entity certificate has not expired.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Optionally, to verify that the signing certificate of the new sub-CA has been added to the IdM database, enter:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">certutil -d /etc/pki/pki-tomcat/alias/ -L</code>

Certificate Nickname                      Trust Attributes
                                          SSL,S/MIME,JAR/XPI

caSigningCert cert-pki-ca                 CTu,Cu,Cu
Server-Cert cert-pki-ca                   u,u,u
auditSigningCert cert-pki-ca              u,u,Pu
<span class="strong strong"><strong>caSigningCert cert-pki-ca ba83f324-5e50-4114-b109-acca05d6f1dc u,u,u</strong></span>
ocspSigningCert cert-pki-ca               u,u,u
subsystemCert cert-pki-ca                 u,u,u</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The new sub-CA certificate is automatically transferred to all the replicas that have a certificate system instance installed.
							</p></div></div></li></ol></div></section><section class="section" id="creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">27.1.2. Creating a sub-CA from IdM CLI</h3></div></div></div><p>
					This procedure describes how to use IdM CLI to create new sub-CAs named <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure that you have obtained the administrator’s credentials.
						</li><li class="listitem">
							Make sure you are logged in to an IdM server that is a CA server.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enter the <code class="literal">ipa ca-add</code> command, and specify the name of the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA and its Subject Distinguished Name (DN):
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa ca-add <span class="emphasis"><em>webserver-ca</em></span> --subject="<span class="emphasis"><em>CN=WEBSERVER,O=IDM.EXAMPLE.COM</em></span>"</code>
-------------------
Created CA "webserver-ca"
-------------------
  Name: webserver-ca
  Authority ID: ba83f324-5e50-4114-b109-acca05d6f1dc
  Subject DN: CN=WEBSERVER,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IDM.EXAMPLE.COM</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd>
										Name of the CA.
									</dd><dt><span class="term">Authority ID</span></dt><dd>
										Automatically created, individual ID for the CA.
									</dd><dt><span class="term">Subject DN</span></dt><dd>
										Subject Distinguished Name (DN). The Subject DN must be unique in the IdM CA infrastructure.
									</dd><dt><span class="term">Issuer DN</span></dt><dd>
										Parent CA that issued the sub-CA certificate. All sub-CAs are created as a child of the IdM root CA.
									</dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA for issuing certificates to web clients:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa ca-add <span class="emphasis"><em>webclient-ca</em></span> --subject="<span class="emphasis"><em>CN=WEBCLIENT,O=IDM.EXAMPLE.COM</em></span>"</code>
-------------------
Created CA "webclient-ca"
-------------------
  Name: webclient-ca
  Authority ID: 8a479f3a-0454-4a4d-8ade-fd3b5a54ab2e
  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IDM.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
							In the command-line interface, run the <span class="strong strong"><strong>ipa-certupdate</strong></span> command to create a <span class="strong strong"><strong>certmonger</strong></span> tracking request for the <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span> sub-CAs certificates:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa-certupdate</code></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Forgetting to run the <span class="strong strong"><strong>ipa-certupdate</strong></span> command after creating a sub-CA means that if the sub-CA certificate expires, end-entity certificates issued by the sub-CA are considered invalid even if the end-entity certificate has not expired.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Optionally, to verify that the signing certificate of the new sub-CA has been added to the IdM database, enter:
						</p><pre class="literallayout">[root@ipaserver ~]# <span class="strong strong"><strong>certutil -d /etc/pki/pki-tomcat/alias/ -L</strong></span>

Certificate Nickname                      Trust Attributes
                                          SSL,S/MIME,JAR/XPI

caSigningCert cert-pki-ca                 CTu,Cu,Cu
Server-Cert cert-pki-ca                   u,u,u
auditSigningCert cert-pki-ca              u,u,Pu
<span class="strong strong"><strong>caSigningCert cert-pki-ca ba83f324-5e50-4114-b109-acca05d6f1dc u,u,u</strong></span>
ocspSigningCert cert-pki-ca               u,u,u
subsystemCert cert-pki-ca                 u,u,u</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The new sub-CA certificate is automatically transferred to all the replicas that have a certificate system instance installed.
							</p></div></div></li></ol></div></section></section><section class="section" id="downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.2. Downloading the sub-CA certificate from IdM WebUI</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Make sure that you have obtained the IdM administrator’s credentials.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Authentication</strong></span> menu, click <span class="strong strong"><strong>Certificates</strong></span> &gt; <span class="strong strong"><strong>Certificates</strong></span>.
					</p><div class="figure" id="sub-CA-certificate-in-the-list-of-certificates_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 27.1. sub-CA certificate in the list of certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="download-sub-CA-certificate.png" alt="download sub CA certificate"/></div></div></div></li><li class="listitem">
						Click the serial number of the sub-CA certificate to open the certificate information page.
					</li><li class="listitem">
						In the certificate information page, click <span class="strong strong"><strong>Actions</strong></span> &gt; <span class="strong strong"><strong>Download</strong></span>.
					</li></ol></div></section><section class="section" id="creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.3. Creating CA ACLs for web server and client authentication</h2></div></div></div><p>
				Certificate authority access control list (CA ACL) rules define which profiles can be used to issue certificates to which users, services, or hosts. By associating profiles, principals, and groups, CA ACLs permit principals or groups to request certificates using particular profiles.
			</p><p>
				For example, using CA ACLs, the administrator can restrict the use of a profile intended for employees working from an office located in London only to users that are members of the London office-related group.
			</p><section class="section" id="viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">27.3.1. Viewing CA ACLs in IdM CLI</h3></div></div></div><p>
					Complete this section to view the list of certificate authority access control lists (CA ACLs) available in your IdM deployment and the details of a specific CA ACL.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To view all the CA ACLs in your IdM environment, enter the <code class="literal">ipa caacl-find</code> command:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-find</strong></span>
-----------------
1 CA ACL matched
-----------------
  ACL name: hosts_services_caIPAserviceCert
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							To view the details of a CA ACL, enter the <code class="literal">ipa caacl-show</code> command, and specify the CA ACL name. For example, to view the details of the <span class="strong strong"><strong>hosts_services_caIPAserviceCert</strong></span> CA ACL, enter:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-show hosts_services_caIPAserviceCert</strong></span>
  ACL name: hosts_services_caIPAserviceCert
  Enabled: TRUE
  Host category: all
  Service category: all
  CAs: ipa
  Profiles: caIPAserviceCert
  Users: admin</pre></li></ol></div></section><section class="section" id="creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">27.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca</h3></div></div></div><p>
					This section describes how to create a CA ACL that requires the system administrator to use the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA and the <span class="strong strong"><strong>caIPAserviceCert</strong></span> profile when requesting a certificate for the <span class="strong strong"><strong>HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</strong></span> service. If the user requests a certificate from a different sub-CA or of a different profile, the request fails. The only exception is when there is another matching CA ACL that is enabled. To view the available CA ACLs, see <a class="link" href="index%3Flb_target=stage.html#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs" title="27.3.1. Viewing CA ACLs in IdM CLI">Viewing CA ACLs in IdM CLI</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure that the <span class="strong strong"><strong>HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</strong></span> service is part of IdM.
						</li><li class="listitem">
							Make sure you have obtained IdM administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a CA ACL using the <code class="literal">ipa caacl</code> command, and specify its name:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add TLS_web_server_authentication</strong></span>
--------------------------------------------
Added CA ACL "TLS_web_server_authentication"
--------------------------------------------
  ACL name: TLS_web_server_authentication
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Modify the CA ACL using the <code class="literal">ipa caacl-mod</code> command to specify the description of the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-mod TLS_web_server_authentication --desc="CAACL for web servers authenticating to web clients using certificates issued by webserver-ca"</strong></span>
-----------------------------------------------
Modified CA ACL "TLS_web_server_authentication"
-----------------------------------------------
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Add the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA to the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-ca TLS_web_server_authentication --ca=webserver-ca</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa caacl-add-service</code> to specify the service whose principal will be able to request a certificate:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-service TLS_web_server_authentication --service=HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
  Services: HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa caacl-add-profile</code> command to specify the certificate profile for the requested certificate:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-profile TLS_web_server_authentication --certprofiles=caIPAserviceCert</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
  Profiles: caIPAserviceCert
  Services: HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM
-------------------------
Number of members added 1
-------------------------</pre><p class="simpara">
							You can use the newly-created CA ACL straight away. It is enabled after its creation by default.
						</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The point of CA ACLs is to specify which CA and profile combinations are allowed for requests coming from particular principals or groups. CA ACLs do not affect certificate validation or trust. They do not affect how the issued certificates will be used.
					</p></div></div></section><section class="section" id="creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">27.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca</h3></div></div></div><p>
					This section describes how to create a CA ACL that requires the system administrator to use the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA and the <span class="strong strong"><strong>IECUserRoles</strong></span> profile when requesting a certificate. If the user requests a certificate from a different sub-CA or of a different profile, the request fails. The only exception is when there is another matching CA ACL that is enabled. To view the available CA ACLs, see <a class="link" href="index%3Flb_target=stage.html#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs" title="27.3.1. Viewing CA ACLs in IdM CLI">Viewing CA ACLs in IdM CLI</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure that you have obtained IdM administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a CA ACL using the <code class="literal">ipa caacl</code> command and specify its name:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add TLS_web_client_authentication</strong></span>
--------------------------------------------
Added CA ACL "TLS_web_client_authentication"
--------------------------------------------
  ACL name: TLS_web_client_authentication
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Modify the CA ACL using the <code class="literal">ipa caacl-mod</code> command to specify the description of the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-mod TLS_web_client_authentication --desc="CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca"</strong></span>
-----------------------------------------------
Modified CA ACL "TLS_web_client_authentication"
-----------------------------------------------
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Add the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA to the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-ca TLS_web_client_authentication --ca=webclient-ca</strong></span>
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE
  CAs: webclient-ca
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa caacl-add-profile</code> command to specify the certificate profile for the requested certificate:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-profile TLS_web_client_authentication --certprofiles=IECUserRoles</strong></span>
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE
  CAs: webclient-ca
  Profiles: IECUserRoles
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Modify the CA ACL using the <code class="literal">ipa caacl-mod</code> command to specify that the CA ACL applies to all IdM users:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-mod TLS_web_client_authentication --usercat=all</strong></span>
-----------------------------------------------
Modified CA ACL "TLS_web_client_authentication"
-----------------------------------------------
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE
  User category: all
  CAs: webclient-ca
  Profiles: IECUserRoles</pre><p class="simpara">
							You can use the newly-created CA ACL straight away. It is enabled after its creation by default.
						</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The point of CA ACLs is to specify which CA and profile combinations are allowed for requests coming from particular principals or groups. CA ACLs do not affect certificate validation or trust. They do not affect how the issued certificates will be used.
					</p></div></div></section></section><section class="section" id="obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.4. Obtaining an IdM certificate for a service using certmonger</h2></div></div></div><p>
				To ensure that communication between browsers and the web service running on your IdM client is secure and encrypted, use a TLS certificate. If you want to restrict web browsers to trust certificates issued by the <code class="literal">webserver-ca</code> sub-CA but no other IdM sub-CA, obtain the TLS certificate for your web service from the <code class="literal">webserver-ca</code> sub-CA.
			</p><p>
				This section describes how to use <code class="literal">certmonger</code> to obtain an IdM certificate for a service (<code class="literal">HTTP/my_company.idm.example.com</code>@<code class="literal">IDM.EXAMPLE.COM</code>) running on an IdM client.
			</p><p>
				Using <code class="literal">certmonger</code> to request the certificate automatically means that <code class="literal">certmonger</code> manages and renews the certificate when it is due for a renewal.
			</p><p>
				For a visual representation of what happens when <code class="literal">certmonger</code> requests a service certificate, see <a class="xref" href="index%3Flb_target=stage.html#communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs" title="27.5. Communication flow for certmonger requesting a service certificate">Section 27.5, “Communication flow for certmonger requesting a service certificate”</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The web server is enrolled as an IdM client.
					</li><li class="listitem">
						You have root access to the IdM client on which you are running the procedure.
					</li><li class="listitem">
						The service for which you are requesting a certificate does not have to pre-exist in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the <code class="literal">my_company.idm.example.com</code> IdM client on which the <code class="literal">HTTP</code> service is running, request a certificate for the service corresponding to the <code class="literal">HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</code> principal, and specify that
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The certificate is to be stored in the local <code class="literal">/etc/pki/tls/certs/httpd.pem</code> file
							</li><li class="listitem">
								The private key is to be stored in the local <code class="literal">/etc/pki/tls/private/httpd.key</code> file
							</li><li class="listitem">
								The <code class="literal">webserver-ca</code> sub-CA is to be the issuing certificate authority
							</li><li class="listitem"><p class="simpara">
								That an extensionRequest for a <code class="literal">SubjectAltName</code> be added to the signing request with the DNS name of <code class="literal">my_company.idm.example.com</code>:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert request -K HTTP/my_company.idm.example.com -k /etc/pki/tls/private/httpd.key -f /etc/pki/tls/certs/httpd.pem -D my_company.idm.example.com -X webserver-ca -C "systemctl restart httpd"</strong></span>
New signing request "20190604065735" added.</pre><p class="simpara">
								In the command above:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <code class="literal">ipa-getcert request</code> command specifies that the certificate is to be obtained from the IdM CA. The <code class="literal">ipa-getcert request</code> command is a shortcut for <code class="literal">getcert request -c IPA</code>.
									</li><li class="listitem">
										The <code class="literal">-C</code> option instructs <code class="literal">certmonger</code> to restart the <code class="literal">httpd</code> service after obtaining the certificate.
									</li><li class="listitem">
										The <code class="literal">-D</code> option specifies the <code class="literal">SubjectAltName</code> DNS value to be added to the request.
									</li><li class="listitem">
										The <code class="literal">-X</code> option specifies that the issuer of the certificate must be <code class="literal">webserver-ca</code>, not <code class="literal">ipa</code>.
									</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										To specify that the certificate be issued with a particular profile, use the <code class="literal">-T</code> option.
									</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									RHEL 8 uses a different SSL module in Apache than the one used in RHEL 7. The SSL module relies on OpenSSL rather than NSS. For this reason, in RHEL 8 you cannot use an NSS database to store the <code class="literal">HTTPS</code> certificate and the private key.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, to check the status of your request:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert list -f /etc/pki/tls/certs/httpd.pem</strong></span>
Number of certificates and requests being tracked: 3.
Request ID '20190604065735':
    status: MONITORING
    stuck: no
    key pair storage: type=FILE,location='/etc/pki/tls/private/httpd.key'
    certificate: type=FILE,location='/etc/pki/tls/certs/httpd.crt'
    CA: IPA
    issuer: CN=WEBSERVER,O=IDM.EXAMPLE.COM

[...]</pre><p class="simpara">
						The output shows that the request is in the <code class="literal">MONITORING</code> status, which means that a certificate has been obtained. The locations of the key pair and the certificate are those requested.
					</p></li></ol></div></section><section class="section" id="communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.5. Communication flow for certmonger requesting a service certificate</h2></div></div></div><p>
				The diagrams in this section show the stages of what happens when <code class="literal">certmonger</code> requests a service certificate from IdM CA server. The sequence consists of these diagrams:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1" title="Figure 27.2. Unencrypted communication">Figure 27.2, “Unencrypted communication”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2" title="Figure 27.3. Certmonger requesting a service certificate">Figure 27.3, “Certmonger requesting a service certificate”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3" title="Figure 27.4. IdM CA issuing the service certificate">Figure 27.4, “IdM CA issuing the service certificate”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4" title="Figure 27.5. Certmonger applying the service certificate">Figure 27.5, “Certmonger applying the service certificate”</a>
					</li><li class="listitem">
						<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5" title="Figure 27.6. Certmonger requesting a new certificate when the old one is nearing expiration">Figure 27.6, “Certmonger requesting a new certificate when the old one is nearing expiration”</a>
					</li></ul></div><p>
				In the diagrams, the <code class="literal">webserver-ca</code> sub-CA is represented by the generic <code class="literal">IdM CA server</code>.
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1" title="Figure 27.2. Unencrypted communication">Figure 27.2, “Unencrypted communication”</a> shows the initial situation: without an HTTPS certificate, the communication between the web server and the browser is unencrypted.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1"><p class="title"><strong>Figure 27.2. Unencrypted communication</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-1.png" alt="Certmonger service cert 1"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2" title="Figure 27.3. Certmonger requesting a service certificate">Figure 27.3, “Certmonger requesting a service certificate”</a> shows the system administrator using <code class="literal">certmonger</code> to manually request an HTTPS certificate for the Apache web server. Note that when requesting a web server certificate, certmonger does not communicate directly with the CA. It proxies through IdM.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2"><p class="title"><strong>Figure 27.3. Certmonger requesting a service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-2.png" alt="Certmonger service cert 2"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3" title="Figure 27.4. IdM CA issuing the service certificate">Figure 27.4, “IdM CA issuing the service certificate”</a> shows an IdM CA issuing an HTTPS certificate for the web server.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3"><p class="title"><strong>Figure 27.4. IdM CA issuing the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-3.png" alt="Certmonger service cert 3"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4" title="Figure 27.5. Certmonger applying the service certificate">Figure 27.5, “Certmonger applying the service certificate”</a> shows <code class="literal">certmonger</code> placing the HTTPS certificate in appropriate locations on the IdM client and, if instructed to do so, restarting the <code class="literal">httpd</code> service. The Apache server subsequently uses the HTTPS certificate to encrypt the traffic between itself and the browser.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4"><p class="title"><strong>Figure 27.5. Certmonger applying the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-4.png" alt="Certmonger service cert 4"/></div></div></div><p>
				<br/>
			</p><p>
				<a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5" title="Figure 27.6. Certmonger requesting a new certificate when the old one is nearing expiration">Figure 27.6, “Certmonger requesting a new certificate when the old one is nearing expiration”</a> shows <code class="literal">certmonger</code> automatically requesting a renewal of the service certificate from the IdM CA before the expiration of the certificate. The IdM CA issues a new certificate.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5"><p class="title"><strong>Figure 27.6. Certmonger requesting a new certificate when the old one is nearing expiration</strong></p><div class="figure-contents"><div class="mediaobject"><img src="Certmonger-service-cert-5.png" alt="Certmonger service cert 5"/></div></div></div><p>
				<br/>
			</p></section><section class="section" id="setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.6. Setting up a single-instance Apache HTTP Server</h2></div></div></div><p>
				This section describes how to set up a single-instance Apache HTTP Server to serve static HTML content.
			</p><p>
				Follow the procedure in this section if the web server should provide the same content for all domains associated with the server. If you want to provide different content for different domains, set up name-based virtual hosts. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#configuring-apache-name-based-virtual-hosts_setting-apache-http-server">Configuring Apache name-based virtual hosts</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">httpd</code> package:
					</p><pre class="literallayout"># yum install httpd</pre></li><li class="listitem"><p class="simpara">
						Open the TCP port <code class="literal command">80</code> in the local firewall:
					</p><pre class="literallayout"># firewall-cmd --permanent --add-port=80/tcp
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl enable --now httpd</pre></li><li class="listitem">
						Optional: Add HTML files to the <code class="literal filename">/var/www/html/</code> directory.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Connect with a web browser to <code class="literal">http://my_company.idm.example.com/</code> or <code class="literal command">http://<span class="emphasis"><em>server_IP</em></span>/</code>.
					</p><p class="simpara">
						If the <code class="literal filename">/var/www/html/</code> directory is empty or does not contain an <code class="literal filename">index.html</code> or <code class="literal filename">index.htm</code> file, Apache displays the <code class="literal command">Red Hat Enterprise Linux Test Page</code>. If <code class="literal filename">/var/www/html/</code> contains HTML files with a different name, you can load them by entering the URL to that file, such as <code class="literal command">http://<span class="emphasis"><em>server_IP</em></span>/<span class="emphasis"><em>example.html</em></span></code> or <code class="literal">http://my_company.idm.example.com/<span class="emphasis"><em>example.html</em></span></code>.
					</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about configuring Apache and adapting the service to your environment, refer to the Apache manual. For details about installing the manual, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual</a>.
					</li><li class="listitem">
						For details about using or adjusting the <code class="literal systemitem">httpd</code> <code class="literal systemitem">systemd</code> service, see the <code class="literal citetitle">httpd.service(8)</code> man page.
					</li></ul></div></section><section class="section" id="proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.7. Adding TLS encryption to an Apache HTTP Server</h2></div></div></div><p>
				This section describes how to enable TLS encryption on the <code class="literal systemitem">my_company.idm.example.com</code> Apache HTTP Server for the <code class="literal systemitem">idm.example.com</code> domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal systemitem">my_company.idm.example.com</code> Apache HTTP Server is installed and running.
					</li><li class="listitem">
						You have obtained the TLS certificate from the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA, and stored it in the <code class="literal filename">/etc/pki/tls/certs/httpd.pem</code> file as described in <a class="xref" href="index%3Flb_target=stage.html#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs" title="27.4. Obtaining an IdM certificate for a service using certmonger">Section 27.4, “Obtaining an IdM certificate for a service using certmonger”</a>. If you use a different path, adapt the corresponding steps of the procedure.
					</li><li class="listitem">
						The corresponding private key is stored in the <code class="literal filename">/etc/pki/tls/private/httpd.key</code> file. If you use a different path, adapt the corresponding steps of the procedure.
					</li><li class="listitem">
						The <span class="strong strong"><strong>webserver-ca</strong></span> CA certificate is stored in the <code class="literal filename">/etc/pki/tls/private/ca.crt</code> file. If you use a different path, adapt the corresponding steps of the procedure.
					</li><li class="listitem">
						Clients and the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> web server resolve the host name of the server to the IP address of the web server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">mod_ssl</code> package:
					</p><pre class="literallayout"># dnf install mod_ssl</pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf.d/ssl.conf</code> file and add the following settings to the <code class="literal parameter">&lt;VirtualHost _default_:443&gt;</code> directive:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Set the server name:
							</p><pre class="literallayout">ServerName <span class="emphasis"><em>my_company.idm.example.com</em></span></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									The server name must match the entry set in the <code class="literal parameter">Common Name</code> field of the certificate.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Optional: If the certificate contains additional host names in the <code class="literal parameter">Subject Alt Names</code> (SAN) field, you can configure <code class="literal systemitem">mod_ssl</code> to provide TLS encryption also for these host names. To configure this, add the <code class="literal parameter">ServerAliases</code> parameter with corresponding names:
							</p><pre class="literallayout">ServerAlias <span class="emphasis"><em>www.my_company.idm.example.com</em></span> <span class="emphasis"><em>server.my_company.idm.example.com</em></span></pre></li><li class="listitem"><p class="simpara">
								Set the paths to the private key, the server certificate, and the CA certificate:
							</p><pre class="literallayout">SSLCertificateKeyFile "/etc/pki/tls/private/httpd.key"
SSLCertificateFile "/etc/pki/tls/certs/httpd.pem"
SSLCACertificateFile "/etc/pki/tls/certs/ca.crt"</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						For security reasons, configure that only the <code class="literal systemitem">root</code> user can access the private key file:
					</p><pre class="literallayout"># chown root:root /etc/pki/tls/private/httpd.key
# chmod 600 //etc/pki/tls/private/httpd.key</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							If the private key was accessed by unauthorized users, revoke the certificate, create a new private key, and request a new certificate. Otherwise, the TLS connection is no longer secure.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Open port <code class="literal command">443</code> in the local firewall:
					</p><pre class="literallayout"># firewall-cmd --permanent --add-port=443
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl restart httpd</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you protected the private key file with a password, you must enter this password each time when the <code class="literal systemitem">httpd</code> service starts.
						</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Use a browser and connect to <code class="literal command">https://my_company.idm.example.com</code>.
							</li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about configuring TLS, refer to the <code class="literal citetitle">SSL/TLS Encryption</code> documentation in the Apache manual. For details about installing the manual, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual</a>.
					</li></ul></div></section><section class="section" id="setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.8. Setting the supported TLS protocol versions on an Apache HTTP Server</h2></div></div></div><p>
				By default, the Apache HTTP Server on RHEL 8 uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For example, the <code class="literal systemitem">DEFAULT</code> policy defines that only the <code class="literal systemitem">TLSv1.2</code> and <code class="literal systemitem">TLSv1.3</code> protocol versions are enabled in apache.
			</p><p>
				This section describes how to manually configure which TLS protocol versions your <span class="strong strong"><strong>my_company.idm.example.com</strong></span> Apache HTTP Server supports. Follow the procedure if your environment requires to enable only specific TLS protocol versions, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If your environment requires that clients can also use the weak <code class="literal systemitem">TLS1</code> (TLSv1.0) or <code class="literal systemitem">TLS1.1</code> protocol.
					</li><li class="listitem">
						If you want to configure that Apache only supports the <code class="literal systemitem">TLSv1.2</code> or <code class="literal systemitem">TLSv1.3</code> protocol.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						TLS encryption is enabled on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> server as described in <a class="xref" href="index%3Flb_target=stage.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="27.7. Adding TLS encryption to an Apache HTTP Server">Section 27.7, “Adding TLS encryption to an Apache HTTP Server”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file, and add the following setting to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to set the TLS protocol version. For example, to enable only the <code class="literal systemitem">TLSv1.3</code> protocol:
					</p><pre class="literallayout">SSLProtocol -All TLSv1.3</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl restart httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the following command to verify that the server supports <code class="literal systemitem">TLSv1.3</code>:
					</p><pre class="literallayout"># openssl s_client -connect <span class="emphasis"><em>example.com</em></span>:443 -tls1_3</pre></li><li class="listitem"><p class="simpara">
						Use the following command to verify that the server does not support <code class="literal systemitem">TLSv1.2</code>:
					</p><pre class="literallayout"># openssl s_client -connect <span class="emphasis"><em>example.com</em></span>:443 -tls1_2</pre><p class="simpara">
						If the server does not support the protocol, the command returns an error:
					</p><pre class="literallayout">140111600609088:error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version:ssl/record/rec_layer_s3.c:1543:SSL alert number 70</pre></li><li class="listitem">
						Optional: Repeat the command for other TLS protocol versions.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about the system-wide crypto policy, see the <code class="literal citetitle">update-crypto-policies(8)</code> man page and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>.
					</li><li class="listitem">
						For further details about the <code class="literal parameter">SSLProtocol</code> parameter, refer to the <code class="literal systemitem">mod_ssl</code> documentation in the Apache manual. For details about installing the manual, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual</a>.
					</li></ul></div></section><section class="section" id="setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.9. Setting the supported ciphers on an Apache HTTP Server</h2></div></div></div><p>
				By default, the Apache HTTP Server on RHEL 8 uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For the list of ciphers the system-wide crypto allows, see the <code class="literal filename">/etc/crypto-policies/back-ends/openssl.config</code> file.
			</p><p>
				This section describes how to manually configure which ciphers the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> Apache HTTP server supports. Follow the procedure if your environment requires specific ciphers.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						TLS encryption is enabled on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> server as described in <a class="xref" href="index%3Flb_target=stage.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="27.7. Adding TLS encryption to an Apache HTTP Server">Section 27.7, “Adding TLS encryption to an Apache HTTP Server”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file, and add the <code class="literal parameter">SSLCipherSuite</code> parameter to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to set the TLS ciphers:
					</p><pre class="literallayout">SSLCipherSuite "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH:!SHA1:!SHA256"</pre><p class="simpara">
						This example enables only the <code class="literal systemitem">EECDH+AESGCM</code>, <code class="literal systemitem">EDH+AESGCM</code>, <code class="literal systemitem">AES256+EECDH</code>, and <code class="literal systemitem">AES256+EDH</code> ciphers and disables all ciphers which use the <code class="literal systemitem">SHA1</code> and <code class="literal systemitem">SHA256</code> message authentication code (MAC).
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl restart httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To display the list of ciphers the Apache HTTP Server supports:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Install the <code class="literal package">nmap</code> package:
							</p><pre class="literallayout"># yum install nmap</pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal systemitem">nmap</code> utility to display the supported ciphers:
							</p><pre class="literallayout"># nmap --script ssl-enum-ciphers -p <span class="emphasis"><em>443</em></span> <span class="emphasis"><em>example.com</em></span>
...
PORT    STATE SERVICE
443/tcp open  https
| ssl-enum-ciphers:
|   TLSv1.2:
|     ciphers:
|       TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (ecdh_x25519) - A
|       TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 (dh 2048) - A
|       TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (ecdh_x25519) - A
...</pre></li></ol></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about the system-wide crypto policy, see the <code class="literal citetitle">update-crypto-policies(8)</code> man page and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>.
					</li><li class="listitem">
						For further details about the <code class="literal parameter">SSLCipherSuite</code> parameter, refer to the <code class="literal systemitem">mod_ssl</code> documentation in the Apache manual. For details about installing the manual, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual</a>.
					</li></ul></div></section><section class="section" id="configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.10. Configuring TLS client certificate authentication</h2></div></div></div><p>
				Client certificate authentication enables administrators to allow only users who authenticate using a certificate to access resources on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> web server. This section describes how to configure client certificate authentication for the <code class="literal filename">/var/www/html/Example/</code> directory.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					If the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> Apache server uses the TLS 1.3 protocol, certain clients require additional configuration. For example, in Firefox, set the <code class="literal parameter">security.tls.enable_post_handshake_auth</code> parameter in the <code class="literal command">about:config</code> menu to <code class="literal command">true</code>. For further details, see <a class="link" href="https://www.redhat.com/en/blog/transport-layer-security-version-13-red-hat-enterprise-linux-8">Transport Layer Security version 1.3 in Red Hat Enterprise Linux 8</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						TLS encryption is enabled on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> server as described in <a class="xref" href="index%3Flb_target=stage.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="27.7. Adding TLS encryption to an Apache HTTP Server">Section 27.7, “Adding TLS encryption to an Apache HTTP Server”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file and add the following settings to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to configure client authentication:
					</p><pre class="literallayout">&lt;Directory "/var/www/html/Example/"&gt;
  SSLVerifyClient require
&lt;/Directory&gt;</pre><p class="simpara">
						The <code class="literal command">SSLVerifyClient require</code> setting defines that the server must successfully validate the client certificate before the client can access the content in the <code class="literal filename">/var/www/html/Example/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl restart httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the <code class="literal systemitem">curl</code> utility to access the <code class="literal command">https://my_company.idm.example.com/Example/</code> URL without client authentication:
					</p><pre class="literallayout">$ curl https://my_company.idm.example.com/Example/
curl: (56) OpenSSL SSL_read: error:1409445C:SSL routines:ssl3_read_bytes:tlsv13 <span class="strong strong"><strong>alert certificate required</strong></span>, errno 0</pre><p class="simpara">
						The error indicates that the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> web server requires a client certificate authentication.
					</p></li><li class="listitem"><p class="simpara">
						Pass the client private key and certificate, as well as the CA certificate to <code class="literal systemitem">curl</code> to access the same URL with client authentication:
					</p><pre class="literallayout">$ curl --cacert <span class="emphasis"><em>ca.crt</em></span> --key <span class="emphasis"><em>client.key</em></span> --cert <span class="emphasis"><em>client.crt</em></span> https://my_company.idm.example.com/Example/</pre><p class="simpara">
						If the request succeeds, <code class="literal systemitem">curl</code> displays the <code class="literal filename">index.html</code> file stored in the <code class="literal filename">/var/www/html/Example/</code> directory.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about client authentication, see the <code class="literal citetitle">mod_ssl Configuration How-To</code> documentation in the Apache manual. For details about installing the manual, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual</a>.
					</li></ul></div></section><section class="section" id="requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.11. Requesting a new user certificate and exporting it to the client</h2></div></div></div><p>
				As an Identity Management (IdM) administrator, you can configure a web server running on an IdM client to request users that use web browsers to access the server to authenticate with certificates issued by a specific IdM sub-CA. Complete this section to request a user certificate from a specific IdM sub-CA and to export the certificate and the corresponding private key on to the host from which the user wants to access the web server using a web browser. Afterwards, <a class="link" href="index%3Flb_target=stage.html#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs" title="27.12. Configuring a browser to enable certificate authentication">import the certificate and the private key into the browser</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, create a new directory, for example <code class="literal replaceable">~/certdb/</code>, and make it a temporary certificate database. When asked, create an NSS Certificate DB password to encrypt the keys to the certificate to be generated in a subsequent step:
					</p><pre class="literallayout"># mkdir <code class="literal replaceable">~/certdb/</code>
# certutil -N -d <code class="literal replaceable">~/certdb/</code>
Enter a password which will be used to encrypt your keys.
The password should be at least 8 characters long,
and should contain at least one non-alphabetic character.

Enter new password:
Re-enter password:</pre></li><li class="listitem"><p class="simpara">
						Create the certificate signing request (CSR) and redirect the output to a file. For example, to create a CSR with the name <code class="literal replaceable">certificate_request.csr</code> for a <code class="literal replaceable">4096</code> bit certificate for the <code class="literal replaceable">idm_user</code> user in the <code class="literal replaceable">IDM.EXAMPLE.COM</code> realm, setting the nickname of the certificate private keys to <code class="literal replaceable">idm_user</code> for easy findability, and setting the subject to <code class="literal replaceable">CN=idm_user,O=IDM.EXAMPLE.COM</code>:
					</p><pre class="literallayout"># certutil -R -d <code class="literal replaceable">~/certdb/</code> -a -g <code class="literal replaceable">4096</code> -n <code class="literal replaceable">idm_user</code> -s "CN=<code class="literal replaceable">idm_user</code>,O=IDM.EXAMPLE.COM" &gt; <code class="literal replaceable">certificate_request.csr</code></pre></li><li class="listitem"><p class="simpara">
						When prompted, enter the same password that you entered when using <code class="literal systemitem">certutil</code> to create the temporary database. Then continue typing randlomly until told to stop:
					</p><pre class="literallayout">Enter Password or Pin for "NSS Certificate DB":

A random seed must be generated that will be used in the
creation of your key.  One of the easiest ways to create a
random seed is to use the timing of keystrokes on a keyboard.

To begin, type keys on the keyboard until this progress meter
is full.  DO NOT USE THE AUTOREPEAT FUNCTION ON YOUR KEYBOARD!


Continue typing until the progress meter is full:</pre></li><li class="listitem"><p class="simpara">
						Submit the certificate request file to the server. Specify the Kerberos principal to associate with the newly-issued certificate, the output file to store the certificate, and optionally the certificate profile. Specify the IdM sub-CA that you want to issue the certificate. For example, to obtain a certificate of the <code class="literal replaceable">IECUserRoles</code> profile, a profile with added user roles extension, for the <code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> principal from <code class="literal">webclient-ca</code>, and save the certificate in the <code class="literal replaceable">~/idm_user.pem</code> file:
					</p><pre class="literallayout"># ipa cert-request <code class="literal replaceable">certificate_request.csr</code> --principal=<code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> --profile-id=<code class="literal replaceable">IECUserRoles</code> --ca=<code class="literal replaceable">webclient-ca</code> --certificate-out=<code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Add the certificate to the NSS database. Use the <code class="literal option">-n</code> option to set the same nickname that you used when creating the CSR previously so that the certificate matches the private key in the NSS database. The <code class="literal option">-t</code> option sets the trust level. For details, see the certutil(1) man page. The <code class="literal option">-i</code> option specifies the input certificate file. For example, to add to the NSS database a certificate with the <code class="literal replaceable">idm_user</code> nickname that is stored in the <code class="literal replaceable">~/idm_user.pem</code> file in the <code class="literal replaceable">~/certdb/</code> database:
					</p><pre class="literallayout"># certutil -A -d <code class="literal replaceable">~/certdb/</code> -n <code class="literal replaceable">idm_user</code> -t "P,," -i <code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Verify that the key in the NSS database does not show <code class="literal replaceable">(orphan)</code> as its nickname. For example, to verify that the certificate stored in the <code class="literal replaceable">~/certdb/</code> database is not orphaned:
					</p><pre class="literallayout"># certutil -K -d <code class="literal replaceable">~/certdb/</code>
&lt; 0&gt; rsa      5ad14d41463b87a095b1896cf0068ccc467df395   <span class="strong strong"><strong>NSS Certificate DB:idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal command">pk12util</code> command to export the certificate from the NSS database to the PKCS12 format. For example, to export the certificate with the <code class="literal replaceable">idm_user</code> nickname from the <code class="literal filename">/root/certdb</code> NSS database into the <code class="literal replaceable">~/idm_user.p12</code> file:
					</p><pre class="literallayout"># pk12util -d <code class="literal filename">~/certdb</code> -o <code class="literal replaceable">~/idm_user.p12</code> -n <code class="literal replaceable">idm_user</code>
Enter Password or Pin for "NSS Certificate DB":
Enter password for PKCS12 file:
Re-enter password:
pk12util: PKCS12 EXPORT SUCCESSFUL</pre></li><li class="listitem"><p class="simpara">
						Transfer the certificate to the host on which you want the certificate authentication for <code class="literal replaceable">idm_user</code> to be enabled:
					</p><pre class="literallayout"># scp <code class="literal replaceable">~/idm_user.p12</code> <code class="literal replaceable">idm_user@client.idm.example.com:/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						On the host to which the certificate has been transferred, make the directory in which the .pkcs12 file is stored inaccessible to the 'other' group for security reasons:
					</p><pre class="literallayout"># chmod o-rwx <code class="literal replaceable">/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						For security reasons, remove the temporary NSS database and the .pkcs12 file from the server:
					</p><pre class="literallayout"># rm <code class="literal replaceable">~/certdb/</code>
# rm <code class="literal replaceable">~/idm_user.p12</code></pre></li></ol></div></section><section class="section" id="configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h2 class="title">27.12. Configuring a browser to enable certificate authentication</h2></div></div></div><p>
				To be able to authenticate with a certificate when using the WebUI to log into Identity Management (IdM), you need to import the user and the relevant certificate authority (CA) certificates into the Mozilla Firefox or Google Chrome browser. The host itself on which the browser is running does not have to be part of the IdM domain.
			</p><p>
				IdM supports the following browsers for connecting to the WebUI:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mozilla Firefox 38 and later
					</li><li class="listitem">
						Google Chrome 46 and later
					</li></ul></div><p>
				The following procedure shows how to configure the Mozilla Firefox 57.0.1 browser.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the <a class="link" href="index%3Flb_target=stage.html#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs" title="27.11. Requesting a new user certificate and exporting it to the client">user certificate</a> that you want to import to the browser at your disposal in the PKCS#12 format.
					</li><li class="listitem">
						You have <a class="link" href="index%3Flb_target=stage.html#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="27.2. Downloading the sub-CA certificate from IdM WebUI">downloaded the sub-CA certificate</a> and have it at your disposal in the PEM format.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open Firefox, then navigate to <code class="literal gui">Preferences</code> → <code class="literal gui">Privacy &amp; Security</code>.
					</p><div class="figure" id="privacy-security_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 27.7. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="privacy_and_security.png" alt="privacy and security"/></div></div></div></li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">View Certificates</span>.
					</p><div class="figure" id="view-certificates_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 27.8. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="view_certificates.png" alt="view certificates"/></div></div></div></li><li class="listitem">
						In the <code class="literal gui">Your Certificates</code> tab, click <span class="guibutton">Import</span>. Locate and open the certificate of the user in the PKCS12 format, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
					</li><li class="listitem"><p class="simpara">
						To make sure that your IdM sub-CA is recognized by Firefox as a trusted authority, import the IdM sub-CA certificate that you saved in <a class="xref" href="index%3Flb_target=stage.html#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="27.2. Downloading the sub-CA certificate from IdM WebUI">Section 27.2, “Downloading the sub-CA certificate from IdM WebUI”</a> as a trusted certificate authority certificate:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Open Firefox, navigate to Preferences and click <span class="guibutton">Privacy &amp; Security</span>.
							</p><div class="figure" id="privacy-security-2_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 27.9. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="privacy_and_security.png" alt="privacy and security"/></div></div></div></li><li class="listitem"><p class="simpara">
								Click <span class="guibutton">View Certificates</span>.
							</p><div class="figure" id="view-certificates-2_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 27.10. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="view_certificates.png" alt="view certificates"/></div></div></div></li><li class="listitem">
								In the <code class="literal gui">Authorities</code> tab, click <span class="guibutton">Import</span>. Locate and open the sub-CA certificate. Trust the certificate to identify websites, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
							</li></ol></div></li></ol></div></section></section><section class="chapter" id="invalidating-a-specific-group-of-related-certificates-quickly_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 28. Invalidating a specific group of related certificates quickly</h1></div></div></div><p>
			As a system administrator, if you want to be able to invalidate a specific group of related certificates quickly:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Design your applications so that they only trust certificates that were issued by a specific lightweight Identity Management (IdM) sub-CA. Afterwards, you will be able to invalidate all these certificates by only revoking the certificate of the Identity Management (IdM) sub-CA that issued these certificates. For details on how to create and use a lightweight sub-CA in IdM, see <a class="xref" href="index%3Flb_target=stage.html#restricting-an-application-to-trust-only-a-subset-of-certificates_configuring-and-managing-idm" title="Chapter 27. Restricting an application to trust only a subset of certificates">Chapter 27, <em>Restricting an application to trust only a subset of certificates</em></a>.
				</li><li class="listitem"><p class="simpara">
					Ensure that all the certificates that have been issued by the to-be-revoked IdM sub-CA are immediately invalid, configure applications that rely on such certificates to use the IdM OCSP responders. For example, to configure the Firefox browser to use OCSP responders, make sure that the <code class="literal">Query OCSP responder servers to confirm the current validity of certificates</code> checkbox is checked in Firefox Preferences.
				</p><p class="simpara">
					In IdM, the certificate revocation list (CRL) is updated every four hours.
				</p></li></ul></div><p>
			To invalidate all the certificates issued by an IdM sub-CA, revoke the IdM sub-CA certificate. For details, see <a class="xref" href="index%3Flb_target=stage.html#revoking-certificates-with-the-integrated-IdM-CAs_validity-certificates" title="18.2. Revoking certificates with the integrated IdM CAs">Section 18.2, “Revoking certificates with the integrated IdM CAs”</a>. In addition, <a class="link" href="index%3Flb_target=stage.html#disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly" title="28.1. Disabling CA ACLs in IdM CLI">disable the relevant CA ACLs</a>.
		</p><section class="section" id="disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly"><div class="titlepage"><div><div><h2 class="title">28.1. Disabling CA ACLs in IdM CLI</h2></div></div></div><p>
				When you want to retire an IdM service or a group of IdM services, consider disabling any existing corresponding CA ACLs.
			</p><p>
				Complete this section to disable the <a class="link" href="index%3Flb_target=stage.html#creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs" title="27.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca">TLS_web_server_authentication</a> CA ACL that restricts the web server running on your IdM client to request a certificate to be issued by the <code class="literal">webserver-ca</code> IdM sub-CA, and to disable the <a class="link" href="index%3Flb_target=stage.html#creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs" title="27.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca">TLS_web_client_authentication</a> CA ACL that restricts IdM users to request a user certificate to be issued by the <code class="literal">webclient-ca</code> IdM sub-CA.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, to view all the CA ACLs in your IdM environment, enter the <code class="literal">ipa caacl-find</code> command:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-find</strong></span>
-----------------
3 CA ACLs matched
-----------------
  ACL name: hosts_services_caIPAserviceCert
  Enabled: TRUE

  ACL name: TLS_web_server_authentication
  Enabled: TRUE

  ACL name: TLS_web_client_authentication
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
						Optionally, to view the details of a CA ACL, enter the <code class="literal">ipa caacl-show</code> command, and specify the CA ACL name:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-show TLS_web_server_authentication</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
  Profiles: caIPAserviceCert
  Services: HTTP/rhel8server.idm.example.com@IDM.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
						To disable a CA ACL, enter the <code class="literal">ipa caacl-disable</code> command, and specify the CA ACL name.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To disable the <span class="strong strong"><strong>TLS_web_server_authentication</strong></span> CA ACL, enter:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-disable TLS_web_server_authentication</strong></span>
-------------------------------------------------
Disabled CA ACL "TLS_web_server_authentication"
-------------------------------------------------</pre></li><li class="listitem"><p class="simpara">
								To disable the <span class="strong strong"><strong>TLS_web_client_authentication</strong></span> CA ACL, enter:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-disable TLS_web_client_authentication</strong></span>
-------------------------------------------------
Disabled CA ACL "TLS_web_client_authentication"
-------------------------------------------------</pre></li></ul></div><p class="simpara">
						The only enabled CA ACL now is the <span class="strong strong"><strong>hosts_services_caIPAserviceCert</strong></span> CA ACL.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Be extremely careful about disabling the <code class="literal">hosts_services_caIPAserviceCert</code> CA ACL. Disabling <code class="literal">hosts_services_caIPAserviceCert</code>, without another CA ACL granting IdM servers use of the <code class="literal">ipa</code> CA with the <code class="literal">caIPAserviceCert</code> profile means that certificate renewal of the IdM <code class="literal">HTTP</code> and <code class="literal">LDAP</code> certificates will fail. The expired IdM <code class="literal">HTTP</code> and <code class="literal">LDAP</code> certificates will eventually cause IdM system failure.
						</p></div></div></li></ol></div></section></section><section class="chapter" id="enabling-ad-user-to-administer-idm_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 29. Enabling AD users to administer IdM</h1></div></div></div><section class="section" id="idoverrides-to-allow-ad-user-to-administer-idm-fin"><div class="titlepage"><div><div><h2 class="title">29.1. ID overrides for AD users</h2></div></div></div><p>
				In Red Hat Enterprise Linux (RHEL) 7, external group membership allows AD users and groups to access IdM resources in a POSIX environment with the help of the System Security Services Daemon (SSSD).
			</p><p>
				The IdM LDAP server has its own mechanisms to grant access control. RHEL 8 introduces an update that allows adding an ID user override for an AD user as a member of an IdM group. An ID override is a record describing what a specific Active Directory user or group properties should look like within a specific ID view, in this case the Default Trust View. As a consequence of the update, the IdM LDAP server is able to apply access control rules for the IdM group to the AD user.
			</p><p>
				AD users are now able to use the self service features of IdM UI, for example to upload their SSH keys, or change their personal data. An AD administrator is able to fully administer IdM without having two different accounts and passwords.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Currently, selected features in IdM may still be unavailable to AD users. For example, setting passwords for IdM users as an AD user from the IdM <code class="literal replaceable">admins</code> group might fail.
				</p></div></div></section><section class="section" id="using-idoverrides-to-allow-ad-user-to-administer-idm-fin"><div class="titlepage"><div><div><h2 class="title">29.2. Using ID overrides to enable AD users to administer IdM</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal stream">idm:DL1</code> stream is enabled on your IdM server and you have switched to the RPMs delivered through this stream:
					</p><pre class="literallayout"># <span class="strong strong"><strong>yum module enable idm:DL1</strong></span>
# <span class="strong strong"><strong>yum distro-sync</strong></span></pre></li><li class="listitem"><p class="simpara">
						The <code class="literal profile">idm:DL1/adtrust</code> profile is installed on your IdM server.
					</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm:DL1/adtrust</strong></span></pre><p class="simpara">
						The profile contains all the packages necessary for installing an IdM server that will have a trust agreement with Active Directory, including the <code class="literal package">ipa-idoverride-memberof</code> package.
					</p></li><li class="listitem">
						A working Identity Management environment is set up. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-idm">Installing Identity Management</a>.
					</li><li class="listitem">
						A working trust between your Identity Management environment and Active Directory is set up.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					This procedure describes creating and using an ID override for an Active Directory (AD) user to give that user rights identical to those of an Identity Management (IdM) user. During this procedure, work on an IdM server that is configured as a trust controller or a trust agent. For details on trust controllers and trust agents, see <span class="emphasis"><em>Trust</em></span> <span class="emphasis"><em>controllers</em></span> <span class="emphasis"><em>and</em></span> <span class="emphasis"><em>trust</em></span> <span class="emphasis"><em>agents</em></span> in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/planning_identity_management_and_access_control/#trust-controllers-and-trust-agents_planning-a-cross-forest-trust-between-idm-and-ad">Planning Identity Management</a>.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						As an IdM administrator, create an ID override for an AD user in the Default Trust View. For example, to create an ID override for the <code class="literal replaceable">ad_user@ad.example.com</code> user:
					</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span>
# <span class="strong strong"><strong>ipa idoverrideuser-add 'default trust view' ad_user@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add the ID override from the Default Trust View as a member to an IdM group. If the group in question is a member of an IdM role, the AD user represented by the ID override will gain all permissions granted by the role when using the IdM API, including both the command line interface and the IdM web UI. For example, to add the ID override for the <code class="literal replaceable">ad_user@ad.example.com</code> user to the <code class="literal replaceable">admins</code> group:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa group-add-member admins --idoverrideusers=ad_user@ad.example.com</strong></span></pre></li></ol></div></section><section class="section" id="using-idm-cli-as-ad-user-fin"><div class="titlepage"><div><div><h2 class="title">29.3. Managing IdM Command-Line Interface (CLI) as an AD user</h2></div></div></div><p>
				This procedure checks that an Active Directory user can log into Identity Management CLI and run commands appropriate for his role.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Destroy the current Kerberos ticket of the IdM administrator:
					</p><pre class="literallayout"># <span class="strong strong"><strong>kdestroy -A</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The destruction of the Kerberos ticket is required because the GSSAPI implementation in MIT Kerberos chooses credentials from the realm of the target service by preference, which in this case is the IdM realm. This means that if a credentials cache collection, namely the KCM:, KEYRING:, or DIR: type of credentials cache is in use, a previously obtained <code class="literal replaceable">admin</code> or any other IdM principal’s credentials will be used to access the IdM API instead of the AD user’s credentials.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Obtain the Kerberos credentials of the AD user for whom an ID override has been created:
					</p><pre class="literallayout"># <span class="strong strong"><strong>kinit ad_user@AD.EXAMPLE.COM</strong></span>
<span class="strong strong"><strong>Password for ad_user@AD.EXAMPLE.COM:</strong></span></pre></li><li class="listitem"><p class="simpara">
						Test that the ID override of the AD user enjoys the same privileges stemming from membership in the IdM group as any IdM user in that group. If the ID override of the AD user has been added to the <code class="literal replaceable">admins</code> group, the AD user can, for example, create groups in IdM:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa group-add some-new-group</strong></span>
----------------------------
Added group "some-new-group"
----------------------------
  Group name: some-new-group
  GID: 1997000011</pre></li></ol></div></section></section><section class="chapter" id="using-canonicalized-dns-host-names-in-idm_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 30. Using canonicalized DNS host names in IdM</h1></div></div></div><p>
			DNS canonicalization is disabled by default on IdM clients to avoid potential security risks. For example, if an attacker controls the DNS server and a host in the domain, the attacker can cause that the short host name <code class="literal systemitem">demo</code> is resolved to <code class="literal systemitem">malicious.example.com</code>. In this case, the user connects to a different server than expected.
		</p><p>
			This section describes how to use canonicalized host names on IdM clients.
		</p><section class="section" id="adding-an-alias-to-a-host-principal_using-canonicalized-dns-host-names-in-idm"><div class="titlepage"><div><div><h2 class="title">30.1. Adding an alias to a host principal</h2></div></div></div><p>
				By default, IdM clients enrolled by using the <code class="literal command">ipa-client-install</code> command do not allow to use short host names in service principals. For example, users can use only <code class="literal systemitem">host/demo.example.com@EXAMPLE.COM</code> instead of <code class="literal systemitem">host/demo@EXAMPLE.COM</code> when accessing a service.
			</p><p>
				This section explains how to add an alias to a Kerberos principal. Note that you can alternatively enable canonicalization of host names in the <code class="literal filename">/etc/krb5.conf</code> file. For details, see <a class="xref" href="index%3Flb_target=stage.html#enabling-canonicalization-of-host-names-in-service-principals-on-clients_using-canonicalized-dns-host-names-in-idm" title="30.2. Enabling canonicalization of host names in service principals on clients">Section 30.2, “Enabling canonicalization of host names in service principals on clients”</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The IdM client is installed.
					</li><li class="listitem">
						The host name is unique in the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Authenticate to IdM as the <code class="literal systemitem">admin</code> user:
					</p><pre class="literallayout">$ kinit admin</pre></li><li class="listitem"><p class="simpara">
						Add the alias to the host principal. For example, to add the <code class="literal systemitem">demo</code> alias to the <code class="literal systemitem">demo.examle.com</code> host principal:
					</p><pre class="literallayout">$ ipa host-add-principal <span class="emphasis"><em>demo.example.com</em></span> --principal=<span class="emphasis"><em>demo</em></span></pre></li></ol></div></section><section class="section" id="enabling-canonicalization-of-host-names-in-service-principals-on-clients_using-canonicalized-dns-host-names-in-idm"><div class="titlepage"><div><div><h2 class="title">30.2. Enabling canonicalization of host names in service principals on clients</h2></div></div></div><p>
				This section describes how you enable canonicalization of host names in services principals on clients.
			</p><p>
				Note that if you use host principal aliases, as described in <a class="xref" href="index%3Flb_target=stage.html#adding-an-alias-to-a-host-principal_using-canonicalized-dns-host-names-in-idm" title="30.1. Adding an alias to a host principal">Section 30.1, “Adding an alias to a host principal”</a>, you do not need to enable canonicalization.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The IdM client is installed.
					</li><li class="listitem">
						You are logged in to the IdM client as the <code class="literal systemitem">root</code> user.
					</li><li class="listitem">
						The host name is unique in the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Set the <code class="literal parameter">dns_canonicalize_hostname</code> parameter in the <code class="literal systemitem">[libdefaults]</code> section in the <code class="literal filename">/etc/krb5.conf</code> file to <code class="literal command">false</code>:
					</p><pre class="literallayout">[libdefaults]
...
dns_canonicalize_hostname = true</pre></li></ol></div></section><section class="section" id="options-for-using-host-names-with-dns-host-name-canonicalization-enabled_using-canonicalized-dns-host-names-in-idm"><div class="titlepage"><div><div><h2 class="title">30.3. Options for using host names with DNS host name canonicalization enabled</h2></div></div></div><p>
				If you set <code class="literal command">dns_canonicalize_hostname = true</code> in the <code class="literal filename">/etc/krb5.conf</code> file as explained in <a class="xref" href="index%3Flb_target=stage.html#enabling-canonicalization-of-host-names-in-service-principals-on-clients_using-canonicalized-dns-host-names-in-idm" title="30.2. Enabling canonicalization of host names in service principals on clients">Section 30.2, “Enabling canonicalization of host names in service principals on clients”</a>, you have the following options when you use a host name in a service principal:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						In IdM environments, you can use the full host name in a service principal, such as <code class="literal systemitem">host/demo.example.com@EXAMPLE.COM</code>.
					</li><li class="listitem">
						In environments without IdM, but if the RHEL host as a member of an Active Directory (AD) domain, no further considerations are required, because AD domain controllers (DC) automatically create service principals for NetBIOS names of the machines enrolled into Active Directory.
					</li></ul></div></section></section><section class="chapter" id="collecting-idm-healthcheck-information_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 31. Collecting IdM Healthcheck information</h1></div></div></div><p>
			Healthcheck has been designed as a manual command line tool which should help you to identify possible problems in Identity Management.
		</p><p>
			This chapter describes how you can create a collection of logs based on the Healthcheck output with 30-day rotation.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available on RHEL 8.1 or newer
				</li></ul></div><section class="section" id="healthcheck-in-idm_collecting-idm-healthcheck-information"><div class="titlepage"><div><div><h2 class="title">31.1. Healthcheck in IdM</h2></div></div></div><p>
				The Healthcheck tool in IdM helps find issues that may impact the state of your IdM environment.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Healthcheck tool is a command line tool that can be used without Kerberos authentication.
				</p></div></div><section class="section" id="modules_are_independent"><div class="titlepage"><div><div><h3 class="title">31.1.1. Modules are Independent</h3></div></div></div><p>
					Healthcheck consists of independent modules which test for:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Replication issues
						</li><li class="listitem">
							Certificate validity
						</li><li class="listitem">
							Certificate Authority infrastructure issues
						</li><li class="listitem">
							IdM and Active Directory trust issues
						</li><li class="listitem">
							Correct file permissions and ownership settings
						</li></ul></div></section><section class="section" id="two_output_formats"><div class="titlepage"><div><div><h3 class="title">31.1.2. Two output formats</h3></div></div></div><p>
					Healthcheck generates the following outputs:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Human-readable output
						</li><li class="listitem">
							Machine-readable output in JSON format
						</li></ul></div><p>
					The output destination for both human and JSON is standard output by default. You can specify a different destination with the <code class="literal">--output-file</code> option.
				</p></section><section class="section" id="results"><div class="titlepage"><div><div><h3 class="title">31.1.3. Results</h3></div></div></div><p>
					Each Healthcheck module returns one of the following results:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">SUCCESS</span></dt><dd>
								configured as expected
							</dd><dt><span class="term">WARNING</span></dt><dd>
								not an error, but worth keeping an eye on or evaluating
							</dd><dt><span class="term">ERROR</span></dt><dd>
								not configured as expected
							</dd><dt><span class="term">CRITICAL</span></dt><dd>
								not configured as expected, with a high possibility for impact
							</dd></dl></div></section><section class="section" id="running_idm_healthcheck"><div class="titlepage"><div><div><h3 class="title">31.1.4. Running IdM Healthcheck</h3></div></div></div><p>
					Healthcheck can be run:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Manually
						</p><pre class="literallayout">[root@master ~]# <span class="strong strong"><strong>ipa-healthcheck</strong></span></pre><p class="simpara">
							For all options, see the man page: <code class="literal">man ipa-healthcheck</code>.
						</p></li><li class="listitem">
							Automatically using <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/collecting-idm-healthcheck-information_configuring-and-managing-idm#log-rotation_collecting-idm-healthcheck-information">log rotation</a>.
						</li></ul></div></section></section><section class="section" id="log-rotation_collecting-idm-healthcheck-information"><div class="titlepage"><div><div><h2 class="title">31.2. Log rotation</h2></div></div></div><p>
				Log rotation creates a new log file every day, and the files are organized by date. Since log files are saved in the same directory, you can select a particular log file according to the date.
			</p><p>
				Rotation means that there is configured a number for max number of log files and if the number is exceeded, the newest file rewrites and renames the oldest one. For example, if the rotation number is 30, the thirty-first log file replaces the first (oldest) one.
			</p><p>
				Log rotation reduces voluminous log files and organizes them, which can help with analysis of the logs.
			</p></section><section class="section" id="configuring-log-rotation-using-the-idm-healthcheck_collecting-idm-healthcheck-information"><div class="titlepage"><div><div><h2 class="title">31.3. Configuring log rotation using the IdM Healthcheck</h2></div></div></div><p>
				This section describes how to configure a log rotation with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						the <code class="literal">systemd</code> timer
					</li><li class="listitem">
						the <code class="literal">crond</code> service
					</li></ul></div><p>
				The <code class="literal">systemd</code> timer runs the Healthcheck tool periodically and generates the logs. The default value is set to 4 am every day.
			</p><p>
				The <code class="literal">crond</code> service is used for log rotation.
			</p><p>
				The default log name is <code class="literal">healthcheck.log</code> and the rotated logs use the <code class="literal">healthcheck.log-YYYYMMDD</code> format.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must execute commands as root.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable a <code class="literal">systemd</code> timer:
					</p><pre class="literallayout"># systemctl enable ipa-healthcheck.timer
Created symlink /etc/systemd/system/multi-user.target.wants/ipa-healthcheck.timer -&gt; /usr/lib/systemd/system/ipa-healthcheck.timer.</pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">systemd</code> timer:
					</p><pre class="literallayout"># systemctl start ipa-healthcheck.timer</pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">/etc/logrotate.d/ipahealthcheck</code> file to configure the number of logs which should be saved.
					</p><p class="simpara">
						By default, log rotation is set up for 30 days.
					</p></li><li class="listitem"><p class="simpara">
						In the <code class="literal">/etc/logrotate.d/ipahealthcheck</code> file, configure the path to the logs.
					</p><p class="simpara">
						By default, logs are saved in the <code class="literal">/var/log/ipa/healthcheck/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						In the <code class="literal">/etc/logrotate.d/ipahealthcheck</code> file, configure the time for log generation.
					</p><p class="simpara">
						By default, a log is created daily at 4 AM.
					</p></li><li class="listitem"><p class="simpara">
						To use log rotation, ensure that the <code class="literal">crond</code> service is enabled and running:
					</p><pre class="literallayout"># systemctl enable crond
# systemctl start crond</pre></li></ol></div><p>
				To start with generating logs, start the IPA healthcheck service:
			</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre><p>
				To verify the result, go to <code class="literal">/var/log/ipa/healthcheck/</code> and check if logs are created correctly.
			</p></section></section><section class="chapter" id="checking-services-using-idm-healthcheck_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 32. Checking services using IdM Healthcheck</h1></div></div></div><p>
			This section describes monitoring services used by the Identity Management (IdM) server using the Healthcheck tool.
		</p><p>
			For details, see <a class="link" href="index%3Flb_target=stage.html#healthcheck-in-idm_collecting-idm-healthcheck-information">Healthcheck in IdM</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available on RHEL 8.1 and newer
				</li><li class="listitem"><p class="simpara">
					Enable Healtheck on the IdM server:
				</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre></li></ul></div><section class="section" id="services-healthcheck-test_checking-services-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">32.1. Services Healthcheck test</h2></div></div></div><p>
				The Healthcheck tool includes a test to check if any IdM services is not running. This test is important because services which are not running can cause failures in other tests. Therefore, check that all services are running first. You can then check all other test results.
			</p><p>
				To see all services tests, run <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				You can find all services tested with Healthcheck under the <code class="literal">ipahealthcheck.meta.services</code> source:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						certmonger
					</li><li class="listitem">
						dirsrv
					</li><li class="listitem">
						gssproxy
					</li><li class="listitem">
						httpd
					</li><li class="listitem">
						ipa_custodia
					</li><li class="listitem">
						ipa_dnskeysyncd
					</li><li class="listitem">
						ipa_otpd
					</li><li class="listitem">
						kadmin
					</li><li class="listitem">
						krb5kdc
					</li><li class="listitem">
						named
					</li><li class="listitem">
						pki_tomcatd
					</li><li class="listitem">
						sssd
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Run these tests on all IdM master servers when trying to discover issues.
				</p></div></div></section><section class="section" id="screening-services-using-healthcheck_checking-services-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">32.2. Screening services using Healthcheck</h2></div></div></div><p>
				This section describes a standalone manual test of services running on the Identity Management (IdM) server using the Healthcheck tool.
			</p><p>
				The Healthcheck tool includes many tests, whose results can be shortened with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						excluding all successful test: <code class="literal">--failures-only</code>
					</li><li class="listitem">
						including only services tests: <code class="literal">--source=ipahealthcheck.meta.services</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck with warnings, errors and critical issues regarding services, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.meta.services --failures-only</pre></li></ul></div><p>
				A successful test displays empty brackets:
			</p><pre class="literallayout">[ ]</pre><p>
				If one of the services fails, the result can looks similarly to this example:
			</p><pre class="literallayout">{
  "source": "ipahealthcheck.meta.services",
  "check": "httpd",
  "result": "ERROR",
  "kw": {
    "status": false,
    "msg": "httpd: not running"
  }
}</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For reviewing detailed reference, enter <code class="literal">man ipa-healthcheck</code> in the command line.
					</li></ul></div></section></section><section class="chapter" id="verifying-your-idm-and-ad-trust-configuration-using-idm-healthcheck_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 33. Verifying your IdM and AD trust configuration using IdM Healthcheck</h1></div></div></div><p>
			This section helps you understand and use the Healthcheck tool in Identity management (IdM) to identify issues with IdM and an Active Directory trust.
		</p><p>
			For details, see <a class="xref" href="index%3Flb_target=stage.html#healthcheck-in-idm_collecting-idm-healthcheck-information" title="31.1. Healthcheck in IdM">Section 31.1, “Healthcheck in IdM”</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available on RHEL 8.1 or newer
				</li><li class="listitem"><p class="simpara">
					Enable Healtheck on the IdM server:
				</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre></li></ul></div><section class="section" id="idm-and-ad-trust-healthcheck-tests_verifying-your-idm-and-ad-trust-configuration-using-idm-healthcheck"><div class="titlepage"><div><div><h2 class="title">33.1. IdM and AD trust Healthcheck tests</h2></div></div></div><p>
				The Healthcheck tool includes several tests for testing the status of your IdM and AD trust.
			</p><p>
				To see all trust tests, run <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				You can find all tests under the <code class="literal">ipahealthcheck.ipa.trust</code> source:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">IPATrustAgentCheck</span></dt><dd>
							This test checks the SSSD configuration when the machine is configured as a trust agent. For each domain in <code class="literal">/etc/sssd/sssd.conf</code> where <code class="literal">id_provider=ipa</code> ensure that <code class="literal">ipa_server_mode</code> is <code class="literal">True</code>.
						</dd><dt><span class="term">IPATrustDomainsCheck</span></dt><dd>
							This test checks if the trust domains match SSSD domains by comparing the list of domains in <code class="literal">sssctl domain-list</code> with the list of domains from <code class="literal">ipa trust-find</code> excluding the IPA domain.
						</dd><dt><span class="term">IPATrustCatalogCheck</span></dt><dd><p class="simpara">
							This test resolves resolves an AD user, <code class="literal">Administrator@REALM</code>. This populates the AD Global catalog and AD Domain Controller values in <code class="literal">sssctl domain-status</code> output.
						</p><p class="simpara">
							For each trust domain look up the user with the id of the SID + 500 (the administrator) and then check the output of <code class="literal">sssctl domain-status &lt;domain&gt; --active-server</code> to ensure that the domain is active.
						</p></dd><dt><span class="term">IPAsidgenpluginCheck</span></dt><dd>
							This test verifies that the <code class="literal">sidgen</code> plugin is enabled in the IPA 389-ds instance. The test also verifies that the <code class="literal">IPA SIDGEN</code> and <code class="literal">ipa-sidgen-task</code> plugins in <code class="literal">cn=plugins,cn=config</code> include the <code class="literal">nsslapd-pluginEnabled</code> option.
						</dd><dt><span class="term">IPATrustAgentMemberCheck</span></dt><dd>
							This test verifies that the current host is a member of <code class="literal">cn=adtrust agents,cn=sysaccounts,cn=etc,SUFFIX</code>.
						</dd><dt><span class="term">IPATrustControllerPrincipalCheck</span></dt><dd>
							This test verifies that the current host is a member of <code class="literal">cn=adtrust agents,cn=sysaccounts,cn=etc,SUFFIX</code>.
						</dd><dt><span class="term">IPATrustControllerServiceCheck</span></dt><dd>
							This test verifies that the current host starts the ADTRUST service in ipactl.
						</dd><dt><span class="term">IPATrustControllerConfCheck</span></dt><dd>
							This test verifies that <code class="literal">ldapi</code> is enabled for the passdb backend in the output of <code class="literal">net conf</code> list.
						</dd><dt><span class="term">IPATrustControllerGroupSIDCheck</span></dt><dd>
							This test verifies that the admins group’s SID ends with 512 (Domain Admins RID).
						</dd><dt><span class="term">IPATrustPackageCheck</span></dt><dd>
							This test verifies that the <code class="literal">trust-ad</code> package is installed if the trust controller and AD trust are not enabled.
						</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Run these tests on all IdM master servers when trying to find an issue.
				</p></div></div></section><section class="section" id="screening-the-trust-with-the-healthcheck-tool_verifying-your-idm-and-ad-trust-configuration-using-idm-healthcheck"><div class="titlepage"><div><div><h2 class="title">33.2. Screening the trust with the Healthcheck tool</h2></div></div></div><p>
				This section describes a standalone manual test of an Identity Management (IdM) and Active Directory (AD) trust health check using the Healthcheck tool.
			</p><p>
				The Healthcheck tool includes many tests, therefore, you can shorten the results by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						excluding all successful test: <code class="literal">--failures-only</code>
					</li><li class="listitem">
						including only trust tests: <code class="literal">--source=ipahealthcheck.ipa.trust</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck with warnings, errors and critical issues in the trust, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.ipa.trust --failures-only</pre></li></ul></div><p>
				Successful test displays empty brackets:
			</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.ipa.trust --failures-only
[]</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For reviewing detailed reference, enter <code class="literal">man ipa-healthcheck</code> in the command line.
					</li></ul></div></section></section><section class="chapter" id="verifying-certificates-using-idm-healthcheck_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 34. Verifying certificates using IdM Healthcheck</h1></div></div></div><p>
			This section helps in understanding and using the Healthcheck tool in Identity management (IdM) to identify issues with IPA certificates maintained by certmonger.
		</p><p>
			For details, see <a class="link" href="index%3Flb_target=stage.html#healthcheck-in-idm_collecting-idm-healthcheck-information">Healthcheck in IdM</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available in RHEL 8.1 and newer.
				</li><li class="listitem"><p class="simpara">
					Enable Healtheck on the IdM server:
				</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre></li></ul></div><section class="section" id="idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck"><div class="titlepage"><div><div><h2 class="title">34.1. IdM certificates Healthcheck tests</h2></div></div></div><p>
				The Healthcheck tool includes several tests for verifying the status of certificates maintained by certmonger in Identity Management (IdM). For details about certmonger, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/using-certmonger_managing-hosts-cli">Obtaining an IdM certificate for a service using certmonger</a>.
			</p><p>
				This suite of tests checks expiration, validation, trust and other issues. Multiple errors may be thrown for the same underlying issue.
			</p><p>
				To see all certificate tests, run the <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				You can find all tests under the <code class="literal">ipahealthcheck.ipa.certs</code> source:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">IPACertmongerExpirationCheck</span></dt><dd><p class="simpara">
							This test checks expirations in <code class="literal">certmonger</code>.
						</p><p class="simpara">
							If an error is reported, the certificate has expired.
						</p><p class="simpara">
							If a warning appears, the certificate will expire soon. By default, this test applies within 28 days or fewer days before certificate expiration.
						</p><p class="simpara">
							You can configure the number of days in the <code class="literal">/etc/ipahealthcheck/ipahealthcheck.conf</code> file. After opening the file, change the <code class="literal">cert_expiration_days</code> option located in the default section.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Certmonger loads and maintains its own view of the certificate expiration. This check does not validate the on-disk certificate.
							</p></div></div></dd><dt><span class="term">IPACertfileExpirationCheck</span></dt><dd><p class="simpara">
							This test checks if the certificate file or NSS database cannot be opened. This test also checks expiration. Therefore, carefully read the <code class="literal">msg</code> attribute in the error or warning output. The message specifies the problem.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								This test checks the on-disk certificate. If a certificate is missing, unreadable, etc a separate error can also be raised.
							</p></div></div></dd><dt><span class="term">IPACertNSSTrust</span></dt><dd>
							This test compares the trust for certificates stored in NSS databases. For the expected tracked certificates in NSS databases the trust is compared to an expected value and an error raised on a non-match.
						</dd><dt><span class="term">IPANSSChainValidation</span></dt><dd>
							This test validates the certificate chain of the NSS certificates. The test executes: <code class="literal">certutil -V -u V -e -d [dbdir] -n [nickname]</code>
						</dd><dt><span class="term">IPAOpenSSLChainValidation</span></dt><dd><p class="simpara">
							This test validates the certificate chain of the OpenSSL certificates. To be comparable to the <code class="literal">NSSChain</code> validation here is the OpenSSL command we execute:
						</p><pre class="literallayout">openssl verify -verbose -show_chain -CAfile /etc/ipa/ca.crt [cert file]</pre></dd><dt><span class="term">IPARAAgent</span></dt><dd>
							This test compares the certificate on disk with the equivalent record in LDAP in <code class="literal">uid=ipara,ou=People,o=ipaca</code>.
						</dd><dt><span class="term">IPACertRevocation</span></dt><dd>
							This test uses certmonger to verify that certificates have not been revoked. Therefore, the test can find issues connected with certificates maintained by certmonger only.
						</dd><dt><span class="term">IPACertmongerCA</span></dt><dd><p class="simpara">
							This test verifies the certmonger Certificate Authority (CA) configuration. IdM cannot issue certificates without CA.
						</p><p class="simpara">
							Certmonger maintains a set of CA helpers. In IdM, there is a CA named IPA which issues certificates through IdM, authenticating as a host or user principal, for host or service certs.
						</p><p class="simpara">
							There are also <code class="literal">dogtag-ipa-ca-renew-agent</code> and <code class="literal">dogtag-ipa-ca-renew-agent-reuse</code> which renew the CA subsystem certificates.
						</p></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Run these tests on all IdM master servers when trying to check for issues.
				</p></div></div></section><section class="section" id="screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck"><div class="titlepage"><div><div><h2 class="title">34.2. Screening certificates using the Healthcheck tool</h2></div></div></div><p>
				This section describes a standalone manual test of an Identity Management (IdM) certificate health check using the Healthcheck tool.
			</p><p>
				The Healthcheck tool includes many tests, therefore, you can shorten the results with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						excluding all successful test: <code class="literal">--failures-only</code>
					</li><li class="listitem">
						including only certificate tests: <code class="literal">--source=ipahealthcheck.ipa.certs</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Healthcheck tests must be performed as the root user.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck with warnings, errors and critical issues regarding certificates, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.ipa.certs --failures-only</pre></li></ul></div><p>
				Successful test displays empty brackets:
			</p><pre class="literallayout">[]</pre><p>
				Failed test shows you the following output:
			</p><pre class="literallayout">{
  "source": "ipahealthcheck.ipa.certs",
  "check": "IPACertfileExpirationCheck",
  "result": "ERROR",
  "kw": {
    "key": 1234,
    "dbdir": "/path/to/nssdb",
    "error": [error],
    "msg": "Unable to open NSS database '/path/to/nssdb': [error]"
  }
}</pre><p>
				This <code class="literal">IPACertfileExpirationCheck</code> test failed on opening the NSS database.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For reviewing detailed reference, enter <code class="literal">man ipa-healthcheck</code> in the command line.
					</li></ul></div></section></section><section class="chapter" id="verifying-system-certificates-using-idm-healthcheck_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 35. Verifying system certificates using IdM Healthcheck</h1></div></div></div><p>
			This section describes a Healthcheck tool in Identity Management (IdM) to identify issues with system certificates.
		</p><p>
			For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management#healthcheck-in-idm_collecting-idm-healthcheck-information">Healthcheck in IdM</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available on RHEL 8.1 or newer.
				</li><li class="listitem"><p class="simpara">
					Enable Healtheck on the IdM server:
				</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre></li></ul></div><section class="section" id="system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">35.1. System certificates Healthcheck tests</h2></div></div></div><p>
				The Healthcheck tool includes several tests for verifying system (DogTag) certificates.
			</p><p>
				To see all tests, run the <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				You can find all tests under the <code class="literal">ipahealthcheck.dogtag.ca</code> source:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">DogtagCertsConfigCheck</span></dt><dd><p class="simpara">
							This test compares the CA (Certificate Authority) certificates in its NSS database to the same values stored in <code class="literal">CS.cfg</code>. If they don’t match, CA fails to start.
						</p><p class="simpara">
							Specifically, it checks:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">auditSigningCert cert-pki-ca</code> against <code class="literal">ca.audit_signing.cert</code>
								</li><li class="listitem">
									<code class="literal">ocspSigningCert cert-pki-ca</code> against <code class="literal">ca.ocsp_signing.cert</code>
								</li><li class="listitem">
									<code class="literal">caSigningCert cert-pki-ca</code> against <code class="literal">ca.signing.cert</code>
								</li><li class="listitem">
									<code class="literal">subsystemCert cert-pki-ca</code> against <code class="literal">ca.subsystem.cert</code>
								</li><li class="listitem">
									<code class="literal">Server-Cert cert-pki-ca</code> against <code class="literal">ca.sslserver.cert</code>
								</li></ul></div><p class="simpara">
							If Key Recovery Authority (KRA) is installed:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">transportCert cert-pki-kra</code> against <code class="literal">ca.connector.KRA.transportCert</code>
								</li></ul></div></dd><dt><span class="term">DogtagCertsConnectivityCheck</span></dt><dd><p class="simpara">
							This test verifies connectivity. This test is equivalent to the <code class="literal">ipa cert-show 1</code> command which checks:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The PKI proxy configuration in Apache
								</li><li class="listitem">
									IdM being able to find a CA
								</li><li class="listitem">
									The RA agent client certificate
								</li><li class="listitem">
									Correctness of CA replies to requests
								</li></ul></div><p class="simpara">
							Note that the test checks a certificate with serial #1 because you want to verify that a <code class="literal">cert-show</code> can be executed and get back an expected result from CA (either the certificate or a not found).
						</p></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Run these tests on all IdM master servers when trying to find an issue.
				</p></div></div></section><section class="section" id="screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">35.2. Screening system certificates using Healthcheck</h2></div></div></div><p>
				This section describes a standalone manual test of Identity Management (IdM) certificates using the Healthcheck tool.
			</p><p>
				Since, the Healthcheck tool includes many tests, you can narrow the results by including only DogTag tests: <code class="literal">--source=ipahealthcheck.dogtag.ca</code>
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck restricted to DogTag certificates, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.dogtag.ca</pre></li></ul></div><p>
				An example of a successful test:
			</p><pre class="literallayout">{
  "source: ipahealthcheck.dogtag.ca",
  "check: DogtagCertsConfigCheck",
  "result: SUCCESS",
  "uuid: 9b366200-9ec8-4bd9-bb5e-9a280c803a9c",
  "when: 20191008135826Z",
  "duration: 0.252280",
  "kw:" {
    "key": "Server-Cert cert-pki-ca",
    "configfile":  "/var/lib/pki/pki-tomcat/conf/ca/CS.cfg"
    }
}</pre><p>
				An example of a failed test:
			</p><pre class="literallayout">{
  "source: ipahealthcheck.dogtag.ca",
  "check: DogtagCertsConfigCheck",
  "result: CRITICAL",
  "uuid: 59d66200-1447-4b3b-be01-89810c803a98",
  "when: 20191008135912Z",
  "duration: 0.002022",
  "kw:" {
    "exception": "NSDB /etc/pki/pki-tomcat/alias not initialized",
    }
}</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For reviewing detailed reference, enter <code class="literal">man ipa-healthcheck</code> in the command line.
					</li></ul></div></section></section><section class="chapter" id="checking-disk-space-using-idm-healthcheck_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 36. Checking disk space using IdM Healthcheck</h1></div></div></div><p>
			This section describes how to monitor the Identity Management server’s free disk space using the Healthcheck tool.
		</p><p>
			For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management#healthcheck-in-idm_collecting-idm-healthcheck-information">Healthcheck in IdM</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available on RHEL 8.1 and newer.
				</li><li class="listitem"><p class="simpara">
					Enable Healtheck on the IdM server:
				</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre></li></ul></div><section class="section" id="disk-space-healthcheck-test_checking-disk-space-using-idm-healthcheck"><div class="titlepage"><div><div><h2 class="title">36.1. Disk space healthcheck test</h2></div></div></div><p>
				The Healthcheck tool includes a test for checking available disk space. Insufficient free disk space can cause issues with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Logging
					</li><li class="listitem">
						Execution
					</li><li class="listitem">
						Backups
					</li></ul></div><p>
				The test checks the following paths:
			</p><div class="table" id="idm140406474165472"><p class="title"><strong>Table 36.1. Tested paths</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140406474160640" scope="col">Paths checked by the test</th><th align="left" valign="top" id="idm140406474159536" scope="col">Minimal disk space in MB</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140406474160640"> <p>
								<code class="literal">/var/lib/dirsrv/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406474159536"> <p>
								1024
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406474160640"> <p>
								<code class="literal">/var/lib/ipa/backup/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406474159536"> <p>
								512
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406474160640"> <p>
								<code class="literal">/var/log/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406474159536"> <p>
								1024
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406474160640"> <p>
								<code class="literal">var/log/audit/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406474159536"> <p>
								512
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406474160640"> <p>
								<code class="literal">/var/tmp/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406474159536"> <p>
								512
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140406474160640"> <p>
								<code class="literal">/tmp/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140406474159536"> <p>
								512
							</p>
							 </td></tr></tbody></table></div></div><p>
				To list all tests, run the <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				The file system space check test is placed under the <code class="literal">ipahealthcheck.system.filesystemspace</code> source:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">FileSystemSpaceCheck</span></dt><dd><p class="simpara">
							This test checks available disk space in the following ways:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The minimum raw free bytes needed.
								</li><li class="listitem">
									The percentage — the minimum free disk space is hardcoded to 20%.
								</li></ul></div></dd></dl></div></section><section class="section" id="screening-disk-space-using-the-healthcheck-tool_checking-disk-space-using-idm-healthcheck"><div class="titlepage"><div><div><h2 class="title">36.2. Screening disk space using the healthcheck tool</h2></div></div></div><p>
				This section describes a standalone manual test of available disk space on an Identity Management (IdM) server using the Healthcheck tool.
			</p><p>
				Since Healthcheck includes many tests, you can narrow the results by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						excluding all successful test: <code class="literal">--failures-only</code>
					</li><li class="listitem">
						including only space check tests: <code class="literal">--source=ipahealthcheck.system.filesystemspace</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck with warnings, errors and critical issues regarding available disk space, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.system.filesystemspace --failures-only</pre></li></ul></div><p>
				A successful test displays empty brackets:
			</p><pre class="literallayout">[]</pre><p>
				As an example, a failed test can display:
			</p><pre class="literallayout">{
  "source": "ipahealthcheck.system.filesystemspace",
  "check": "FileSystemSpaceCheck",
  "result": "ERROR",
  "kw": {
    "msg": "/var/lib/dirsrv: free space under threshold: 0 MiB &lt; 1024 MiB",
    "store": "/var/lib/dirsrv",
    "free_space": 0,
    "threshold": 1024
  }
}</pre><p>
				The failed test informs you that the <code class="literal">/var/lib/dirsrv</code> directory has run out of space.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For reviewing detailed reference, enter <code class="literal">man ipa-healthcheck</code> in the command line.
					</li></ul></div></section></section><section class="chapter" id="verifying-permissions-of-idm-configuration-files-using-healthcheck_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 37. Verifying permissions of IdM configuration files using Healthcheck</h1></div></div></div><p>
			This section describes how to test Identity Management (IdM) configuration files using the Healthcheck tool.
		</p><p>
			For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management#healthcheck-in-idm_collecting-idm-healthcheck-information">Healthcheck in IdM</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available on RHEL 8.1 or newer systems.
				</li><li class="listitem"><p class="simpara">
					Enable Healtheck on the IdM server:
				</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre></li></ul></div><section class="section" id="file-permissions-healthcheck-tests_verifying-permissions-of-idm-configuration-files-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">37.1. File permissions Healthcheck tests</h2></div></div></div><p>
				The Healthcheck tool tests ownership and permissions of some important files installed or configured by Identity Management (IdM).
			</p><p>
				If you change the ownership or permissions of any tested file, the test returns a warning in the <code class="literal">result</code> section. While it does not necessarily mean that the configuration will not work, it means that the file differs from the default configuration.
			</p><p>
				To see all tests, run the <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				The file permissions test is placed under the <code class="literal">ipahealthcheck.ipa.files</code> source:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">IPAFileNSSDBCheck</span></dt><dd>
							This test checks the 389-ds NSS database and the Certificate Authority (CA) database. The 389-ds database is located in <code class="literal">/etc/dirsrv/slapd-&lt;dashed-REALM&gt;</code> and the CA database is located in <code class="literal">/etc/pki/pki-tomcat/alias/</code>.
						</dd><dt><span class="term">IPAFileCheck</span></dt><dd><p class="simpara">
							This test checks the following files:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">/var/lib/ipa/ra-agent.{key|pem}</code>
								</li><li class="listitem">
									<code class="literal">/var/lib/ipa/certs/httpd.pem</code>
								</li><li class="listitem">
									<code class="literal">/var/lib/ipa/private/httpd.key</code>
								</li><li class="listitem">
									<code class="literal">/etc/httpd/alias/ipasession.key</code>
								</li><li class="listitem">
									<code class="literal">/etc/dirsrv/ds.keytab</code>
								</li><li class="listitem">
									<code class="literal">/etc/ipa/ca.crt</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal">/etc/ipa/custodia/server.keys</code>
								</p><p class="simpara">
									If PKINIT is enabled:
								</p></li><li class="listitem">
									<code class="literal">/var/lib/ipa/certs/kdc.pem</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal">/var/lib/ipa/private/kdc.key</code>
								</p><p class="simpara">
									If DNS is configured:
								</p></li><li class="listitem">
									<code class="literal">/etc/named.keytab</code>
								</li><li class="listitem">
									<code class="literal">/etc/ipa/dnssec/ipa-dnskeysyncd.keytab</code>
								</li></ul></div></dd><dt><span class="term">TomcatFileCheck</span></dt><dd><p class="simpara">
							This test checks some tomcat-specific files if a CA is configured:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">/etc/pki/pki-tomcat/password.conf</code>
								</li><li class="listitem">
									<code class="literal">/var/lib/pki/pki-tomcat/conf/ca/CS.cfg</code>
								</li><li class="listitem">
									<code class="literal">/etc/pki/pki-tomcat/server.xml</code>
								</li></ul></div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Run these tests on all IdM master servers when trying to find issues.
				</p></div></div></section><section class="section" id="screening-configuration-files-using-healthcheck_verifying-permissions-of-idm-configuration-files-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">37.2. Screening configuration files using Healthcheck</h2></div></div></div><p>
				This section describes a standalone manual test of an Identity Management (IdM) server’s configuration files using the Healthcheck tool.
			</p><p>
				The Healthcheck tool includes many tests. Results can be narrowed down by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						excluding all successful test: <code class="literal">--failures-only</code>
					</li><li class="listitem">
						including only ownership and permissions tests: <code class="literal">--source=ipahealthcheck.ipa.files</code>
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To run Healthcheck tests on IdM configuration file ownership and permissions, while displaying only warnings, errors and critical issues, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.ipa.files --failures-only</pre></li></ol></div><p>
				A successful test displays empty brackets:
			</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.ipa.files --failures-only
[]</pre><p>
				Failed tests display results similar to the following <code class="literal">WARNING</code>:
			</p><pre class="literallayout">{
  "source": "ipahealthcheck.ipa.files",
  "check": "IPAFileNSSDBCheck",
  "result": "WARNING",
  "kw": {
    "key": "_etc_dirsrv_slapd-EXAMPLE-TEST_pkcs11.txt_mode",
    "path": "/etc/dirsrv/slapd-EXAMPLE-TEST/pkcs11.txt",
    "type": "mode",
    "expected": "0640",
    "got": "0666",
    "msg": "Permissions of /etc/dirsrv/slapd-EXAMPLE-TEST/pkcs11.txt are 0666 and should be 0640"
  }
}</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For reviewing detailed reference material, open <code class="literal">man ipa-healthcheck</code> in the command line.
					</li></ul></div></section></section><section class="chapter" id="checking-idm-replication-using-healthcheck_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 38. Checking IdM replication using Healthcheck</h1></div></div></div><p>
			This section describes how to test Identity Management (IdM) replication using the Healthcheck tool.
		</p><p>
			For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management#healthcheck-in-idm_collecting-idm-healthcheck-information">Healthcheck in IdM</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Healthcheck tool is only available on RHEL 8.1 or newer.
				</li><li class="listitem"><p class="simpara">
					Enable Healtheck on the IdM server:
				</p><pre class="literallayout"># systemctl start ipa-healthcheck</pre></li></ul></div><section class="section" id="replication-healthcheck-tests_checking-idm-replication-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">38.1. Replication healthcheck tests</h2></div></div></div><p>
				The Healthcheck tool tests the Identity Management (IdM) topology configuration and searches for replication conflict issues.
			</p><p>
				To list all tests, run the <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				The topology tests are placed under the <code class="literal">ipahealthcheck.ipa.topology</code> and <code class="literal">ipahealthcheck.ds.replication</code> sources:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">IPATopologyDomainCheck</span></dt><dd><p class="simpara">
							This test verifies:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									whether topology is not disconnected and there are replication paths between all servers.
								</li><li class="listitem"><p class="simpara">
									if servers don’t have more than the recommended number of replication agreements.
								</p><p class="simpara">
									If the test fails, the test returns errors, such as connection errors or too many replication agreements.
								</p><p class="simpara">
									If the test succeeds, the test returns the configured domains.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The test runs the <code class="literal">ipa topologysuffix-verify</code> command for both the domain and ca suffixes (assuming the Certificate Authority is configured on this master).
									</p></div></div></li></ul></div></dd><dt><span class="term">ReplicationConflictCheck</span></dt><dd>
							The test searches for entries in LDAP matching <code class="literal">(&amp;(!(objectclass=nstombstone))(nsds5ReplConflict=*))</code>.
						</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Run these tests on all IdM master servers when trying to check for issues.
				</p></div></div></section><section class="section" id="screening-replication-using-healthcheck_checking-idm-replication-using-healthcheck"><div class="titlepage"><div><div><h2 class="title">38.2. Screening replication using Healthcheck</h2></div></div></div><p>
				This section describes a standalone manual test of an Identity Management (IdM) replication topology and configuration using the Healthcheck tool.
			</p><p>
				The Healthcheck tool includes many tests, therefore, you can shorten the results with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Replication conflict test: <code class="literal">--source=ipahealthcheck.ds.replication</code>
					</li><li class="listitem">
						Correct topology test: <code class="literal">--source=ipahealthcheck.ipa.topology</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Healthcheck tests must be performed as the root user.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck replication conflict and topology checks, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.ds.replication --source=ipahealthcheck.ipa.topology</pre></li></ul></div><p>
				Four different results are possible:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						SUCCESS — the test passed successfully.
					</p><pre class="literallayout">{
  "source": "ipahealthcheck.ipa.topology",
  "check": "IPATopologyDomainCheck",
  "result": "SUCCESS",
  "kw": {
    "suffix": "domain"
  }
}</pre></li><li class="listitem">
						WARNING — the test passed but there might be a problem.
					</li><li class="listitem"><p class="simpara">
						ERROR — the test failed.
					</p><pre class="literallayout">{
  "source": "ipahealthcheck.ipa.topology",
  "check": "IPATopologyDomainCheck",
  "result": "ERROR",
  "uuid": d6ce3332-92da-423d-9818-e79f49ed321f
  "when": 20191007115449Z
  "duration": 0.005943
  "kw": {
    "msg": "topologysuffix-verify domain failed, server2 is not connected (server2_139664377356472 in MainThread)"
  }
}</pre></li><li class="listitem">
						CRITICAL — the test failed and it affects the IdM server functionality.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For reviewing detailed reference, open <code class="literal">man ipa-healthcheck</code> in the command line.
					</li></ul></div></section></section><section class="chapter" id="demoting-or-promoting-hidden-replicas_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 39. Demoting or promoting hidden replicas</h1></div></div></div><p>
			After a replica has been installed, you can change whether the replica is hidden or visible.
		</p><p>
			For details about hidden replicas, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/planning_identity_management/planning-the-replica-topology_planning-dns-and-host-names#the-hidden-replica-mode_planning-the-replica-topology">The hidden replica mode</a>.
		</p><p>
			If the replica is a CA renewal master, move the service to another replica. For details, see <a class="link" href="index%3Flb_target=stage.html#changing-ca-renewal_ipa-ca-renewal" title="23.2. Changing and resetting IdM CA renewal master">Changing and resetting IdM CA Renewal Master</a>.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				The hidden replica feature is available in Red Hat Enterprise Linux 8.1 and later as a Technology Preview and, therefore, not supported.
			</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					To hide the replica, enter:
				</p><pre class="literallayout"># ipa server-state replica.idm.example.com --state=hidden</pre><p class="simpara">
					Alternatively, you can make the replica visible with the following command
				</p><pre class="literallayout"># ipa server-state replica.idm.example.com --state=enabled</pre></li></ul></div></section><section class="chapter" id="setting-up-samba-on-an-idm-domain-member_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 40. Setting up Samba on an IdM domain member</h1></div></div></div><p>
			This section describes how to set up Samba on a host that is joined to a Red Hat Identity Management (IdM) domain. Users from IdM and also, if available, from trusted Active Directory (AD) domains, can access shares and printer services provided by Samba.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				Using Samba on an IdM domain member is an unsupported Technology Preview feature.
			</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The host is joined as a client to the IdM domain.
				</li><li class="listitem">
					Both the IdM servers and the client must run on RHEL 8.1 or later.
				</li></ul></div><section class="section" id="preparing-the-idm-domain-for-installing-samba-on-domain-members_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h2 class="title">40.1. Preparing the IdM domain for installing Samba on domain members</h2></div></div></div><p>
				Before you can establish a trust with AD and if you want to set up Samba on an IdM client, you must prepare the IdM domain using the <code class="literal">ipa-adtrust-install</code> utility on an IdM server. However, even if both situations apply, you must run <code class="literal">ipa-adtrust-install</code> only once on an IdM master.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the required packages:
					</p><pre class="literallayout">[root@ipaserver ~]# yum install ipa-server ipa-server-trust-ad samba-client</pre></li><li class="listitem"><p class="simpara">
						Authenticate as the IdM administrative user:
					</p><pre class="literallayout">[root@ipaserver ~]# kinit admin</pre></li><li class="listitem"><p class="simpara">
						Run the <code class="literal">ipa-adtrust-install</code> utility:
					</p><pre class="literallayout">[root@ipaserver ~]# ipa-adtrust-install</pre><p class="simpara">
						The DNS service records are created automatically if IdM was installed with an integrated DNS server.
					</p><p class="simpara">
						If IdM was installed without an integrated DNS server, <code class="literal">ipa-adtrust-install</code> prints a list of service records that must be manually added to DNS before you can continue.
					</p></li><li class="listitem"><p class="simpara">
						The script prompts you that the <code class="literal">/etc/samba/smb.conf</code> already exists and will be rewritten:
					</p><pre class="literallayout">WARNING: The smb.conf already exists. Running ipa-adtrust-install will break your existing Samba configuration.

Do you wish to continue? [no]: yes</pre></li><li class="listitem"><p class="simpara">
						The script prompts you to configure the <code class="literal">slapi-nis</code> plug-in, a compatibility plug-in that allows older Linux clients to work with trusted users:
					</p><pre class="literallayout">Do you want to enable support for trusted domains in Schema Compatibility plugin?
This will allow clients older than SSSD 1.9 and non-Linux clients to work with trusted users.

Enable trusted domains support in slapi-nis? [no]: yes</pre></li><li class="listitem"><p class="simpara">
						When prompted, enter the NetBIOS name for the IdM domain or press <span class="strong strong"><strong>Enter</strong></span> to accept the name suggested:
					</p><pre class="literallayout">Trust is configured but no NetBIOS domain name found, setting it now.
Enter the NetBIOS name for the IPA domain.
Only up to 15 uppercase ASCII letters, digits and dashes are allowed.
Example: EXAMPLE.

NetBIOS domain name [IDM]:</pre></li><li class="listitem"><p class="simpara">
						You are prompted to run the SID generation task to create a SID for any existing users:
					</p><pre class="literallayout">Do you want to run the ipa-sidgen task? [no]: yes</pre><p class="simpara">
						When the directory is first installed, at least one user (the IdM administrator) exists and as this is a resource-intensive task, if you have a high number of users, you can run this at another time.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">ipa</code> service:
					</p><pre class="literallayout">[root@ipaserver ~]# systemctl restart ipa</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal systemitem">smbclient</code> utility to verify that Samba responds to Kerberos authentication from the IdM side:
					</p><pre class="literallayout">[root@ipaserver ~]# smbclient -L server.idm.example.com -k
lp_load_ex: changing to config backend registry
    Sharename       Type      Comment
    ---------       ----      -------
    IPC$            IPC       IPC Service (Samba 4.10.4)
...</pre></li></ol></div></section><section class="section" id="enabling-the-aes-encryption-type-in-active-directory-using-a-gpo_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h2 class="title">40.2. Enabling the AES encryption type in Active Directory using a GPO</h2></div></div></div><p>
				This section describes how to enable the AES encryption type in Active Directory (AD) using a group policy object (GPO). Certain Identity Management (IdM) features, such as running a Samba server on an IdM client, require this encryption type.
			</p><p>
				Note that RHEL 8 does not support the weak DES and RC4 encryption types.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged into AD as a user who can edit group policies.
					</li><li class="listitem">
						The <code class="literal application">Group Policy Management Console</code> is installed on the computer.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the <code class="literal application">Group Policy Management Console</code>.
					</li><li class="listitem">
						Right-click <code class="literal gui">Default Domain Policy</code>, and select <code class="literal gui">Edit</code>. The <code class="literal application">Group Policy Management Editor</code> opens.
					</li><li class="listitem">
						Navigate to <code class="literal gui">Computer Configuration</code> → <code class="literal gui">Policies</code> → <code class="literal gui">Windows Settings</code> → <code class="literal gui">Security Settings</code> → <code class="literal gui">Local Policies</code> → <code class="literal gui">Security Options</code>.
					</li><li class="listitem">
						Double-click the <code class="literal gui">Network security: Configure encryption types allowed for Kerberos</code> policy.
					</li><li class="listitem">
						Select <code class="literal gui">AES256_HMAC_SHA1</code> and, optionally, <code class="literal gui">Future encryption types</code>.
					</li><li class="listitem">
						Click <span class="guibutton">OK</span>.
					</li><li class="listitem">
						Close the <code class="literal application">Group Policy Management Editor</code>.
					</li><li class="listitem">
						Repeat the steps for the <code class="literal gui">Default Domain Controller Policy</code>.
					</li><li class="listitem"><p class="simpara">
						Wait until the Windows domain controllers (DC) applied the group policy automatically. Alternatively, to apply the GPO manually on a DC, enter the following command using an account that has administrator permissions:
					</p><pre class="literallayout">C:\&gt; gpupdate /force /target:computer</pre></li></ol></div></section><section class="section" id="installing-and-configuring-samba-on-an-idm-client_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h2 class="title">40.3. Installing and configuring a Samba server on an IdM client</h2></div></div></div><p>
				This section describes how to install and configure Samba on a client enrolled in an IdM domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Both the IdM servers and the client must run on RHEL 8.1 or later.
					</li><li class="listitem">
						The IdM domain is prepared as described in <a class="xref" href="index%3Flb_target=stage.html#preparing-the-idm-domain-for-installing-samba-on-domain-members_setting-up-samba-on-an-idm-domain-member" title="40.1. Preparing the IdM domain for installing Samba on domain members">Section 40.1, “Preparing the IdM domain for installing Samba on domain members”</a>.
					</li><li class="listitem">
						If IdM has a trust configured with AD, enable the AES encryption type for Kerberos. For example, use a group policy object (GPO) to enable the AES encryption type. For details, see <a class="xref" href="index%3Flb_target=stage.html#enabling-the-aes-encryption-type-in-active-directory-using-a-gpo_setting-up-samba-on-an-idm-domain-member" title="40.2. Enabling the AES encryption type in Active Directory using a GPO">Section 40.2, “Enabling the AES encryption type in Active Directory using a GPO”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">ipa-client-samba</code> package:
					</p><pre class="literallayout">[root@idm_client]# yum install ipa-client-samba</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">ipa-client-samba</code> utility to prepare the client and create an initial Samba configuration:
					</p><pre class="literallayout">[root@idm_client]# ipa-client-samba
Searching for IPA server...
IPA server: DNS discovery
Chosen IPA master: <span class="emphasis"><em>idm_server.idm.example.com</em></span>
SMB principal to be created: cifs/<span class="emphasis"><em>idm_client.idm.example.com</em></span>@<span class="emphasis"><em>IDM.EXAMPLE.COM</em></span>
NetBIOS name to be used: <span class="emphasis"><em>IDM_CLIENT</em></span>
Discovered domains to use:

 Domain name: <span class="emphasis"><em>idm.example.com</em></span>
NetBIOS name: <span class="emphasis"><em>IDM</em></span>
         SID: <span class="emphasis"><em>S-1-5-21-525930803-952335037-206501584</em></span>
    ID range: <span class="emphasis"><em>212000000 - 212199999</em></span>

 Domain name: <span class="emphasis"><em>ad.example.com</em></span>
NetBIOS name: <span class="emphasis"><em>AD</em></span>
         SID: None
    ID range: <span class="emphasis"><em>1918400000 - 1918599999</em></span>

Continue to configure the system with these values? [no]: <span class="strong strong"><strong>yes</strong></span>
Samba domain member is configured. Please check configuration at /etc/samba/smb.conf and start smb and winbind services</pre></li><li class="listitem"><p class="simpara">
						By default, <code class="literal">ipa-client-samba</code> automatically adds the <code class="literal systemitem">[homes]</code> section to the <code class="literal filename">/etc/samba.smb.conf</code> file that dynamically shares a user’s home directory when the user connects. If users do not have home directories on this server, or if you do not want to share them, remove the following lines from <code class="literal filename">/etc/samba.smb.conf</code>:
					</p><pre class="literallayout">[homes]
    read only = no</pre></li><li class="listitem"><p class="simpara">
						Share directories and printers. For details, see the following sections in the <code class="literal citetitle">Deploying different types of servers</code> documentation for RHEL 8:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/assembly_using-samba-as-a-server_deploying-different-types-of-servers#assembly_configuring-file-shares-on-a-samba-server_assembly_using-samba-as-a-server">Configuring file shares on a Samba server</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/assembly_using-samba-as-a-server_deploying-different-types-of-servers#assembly_setting-up-samba-as-a-print-server_assembly_using-samba-as-a-server">Setting up Samba as a print server</a>
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Open the ports required for a Samba client in the local firewall:
					</p><pre class="literallayout">[root@idm_client]# firewall-cmd --permanent --add-service=samba-client
[root@idm_client]# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">smb</code> and <code class="literal systemitem">winbind</code> services:
					</p><pre class="literallayout">[root@idm_client]# systemctl enable --now smb winbind</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					Run the following verification steps on a different IdM domain member that has the <code class="literal package">samba-client</code> package installed:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Authenticate and obtain a Kerberos ticket-granting ticket:
					</p><pre class="literallayout">$ kinit <span class="emphasis"><em>example_user</em></span></pre></li><li class="listitem"><p class="simpara">
						List the shares on the Samba server using Kerberos authentication:
					</p><pre class="literallayout">$ smbclient -L <span class="emphasis"><em>idm_client.idm.example.com</em></span> -k
lp_load_ex: changing to config backend registry

    Sharename       Type      Comment
    ---------       ----      -------
    <span class="emphasis"><em>example</em></span>         Disk
    IPC$            IPC       IPC Service (Samba 4.10.4)
...</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For details about which steps <code class="literal systemitem">ipa-client-samba</code> performs during the configuration, see the <code class="literal citetitle">ipa-client-samba(1)</code> man page.
					</li></ul></div></section><section class="section" id="manually-adding-an-id-mapping-configuration-if-idm-trusts-a-new-domain_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h2 class="title">40.4. Manually adding an ID mapping configuration if IdM trusts a new domain</h2></div></div></div><p>
				Samba requires an ID mapping configuration for each domain from which users access resources. On an existing Samba server running on an IdM client, you must manually add an ID mapping configuration after the administrator added a new trust to an Active Directory (AD) domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You configured Samba on an IdM client as described in <a class="xref" href="index%3Flb_target=stage.html#installing-and-configuring-samba-on-an-idm-client_setting-up-samba-on-an-idm-domain-member" title="40.3. Installing and configuring a Samba server on an IdM client">Section 40.3, “Installing and configuring a Samba server on an IdM client”</a>. Afterward, new trust was added to IdM.
					</li><li class="listitem">
						The DES and RC4 encryption types for Kerberos must be disabled in the trusted AD domain. For security reasons, RHEL 8 does not support these weak encryption types.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Authenticate using the host’s keytab:
					</p><pre class="literallayout">[root@idm_client]# kinit -k</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal command">ipa idrange-find</code> command to display both the base ID and the ID range size of the new domain. For example, the following command displays the values for the <code class="literal systemitem">ad.example.com</code> domain:
					</p><pre class="literallayout">[root@idm_client]# ipa idrange-find --name="<span class="emphasis"><em>AD.EXAMPLE.COM</em></span>_id_range" --raw
---------------
1 range matched
---------------
  cn: <span class="emphasis"><em>AD.EXAMPLE.COM</em></span>_id_range
  ipabaseid: <span class="emphasis"><em>1918400000</em></span>
  ipaidrangesize: <span class="emphasis"><em>200000</em></span>
  ipabaserid: 0
  ipanttrusteddomainsid: <span class="emphasis"><em>S-1-5-21-968346183-862388825-1738313271</em></span>
  iparangetype: ipa-ad-trust
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
						You need the values from the <code class="literal parameter">ipabaseid</code> and <code class="literal parameter">ipaidrangesize</code> attributes in the next steps.
					</p></li><li class="listitem"><p class="simpara">
						To calculate the highest usable ID, use the following formula:
					</p><pre class="literallayout">maximum_range = ipabaseid + ipaidrangesize - 1</pre><p class="simpara">
						With the values from the previous step, the highest usable ID for the <code class="literal systemitem">ad.example.com</code> domain is <code class="literal command">1918599999</code> (1918400000 + 200000 - 1).
					</p></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/samba/smb.conf</code> file, and add the ID mapping configuration for the domain to the <code class="literal parameter">[global]</code> section:
					</p><pre class="literallayout">idmap config <span class="emphasis"><em>AD</em></span> : range = <span class="emphasis"><em>1918400000</em></span> - <span class="emphasis"><em>1918599999</em></span>
idmap config <span class="emphasis"><em>AD</em></span> : backend = sss</pre><p class="simpara">
						Specify the value from <code class="literal parameter">ipabaseid</code> attribute as the lowest and the computed value from the previous step as the highest value of the range.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">smb</code> and <code class="literal">winbind</code> services:
					</p><pre class="literallayout">[root@idm_client]# systemctl restart smb winbind</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Authenticate as a user from the new domain and obtain a Kerberos ticket-granting ticket:
					</p><pre class="literallayout">$ kinit <span class="emphasis"><em>example_user</em></span></pre></li><li class="listitem"><p class="simpara">
						List the shares on the Samba server using Kerberos authentication:
					</p><pre class="literallayout">$ smbclient -L <span class="emphasis"><em>idm_client.idm.example.com</em></span> -k
lp_load_ex: changing to config backend registry

    Sharename       Type      Comment
    ---------       ----      -------
    <span class="emphasis"><em>example</em></span>         Disk
    IPC$            IPC       IPC Service (Samba 4.10.4)
...</pre></li></ol></div></section><section class="section" id="additional_resources"><div class="titlepage"><div><div><h2 class="title">40.5. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For details about joining RHEL 8 to an IdM domain, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/installing-an-ipa-client-basic-scenario_installing-identity-management"><code class="literal citetitle">Installing an Identity Management client</code></a> section in the <code class="literal citetitle">Installing Identity Management</code> guide.
					</li></ul></div></section></section><section class="chapter" id="identity-management-security-settings_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 41. Identity Management security settings</h1></div></div></div><p>
			This section describes security-related features of Identity Management.
		</p><section class="section" id="how-identity-management-applies-default-security-settings_identity-management-security-settings"><div class="titlepage"><div><div><h2 class="title">41.1. How Identity Management applies default security settings</h2></div></div></div><p>
				By default, Identity Management (IdM) on RHEL 8 uses the system-wide crypto policy. The benefit of this policy is that you do not need to harden individual IdM components manually.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Red Hat recommends that you use the system-wide crypto policy. Changing individual security settings can break components of IdM. For example, Java in RHEL 8 does not fully support the TLS 1.3 protocol. Therefore, using this protocol can cause failures in IdM.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about the system-wide crypto policies, see the <code class="literal citetitle">crypto-policies(7)</code> man page.
					</li></ul></div></section><section class="section" id="anonymous-ldap-binds-in-identity-management_identity-management-security-settings"><div class="titlepage"><div><div><h2 class="title">41.2. Anonymous LDAP binds in Identity Management</h2></div></div></div><p>
				By default, anonymous binds to the Identity Management (IdM) LDAP server are enabled. Anonymous binds can expose certain configuration settings or directory values. However, some utilities, such as <code class="literal systemitem">reald</code>, or older RHEL clients require anonymous binds enabled to discover domain settings when enrolling a client.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For details about disabling anonymous binds in the IdM LDAP server, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_directory_server/11/html/administration_guide/configuring-special-binds#disabling-anonymous-binds"><code class="literal citetitle">Disabling Anonymous Binds</code></a> section in the <code class="literal citetitle">Red Hat Directory Server 11 Administration Guide</code>.
					</li></ul></div></section></section><section class="chapter" id="using-automount_configuring-and-managing-idm"><div class="titlepage"><div><div><h1 class="title">Chapter 42. Using automount in IdM</h1></div></div></div><p>
			Automount is a way to manage, organize, and access directories across multiple systems. Automount program automatically mounts a directory whenever access to it is requested. This works well within an IdM domain since it allows directories on clients within the domain to be shared easily. This is especially important with user home directories.
		</p><p>
			In IdM, automount works with the internal LDAP directory and also with DNS services if configured.
		</p><section class="section" id="setting-up-a-kerberos-aware-nfs-server_using-automount"><div class="titlepage"><div><div><h2 class="title">42.1. Setting up a Kerberos-aware NFS server</h2></div></div></div><p>
				This procedure describes how to set up a Kerberos-aware NFS server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM domain set up. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-idm">Installing Identity Management</a>.
					</li><li class="listitem">
						IPA client installed. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-ipa-client-packages-from-the-idm-client-stream">Installing ipa-client packages</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						If any of your NFS clients support only weak cryptography, such as Red Hat Enterprise Linux 5 clients:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Update the IdM server Kerberos configuration to enable the weak <code class="literal">des-cbc-crc</code> encryption type:
							</p><pre class="literallayout">$ ldapmodify -x -D "cn=directory manager" -w password -h ipaserver.example.com -p 389

dn: cn=<span class="emphasis"><em>REALM_NAME</em></span>,cn=kerberos,dc=example,dc=com
changetype: modify
add: krbSupportedEncSaltTypes
krbSupportedEncSaltTypes: des-cbc-crc:normal
-
add: krbSupportedEncSaltTypes
krbSupportedEncSaltTypes: des-cbc-crc:special
-
add: krbDefaultEncSaltTypes
krbDefaultEncSaltTypes: des-cbc-crc:special</pre></li><li class="listitem"><p class="simpara">
								On the NFS server, add the following entry to the <code class="literal">/etc/krb5.conf</code> file of the NFS server enable weak cryptography support:
							</p><pre class="literallayout">allow_weak_crypto = true</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Obtain a Kerberos ticket:
					</p><pre class="literallayout">[root@nfs-server ~]# kinit admin</pre></li><li class="listitem">
						If the NFS host machine has not been added as a client to the IdM domain, create the host entry. See <a class="link" href="index.html#adding-host-entry-cmd_managing-hosts-cli">Adding IdM host entries from IdM CLI</a>.
					</li><li class="listitem"><p class="simpara">
						Create the NFS service entry:
					</p><pre class="literallayout">[root@nfs-server ~]# ipa service-add nfs/<span class="emphasis"><em>nfs-server.example.com</em></span></pre></li><li class="listitem"><p class="simpara">
						Retrieve an NFS service keytab for the NFS server using the following <code class="literal command">ipa-getkeytab</code> command that saves the keys in the <code class="literal">/etc/krb5.keytab</code> file:
					</p><pre class="literallayout">[root@nfs-server ~]# ipa-getkeytab -s <span class="emphasis"><em>ipaserver.example.com</em></span> -p nfs/<span class="emphasis"><em>nfs-server.example.com</em></span> -k /etc/krb5.keytab</pre><p class="simpara">
						If any of your NFS clients support only weak cryptography, additionally pass the <code class="literal option">-e des-cbc-crc</code> option to the command to request a DES-encrypted keytab.
					</p></li><li class="listitem"><p class="simpara">
						Verify that the NFS service has been properly configured in IdM, with its keytab, by checking the service entry:
					</p><pre class="literallayout">[root@nfs-server ~]# ipa service-show nfs/nfs-server.example.com
  Principal name: nfs/nfs-server.example.com@IDM.EXAMPLE.COM
  Principal alias: nfs/nfs-server.example.com@IDM.EXAMPLE.COM
  Keytab: True
  Managed by: nfs-server.example.com</pre></li><li class="listitem"><p class="simpara">
						Install the <span class="strong strong"><strong><span class="package package">nfs-utils</span></strong></span> package:
					</p><pre class="literallayout">[root@nfs-server ~]# yum install nfs-utils</pre></li><li class="listitem"><p class="simpara">
						Run the <code class="literal command">ipa-client-automount</code> utility to configure the NFS settings:
					</p><pre class="literallayout">[root@nfs-server ~] ipa-client-automount
Searching for IPA server...
IPA server: DNS discovery
Location: default
Continue to configure the system with these values? [no]: yes
Configured /etc/idmapd.conf
Restarting sssd, waiting for it to become available.
Started autofs</pre><p class="simpara">
						By default, this command enables secure NFS and sets the <code class="literal">Domain</code> parameter in the <code class="literal">/etc/idmapd.conf</code> file to the IdM DNS domain. If you use a different domain, specify it using the <code class="literal">--idmap-domain <span class="emphasis"><em>domain_name</em></span></code> parameter.
					</p></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal">/etc/exports</code> file and add shares with the <code class="literal command">krb5p</code> Kerberos security setting:
					</p><pre class="literallayout"><span class="emphasis"><em>/export</em></span>  *(<span class="emphasis"><em>rw</em></span>,sec=krb5:krb5i:krb5p)
<span class="emphasis"><em>/home</em></span>  *(<span class="emphasis"><em>rw</em></span>,sec=krb5:krb5i:krb5p)</pre><p class="simpara">
						This example shares the <code class="literal">/export</code> and <code class="literal">/home</code> directories in read-write mode with Kerberos authentication enabled.
					</p></li><li class="listitem"><p class="simpara">
						Restart and enable nfs-server:
					</p><pre class="literallayout">[root@nfs-server ~]# systemctl restart nfs-server
[root@nfs-server ~]# systemctl enable nfs-server</pre></li><li class="listitem"><p class="simpara">
						Re-export the shared directories:
					</p><pre class="literallayout">[root@nfs-server ~]# exportfs -rav</pre></li><li class="listitem">
						Optionally, configure the NFS server as an NFS client. See <a class="xref" href="index%3Flb_target=stage.html#setting-up-a-kerberos-aware-nfs-client_using-automount" title="42.2. Setting up a Kerberos-aware NFS client">Section 42.2, “Setting up a Kerberos-aware NFS client”</a>.
					</li></ol></div></section><section class="section" id="setting-up-a-kerberos-aware-nfs-client_using-automount"><div class="titlepage"><div><div><h2 class="title">42.2. Setting up a Kerberos-aware NFS client</h2></div></div></div><p>
				This procedure describes how to set up a kerberos-aware NFS client.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM domain set up. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-idm">Installing Identity Management</a>.
					</li><li class="listitem">
						IPA client installed. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-ipa-client-packages-from-the-idm-client-stream">Installing ipa-client packages</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						If the NFS clients supports only weak cryptography, such as a Red Hat Enterprise Linux 5 client, set the following entry in the <code class="literal">/etc/krb5.conf</code> file of the server to allow weak cryptography:
					</p><pre class="literallayout">allow_weak_crypto = true</pre></li><li class="listitem">
						If the NFS client is not enrolled as a client in the IdM domain, set up the required host entries, as described in <a class="link" href="index.html#adding-host-entry-cmd_managing-hosts-cli">Adding IdM host entries from IdM CLI</a>.
					</li><li class="listitem"><p class="simpara">
						Install the <span class="strong strong"><strong><span class="package package">nfs-utils</span></strong></span> package:
					</p><pre class="literallayout">[root@nfs-client ~]# yum install nfs-utils</pre></li><li class="listitem"><p class="simpara">
						Obtain a Kerberos ticket before running IdM tools.
					</p><pre class="literallayout">[root@nfs-client ~]# kinit admin</pre></li><li class="listitem"><p class="simpara">
						Run the <code class="literal command">ipa-client-automount</code> utility to configure the NFS settings:
					</p><pre class="literallayout">[root@nfs-client ~] ipa-client-automount
Searching for IPA server...
IPA server: DNS discovery
Location: default
Continue to configure the system with these values? [no]: yes
Configured /etc/idmapd.conf
Restarting sssd, waiting for it to become available.
Started autofs</pre><p class="simpara">
						By default, this enables secure NFS in the <code class="literal">/etc/sysconfig/nfs</code> file and sets the IdM DNS domain in the <code class="literal">Domain</code> parameter in the <code class="literal">/etc/idmapd.conf</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Add the following entries to the <code class="literal">/etc/fstab</code> file to mount the NFS shares from the <code class="literal">nfs-server.example.com</code> host when the system boots:
					</p><pre class="literallayout">nfs-server.example.com:/export  /mnt   nfs4  sec=krb5p,rw
nfs-server.example.com:/home    /home  nfs4  sec=krb5p,rw</pre><p class="simpara">
						These settings configure Red Hat Enterprise Linux to mount the <code class="literal">/export</code> share to the <code class="literal">/mnt</code> and the <code class="literal">/home</code> share to the <code class="literal">/home</code> directory.
					</p></li><li class="listitem">
						Create the mount points if they do not exist. In our case both should exist.
					</li><li class="listitem"><p class="simpara">
						Mount the NFS shares:
					</p><pre class="literallayout">[root@nfs-client ~]# mount /mnt/
[root@nfs-client ~]# mount /home</pre><p class="simpara">
						The command uses the information from the <code class="literal">/etc/fstab</code> entry.
					</p></li><li class="listitem"><p class="simpara">
						Configure SSSD to renew Kerberos tickets:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Set the following parameters in the IdM domain section of the <code class="literal">/etc/sssd/sssd.conf</code> file to configure SSSD to automatically renew tickets:
							</p><pre class="literallayout">[domain/EXAMPLE.COM]
...
krb5_renewable_lifetime = 50d
krb5_renew_interval = 3600</pre></li><li class="listitem"><p class="simpara">
								Restart SSSD:
							</p><pre class="literallayout">[root@nfs-client ~]# systemctl restart sssd</pre></li></ol></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The <code class="literal">pam_oddjob_mkhomedir</code> module does not support automatic creation of home directories on an NFS share. Therefore, you must manually create the home directories on the server in the root of the share that contains the home directories.
				</p></div></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140406472202496"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2020 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div>
  
  </div>
  </div>
</div>
<div id="comments-footer" class="book-comments">
  </div>
<meta itemscope="" itemref="md1">

    <!-- Display: Next/Previous Nav -->
          
      </div>
</article>


  

            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="index%3Flb_target=stage.html#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

            <div role="navigation">
                <h3>Quick Links</h3>
                <ul>
                    <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li><a class="manage-subscriptions" href="https://access.redhat.com/management/subscriptions/#active">Subscriptions</a></li>
                    <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                    <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                    <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Help</h3>
                <ul>
                    <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                    <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                    <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Site Info</h3>
                <ul>
                  <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                  <li><a class="browser-support-policy" href="https://access.redhat.com/help/browsers/">Browser Support Policy</a></li>
                  <li><a class="accessibility" href="https://access.redhat.com/help/accessibility/">Accessibility</a></li>
                  <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                  <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Related Sites</h3>
                <ul>
                    <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                    <li><a href="https://www.openshift.com" class="openshift-com">openshift.com</a></li>
                    <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                    <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>About</h3>
                <ul>
                    <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                    <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                    <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                </ul>
            </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                          <span class="status-description"></span>
                          <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2020 Red Hat, Inc.</div>

                        <div role="navigation" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://access.redhat.com/help/terms/" class="terms-of-use">Customer Portal Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                      <img src="l_summit.png" alt="Red Hat Summit" />
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHatSupport" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>
                        <a href="https://www.facebook.com/RedHatSupport" class="sm-icon facebook"><span class="nicon-facebook"></span><span class="offscreen">Facebook</span></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--googleon: all-->
</div>
  
  <div id="formatHelp" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="formatTitle" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="formatTitle">Formatting Tips</h3>
    </div>
    <div class="modal-body">
      <p>Here are the common uses of Markdown.</p><dl class="formatting-help">
        <dt class="codeblock">Code blocks</dt><dd class="codeblock"><pre><code>~~~
Code surrounded in tildes is easier to read
~~~</code></pre></dd>
        <dt class="urls">Links/URLs</dt><dd class="urls"><code>[Red Hat Customer Portal](https://access.redhat.com)</code></dd>
       </dl>
    </div>
    <div class="modal-footer">
      <a target="_blank" href="https://access.redhat.com/help/markdown" class="btn btn-primary">Learn more</a>
      <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
  </div></div></div></body>
</html>
