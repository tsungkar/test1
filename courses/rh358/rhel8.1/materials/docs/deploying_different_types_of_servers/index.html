<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video#" >

<head profile="http://www.w3.org/1999/xhtml/vocab">
	  <!--[if IE]><![endif]-->
<meta charset="utf-8" />
<meta name="revision" title="5f9ed055-4670-4136-a4f4-7237eed35b6d" product="f321f43a-4a79-48fe-8aae-117b9d973ec0" revision="7b1c9d2c0f4e7ba5391cdbf9c3abda04e04b812d:en-us" page="d6e04b84-2dc4-4e77-bfa6-ae6118e76407" />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/index" />
<meta property="og:title" content="Deploying different types of servers Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta property="og:description" content="This document describes how to configure and run different types of servers on Red Hat Enterprise Linux 8, including Apache HTTP web server, Samba server, NFS server, available database servers, and the CUPS server." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/index" />
<meta name="twitter:title" content="Deploying different types of servers Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta name="twitter:description" content="This document describes how to configure and run different types of servers on Red Hat Enterprise Linux 8, including Apache HTTP web server, Samba server, NFS server, available database servers, and the CUPS server." />
<meta name="twitter:image:src" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
  <title>Deploying different types of servers Red Hat Enterprise Linux 8 | Red Hat Customer Portal</title>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="kcs07.web.prod.ext.phx2.redhat.com" />
<meta name="avalon-version" content="2070d6b" />
<meta name="cp-chrome-build-date" content="2020-03-09T20:28:54.189Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />

 

<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en",  
        version   : "2070d6b",
        builddate : "2020-03-09T20:28:54.189Z",
        fetchdate : "2020-03-11T07:52:05-0400",
        nrid      : "14615289",
        nrlk      : "2a497fa56f"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="favicon.ico" />

<link media="all" rel="stylesheet" type="text/css" href="bootstrap.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="main.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="components.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="pages.css%3Fv=2070d6b.css" />

<link href="chosen.css%3Fv=2070d6b.css" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]-->

<noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>

<!-- /cssInclude -->
<script type="text/javascript" src="require.js%3Fv=2070d6b" data-main="/webassets/avalon/j/"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
  <link type="text/css" rel="stylesheet" href="css__c2Nkkx_5vYh8rvZbfBAGB4EMzMtH5ouFJDBlDsnhSR8__-ax0_8bam15ZDJT9j7LilCfJrDyEhGGAgc0KC8HYvJg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__Jy3BSr8TrxptaufAzQDT1skBUlX2CnL_wm6BizzYuGw__-YZvqB8yuA4kK_iKklbk5HdZCoG2qAgz1l-8Qi2NFH4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="messages.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__m76iIFREtc70Nmw5xe1ZwHbNBlwOP2Zjc3DcacNWnFQ__STEh8aY3w8E_bKzhB4Xke2WOQ9XMDQquHIP5B8SeDIY__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__4sM4s6XOQ2Nm0pdkrWRLvrgtwpTmHAFzR_LcdesKYj8__vJ0jjVEhoPh3KBeLZfkqg51T3AFxhQCuXg1reipa__k__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="print" />
  <link rel="stylesheet" type="text/css" media="all" href="list.css" />
  <script src="js__1YIht1y1Jlm9D0PyxEuhS3DlWdYAlEsNpsFDOaUsfRw__ZnC7278ZsqBG-1FOUqflDl8B3Y1kLiAWXAIkoLrHbYg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__5ysXPc5KIyMmizxqRY68ILfrEGrj0P29WBIifnPTJvQ__Cap0DACEVMsefumg1gS1APLLd8stDkdGfp6c1uswMo4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>chrometwo_require(["analytics/attributes"], function(attributes) {
attributes.set('ResourceID',       '5f9ed055-4670-4136-a4f4-7237eed35b6d');
attributes.set('ResourceTitle',    'Deploying different types of servers');
attributes.set('Language',         'en-us');
attributes.set('RevisionId',       '7b1c9d2c0f4e7ba5391cdbf9c3abda04e04b812d:en-us');
attributes.set('PublicationState', ['active','published']);
attributes.set('Product',          'Red Hat Enterprise Linux');
attributes.set('ProductVersion',   '8');
attributes.set('ProductId',        'Red Hat Enterprise Linux 8');
});</script>
<script>breadcrumbs = [ ["Products &amp; Services", "/products/"], ["Product Documentation", "/documentation/"], ["Red Hat Enterprise Linux", "/documentation/en-us/red_hat_enterprise_linux/"], ["8", "/documentation/en-us/red_hat_enterprise_linux/8/"], ["Deploying different types of servers", "/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/"] ];</script>
<script>window.siteMapState = "products";</script>
<script src="js__i6ieGBO-OPmIKm_f0srsb6gM7QELIWrBpKh6ub_yj8A__wjRg_duSK4rEZCRV2uwrCIPMl80Z_LJ9ew61H5hE-ZI__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__vGeEtorfXGI3aPAp71YA74N5p8wfpYVhnoIqwaJrOiQ__veGxEiPQW6fkzAPZnAFA23SFz1CyJy2dlu6x8XuHM4s__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"kcs","theme_token":"uuuWhJ5USxK2t2HhwC-cL4qxwXVquxLHEAkJCeUX5x4","js":{"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.jquery.min.js":1,"modules\/chosen\/chosen.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/prism.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/underscore.js":1,"sites\/all\/themes\/kcs\/js\/kcs_base.js":1,"sites\/all\/themes\/kcs\/js\/showdown.js":1,"sites\/all\/themes\/kcs\/js\/case_links.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/date\/date_api\/date.css":1,"modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/contrib\/user_prune\/css\/user_prune.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/panels\/css\/panels.css":1,"sites\/all\/modules\/custom\/rate\/rate.css":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/plugins\/layouts\/docs_page\/docs_page.css":1,"https:\/\/access.redhat.com\/webassets\/avalon\/s\/messages.css":1,"sites\/all\/themes\/zen\/system.base.css":1,"sites\/all\/themes\/zen\/system.menus.css":1,"sites\/all\/themes\/zen\/system.messages.css":1,"sites\/all\/themes\/zen\/system.theme.css":1,"sites\/all\/themes\/zen\/comment.css":1,"sites\/all\/themes\/zen\/node.css":1,"sites\/all\/themes\/kcs\/css\/html-reset.css":1,"sites\/all\/themes\/kcs\/css\/wireframes.css":1,"sites\/all\/themes\/kcs\/css\/layout-fixed.css":1,"sites\/all\/themes\/kcs\/css\/page-backgrounds.css":1,"sites\/all\/themes\/kcs\/css\/tabs.css":1,"sites\/all\/themes\/kcs\/css\/pages.css":1,"sites\/all\/themes\/kcs\/css\/blocks.css":1,"sites\/all\/themes\/kcs\/css\/navigation.css":1,"sites\/all\/themes\/kcs\/css\/views-styles.css":1,"sites\/all\/themes\/kcs\/css\/nodes.css":1,"sites\/all\/themes\/kcs\/css\/comments.css":1,"sites\/all\/themes\/kcs\/css\/forms.css":1,"sites\/all\/themes\/kcs\/css\/fields.css":1,"sites\/all\/themes\/kcs\/css\/kcs.css":1,"sites\/all\/themes\/kcs\/css\/print.css":1}},"chosen":{"selector":"#edit-field-kcs-component-select-und, #edit-field-kcs-sbr-select-und, #edit-field-kcs-product-select-und, #edit-field-kcs-type-select-und, #edit-language, #edit-field-kcs-a-category-select-und, #edit-field-kcs-state-select-und, #edit-field-kcs-tags-select-und, #edit-field-kcs-state-select-value, #edit-field-vid-reference-product-und, #edit-state, #edit-product, #edit-category, #edit-field-kcs-product-select-tid, #edit-field-kcs-type-select-tid, #edit-field-kcs-a-category-select-tid, #edit-sort-bef-combine, #edit-kcs-state, #edit-field-category-tid, #edit-field-product-tid, #edit-field-tags-tid, #edit-field-category-und, #edit-field-product-und, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-category, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-product, #views-exposed-form-questions-list-questions-filter-block #edit-field-tags, #edit-field-mega-menu-tab-und, #edit-field-internal-tags-tid, #edit-tags, #edit-field-kcs-tags-select-tid, #edit-subscriptions-and-choose-field-select, #edit-subscriptions-and-type, #edit-vid-13, #edit-vid-4, #edit-vid-5, #edit-vid-53, #edit-vid-1, #edit-vid-3, #edit-group-blog, #edit-group-group, #edit-subscriptions-and-choose-field-select-two, #edit-subscriptions-and-type-two, #edit-vid-13-two, #edit-vid-4-two, #edit-vid-5-two, #edit-vid-53-two, #edit-vid-1-two, #edit-vid-3-two, #edit-group-blog-two, #edit-group-group-two, #edit-subscriptions-and-edit-choose-field-select, #edit-subscriptions-and-type-edit, #edit-subscriptions-and-edit-type-two, #edit-vid-13-edit-two, #edit-vid-4-edit-two, #edit-vid-5-edit-two, #edit-vid-53-edit-two, #edit-vid-1-edit-two, #edit-vid-3-edit-two, #edit-group-group-edit-two, #edit-subscriptions-and-edit-choose-field-select-two, #edit-vid-13-edit, #edit-vid-4-edit, #edit-vid-5-edit, #edit-vid-53-edit, #edit-vid-1-edit, #edit-vid-3-edit, #edit-group-group-edit, #edit-group-blog-edit, #edit-field-supported-languages-tid, #edit-field-geography-und, #edit-field-supported-products-und, #edit-field-supported-languages-und, #edit-field-vendor-und, #edit-field-errata-type-text-und, #edit-field-errata-severity-text-und, #edit-field-software-partner-level-und, #edit-field-scert-product-category-und, #edit-field-certifications-und-0-field-product-und, #edit-kcs-article-type, #edit-field-eco-industry-tag-select-tid, #edit-field-eco-software-catego-select-tid, #edit-field-ecosystem-tag-select-und, #edit-field-eco-industry-tag-select-und, #edit-field-eco-software-catego-select-und, #edit-field-vendor-tsanet-member-ref-und, #edit-field-og-vendor-ref-und-0-default, #edit-field-eco-products-enabled-col-und-0-field-eco-subscription-model-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-support-level-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-archite-select-und, #edit-field-eco-certifications-select-und-0-field-eco-certificati-lvl-select-und, #edit-field-eco-certifications-select-und-0-field-eco-hypervisor-str-und, #edit-field-eco-supported-language-ref-und, #edit-field-eco-region-ref-und, #edit-field-cs-product-category-str-und, #edit-field-eco-certifications-select-und-0-field-eco-format-ref-und, #edit-field-eco-group-access-ref-und, #edit-field-hw-category-tag-ref-und, #edit-field-profile-industry-und, #edit-field-profile-tech-interests-und, #edit-field-product-page-features-ref-und, #edit-field-eco-product-select-und, #edit-field-base-product-ref-und, #edit-field-eco-product-archite-select-und, #edit-field-eco-format-ref-und, #edit-field-certification-status-ref-und, #edit-field-certification-result-ref-und, #edit-field-og-certified-product-ref-und-0-default, #edit-field-eco-subscription-model-ref-und, #edit-field-eco-support-level-ref-und, #edit-field-eco-certificati-lvl-select-und, #edit-field-eco-hypervisor-str-und, #edit-field-ccp-thirdparty-cert-select-und, .use_, #edit-field-eco-cert-product-tag-und, #edit-field-documentation-location-ref-und, #edit-field-documentation-title-und, #edit-field-accelerator-products-und","minimum":"0"},"rh_doc_fetcher":{"page_type":"single"},"section":"","kcs":{"nodeType":null,"nodeId":null}});</script>
    <!--[if lt IE 9]>
  <script src="https://access.redhat.com/sites/all/themes/kcs/js/html5shiv.js"></script>
  <![endif]-->
  
      


    <!--kcs06-->
<script type="text/javascript">
  Drupal.portal = {"version":{"redhat_portal":"package drupal7-redhat_portal is not installed"}};
  Drupal.portal.currentUser = {};
  </script>

</head>

<body class="portal-page admin-bar  kcs_external" >

  
  <div id="page-wrap" class="page-wrap">
    <div class="top-page-wrap">

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <!-- Accessibility Nav & Header -->
<div class="accessibility-nav sr-only">
    <a href="https://access.redhat.com/">
        <h1>Red Hat <span>Customer </span><span>Portal</span></h1>
    </a>
    <p><a href="index.html#cp-main">Skip to main content</a></p>
    <nav aria-labelledby="accessibility-nav-heading">
        <h2 id="accessibility-nav-heading">Main Navigation</h2>
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="accessibility-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="accessibility-accountUser">
                    <div class="account-name"><strong id="accessibility-userFullName"></strong></div>
                    <div class="account-org"><span id="accessibility-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="accessibility-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="accessibility-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="accessibility-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="accessibility-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="accessibility-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="accessibility-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- Mobile Header -->
<nav class="mobile-nav-bar hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <button id="menu-btn" class="menu menu-white" type="button" aria-label="Toggle Navigation">
        <span class="lines"></span>
    </button>
    <a class="logo" href="https://access.redhat.com/">
        <span class="logo-crop">
          <!-- logo -->
          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
            <defs>
              <style>
                .rh-logo-hat {
                  fill: #e00;
                }
                .rh-logo-type {
                  fill: #fff;
                }
              </style>
            </defs>
            <title>Red Hat</title>
            <path
              class="rh-logo-hat"
              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
              <path class="rh-logo-band"
              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
              <path
              class="rh-logo-type"
              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
          </svg>
        </span>
        <span class="site-title"><span>Customer </span><span>Portal</span></span>
    </a>
    <button class="btn btn-search btn-utility" data-target="#site-search">
        <span class="web-icon-search"></span>
        <span class="link-text">Search</span>
    </button>
</nav>

<!-- Mobile Menu Drawer -->
<div class="nav-drawer mobile-nav-drawer hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <nav class="nav-container">
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="mobile-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="mobile-accountUser">
                    <div class="account-name"><strong id="mobile-userFullName"></strong></div>
                    <div class="account-org"><span id="mobile-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="mobile-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="mobile-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="mobile-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="mobile-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="mobile-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="mobile-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- White Utility Menu for large screens -->
<div class="utility-wrap" aria-hidden="true">
    <div class="utility-container">
        <div class="utility-bar hidden-xs">
            <div role="navigation" class="top-nav">
                <ul>
                    <li id="nav-subscription" data-portal-tour-1="1"><a class="top-nav-subscriptions" href="https://access.redhat.com/management/">Subscriptions</a></li>
                    <li id="nav-downloads" data-portal-tour-1="2"><a class="top-nav-downloads" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li id="nav-containers"><a class="top-nav-containers" href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
                    <li id="nav-support" data-portal-tour-1="3"><a class="top-nav-support-cases" href="https://access.redhat.com/support/cases/">Support Cases</a></li>
                </ul>
            </div>

            <div role="navigation" class="utility-nav">
                <ul>
                    <li id="searchABTestHide">
                        <a class="btn-search" data-target="#site-search" title="Search" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-search" aria-label="search"></span>
                            <span class="link-text">Search</span>
                        </a>
                    </li>
                    <!-- AB Test -->
                    <li id="searchABTestShow">
                        <form id="topSearchFormABTest" name="topSearchFormABTest">
                            <label for="topSearchInputABTest" class="sr-only">Search</label>
                            <input id="topSearchInputABTest" name="keyword" placeholder="Search" value="" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="form-control">
                            <button type="submit" class="btn btn-app btn-sm btn-link"><span class="web-icon-search" aria-label="search"></span></button>
                        </form>
                    </li>
                    <!-- End of AB Test -->
                    <li>
                        <a class="btn-profile" data-target="#account-info" data-portal-tour-1="4a" title="Account" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-user" aria-label="log in"></span>
                            <span class="link-text">Log In</span>
                            <span class="account-user" id="accountUserName"></span>
                        </a>
                    </li>
                    <li>
                        <a class="btn-language" data-target="#language" data-portal-tour-1="6" title="Language" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-globe" aria-label="language"></span>
                            <span class="link-text">Language</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Utility Tray -->
        <div class="utility-tray-container">
            <div class="utility-tray">
                <div id="site-search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="https://access.redhat.com/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <div class="input-group push-bottom">

                                <input class="form-control searchField" id="topSearchInput" name="keyword" value="" placeholder="Enter your search term" type="text">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primary">Search</button>
                                </span>
                            </div>
                            <div>Troubleshooting an issue? Try <a href="https://access.redhat.com/solution-engine">Solution Engine</a>&mdash;our new support tool.</div>
                        </form>
                    </div>
                </div>
                <div id="account-info" class="utility-link account-info">
                    <div class="content">

                        <!-- Account Unauthenticated -->
                        <div id="accountLinksLoggedOut" class="unauthenticated">
                            <h2 class="utility-header">Log in to Your Red Hat Account</h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border">
                                    <p><a href="https://access.redhat.com/login" id="accountLogin" class="btn btn-primary">Log In</a></p>
                                    <p>Your Red Hat account gives you access to your profile, preferences, and services, depending on your status.</p>
                                </div>
                                <div class="col-sm-6 col-border col-border-left">
                                    <p><a href="https://www.redhat.com/wapps/ugc/register.html" class="btn btn-primary">Register</a></p>
                                    <p>If you are a new customer, register now for access to product evaluations and purchasing capabilities. </p>

                                    <strong>Need access to an account?</strong><p>If your company has an existing Red Hat account, your organization administrator can grant you access.</p>

                                    <p><a href="https://access.redhat.com/support/contact/customerService/">If you have any questions, please contact customer service.</a></p>
                                </div>
                            </div>
                        </div>

                        <!-- Account Authenticated -->
                        <div id="accountLinksLoggedIn" class="authenticated">
                            <h2 class="utility-header"><span id="userFirstName"></span></h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border col-border-right">
                                    <div class="account-info" id="accountUser">
                                        <div class="avatar"><!-- placeholder--></div>
                                        <div class="account-name"><strong id="userFullName"></strong></div>
                                        <div class="account-org"><span id="userOrg"></span></div>
                                        <div class="account-number accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                                    </div>

                                    <div class="row account-settings">
                                        <div class="col-md-6" data-portal-tour-1="4">
                                            <h3>Red Hat Account</h3>
                                            <ul class="reset">
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
                                                <!-- <li><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
                                                <li><a href="https://access.redhat.com/account-team">Account Team</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6" data-portal-tour-1="5">
                                            <h3>Customer Portal</h3>
                                            <ul class="reset">
                                                <li><a href="https://access.redhat.com/user">My Profile</a></li>
                                                <li><a href="https://access.redhat.com/user" id="userNotificationsLink">Notifications</a></li>
                                                <li><a href="https://access.redhat.com/help/">Help</a></li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-6 col-border">
                                    <p>For your security, if you’re on a public computer and have finished using your Red Hat services, please be sure to log out.</p>
                                    <p><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout" id="accountLogout" class="btn btn-primary">Log Out</a></p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="language" class="utility-link language">
                    <div class="content">
                        <h2 class="utility-header">Select Your Language</h2>
                        <div class="row" id="localesMenu">
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en">English</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko">한국어</a></li>
                                </ul>
                            </div>
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja">日本語</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN">中文 (中国)</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="scroll-anchor"></div>

<!-- Main Menu for large screens -->
<div class="header-nav visible-sm visible-md visible-lg" aria-hidden="true">
    <div id="header-nav">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">

                    <a href="https://access.redhat.com/" class="logo">
                        <span class="logo-crop">
                          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                            <defs>
                              <style>
                                .rh-logo-hat {
                                  fill: #e00;
                                }
                                .rh-logo-type {
                                  fill: #fff;
                                }
                              </style>
                            </defs>
                            <title>Red Hat</title>
                            <path
                              class="rh-logo-hat"
                              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                              <path class="rh-logo-band"
                              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                              <path
                              class="rh-logo-type"
                              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                          </svg>
                        </span>
                        <span class="site-title"><span>Customer </span><span>Portal</span></span>
                    </a>

                    <nav class="primary-nav hidden-sm">
                        <ul>
                            <li id="nav-products"><a class="products" data-link="mega" data-target="products-menu" href="https://access.redhat.com/products/" id="products-menu">Products &amp; Services</a></li>
                            <li id="nav-tools"><a class="tools" data-link="mega" data-target="tools-menu" href="https://access.redhat.com/labs/" id="tools-menu">Tools</a></li>
                            <li id="nav-security"><a class="security" data-link="mega" data-target="security-menu" href="https://access.redhat.com/security/" id="security-menu">Security</a></li>
                            <li id="nav-community"><a class="community" data-link="mega" data-target="community-menu" href="https://access.redhat.com/community/" id="community-menu">Community</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Mega Menu for large screens -->
<div class="mega-wrap visible-sm visible-md visible-lg" aria-hidden="true">
    <nav class="mega">
        <div class="container">
            <div class="mega-menu-wrap">

                <!-- Products Menu -->
                <div aria-labelledby="products-menu" class="products-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-md-6 col-sm-8">
                            <div class="root clearfix" data-portal-tour-1="7">
                                <ul class="subnav subnav-root">
                                    <li data-target="infrastructure-menu" class="active">
                                        <h3>Infrastructure and Management</h3>
                                    </li>
                                    <li data-target="cloud-menu">
                                        <h3>Cloud Computing</h3>
                                    </li>
                                    <li data-target="storage-menu">
                                        <h3>Storage</h3>
                                    </li>
                                    <li data-target="jboss-dev-menu">
                                        <h3>Runtimes</h3>
                                    </li>
                                    <li data-target="jboss-int-menu">
                                        <h3>Integration and Automation</h3>
                                    </li>
                                </ul>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="infrastructure-menu" style="display: block;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="cloud-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="storage-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a>
                                        </li>
                                        <li>
                                          <a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-dev-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                        </li>
                                    </ul>
                                </div> -->
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul class="border-bottom" id="portal-menu-border-bottom">
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                      </li>
                                    </ul>
                                    <ul>
                                      <li>
                                        <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                      </li>
                                    </ul>
                                </div>
                            </div>
                            <a href="https://access.redhat.com/products" class="btn btn-primary">View All Products</a>
                        </div>

                        <div class="col-md-6 col-sm-4 pull-right" data-portal-tour-1="8">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/support" class="cta-link cta-link-darkbg">Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
                                        <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>
                                    </ul>
                                    <h4 class="nav-title">Services</h4>
                                    <ul>
                                        <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
                                        <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/documentation" class="cta-link cta-link-darkbg">Documentation</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>
                                    </ul>
                                    <ul>
                                        <li><a href="https://access.redhat.com/ecosystem/" class="cta-link cta-link-darkbg">Ecosystem</a></li>
                                        <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
                                        <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tools Menu -->
                <div aria-labelledby="tools-menu" class="tools-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row" data-portal-tour-1="9">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h3 class="nav-title">Tools</h3>
                                    <ul>
                                        <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
                                        <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
                                        <li><a href="https://access.redhat.com/errata/">Errata</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <ul class="list-flat">
                                        <li><a href="https://access.redhat.com/labs/" class="cta-link cta-link-darkbg">Customer Portal Labs</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <div class="card card-dark-grey">
                                        <h4 class="card-heading">Red Hat Insights</h4>
                                        <p class="text-white">Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                        <ul class="list-flat rh-l-grid rh-m-gutters rh-m-all-6-col-on-md">
                                          <li><a href="https://www.redhat.com/en/technologies/management/insights" class="cta-link cta-link-md cta-link-darkbg">Learn more</a></li>
                                          <li><a href="https://cloud.redhat.com/insights" class="cta-link cta-link-md cta-link-darkbg">Go to Insights</a></li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <!-- Security Menu -->
                <div aria-labelledby="security-menu" class="security-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="10">

                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Red Hat Product Security Center</h2>
                                    <p class="text-white">Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.</p>
                                    <p><a href="https://access.redhat.com/security/" class="btn btn-primary">Product Security Center</a></p>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Security Updates</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
                                    </ul>
                                    <p class="text-white">Keep your systems secure with Red Hat&#039;s specialized responses for high-priority security vulnerabilities.</p>
                                    <ul>
                                        <li class="more-link"><a href="https://access.redhat.com/security/vulnerability">View Responses</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Resources</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
                                        <li><a href="https://www.redhat.com/en/blog/channel/security">Security Blog</a></li>
                                        <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
                                        <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community Menu -->
                <div aria-labelledby="community-menu" class="community-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="11">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Portal Community</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
                                        <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
                                        <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
                                        <p class="push-top"><a href="https://access.redhat.com/community/" class="btn btn-primary">Community Activity</a></p>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Events</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
                                        <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Stories</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
                                        <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
                                        <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--<a href="https://access.redhat.com/community/" class="btn btn-primary">Explore Community</a>-->
                    </div>
                </div>
            </div>
        </div>
    </nav>
</div>

            <!--[if IE 8]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
            </div>
            <![endif]-->
            <!--[if IE 9]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
            </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">
  <script type="text/javascript">
    chrometwo_require(['jquery-ui']);
  </script>


      <article class="rh_docs">
  <div class="container">
        <!-- Display: Book Page Content -->
    
  

<div class="row">
  <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
  <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
  


<a class="toc-toggle toc-show" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
  <span class="sr-only">Show Table of Contents</span>
  <span class="web-icon-mobile-menu" aria-hidden="true"></span>
</a>
<nav id="toc-main" class="toc-main collapse in">
  <div class="toc-menu affix-top">
    <a class="toc-toggle toc-hide" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
      <span class="sr-only">Hide Table of Contents</span>
      <span class="icon-remove" aria-hidden="true"></span>
    </a>
    <div class="doc-options">
      <div class="doc-language btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          English <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/">日本語</a></li>
                      <li><a href="index.html">English</a></li>
                  </ul>
      </div>
      <div class="doc-format btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          Single-page HTML <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/">Multi-page HTML</a></li>
                                <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/pdf/deploying_different_types_of_servers/Red_Hat_Enterprise_Linux-8-Deploying_different_types_of_servers-en-US.pdf">PDF</a></li>
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/epub/deploying_different_types_of_servers/Red_Hat_Enterprise_Linux-8-Deploying_different_types_of_servers-en-US.epub">ePub</a></li>
                  </ul>
      </div>
    </div>
    <ol class="menu"><li class=" leaf"><a href="index.html">Deploying different types of servers</a></li><li class=" leaf"><a href="index.html#proc_providing-feedback-on-red-hat-documentation_Deploying-different-types-of-servers">Providing feedback on Red Hat documentation</a></li><li class=" leaf"><a href="index.html#setting-apache-http-server_Deploying-different-types-of-servers">1. Setting up the Apache HTTP web server</a><ol class="menu"><li class=" leaf"><a href="index.html#apache-intro_setting-apache-http-server">1.1. Introduction to the Apache HTTP web server</a><ol class="menu"><li class=" leaf"><a href="index.html#apache-changes-to-rhel7_setting-apache-http-server">1.1.1. Notable changes in the Apache HTTP Server</a></li><li class=" leaf"><a href="index.html#apache-updating-configuration_setting-apache-http-server">1.1.2. Updating the configuration</a></li></ol></li><li class=" leaf"><a href="index.html#con-the-apache-configuration-files_setting-apache-http-server">1.2. The Apache configuration files</a></li><li class=" leaf"><a href="index.html#managing-the-httpd-service_setting-apache-http-server">1.3. Managing the httpd service</a></li><li class=" leaf"><a href="index.html#setting-up-a-single-instance-apache-http-server_setting-apache-http-server">1.4. Setting up a single-instance Apache HTTP Server</a></li><li class=" leaf"><a href="index.html#configuring-apache-name-based-virtual-hosts_setting-apache-http-server">1.5. Configuring Apache name-based virtual hosts</a></li><li class=" leaf"><a href="index.html#configuring-tls-encryption-on-an-apache-http-server_setting-apache-http-server">1.6. Configuring TLS encryption on an Apache HTTP Server</a><ol class="menu"><li class=" leaf"><a href="index.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_configuring-tls-encryption-on-an-apache-http-server">1.6.1. Adding TLS encryption to an Apache HTTP Server</a></li><li class=" leaf"><a href="index.html#setting-the-supported-tls-protocol-versions-on-an-apache-http-server_configuring-tls-encryption-on-an-apache-http-server">1.6.2. Setting the supported TLS protocol versions on an Apache HTTP Server</a></li><li class=" leaf"><a href="index.html#setting-the-supported-ciphers-on-an-apache-http-server_configuring-tls-encryption-on-an-apache-http-server">1.6.3. Setting the supported ciphers on an Apache HTTP Server</a></li></ol></li><li class=" leaf"><a href="index.html#configuring-tls-client-certificate-authentication_setting-apache-http-server">1.7. Configuring TLS client certificate authentication</a></li><li class=" leaf"><a href="index.html#installing-the-apache-http-server-manual_setting-apache-http-server">1.8. Installing the Apache HTTP Server manual</a></li><li class=" leaf"><a href="index.html#working-with-modules_setting-apache-http-server">1.9. Working with modules</a><ol class="menu"><li class=" leaf"><a href="index.html#sec-apache-dso-loading">1.9.1. Loading a module</a></li><li class=" leaf"><a href="index.html#sec-apache-dso-writing">1.9.2. Writing a module</a></li></ol></li><li class=" leaf"><a href="index.html#additional_resources">1.10. Additional resources</a></li></ol></li><li class=" leaf"><a href="index.html#assembly_using-samba-as-a-server_Deploying-different-types-of-servers">2. Using Samba as a server</a><ol class="menu"><li class=" leaf"><a href="index.html#con_the-samba-services_assembly_using-samba-as-a-server">2.1. The Samba services</a></li><li class=" leaf"><a href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server">2.2. Verifying the smb.conf file by using the testparm utility</a></li><li class=" leaf"><a href="index.html#con_the-samba-security-services_assembly_using-samba-as-a-server">2.3. The Samba security services</a></li><li class=" leaf"><a href="index.html#assembly_setting-up-samba-as-a-standalone-server_assembly_using-samba-as-a-server">2.4. Setting up Samba as a standalone server</a><ol class="menu"><li class=" leaf"><a href="index.html#proc_setting-up-the-server-configuration-for-the-standalone-server_assembly_setting-up-samba-as-a-standalone-server">2.4.1. Setting up the server configuration for the standalone server</a></li><li class=" leaf"><a href="index.html#proc_creating-and-enabling-local-user-accounts_assembly_setting-up-samba-as-a-standalone-server">2.4.2. Creating and enabling local user accounts</a></li></ol></li><li class=" leaf"><a href="index.html#assembly_setting-up-samba-as-an-ad-domain-member-server_assembly_using-samba-as-a-server">2.5. Setting up Samba as an AD domain member server</a><ol class="menu"><li class=" leaf"><a href="index.html#proc_joining-samba-to-a-domain_assembly_setting-up-samba-as-an-ad-domain-member-server">2.5.1. Joining Samba to a Domain</a></li><li class=" leaf"><a href="index.html#proc_verifying-that-samba-was-correctly-joined-as-a-domain-member_assembly_setting-up-samba-as-an-ad-domain-member-server">2.5.2. Verifying that Samba was correctly joined as a domain member</a></li><li class=" leaf"><a href="index.html#using-the-local-authorization-plug-in-for-mit-kerberos_assembly_setting-up-samba-as-an-ad-domain-member-server">2.5.3. Using the local authorization plug-in for MIT Kerberos</a></li><li class=" leaf"><a href="index.html#assembly_samba-id-mapping_assembly_setting-up-samba-as-an-ad-domain-member-server">2.5.4. Samba ID mapping</a></li><li class=" leaf"><a href="index.html#assembly_the-different-samba-id-mapping-back-ends_assembly_setting-up-samba-as-an-ad-domain-member-server">2.5.5. The different Samba ID mapping back ends</a></li></ol></li><li class=" leaf"><a href="index.html#setting-up-samba-on-an-idm-domain-member_assembly_using-samba-as-a-server">2.6. Setting up Samba on an IdM domain member</a><ol class="menu"><li class=" leaf"><a href="index.html#preparing-the-idm-domain-for-installing-samba-on-domain-members_setting-up-samba-on-an-idm-domain-member">2.6.1. Preparing the IdM domain for installing Samba on domain members</a></li><li class=" leaf"><a href="index.html#enabling-the-aes-encryption-type-in-active-directory-using-a-gpo_setting-up-samba-on-an-idm-domain-member">2.6.2. Enabling the AES encryption type in Active Directory using a GPO</a></li><li class=" leaf"><a href="index.html#installing-and-configuring-samba-on-an-idm-client_setting-up-samba-on-an-idm-domain-member">2.6.3. Installing and configuring a Samba server on an IdM client</a></li><li class=" leaf"><a href="index.html#manually-adding-an-id-mapping-configuration-if-idm-trusts-a-new-domain_setting-up-samba-on-an-idm-domain-member">2.6.4. Manually adding an ID mapping configuration if IdM trusts a new domain</a></li><li class=" leaf"><a href="index.html#additional_resources_2">2.6.5. Additional resources</a></li></ol></li><li class=" leaf"><a href="index.html#assembly_configuring-file-shares-on-a-samba-server_assembly_using-samba-as-a-server">2.7. Configuring file shares on a Samba server</a><ol class="menu"><li class=" leaf"><a href="index.html#assembly_setting-up-a-share-that-uses-posix-acls_assembly_configuring-file-shares-on-a-samba-server">2.7.1. Setting up a share that uses POSIX ACLs</a></li><li class=" leaf"><a href="index.html#assembly_setting-up-a-share-that-uses-windows-acls_assembly_configuring-file-shares-on-a-samba-server">2.7.2. Setting up a share that uses Windows ACLs</a></li><li class=" leaf"><a href="index.html#assembly_managing-acls-on-an-smb-share-using-smbcacls_assembly_configuring-file-shares-on-a-samba-server">2.7.3. Managing ACLs on an SMB share using smbcacls</a></li><li class=" leaf"><a href="index.html#assembly_enabling-users-to-share-directories-on-a-samba-server_assembly_configuring-file-shares-on-a-samba-server">2.7.4. Enabling users to share directories on a Samba server</a></li><li class=" leaf"><a href="index.html#proc_enabling-guest-access-to-a-share_assembly_configuring-file-shares-on-a-samba-server">2.7.5. Enabling guest access to a share</a></li><li class=" leaf"><a href="index.html#optimizing-the-samba-configuration-for-providing-file-shares-for-macos-clients_assembly_configuring-file-shares-on-a-samba-server">2.7.6. Optimizing the Samba configuration for providing file shares for macOS clients</a></li></ol></li><li class=" leaf"><a href="index.html#assembly_setting-up-samba-as-a-print-server_assembly_using-samba-as-a-server">2.8. Setting up Samba as a print server</a><ol class="menu"><li class=" leaf"><a href="index.html#proc_the-samba-spoolssd-service_assembly_setting-up-samba-as-a-print-server">2.8.1. The Samba spoolssd service</a></li><li class=" leaf"><a href="index.html#proc_enabling-print-server-support-in-samba_assembly_setting-up-samba-as-a-print-server">2.8.2. Enabling print server support in Samba</a></li><li class=" leaf"><a href="index.html#proc_manually-sharing-specific-printers_assembly_setting-up-samba-as-a-print-server">2.8.3. Manually sharing specific printers</a></li><li class=" leaf"><a href="index.html#assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients_assembly_setting-up-samba-as-a-print-server">2.8.4. Setting up automatic printer driver downloads for Windows clients</a></li></ol></li><li class=" leaf"><a href="index.html#assembly_tuning-the-performance-of-a-samba-server_assembly_using-samba-as-a-server">2.9. Tuning the performance of a Samba server</a><ol class="menu"><li class=" leaf"><a href="index.html#proc_setting-the-smb-protocol-version_assembly_tuning-the-performance-of-a-samba-server">2.9.1. Setting the SMB protocol version</a></li><li class=" leaf"><a href="index.html#proc_tuning-shares-with-directories-that-contain-a-large-number-of-files_assembly_tuning-the-performance-of-a-samba-server">2.9.2. Tuning shares with directories that contain a large number of files</a></li><li class=" leaf"><a href="index.html#con_settings-that-can-have-a-negative-performance-impact_assembly_tuning-the-performance-of-a-samba-server">2.9.3. Settings that can have a negative performance impact</a></li></ol></li><li class=" leaf"><a href="index.html#setting-the-minimum-smb-protocol-version-supported-by-a-samba-server_assembly_using-samba-as-a-server">2.10. Setting the minimum SMB protocol version supported by a Samba server</a></li><li class=" leaf"><a href="index.html#assembly_frequently-used-samba-command-line-utilities_assembly_using-samba-as-a-server">2.11. Frequently used Samba command-line utilities</a><ol class="menu"><li class=" leaf"><a href="index.html#assembly_using-the-net-utility_assembly_frequently-used-samba-command-line-utilities">2.11.1. Using the net utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-rpcclient-utility_assembly_frequently-used-samba-command-line-utilities">2.11.2. Using the rpcclient utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-samba-regedit-application_assembly_frequently-used-samba-command-line-utilities">2.11.3. Using the samba-regedit application</a></li><li class=" leaf"><a href="index.html#assembly_using-the-smbcacls-utility_assembly_frequently-used-samba-command-line-utilities">2.11.4. Using the smbcacls utility</a></li><li class=" leaf"><a href="index.html#assembly_using-the-smbclient-utility_assembly_frequently-used-samba-command-line-utilities">2.11.5. Using the smbclient utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-smbcontrol-utility_assembly_frequently-used-samba-command-line-utilities">2.11.6. Using the smbcontrol utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-smbpasswd-utility_assembly_frequently-used-samba-command-line-utilities">2.11.7. Using the smbpasswd utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-smbstatus-utility_assembly_frequently-used-samba-command-line-utilities">2.11.8. Using the smbstatus utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-smbtar-utility_assembly_frequently-used-samba-command-line-utilities">2.11.9. Using the smbtar utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-testparm-utility_assembly_frequently-used-samba-command-line-utilities">2.11.10. Using the testparm utility</a></li><li class=" leaf"><a href="index.html#proc_using-the-wbinfo-utility_assembly_frequently-used-samba-command-line-utilities">2.11.11. Using the wbinfo utility</a></li></ol></li><li class=" leaf"><a href="index.html#related-information-assembly_using-samba-as-a-server">2.12. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#exporting-nfs-shares_Deploying-different-types-of-servers">3. Exporting NFS shares</a><ol class="menu"><li class=" leaf"><a href="index.html#introduction-to-nfs_exporting-nfs-shares">3.1. Introduction to NFS</a></li><li class=" leaf"><a href="index.html#supported-nfs-versions_exporting-nfs-shares">3.2. Supported NFS versions</a></li><li class=" leaf"><a href="index.html#the-tcp-and-udp-protocols-in-nfsv3-and-nfsv4_exporting-nfs-shares">3.3. The TCP and UDP protocols in NFSv3 and NFSv4</a></li><li class=" leaf"><a href="index.html#services-required-by-nfs_exporting-nfs-shares">3.4. Services required by NFS</a></li><li class=" leaf"><a href="index.html#nfs-host-name-formats_exporting-nfs-shares">3.5. NFS host name formats</a></li><li class=" leaf"><a href="index.html#nfs-server-configuration_exporting-nfs-shares">3.6. NFS server configuration</a><ol class="menu"><li class=" leaf"><a href="index.html#the-etc-exports-configuration-file_exporting-nfs-shares">3.6.1. The /etc/exports configuration file</a></li><li class=" leaf"><a href="index.html#the-exportfs-utility_exporting-nfs-shares">3.6.2. The exportfs utility</a></li></ol></li><li class=" leaf"><a href="index.html#nfs-and-rpcbind_exporting-nfs-shares">3.7. NFS and rpcbind</a></li><li class=" leaf"><a href="index.html#installing-nfs_exporting-nfs-shares">3.8. Installing NFS</a></li><li class=" leaf"><a href="index.html#starting-the-nfs-server_exporting-nfs-shares">3.9. Starting the NFS server</a></li><li class=" leaf"><a href="index.html#troubleshooting-nfs-and-rpcbind_exporting-nfs-shares">3.10. Troubleshooting NFS and rpcbind</a></li><li class=" leaf"><a href="index.html#configuring-the-nfs-server-to-run-behind-a-firewall_exporting-nfs-shares">3.11. Configuring the NFS server to run behind a firewall</a></li><li class=" leaf"><a href="index.html#exporting-rpc-quota-through-a-firewall_exporting-nfs-shares">3.12. Exporting RPC quota through a firewall</a></li><li class=" leaf"><a href="index.html#enabling-nfs-over-rdma-nfsordma_exporting-nfs-shares">3.13. Enabling NFS over RDMA (NFSoRDMA)</a></li><li class=" leaf"><a href="index.html#configuring-an-nfsv4-only-server_exporting-nfs-shares">3.14. Configuring an NFSv4-only server</a><ol class="menu"><li class=" leaf"><a href="index.html#benefits-and-drawbacks-of-an-nfsv4-only-server_configuring-an-nfsv4-only-server">3.14.1. Benefits and drawbacks of an NFSv4-only server</a></li><li class=" leaf"><a href="index.html#nfs-and-rpcbind_configuring-an-nfsv4-only-server">3.14.2. NFS and rpcbind</a></li><li class=" leaf"><a href="index.html#configuring-the-nfs-server-to-support-only-nfsv4_configuring-an-nfsv4-only-server">3.14.3. Configuring the NFS server to support only NFSv4</a></li><li class=" leaf"><a href="index.html#verifying-the-nfsv4-only-configuration_configuring-an-nfsv4-only-server">3.14.4. Verifying the NFSv4-only configuration</a></li></ol></li><li class=" leaf"><a href="index.html#related-information-exporting-nfs-shares">3.15. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#securing-nfs_Deploying-different-types-of-servers">4. Securing NFS</a><ol class="menu"><li class=" leaf"><a href="index.html#nfs-security-with-auth_sys-and-export-controls_securing-nfs">4.1. NFS security with AUTH_SYS and export controls</a></li><li class=" leaf"><a href="index.html#nfs-security-with-auth_gss_securing-nfs">4.2. NFS security with AUTH_GSS</a></li><li class=" leaf"><a href="index.html#configuring-an-nfs-server-and-client-to-use-kerberos_securing-nfs">4.3. Configuring an NFS server and client to use Kerberos</a></li><li class=" leaf"><a href="index.html#nfsv4-security-options_securing-nfs">4.4. NFSv4 security options</a></li><li class=" leaf"><a href="index.html#file-permissions-on-mounted-nfs-exports_securing-nfs">4.5. File permissions on mounted NFS exports</a></li></ol></li><li class=" leaf"><a href="index.html#enabling-pnfs-scsi-layouts-in-nfs_Deploying-different-types-of-servers">5. Enabling pNFS SCSI layouts in NFS</a><ol class="menu"><li class=" leaf"><a href="index.html#the-pnfs-technology_enabling-pnfs-scsi-layouts-in-nfs">5.1. The pNFS technology</a></li><li class=" leaf"><a href="index.html#pnfs-scsi-layouts_enabling-pnfs-scsi-layouts-in-nfs">5.2. pNFS SCSI layouts</a></li><li class=" leaf"><a href="index.html#checking-for-a-scsi-device-compatible-with-pnfs_enabling-pnfs-scsi-layouts-in-nfs">5.3. Checking for a SCSI device compatible with pNFS</a></li><li class=" leaf"><a href="index.html#setting-up-pnfs-scsi-on-the-server_enabling-pnfs-scsi-layouts-in-nfs">5.4. Setting up pNFS SCSI on the server</a></li><li class=" leaf"><a href="index.html#setting-up-pnfs-scsi-on-the-client_enabling-pnfs-scsi-layouts-in-nfs">5.5. Setting up pNFS SCSI on the client</a></li><li class=" leaf"><a href="index.html#releasing-the-pnfs-scsi-reservation-on-the-server_enabling-pnfs-scsi-layouts-in-nfs">5.6. Releasing the pNFS SCSI reservation on the server</a></li><li class=" leaf"><a href="index.html#monitoring-pnfs-scsi-layouts-functionality_enabling-pnfs-scsi-layouts-in-nfs">5.7. Monitoring pNFS SCSI layouts functionality</a><ol class="menu"><li class=" leaf"><a href="index.html#checking-pnfs-scsi-operations-from-the-server-using-nfsstat_monitoring-pnfs-scsi-layouts-functionality">5.7.1. Checking pNFS SCSI operations from the server using nfsstat</a></li><li class=" leaf"><a href="index.html#checking-pnfs-scsi-operations-from-the-client-using-mountstats_monitoring-pnfs-scsi-layouts-functionality">5.7.2. Checking pNFS SCSI operations from the client using mountstats</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#configuring-the-squid-caching-proxy-server_Deploying-different-types-of-servers">6. Configuring the Squid caching proxy server</a><ol class="menu"><li class=" leaf"><a href="index.html#setting-up-squid-as-a-caching-proxy-without-authentication_configuring-the-squid-caching-proxy-server">6.1. Setting up Squid as a caching proxy without authentication</a></li><li class=" leaf"><a href="index.html#setting-up-squid-as-a-caching-proxy-with-ldap-authentication_configuring-the-squid-caching-proxy-server">6.2. Setting up Squid as a caching proxy with LDAP authentication</a></li><li class=" leaf"><a href="index.html#setting-up-squid-as-a-caching-proxy-with-kerberos-authentication_configuring-the-squid-caching-proxy-server">6.3. Setting up Squid as a caching proxy with kerberos authentication</a></li><li class=" leaf"><a href="index.html#configuring-a-domain-blacklist-in-squid_configuring-the-squid-caching-proxy-server">6.4. Configuring a domain blacklist in Squid</a></li><li class=" leaf"><a href="index.html#configuring-the-squid-service-to-listen-on-a-specific-port-or-ip-address_configuring-the-squid-caching-proxy-server">6.5. Configuring the Squid service to listen on a specific port or IP address</a></li><li class=" leaf"><a href="index.html#additional_resources_3">6.6. Additional resources</a></li></ol></li><li class=" leaf"><a href="index.html#using-databases">7. Database servers</a><ol class="menu"><li class=" leaf"><a href="index.html#introduction-to-databases_using-databases">7.1. Introduction to database servers</a></li><li class=" leaf"><a href="index.html#using-mariadb">7.2. Using MariaDB</a><ol class="menu"><li class=" leaf"><a href="index.html#introduction-to-mariadb_using-mariadb">7.2.1. Getting started with MariaDB</a></li><li class=" leaf"><a href="index.html#installing-mariadb_using-mariadb">7.2.2. Installing MariaDB</a></li><li class=" leaf"><a href="index.html#configuring-mariadb_using-mariadb">7.2.3. Configuring MariaDB</a></li><li class=" leaf"><a href="index.html#backing-up-mariadb-data_using-mariadb">7.2.4. Backing up MariaDB data</a></li><li class=" leaf"><a href="index.html#migrating-to-mariadb_10_3_using-mariadb">7.2.5. Migrating to MariaDB 10.3</a></li><li class=" leaf"><a href="index.html#replicating-mariadb-with-galera_using-mariadb">7.2.6. Replicating MariaDB with Galera</a></li></ol></li><li class=" leaf"><a href="index.html#using-postgresql">7.3. Using PostgreSQL</a><ol class="menu"><li class=" leaf"><a href="index.html#introduction-to-postgresql_using-postgresql">7.3.1. Getting started with PostgreSQL</a></li><li class=" leaf"><a href="index.html#installing-postgresql_using-postgresql">7.3.2. Installing PostgreSQL</a></li><li class=" leaf"><a href="index.html#configuring-postgresql_using-postgresql">7.3.3. Configuring PostgreSQL</a></li><li class=" leaf"><a href="index.html#backing-up-postgresql-data_using-postgresql">7.3.4. Backing up PostgreSQL data</a></li><li class=" leaf"><a href="index.html#migrating-to-postgresql_using-postgresql">7.3.5. Migrating to a RHEL 8 version of PostgreSQL</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#configuring-printing_Deploying-different-types-of-servers">8. Configuring printing</a><ol class="menu"><li class=" leaf"><a href="index.html#activating-cups-service_configuring-printing">8.1. Activating the cups service</a></li><li class=" leaf"><a href="index.html#print-settings-tools_configuring-printing">8.2. Print settings tools</a></li><li class=" leaf"><a href="index.html#starting-cups-web-ui_configuring-printing">8.3. Accessing and configuring the CUPS web UI</a><ol class="menu"><li class=" leaf"><a href="index.html#acquiring-administration-access-to-cups-web-ui_configuring-printing">8.3.1. Acquiring administration access to the CUPS web UI</a></li></ol></li><li class=" leaf"><a href="index.html#adding-a-printer-cups-web-ui_configuring-printing">8.4. Adding a printer in the CUPS web UI</a></li><li class=" leaf"><a href="index.html#configuring-printer-cups-web-ui_acquiconfiguring-printing">8.5. Configuring a printer in the CUPS web UI</a></li><li class=" leaf"><a href="index.html#printing-a-test-page_latest_configuring-printing">8.6. Printing a test page using the CUPS web UI</a></li><li class=" leaf"><a href="index.html#setting-print-options_cups-web-ui_configuring-printing">8.7. Setting print options using the CUPS web UI</a></li><li class=" leaf"><a href="index.html#using-samba-to-print-to-a-windows-print-server-with-kerberos-authentication_configuring-printing">8.8. Using Samba to print to a Windows print server with Kerberos authentication</a></li><li class=" leaf"><a href="index.html#working-with-cups-logs_configuring-printing">8.9. Working with CUPS logs</a><ol class="menu"><li class=" leaf"><a href="index.html#types-of-cups-logs_working-with-cups-logs">8.9.1. Types of CUPS logs</a></li><li class=" leaf"><a href="index.html#accessing-cups-logs_working-with-cups-logs">8.9.2. Accessing CUPS logs</a></li><li class=" leaf"><a href="index.html#configuring-the-cups-log-location_working-with-cups-logs">8.9.3. Configuring the CUPS log location</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#idm140042815399824">Legal Notice</a></li></ol>  </div>
</nav>


  <div class="doc-wrapper">
    <div class="panel-pane pane-training-banner"  >
  
      
  
  <div class="card card-light card-md push-bottom">
  <h2 class="card-heading card-heading-red card-heading-sm card-heading-flush">Red Hat Training</h2>
  <p>A Red Hat training course is available for <a href="https://www.redhat.com/en/services/training/courses-by-curriculum?intcmp=701f2000001D4OtAAK&amp;#Red-Hat-Enterprise-Linux" class="cta-link">RHEL 8</a></p>
</div>

  
  </div>
<div class="panel-pane pane-page-title"  >
  
      
  
  <h1 class="title" itemprop="name">Deploying different types of servers</h1>
  
  </div>
<div class="panel-pane pane-page-body"  >
  
      
  
  <div class="body"><div xml:lang="en-US" class="book" id="idm140042829087712"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">8</span></div><div><h2 class="subtitle">A guide to deploying different types of servers in Red Hat Enterprise Linux 8</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="index.html#idm140042815399824">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document describes how to configure and run different types of servers on Red Hat Enterprise Linux 8, including Apache HTTP web server, Samba server, NFS server, available database servers, and the CUPS server.
			</div></div></div></div><hr/></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Providing feedback on Red Hat documentation</h1></div></div></div><p>
			We appreciate your input on our documentation. Please let us know how we could make it better. To do so:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					For simple comments on specific passages:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Make sure you are viewing the documentation in the <span class="emphasis"><em>Multi-page HTML</em></span> format. In addition, ensure you see the <span class="strong strong"><strong>Feedback</strong></span> button in the upper right corner of the document.
						</li><li class="listitem">
							Use your mouse cursor to highlight the part of text that you want to comment on.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Add Feedback</strong></span> pop-up that appears below the highlighted text.
						</li><li class="listitem">
							Follow the displayed instructions.
						</li></ol></div></li><li class="listitem"><p class="simpara">
					For submitting more complex feedback, create a Bugzilla ticket:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Go to the <a class="link" href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20Enterprise%20Linux%208">Bugzilla</a> website.
						</li><li class="listitem">
							As the Component, use <span class="strong strong"><strong>Documentation</strong></span>.
						</li><li class="listitem">
							Fill in the <span class="strong strong"><strong>Description</strong></span> field with your suggestion for improvement. Include a link to the relevant part(s) of documentation.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit Bug</strong></span>.
						</li></ol></div></li></ul></div></section><section class="chapter" id="setting-apache-http-server_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Setting up the Apache HTTP web server</h1></div></div></div><section class="section" id="apache-intro_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.1. Introduction to the Apache HTTP web server</h2></div></div></div><p>
				A <span class="emphasis"><em>web server</em></span> is a network service that serves content to a client over the web. This typically means web pages, but any other documents can be served as well. Web servers are also known as HTTP servers, as they use the <span class="emphasis"><em>hypertext transport protocol</em></span> (<span class="strong strong"><strong>HTTP</strong></span>).
			</p><p>
				The <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span>, <code class="literal">httpd</code>, is an open source web server developed by the <a class="link" href="http://www.apache.org/">Apache Software Foundation</a>.
			</p><p>
				If you are upgrading from a previous release of Red Hat Enterprise Linux, you will need to update the <code class="literal">httpd</code> service configuration accordingly. This section reviews some of the newly added features, and guides you through the update of prior configuration files.
			</p><section class="section" id="apache-changes-to-rhel7_setting-apache-http-server"><div class="titlepage"><div><div><h3 class="title">1.1.1. Notable changes in the Apache HTTP Server</h3></div></div></div><p>
					The <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span>, has been updated from version 2.4.6 to version 2.4.37 between RHEL 7 and RHEL 8. This updated version includes several new features, but maintains backwards compatibility with the RHEL 7 version at the level of configuration and Application Binary Interface (ABI) of external modules.
				</p><p>
					New features include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal systemitem">HTTP/2</code> support is now provided by the <code class="literal package">mod_http2</code> package, which is a part of the <code class="literal">httpd</code> module.
						</li><li class="listitem">
							systemd socket activation is supported. See <code class="literal">httpd.socket(8)</code> man page for more details.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Multiple new modules have been added:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal systemitem">mod_proxy_hcheck</code> - a proxy health-check module
								</li><li class="listitem">
									<code class="literal systemitem">mod_proxy_uwsgi</code> - a Web Server Gateway Interface (WSGI) proxy
								</li><li class="listitem">
									<code class="literal systemitem">mod_proxy_fdpass</code> - provides support for the passing the socket of the client to another process
								</li><li class="listitem">
									<code class="literal systemitem">mod_cache_socache</code> - an HTTP cache using, for example, memcache backend
								</li><li class="listitem">
									<code class="literal systemitem">mod_md</code> - an ACME protocol SSL/TLS certificate service
								</li></ul></div></li><li class="listitem"><p class="simpara">
							The following modules now load by default:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal systemitem">mod_request</code>
								</li><li class="listitem">
									<code class="literal systemitem">mod_macro</code>
								</li><li class="listitem">
									<code class="literal systemitem">mod_watchdog</code>
								</li></ul></div></li><li class="listitem">
							A new subpackage, <code class="literal package">httpd-filesystem</code>, has been added, which contains the basic directory layout for the <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span> including the correct permissions for the directories.
						</li><li class="listitem">
							Instantiated service support, <code class="literal">httpd@.service</code> has been introduced. See the <code class="literal">httpd.service</code> man page for more information.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A new <code class="literal service">httpd-init.service</code> replaces the <code class="literal">%post script</code> to create a self-signed <code class="literal">mod_ssl</code> key pair.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Automated TLS certificate provisioning and renewal using the Automatic Certificate Management Environment (ACME) protocol is now supported with the <code class="literal package">mod_md</code> package (for use with certificate providers such as <code class="literal">Let’s Encrypt</code>).
						</li><li class="listitem">
							The <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span> now supports loading TLS certificates and private keys from hardware security tokens directly from <code class="literal">PKCS#11</code> modules. As a result, a <code class="literal">mod_ssl</code> configuration can now use <code class="literal">PKCS#11</code> URLs to identify the TLS private key, and, optionally, the TLS certificate in the <code class="literal">SSLCertificateKeyFile</code> and <code class="literal">SSLCertificateFile</code> directives.
						</li><li class="listitem"><p class="simpara">
							A new <code class="literal">ListenFree</code> directive in the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file is now supported.
						</p><p class="simpara">
							Similarly to the <code class="literal">Listen</code> directive, <code class="literal">ListenFree</code> provides information about IP addresses, ports, or IP address-and-port combinations that the server listens to. However, with <code class="literal">ListenFree</code>, the <code class="literal">IP_FREEBIND</code> socket option is enabled by default. Hence, <code class="literal">httpd</code> is allowed to bind to a nonlocal IP address or to an IP address that does not exist yet. This allows <code class="literal">httpd</code> to listen on a socket without requiring the underlying network interface or the specified dynamic IP address to be up at the time when <code class="literal">httpd</code> is trying to bind to it.
						</p><p class="simpara">
							Note that the <code class="literal">ListenFree</code> directive is currently available only in RHEL 8.
						</p><p class="simpara">
							For more details on <code class="literal">ListenFree</code>, see the following table:
						</p><div class="table" id="idm140042833551280"><p class="title"><strong>Table 1.1. ListenFree directive’s syntax, status, and modules</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140042828207552" scope="col">Syntax</th><th align="left" valign="top" id="idm140042828206112" scope="col">Status</th><th align="left" valign="top" id="idm140042828205024" scope="col">Modules</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140042828207552"> <p>
											ListenFree [IP-address:]portnumber [protocol]
										</p>
										 </td><td align="left" valign="top" headers="idm140042828206112"> <p>
											MPM
										</p>
										 </td><td align="left" valign="top" headers="idm140042828205024"> <p>
											event, worker, prefork, mpm_winnt, mpm_netware, mpmt_os2
										</p>
										 </td></tr></tbody></table></div></div></li></ul></div><p>
					Other notable changes include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The following modules have been removed:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal systemitem">mod_file_cache</code>
								</li><li class="listitem">
									<code class="literal systemitem">mod_nss</code>
								</li><li class="listitem">
									<code class="literal systemitem">mod_perl</code>
								</li></ul></div></li><li class="listitem">
							The default type of the DBM authentication database used by the <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span> in RHEL 8 has been changed from <code class="literal">SDBM</code> to <code class="literal">db5</code>.
						</li><li class="listitem">
							The <code class="literal">mod_wsgi</code> module for the <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span> has been updated to Python 3. WSGI applications are now supported only with Python 3, and must be migrated from Python 2.
						</li><li class="listitem"><p class="simpara">
							The multi-processing module (MPM) configured by default with the <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span> has changed from a multi-process, forked model (known as <code class="literal">prefork</code>) to a high-performance multi-threaded model, <code class="literal">event</code>.
						</p><p class="simpara">
							Any third-party modules that are not thread-safe need to be replaced or removed. To change the configured MPM, edit the <code class="literal filename">/etc/httpd/conf.modules.d/00-mpm.conf</code> file. See the <code class="literal">httpd.service(8)</code> man page for more information.
						</p></li><li class="listitem">
							The minimum UID and GID allowed for users by suEXEC are now 1000 and 500, respectively (previously 100 and 100).
						</li><li class="listitem">
							The <code class="literal filename">/etc/sysconfig/httpd</code> file is no longer a supported interface for setting environment variables for the <code class="literal service">httpd</code> service. The <code class="literal">httpd.service(8)</code> man page has been added for the systemd service.
						</li><li class="listitem">
							Stopping the <code class="literal service">httpd</code> service now uses a “graceful stop” by default.
						</li><li class="listitem">
							The <code class="literal systemitem">mod_auth_kerb</code> module has been replaced by the <code class="literal systemitem">mod_auth_gssapi</code> module.
						</li></ul></div></section><section class="section" id="apache-updating-configuration_setting-apache-http-server"><div class="titlepage"><div><div><h3 class="title">1.1.2. Updating the configuration</h3></div></div></div><p>
					To update the configuration files from the <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span> version used in Red Hat Enterprise Linux 7, choose one of the following options:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If <code class="literal filename">/etc/sysconfig/httpd</code> is used to set environment variables, create a systemd drop-in file instead.
						</li><li class="listitem">
							If any third-party modules are used, ensure they are compatible with a threaded MPM.
						</li><li class="listitem">
							If suexec is used, ensure user and group IDs meet the new minimums.
						</li></ul></div><p>
					You can check the configuration for possible errors by using the following command:
				</p><pre class="literallayout"># apachectl configtest
Syntax OK</pre></section></section><section class="section" id="con-the-apache-configuration-files_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.2. The Apache configuration files</h2></div></div></div><p>
				When the <code class="literal service">httpd</code> service is started, by default, it reads the configuration from locations that are listed in <a class="xref" href="index.html#table-apache-editing-files" title="Table 1.2. The httpd service configuration files">Table 1.2, “The httpd service configuration files”</a>.
			</p><div class="table" id="table-apache-editing-files"><p class="title"><strong>Table 1.2. The httpd service configuration files</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140042832953504" scope="col">Path</th><th align="left" valign="top" id="idm140042832952416" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140042832953504"> <p>
								<code class="literal">/etc/httpd/conf/httpd.conf</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140042832952416"> <p>
								The main configuration file.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140042832953504"> <p>
								<code class="literal">/etc/httpd/conf.d/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140042832952416"> <p>
								An auxiliary directory for configuration files that are included in the main configuration file.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140042832953504"> <p>
								<code class="literal">/etc/httpd/conf.modules.d/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140042832952416"> <p>
								An auxiliary directory for configuration files which load installed dynamic modules packaged in Red Hat Enterprise Linux. In the default configuration, these configuration files are processed first.
							</p>
							 </td></tr></tbody></table></div></div><p>
				Although, the default configuration is suitable for most situations, you can use also other configuration options. For any changes to take effect, restart the web server first. See <a class="xref" href="index.html#managing-the-httpd-service_setting-apache-http-server" title="1.3. Managing the httpd service">Section 1.3, “Managing the httpd service”</a> for more information on how to restart the <code class="literal service">httpd</code> service.
			</p><p>
				To check the configuration for possible errors, type the following at a shell prompt:
			</p><pre class="literallayout"># apachectl configtest
Syntax OK</pre><p>
				To make the recovery from mistakes easier, make a copy of the original file before editing it.
			</p></section><section class="section" id="managing-the-httpd-service_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.3. Managing the httpd service</h2></div></div></div><p>
				This section describes hot to start, stop, and restart the <code class="literal systemitem">httpd</code> service.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Apache HTTP Server is installed.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To start the <code class="literal systemitem">httpd</code> service, enter:
					</p><pre class="literallayout"># systemctl start httpd</pre></li><li class="listitem"><p class="simpara">
						To stop the <code class="literal systemitem">httpd</code> service, enter:
					</p><pre class="literallayout"># systemctl stop httpd</pre></li><li class="listitem"><p class="simpara">
						To restart the <code class="literal systemitem">httpd</code> service, enter:
					</p><pre class="literallayout"># systemctl restart httpd</pre></li></ul></div></section><section class="section" id="setting-up-a-single-instance-apache-http-server_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.4. Setting up a single-instance Apache HTTP Server</h2></div></div></div><p>
				This section describes how to set up a single-instance Apache HTTP Server to serve static HTML content.
			</p><p>
				Follow the procedure in this section if the web server should provide the same content for all domains associated with the server. If you want to provide different content for different domains, set up name-based virtual hosts. For details, see <a class="xref" href="index.html#configuring-apache-name-based-virtual-hosts_setting-apache-http-server" title="1.5. Configuring Apache name-based virtual hosts">Section 1.5, “Configuring Apache name-based virtual hosts”</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">httpd</code> package:
					</p><pre class="literallayout"># yum install httpd</pre></li><li class="listitem"><p class="simpara">
						Open the TCP port <code class="literal command">80</code> in the local firewall:
					</p><pre class="literallayout"># firewall-cmd --permanent --add-port=80/tcp
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl enable --now httpd</pre></li><li class="listitem">
						Optional: Add HTML files to the <code class="literal filename">/var/www/html/</code> directory.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Connect with a web browser to <code class="literal command">http://<span class="emphasis"><em>server_IP_or_host_name</em></span>/</code>.
					</p><p class="simpara">
						If the <code class="literal filename">/var/www/html/</code> directory is empty or does not contain an <code class="literal filename">index.html</code> or <code class="literal filename">index.htm</code> file, Apache displays the <code class="literal command">Red Hat Enterprise Linux Test Page</code>. If <code class="literal filename">/var/www/html/</code> contains HTML files with a different name, you can load them by entering the URL to that file, such as <code class="literal command">http://<span class="emphasis"><em>server_IP_or_host_name</em></span>/<span class="emphasis"><em>example.html</em></span></code>.
					</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about configuring Apache and adapting the service to your environment, refer to the Apache manual. For details about installing the manual, see <a class="xref" href="index.html#installing-the-apache-http-server-manual_setting-apache-http-server" title="1.8. Installing the Apache HTTP Server manual">Section 1.8, “Installing the Apache HTTP Server manual”</a>.
					</li><li class="listitem">
						For details about using or adjusting the <code class="literal systemitem">httpd</code> <code class="literal systemitem">systemd</code> service, see the <code class="literal citetitle">httpd.service(8)</code> man page.
					</li></ul></div></section><section class="section" id="configuring-apache-name-based-virtual-hosts_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.5. Configuring Apache name-based virtual hosts</h2></div></div></div><p>
				Name-based virtual hosts enable Apache to serve different content for different domains that resolve to the IP address of the server.
			</p><p>
				The procedure in this section describes setting up a virtual host for both the <code class="literal systemitem">example.com</code> and <code class="literal systemitem">example.net</code> domain with separate document root directories. Both virtual hosts serve static HTML content.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Clients and the web server resolve the <code class="literal systemitem">example.com</code> and <code class="literal systemitem">example.net</code> domain to the IP address of the web server.
					</p><p class="simpara">
						Note that you must manually add these entries to your DNS server.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">httpd</code> package:
					</p><pre class="literallayout"># yum install httpd</pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Append the following virtual host configuration for the <code class="literal systemitem">example.com</code> domain:
							</p><pre class="literallayout">&lt;VirtualHost *:80&gt;
    DocumentRoot "/var/www/example.com/"
    ServerName example.com
    CustomLog /var/log/httpd/example.com_access.log combined
    ErrorLog /var/log/httpd/example.com_error.log
&lt;/VirtualHost&gt;</pre><p class="simpara">
								These settings configure the following:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										All settings in the <code class="literal command">&lt;VirtualHost *:80&gt;</code> directive are specific for this virtual host.
									</li><li class="listitem">
										<code class="literal parameter">DocumentRoot</code> sets the path to the web content of the virtual host.
									</li><li class="listitem"><p class="simpara">
										<code class="literal parameter">ServerName</code> sets the domains for which this virtual host serves content.
									</p><p class="simpara">
										To set multiple domains, add the <code class="literal parameter">ServerAlias</code> parameter to the configuration and specify the additional domains separated with a space in this parameter.
									</p></li><li class="listitem">
										<code class="literal parameter">CustomLog</code> sets the path to the access log of the virtual host.
									</li><li class="listitem"><p class="simpara">
										<code class="literal parameter">ErrorLog</code> sets the path to the error log of the virtual host.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											Apache uses the first virtual host found in the configuration also for requests that do not match any domain set in the <code class="literal parameter">ServerName</code> and <code class="literal parameter">ServerAlias</code> parameters. This also includes requests sent to the IP address of the server.
										</p></div></div></li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Append a similar virtual host configuration for the <code class="literal systemitem">example.net</code> domain:
					</p><pre class="literallayout">&lt;VirtualHost *:80&gt;
    DocumentRoot "/var/www/example.net/"
    ServerName example.net
    CustomLog /var/log/httpd/example.net_access.log combined
    ErrorLog /var/log/httpd/example.net_error.log
&lt;/VirtualHost&gt;</pre></li><li class="listitem"><p class="simpara">
						Create the document roots for both virtual hosts:
					</p><pre class="literallayout"># mkdir /var/www/example.com/
# mkdir /var/www/example.net/</pre></li><li class="listitem"><p class="simpara">
						If you set paths in the <code class="literal parameter">DocumentRoot</code> parameters that are not within <code class="literal filename">/var/www/</code>, set the <code class="literal command">httpd_sys_content_t</code> context on both document roots:
					</p><pre class="literallayout"># semanage fcontext -a -t httpd_sys_content_t "/srv/example.com(/.*)?"
# restorecon -Rv /srv/example.com/
# semanage fcontext -a -t httpd_sys_content_t "/srv/example.net(/.\*)?"
# restorecon -Rv /srv/example.net/</pre><p class="simpara">
						These commands set the <code class="literal command">httpd_sys_content_t</code> context on the <code class="literal filename">/srv/example.com/</code> and <code class="literal filename">/srv/example.net/</code> directory.
					</p><p class="simpara">
						Note that you must install the <code class="literal package">policycoreutils-python-utils</code> package to run the <code class="literal command">restorecon</code> command.
					</p></li><li class="listitem"><p class="simpara">
						Open port <code class="literal command">80</code> in the local firewall:
					</p><pre class="literallayout"># firewall-cmd --permanent --add-port=80
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl enable --now httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a different example file in each virtual host’s document root:
					</p><pre class="literallayout"># echo "vHost example.com" &gt; /var/www/example.com/index.html
# echo "vHost example.net" &gt; /var/www/example.net/index.html</pre></li><li class="listitem">
						Use a browser and connect to <code class="literal command">http://example.com</code>. The web server shows the example file from the <code class="literal systemitem">example.com</code> virtual host.
					</li><li class="listitem">
						Use a browser and connect to <code class="literal command">http://example.net</code>. The web server shows the example file from the <code class="literal systemitem">example.net</code> virtual host.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about configuring Apache virtual hosts, refer to the <code class="literal citetitle">Virtual Hosts</code> documentation in the Apache manual. For details about installing the manual, see <a class="xref" href="index.html#installing-the-apache-http-server-manual_setting-apache-http-server" title="1.8. Installing the Apache HTTP Server manual">Section 1.8, “Installing the Apache HTTP Server manual”</a>.
					</li></ul></div></section><section class="section" id="configuring-tls-encryption-on-an-apache-http-server_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.6. Configuring TLS encryption on an Apache HTTP Server</h2></div></div></div><p>
				By default, Apache provides content to clients using an unencrypted HTTP connection. This section describes how to enable TLS encryption and configure frequently used encryption-related settings on an Apache HTTP Server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Apache HTTP Server is installed and running.
					</li></ul></div><section class="section" id="proc_adding-tls-encryption-to-an-apache-http-server-configuration_configuring-tls-encryption-on-an-apache-http-server"><div class="titlepage"><div><div><h3 class="title">1.6.1. Adding TLS encryption to an Apache HTTP Server</h3></div></div></div><p>
					This section describes how to enable TLS encryption on an Apache HTTP Server for the <code class="literal systemitem">example.com</code> domain.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The Apache HTTP Server is installed and running.
						</li><li class="listitem"><p class="simpara">
							The private key is stored in the <code class="literal filename">/etc/pki/tls/private/example.com.key</code> file.
						</p><p class="simpara">
							For details about creating a private key and certificate signing request (CSR), as well as how to request a certificate from a certificate authority (CA), see your CA’s documentation. Alternatively, if your CA supports the ACME protocol, you can use the <code class="literal systemitem">mod_md</code> module to automate retrieving and provisioning TLS certificates.
						</p></li><li class="listitem">
							The TLS certificate is stored in the <code class="literal filename">/etc/pki/tls/private/example.com.crt</code> file. If you use a different path, adapt the corresponding steps of the procedure.
						</li><li class="listitem">
							The CA certificate is stored in the <code class="literal filename">/etc/pki/tls/private/ca.crt</code> file. If you use a different path, adapt the corresponding steps of the procedure.
						</li><li class="listitem">
							Clients and the web server resolve the host name of the server to the IP address of the web server.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the <code class="literal package">mod_ssl</code> package:
						</p><pre class="literallayout"># dnf install mod_ssl</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/httpd/conf.d/ssl.conf</code> file and add the following settings to the <code class="literal parameter">&lt;VirtualHost _default_:443&gt;</code> directive:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Set the server name:
								</p><pre class="literallayout">ServerName <span class="emphasis"><em>example.com</em></span></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										The server name must match the entry set in the <code class="literal parameter">Common Name</code> field of the certificate.
									</p></div></div></li><li class="listitem"><p class="simpara">
									Optional: If the certificate contains additional host names in the <code class="literal parameter">Subject Alt Names</code> (SAN) field, you can configure <code class="literal systemitem">mod_ssl</code> to provide TLS encryption also for these host names. To configure this, add the <code class="literal parameter">ServerAliases</code> parameter with corresponding names:
								</p><pre class="literallayout">ServerAlias <span class="emphasis"><em>www.example.com</em></span> <span class="emphasis"><em>server.example.com</em></span></pre></li><li class="listitem"><p class="simpara">
									Set the paths to the private key, the server certificate, and the CA certificate:
								</p><pre class="literallayout">SSLCertificateKeyFile "/etc/pki/tls/private/example.com.key"
SSLCertificateFile "/etc/pki/tls/certs/example.com.crt"
SSLCACertificateFile "/etc/pki/tls/certs/ca.crt"</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							For security reasons, configure that only the <code class="literal systemitem">root</code> user can access the private key file:
						</p><pre class="literallayout"># chown root:root /etc/pki/tls/private/example.com.key
# chmod 600 /etc/pki/tls/private/example.com.key</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								If the private key was accessed by unauthorized users, revoke the certificate, create a new private key, and request a new certificate. Otherwise, the TLS connection is no longer secure.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Open port <code class="literal command">443</code> in the local firewall:
						</p><pre class="literallayout"># firewall-cmd --permanent --add-port=443
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal systemitem">httpd</code> service:
						</p><pre class="literallayout"># systemctl restart httpd</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If you protected the private key file with a password, you must enter this password each time when the <code class="literal systemitem">httpd</code> service starts.
							</p></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Use a browser and connect to <code class="literal command">https://<span class="emphasis"><em>example.com</em></span></code>.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For further details about configuring TLS, refer to the <code class="literal citetitle">SSL/TLS Encryption</code> documentation in the Apache manual. For details about installing the manual, see <a class="xref" href="index.html#installing-the-apache-http-server-manual_setting-apache-http-server" title="1.8. Installing the Apache HTTP Server manual">Section 1.8, “Installing the Apache HTTP Server manual”</a>.
						</li></ul></div></section><section class="section" id="setting-the-supported-tls-protocol-versions-on-an-apache-http-server_configuring-tls-encryption-on-an-apache-http-server"><div class="titlepage"><div><div><h3 class="title">1.6.2. Setting the supported TLS protocol versions on an Apache HTTP Server</h3></div></div></div><p>
					By default, the Apache HTTP Server on RHEL 8 uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For example, the <code class="literal systemitem">DEFAULT</code> policy defines that only the <code class="literal systemitem">TLSv1.2</code> and <code class="literal systemitem">TLSv1.3</code> protocol versions are enabled in apache.
				</p><p>
					This section describes how to manually configure which TLS protocol versions your Apache HTTP Server supports. Follow the procedure if your environment requires to enable only specific TLS protocol versions, for example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If your environment requires that clients can also use the weak <code class="literal systemitem">TLS1</code> (TLSv1.0) or <code class="literal systemitem">TLS1.1</code> protocol.
						</li><li class="listitem">
							If you want to configure that Apache only supports the <code class="literal systemitem">TLSv1.2</code> or <code class="literal systemitem">TLSv1.3</code> protocol.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							TLS encryption is enabled on the server as described in <a class="xref" href="index.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_configuring-tls-encryption-on-an-apache-http-server" title="1.6.1. Adding TLS encryption to an Apache HTTP Server">Section 1.6.1, “Adding TLS encryption to an Apache HTTP Server”</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file, and add the following setting to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to set the TLS protocol version. For example, to enable only the <code class="literal systemitem">TLSv1.3</code> protocol:
						</p><pre class="literallayout">SSLProtocol -All TLSv1.3</pre></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal systemitem">httpd</code> service:
						</p><pre class="literallayout"># systemctl restart httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the following command to verify that the server supports <code class="literal systemitem">TLSv1.3</code>:
						</p><pre class="literallayout"># openssl s_client -connect <span class="emphasis"><em>example.com</em></span>:443 -tls1_3</pre></li><li class="listitem"><p class="simpara">
							Use the following command to verify that the server does not support <code class="literal systemitem">TLSv1.2</code>:
						</p><pre class="literallayout"># openssl s_client -connect <span class="emphasis"><em>example.com</em></span>:443 -tls1_2</pre><p class="simpara">
							If the server does not support the protocol, the command returns an error:
						</p><pre class="literallayout">140111600609088:error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version:ssl/record/rec_layer_s3.c:1543:SSL alert number 70</pre></li><li class="listitem">
							Optional: Repeat the command for other TLS protocol versions.
						</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For further details about the system-wide crypto policy, see the <code class="literal citetitle">update-crypto-policies(8)</code> man page and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>.
						</li><li class="listitem">
							For further details about the <code class="literal parameter">SSLProtocol</code> parameter, refer to the <code class="literal systemitem">mod_ssl</code> documentation in the Apache manual. For details about installing the manual, see <a class="xref" href="index.html#installing-the-apache-http-server-manual_setting-apache-http-server" title="1.8. Installing the Apache HTTP Server manual">Section 1.8, “Installing the Apache HTTP Server manual”</a>.
						</li></ul></div></section><section class="section" id="setting-the-supported-ciphers-on-an-apache-http-server_configuring-tls-encryption-on-an-apache-http-server"><div class="titlepage"><div><div><h3 class="title">1.6.3. Setting the supported ciphers on an Apache HTTP Server</h3></div></div></div><p>
					By default, the Apache HTTP Server on RHEL 8 uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For the list of ciphers the system-wide crypto allows, see the <code class="literal filename">/etc/crypto-policies/back-ends/openssl.config</code> file.
				</p><p>
					This section describes how to manually configure which ciphers your Apache HTTP Server supports. Follow the procedure if your environment requires specific ciphers.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							TLS encryption is enabled on the server as described in <a class="xref" href="index.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_configuring-tls-encryption-on-an-apache-http-server" title="1.6.1. Adding TLS encryption to an Apache HTTP Server">Section 1.6.1, “Adding TLS encryption to an Apache HTTP Server”</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file, and add the <code class="literal parameter">SSLCipherSuite</code> parameter to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to set the TLS ciphers:
						</p><pre class="literallayout">SSLCipherSuite "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH:!SHA1:!SHA256"</pre><p class="simpara">
							This example enables only the <code class="literal systemitem">EECDH+AESGCM</code>, <code class="literal systemitem">EDH+AESGCM</code>, <code class="literal systemitem">AES256+EECDH</code>, and <code class="literal systemitem">AES256+EDH</code> ciphers and disables all ciphers which use the <code class="literal systemitem">SHA1</code> and <code class="literal systemitem">SHA256</code> message authentication code (MAC).
						</p></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal systemitem">httpd</code> service:
						</p><pre class="literallayout"># systemctl restart httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To display the list of ciphers the Apache HTTP Server supports:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Install the <code class="literal package">nmap</code> package:
								</p><pre class="literallayout"># yum install nmap</pre></li><li class="listitem"><p class="simpara">
									Use the <code class="literal systemitem">nmap</code> utility to display the supported ciphers:
								</p><pre class="literallayout"># nmap --script ssl-enum-ciphers -p <span class="emphasis"><em>443</em></span> <span class="emphasis"><em>example.com</em></span>
...
PORT    STATE SERVICE
443/tcp open  https
| ssl-enum-ciphers:
|   TLSv1.2:
|     ciphers:
|       TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (ecdh_x25519) - A
|       TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 (dh 2048) - A
|       TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (ecdh_x25519) - A
...</pre></li></ol></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For further details about the system-wide crypto policy, see the <code class="literal citetitle">update-crypto-policies(8)</code> man page and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>.
						</li><li class="listitem">
							For further details about the <code class="literal parameter">SSLCipherSuite</code> parameter, refer to the <code class="literal systemitem">mod_ssl</code> documentation in the Apache manual. For details about installing the manual, see <a class="xref" href="index.html#installing-the-apache-http-server-manual_setting-apache-http-server" title="1.8. Installing the Apache HTTP Server manual">Section 1.8, “Installing the Apache HTTP Server manual”</a>.
						</li></ul></div></section></section><section class="section" id="configuring-tls-client-certificate-authentication_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.7. Configuring TLS client certificate authentication</h2></div></div></div><p>
				Client certificate authentication enables administrators to allow only users who authenticate using a certificate to access resources on the web server. This section describes how to configure client certificate authentication for the <code class="literal filename">/var/www/html/Example/</code> directory.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					If the Apache HTTP Server uses the TLS 1.3 protocol, certain clients require additional configuration. For example, in Firefox, set the <code class="literal parameter">security.tls.enable_post_handshake_auth</code> parameter in the <code class="literal command">about:config</code> menu to <code class="literal command">true</code>. For further details, see <a class="link" href="https://www.redhat.com/en/blog/transport-layer-security-version-13-red-hat-enterprise-linux-8">Transport Layer Security version 1.3 in Red Hat Enterprise Linux 8</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						TLS encryption is enabled on the server as described in <a class="xref" href="index.html#proc_adding-tls-encryption-to-an-apache-http-server-configuration_configuring-tls-encryption-on-an-apache-http-server" title="1.6.1. Adding TLS encryption to an Apache HTTP Server">Section 1.6.1, “Adding TLS encryption to an Apache HTTP Server”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file and add the following settings to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to configure client authentication:
					</p><pre class="literallayout">&lt;Directory "/var/www/html/Example/"&gt;
  SSLVerifyClient require
&lt;/Directory&gt;</pre><p class="simpara">
						The <code class="literal command">SSLVerifyClient require</code> setting defines that the server must successfully validate the client certificate before the client can access the content in the <code class="literal filename">/var/www/html/Example/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl restart httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the <code class="literal systemitem">curl</code> utility to access the <code class="literal command">https://example.com/Example/</code> URL without client authentication:
					</p><pre class="literallayout">$ curl https://example.com/Example/
curl: (56) OpenSSL SSL_read: error:1409445C:SSL routines:ssl3_read_bytes:tlsv13 <span class="strong strong"><strong>alert certificate required</strong></span>, errno 0</pre><p class="simpara">
						The error indicates that the web server requires a client certificate authentication.
					</p></li><li class="listitem"><p class="simpara">
						Pass the client private key and certificate, as well as the CA certificate to <code class="literal systemitem">curl</code> to access the same URL with client authentication:
					</p><pre class="literallayout">$ curl --cacert <span class="emphasis"><em>ca.crt</em></span> --key <span class="emphasis"><em>client.key</em></span> --cert <span class="emphasis"><em>client.crt</em></span> https://example.com/Example/</pre><p class="simpara">
						If the request succeeds, <code class="literal systemitem">curl</code> displays the <code class="literal filename">index.html</code> file stored in the <code class="literal filename">/var/www/html/Example/</code> directory.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For further details about client authentication, see the <code class="literal citetitle">mod_ssl Configuration How-To</code> documentation in the Apache manual. For details about installing the manual, see <a class="xref" href="index.html#installing-the-apache-http-server-manual_setting-apache-http-server" title="1.8. Installing the Apache HTTP Server manual">Section 1.8, “Installing the Apache HTTP Server manual”</a>.
					</li></ul></div></section><section class="section" id="installing-the-apache-http-server-manual_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.8. Installing the Apache HTTP Server manual</h2></div></div></div><p>
				This section describes how to install the Apache HTTP Server manual. This manual provides a detailed documentation of, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Configuration parameters and directives
					</li><li class="listitem">
						Performance tuning
					</li><li class="listitem">
						Authentication settings
					</li><li class="listitem">
						Modules
					</li><li class="listitem">
						Content caching
					</li><li class="listitem">
						Security tips
					</li><li class="listitem">
						Configuring TLS encryption
					</li></ul></div><p>
				After installing the manual, you can display it using a web browser.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Apache HTTP Server is installed and running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">httpd-manual</code> package:
					</p><pre class="literallayout"># yum install httpd-manual</pre></li><li class="listitem"><p class="simpara">
						Optional: By default, all clients connecting to the Apache HTTP Server can display the manual. To restrict access to a specific IP range, such as the <code class="literal systemitem">192.0.2.0/24</code> subnet, edit the <code class="literal filename">/etc/httpd/conf.d/manual.conf</code> file and add the <code class="literal command">Require ip 192.0.2.0/24</code> setting to the <code class="literal parameter">&lt;Directory "/usr/share/httpd/manual"&gt;</code> directive:
					</p><pre class="literallayout">&lt;Directory "/usr/share/httpd/manual"&gt;
...
    <span class="strong strong"><strong>Require ip 192.0.2.0/24</strong></span>
...
&lt;/Directory&gt;</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># systemctl restart httpd</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						To display the Apache HTTP Server manual, connect with a web browser to <code class="literal command">http://<span class="emphasis"><em>host_name_or_IP_address</em></span>/manual/</code>
					</li></ol></div></section><section class="section" id="working-with-modules_setting-apache-http-server"><div class="titlepage"><div><div><h2 class="title">1.9. Working with modules</h2></div></div></div><p>
				Being a modular application, the <code class="literal service">httpd</code> service is distributed along with a number of <span class="emphasis"><em>Dynamic Shared Objects</em></span> (<span class="strong strong"><strong>DSO</strong></span>s), which can be dynamically loaded or unloaded at runtime as necessary. These modules are located in the <code class="literal filename">/usr/lib64/httpd/modules/</code> directory.
			</p><section class="section" id="sec-apache-dso-loading"><div class="titlepage"><div><div><h3 class="title">1.9.1. Loading a module</h3></div></div></div><p>
					To load a particular DSO module, use the <code class="literal option">LoadModule</code> directive. Note that modules provided by a separate package often have their own configuration file in the <code class="literal filename">/etc/httpd/conf.modules.d/</code> directory.
				</p><div class="example" id="example-apache-dso-loading"><p class="title"><strong>Example 1.1. Loading the mod_ssl DSO</strong></p><div class="example-contents"><pre class="literallayout">LoadModule ssl_module modules/mod_ssl.so</pre></div></div><p>
					After loading the module, restart the web server to reload the configuration. See <a class="xref" href="index.html#managing-the-httpd-service_setting-apache-http-server" title="1.3. Managing the httpd service">Section 1.3, “Managing the httpd service”</a> for more information on how to restart the <code class="literal service">httpd</code> service.
				</p></section><section class="section" id="sec-apache-dso-writing"><div class="titlepage"><div><div><h3 class="title">1.9.2. Writing a module</h3></div></div></div><p>
					To create a new DSO module, make sure you have the <code class="literal package">httpd-devel</code> package installed. To do so, enter the following command as <code class="literal">root</code>:
				</p><pre class="literallayout"># yum install httpd-devel</pre><p>
					This package contains the include files, the header files, and the <span class="strong strong"><strong><span class="application application">APache eXtenSion</span></strong></span> (<code class="literal command">apxs</code>) utility required to compile a module.
				</p><p>
					Once written, you can build the module with the following command:
				</p><pre class="literallayout"># apxs -i -a -c module_name.c</pre><p>
					If the build was successful, you should be able to load the module the same way as any other module that is distributed with the <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span>.
				</p></section></section><section class="section" id="additional_resources"><div class="titlepage"><div><div><h2 class="title">1.10. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">httpd(8)</code> — The manual page for the <code class="literal service">httpd</code> service containing the complete list of its command-line options.
					</li><li class="listitem">
						<code class="literal">httpd.service(8)</code> — The manual page for the <code class="literal systemitem">httpd.service</code> unit file, describing how to customize and enhance the service.
					</li><li class="listitem">
						<code class="literal">httpd.conf(5)</code> — The manual page for <code class="literal">httpd</code> configuration, describing the structure and location of the <code class="literal">httpd</code> configuration files.
					</li><li class="listitem">
						<code class="literal">apachectl(8)</code> — The manual page for the <span class="strong strong"><strong><span class="application application">Apache HTTP Server</span></strong></span> Control Interface.
					</li></ul></div></section></section><section class="chapter" id="assembly_using-samba-as-a-server_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Using Samba as a server</h1></div></div></div><p>
			Samba implements the Server Message Block (SMB) protocol in Red Hat Enterprise Linux. The SMB protocol is used to access resources on a server, such as file shares and shared printers. Additionally, Samba implements the Distributed Computing Environment Remote Procedure Call (DCE RPC) protocol used by Microsoft Windows.
		</p><p>
			You can run Samba as:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					An Active Directory (AD) or NT4 domain member
				</li><li class="listitem">
					A standalone server
				</li><li class="listitem"><p class="simpara">
					An NT4 Primary Domain Controller (PDC) or Backup Domain Controller (BDC)
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat supports the PDC and BDC modes only in existing installations with Windows versions which support NT4 domains. Red Hat recommends not setting up a new Samba NT4 domain, because Microsoft operating systems later than Windows 7 and Windows Server 2008 R2 do not support NT4 domains.
					</p><p>
						Red Hat does not support running Samba as an AD domain controller (DC).
					</p></div></div></li></ul></div><p>
			Independently of the installation mode, you can optionally share directories and printers. This enables Samba to act as a file and print server.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					Red Hat Enterprise Linux 8 is installed on the server.
				</li></ul></div><section class="section" id="con_the-samba-services_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.1. The Samba services</h2></div></div></div><p>
				Samba provides the following services:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">smbd</code></span></dt><dd><p class="simpara">
							This service provides file sharing and printing services using the SMB protocol. Additionally, the service is responsible for resource locking and for authenticating connecting users. The <code class="literal">smb</code> <code class="literal">systemd</code> service starts and stops the <code class="literal">smbd</code> daemon.
						</p><p class="simpara">
							To use the <code class="literal">smbd</code> service, install the <code class="literal package">samba</code> package.
						</p></dd><dt><span class="term"><code class="literal">nmbd</code></span></dt><dd><p class="simpara">
							This service provides host name and IP resolution using the NetBIOS over IPv4 protocol. Additionally to the name resolution, the <code class="literal">nmbd</code> service enables browsing the SMB network to locate domains, work groups, hosts, file shares, and printers. For this, the service either reports this information directly to the broadcasting client or forwards it to a local or master browser. The <code class="literal">nmb</code> <code class="literal">systemd</code> service starts and stops the <code class="literal">nmbd</code> daemon.
						</p><p class="simpara">
							Note that modern SMB networks use DNS to resolve clients and IP addresses.
						</p><p class="simpara">
							To use the <code class="literal">nmbd</code> service, install the <code class="literal package">samba</code> package.
						</p></dd><dt><span class="term"><code class="literal">winbindd</code></span></dt><dd><p class="simpara">
							This service provides an interface for the Name Service Switch (NSS) to use AD or NT4 domain users and groups on the local system. This enables, for example, domain users to authenticate to services hosted on a Samba server or to other local services. The <code class="literal">winbind</code> <code class="literal">systemd</code> service starts and stops the <code class="literal">winbindd</code> daemon.
						</p><p class="simpara">
							If you set up Samba as a domain member, <code class="literal">winbindd</code> must be started before the <code class="literal">smbd</code> service. Otherwise, domain users and groups are not available to the local system..
						</p><p class="simpara">
							To use the <code class="literal">winbindd</code> service, install the <code class="literal package">samba-winbind</code> package.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Red Hat only supports running Samba as a server with the <code class="literal">winbindd</code> service to provide domain users and groups to the local system. Due to certain limitations, such as missing Windows access control list (ACL) support and NT LAN Manager (NTLM) fallback, SSSD is not supported.
							</p></div></div></dd></dl></div></section><section class="section" id="proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.2. Verifying the smb.conf file by using the testparm utility</h2></div></div></div><p>
				The <code class="literal">testparm</code> utility verifies that the Samba configuration in the <code class="literal filename">/etc/samba/smb.conf</code> file is correct. The utility detects invalid parameters and values, but also incorrect settings, such as for ID mapping. If <code class="literal">testparm</code> reports no problem, the Samba services will successfully load the <code class="literal filename">/etc/samba/smb.conf</code> file. Note that <code class="literal">testparm</code> cannot verify that the configured services will be available or work as expected.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Red Hat recommends that you verify the <code class="literal filename">/etc/samba/smb.conf</code> file by using <code class="literal">testparm</code> after each modification of this file.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the <code class="literal">testparm</code> utility as the <code class="literal">root</code> user:
					</p><pre class="literallayout"># testparm
Load smb config files from /etc/samba/smb.conf
rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)
<span class="strong strong"><strong>Unknown parameter encountered: "log levell"</strong></span>
Processing section "[example_share]"
Loaded services file OK.
<span class="strong strong"><strong>ERROR: The idmap range for the domain * (tdb) overlaps with the range of DOMAIN (ad)!</strong></span>

Server role: ROLE_DOMAIN_MEMBER

Press enter to see a dump of your service definitions

# Global parameters
[global]
	...

[example_share]
	...</pre><p class="simpara">
						The previous example output reports a non-existent parameter and an incorrect ID mapping configuration.
					</p></li><li class="listitem">
						If <code class="literal">testparm</code> reports incorrect parameters, values, or other errors in the configuration, fix the problem and run the utility again.
					</li></ol></div></section><section class="section" id="con_the-samba-security-services_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.3. The Samba security services</h2></div></div></div><p>
				The <code class="literal">security</code> parameter in the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file manages how Samba authenticates users that are connecting to the service. Depending on the mode you install Samba in, the parameter must be set to different values:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">On an AD domain member, set <code class="literal">security = ads</code></span></dt><dd><p class="simpara">
							In this mode, Samba uses Kerberos to authenticate AD users.
						</p><p class="simpara">
							For details about setting up Samba as a domain member, see <a class="xref" href="index.html#assembly_setting-up-samba-as-an-ad-domain-member-server_assembly_using-samba-as-a-server" title="2.5. Setting up Samba as an AD domain member server">Section 2.5, “Setting up Samba as an AD domain member server”</a>.
						</p></dd><dt><span class="term">On a standalone server, set <code class="literal">security = user</code></span></dt><dd><p class="simpara">
							In this mode, Samba uses a local database to authenticate connecting users.
						</p><p class="simpara">
							For details about setting up Samba as a standalone server, see <a class="xref" href="index.html#assembly_setting-up-samba-as-a-standalone-server_assembly_using-samba-as-a-server" title="2.4. Setting up Samba as a standalone server">Section 2.4, “Setting up Samba as a standalone server”</a>.
						</p></dd><dt><span class="term">On an NT4 PDC or BDC, set <code class="literal">security = user</code></span></dt><dd>
							In this mode, Samba authenticates users to a local or LDAP database.
						</dd><dt><span class="term">On an NT4 domain member, set <code class="literal">security = domain</code></span></dt><dd><p class="simpara">
							In this mode, Samba authenticates connecting users to an NT4 PDC or BDC. You cannot use this mode on AD domain members.
						</p><p class="simpara">
							For details about setting up Samba as a domain member, see <a class="xref" href="index.html#assembly_setting-up-samba-as-an-ad-domain-member-server_assembly_using-samba-as-a-server" title="2.5. Setting up Samba as an AD domain member server">Section 2.5, “Setting up Samba as an AD domain member server”</a>.
						</p></dd></dl></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						See the description of the <code class="literal">security</code> parameter in the <code class="literal">smb.conf(5)</code> man page.
					</li></ul></div></section><section class="section" id="assembly_setting-up-samba-as-a-standalone-server_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.4. Setting up Samba as a standalone server</h2></div></div></div><p>
				You can set up Samba as a server that is not a member of a domain. In this installation mode, Samba authenticates users to a local database instead of to a central DC. Additionally, you can enable guest access to allow users to connect to one or multiple services without authentication.
			</p><section class="section" id="proc_setting-up-the-server-configuration-for-the-standalone-server_assembly_setting-up-samba-as-a-standalone-server"><div class="titlepage"><div><div><h3 class="title">2.4.1. Setting up the server configuration for the standalone server</h3></div></div></div><p>
					This section describes how to set up the server configuration for a Samba standalone server.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the <code class="literal package">samba</code> package:
						</p><pre class="literallayout"># yum install samba</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/samba/smb.conf</code> file and set the following parameters:
						</p><pre class="literallayout">[global]
	workgroup = <span class="emphasis"><em>Example-WG</em></span>
	netbios name = <span class="emphasis"><em>Server</em></span>
	security = user

	log file = /var/log/samba/%m.log
	log level = 1</pre><p class="simpara">
							This configuration defines a standalone server named <code class="literal">Server</code> within the <code class="literal">Example-WG</code> work group. Additionally, this configuration enables logging on a minimal level (<code class="literal">1</code>) and log files will be stored in the <code class="literal filename">/var/log/samba/</code> directory. Samba will expand the <code class="literal">%m</code> macro in the <code class="literal">log file</code> parameter to the NetBIOS name of connecting clients. This enables individual log files for each client.
						</p></li><li class="listitem"><p class="simpara">
							Configure file or printer sharing. See:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="xref" href="index.html#assembly_configuring-file-shares-on-a-samba-server_assembly_using-samba-as-a-server" title="2.7. Configuring file shares on a Samba server">Section 2.7, “Configuring file shares on a Samba server”</a>
								</li><li class="listitem">
									<a class="xref" href="index.html#assembly_setting-up-samba-as-a-print-server_assembly_using-samba-as-a-server" title="2.8. Setting up Samba as a print server">Section 2.8, “Setting up Samba as a print server”</a>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout"># testparm</pre></li><li class="listitem">
							If you set up shares that require authentication, create the user accounts. See <a class="xref" href="index.html#proc_creating-and-enabling-local-user-accounts_assembly_setting-up-samba-as-a-standalone-server" title="2.4.2. Creating and enabling local user accounts">Section 2.4.2, “Creating and enabling local user accounts”</a>.
						</li><li class="listitem"><p class="simpara">
							Open the required ports and reload the firewall configuration by using the <code class="literal">firewall-cmd</code> utility:
						</p><pre class="literallayout"># firewall-cmd --permanent --add-port={139/tcp,445/tcp}
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
							Start the <code class="literal">smb</code> service:
						</p><pre class="literallayout"># systemctl start smb</pre><p class="simpara">
							Optionally, enable the <code class="literal">smb</code> service to start automatically when the system boots:
						</p><pre class="literallayout"># systemctl enable smb</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For further details about the parameters used in the procedure, see the descriptions of the parameters in the <code class="literal">smb.conf(5)</code> man page.
						</li><li class="listitem">
							<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
						</li></ul></div></section><section class="section" id="proc_creating-and-enabling-local-user-accounts_assembly_setting-up-samba-as-a-standalone-server"><div class="titlepage"><div><div><h3 class="title">2.4.2. Creating and enabling local user accounts</h3></div></div></div><p>
					To enable users to authenticate when they connect to a share, you must create the accounts on the Samba host both in the operating system and in the Samba database. Samba requires the operating system account to validate the Access Control Lists (ACL) on file system objects and the Samba account to authenticate connecting users.
				</p><p>
					If you use the <code class="literal">passdb backend = tdbsam</code> default setting, Samba stores user accounts in the <code class="literal filename">/var/lib/samba/private/passdb.tdb</code> database.
				</p><p>
					The procedure in this section describes how to create a local Samba user named <code class="literal">example</code>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Samba is installed configured as a standalone server.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the operating system account:
						</p><pre class="literallayout"># useradd -M -s /sbin/nologin example</pre><p class="simpara">
							This command adds the <code class="literal">example</code> account without creating a home directory. If the account is only used to authenticate to Samba, assign the <code class="literal filename">/sbin/nologin</code> command as shell to prevent the account from logging in locally.
						</p></li><li class="listitem"><p class="simpara">
							Set a password to the operating system account to enable it:
						</p><pre class="literallayout"># passwd example
Enter new UNIX password: <span class="emphasis"><em>password</em></span>
Retype new UNIX password: <span class="emphasis"><em>password</em></span>
passwd: password updated successfully</pre><p class="simpara">
							Samba does not use the password set on the operating system account to authenticate. However, you need to set a password to enable the account. If an account is disabled, Samba denies access if this user connects.
						</p></li><li class="listitem"><p class="simpara">
							Add the user to the Samba database and set a password to the account:
						</p><pre class="literallayout"># smbpasswd -a example
New SMB password: <span class="emphasis"><em>password</em></span>
Retype new SMB password: <span class="emphasis"><em>password</em></span>
Added user example.</pre><p class="simpara">
							Use this password to authenticate when using this account to connect to a Samba share.
						</p></li><li class="listitem"><p class="simpara">
							Enable the Samba account:
						</p><pre class="literallayout"># smbpasswd -e example
Enabled user example.</pre></li></ol></div></section></section><section class="section" id="assembly_setting-up-samba-as-an-ad-domain-member-server_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.5. Setting up Samba as an AD domain member server</h2></div></div></div><p>
				If you are running an AD or NT4 domain, use Samba to add your Red Hat Enterprise Linux server as a member to the domain to gain the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Access domain resources on other domain members
					</li><li class="listitem">
						Authenticate domain users to local services, such as <code class="literal">sshd</code>
					</li><li class="listitem">
						Share directories and printers hosted on the server to act as a file and print server
					</li></ul></div><section class="section" id="proc_joining-samba-to-a-domain_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h3 class="title">2.5.1. Joining Samba to a Domain</h3></div></div></div><p>
					This section describes how to join a Red Hat Enterprise Linux system to a domain.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the following packages:
						</p><pre class="literallayout"># yum install realmd oddjob-mkhomedir oddjob samba-winbind-clients \
       samba-winbind samba-common-tools samba</pre></li><li class="listitem"><p class="simpara">
							To share directories or printers on the domain member, install the <code class="literal package">samba</code> package:
						</p><pre class="literallayout"># yum install samba</pre></li><li class="listitem"><p class="simpara">
							If you are joining an AD, additionally install the Winbind Kerberos locator plug-in:
						</p><pre class="literallayout"># yum install samba-winbind-krb5-locator</pre><p class="simpara">
							This plug-in enables Kerberos to locate the Key Distribution Center (KDC) based on AD sites using DNS service records.
						</p></li><li class="listitem"><p class="simpara">
							Optionally, for backup purposes, rename the existing <code class="literal filename">/etc/samba/smb.conf</code> Samba configuration file:
						</p><pre class="literallayout"># mv /etc/samba/smb.conf /etc/samba/smb.conf.old</pre></li><li class="listitem"><p class="simpara">
							Join the domain. For example, to join a domain named <code class="literal">ad.example.com</code>:
						</p><pre class="literallayout"># realm join --membership-software=samba --client-software=winbind ad.example.com</pre><p class="simpara">
							Using the previous command, the <code class="literal">realm</code> utility automatically:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Creates a <code class="literal filename">/etc/samba/smb.conf</code> file for a membership in the <code class="literal">ad.example.com</code> domain
								</li><li class="listitem">
									Adds the <code class="literal">winbind</code> module for user and group lookups to the <code class="literal filename">/etc/nsswitch.conf</code> file
								</li><li class="listitem">
									Updates the Pluggable Authentication Module (PAM) configuration files in the <code class="literal filename">/etc/pam.d/</code> directory
								</li><li class="listitem">
									Starts the <code class="literal">winbind</code> service and enables the service to start when the system boots
								</li></ul></div></li><li class="listitem">
							Optionally, set an alternative ID mapping back end or customized ID mapping settings in the <code class="literal filename">/etc/samba/smb.conf</code> file. For details, see <a class="xref" href="index.html#assembly_samba-id-mapping_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.4. Samba ID mapping">Section 2.5.4, “Samba ID mapping”</a>.
						</li><li class="listitem">
							Optionally, verify the configuration. See <a class="xref" href="index.html#proc_verifying-that-samba-was-correctly-joined-as-a-domain-member_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.2. Verifying that Samba was correctly joined as a domain member">Section 2.5.2, “Verifying that Samba was correctly joined as a domain member”</a>.
						</li><li class="listitem"><p class="simpara">
							Verify that the <code class="literal">winbind</code> service is running:
						</p><pre class="literallayout"># systemctl status winbind
...
   Active: active (running) since Tue 2018-11-06 19:10:40 CET; 15s ago</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								To enable Samba to query domain user and group information, the <code class="literal">winbind</code> service must be running before you start <code class="literal">smb</code>.
							</p></div></div></li><li class="listitem"><p class="simpara">
							If you installed the <code class="literal package">samba</code> package to share directories and printers, start the <code class="literal systemitem">smb</code> service:
						</p><pre class="literallayout"># systemctl start smb</pre></li><li class="listitem">
							Optionally, if you are authenticating local logins to Active Directory, enable the <code class="literal">winbind_krb5_localauth</code> plug-in. See <a class="xref" href="index.html#using-the-local-authorization-plug-in-for-mit-kerberos_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.3. Using the local authorization plug-in for MIT Kerberos">Section 2.5.3, “Using the local authorization plug-in for MIT Kerberos”</a>.
						</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							For further details about the <code class="literal">realm</code> utility, see
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									The <code class="literal">realm(8)</code> man page
								</li></ul></div></li></ul></div></section><section class="section" id="proc_verifying-that-samba-was-correctly-joined-as-a-domain-member_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h3 class="title">2.5.2. Verifying that Samba was correctly joined as a domain member</h3></div></div></div><p>
					To verify you added your Red Hat Enterprise Linux correctly to your domain perform the tests described in this section on the domain member.
				</p><section class="section" id="verifying-that-the-operating-system-can-retrieve-domain-user-accounts-and-groups_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h4 class="title">2.5.2.1. Verifying that the operating system can retrieve domain user accounts and groups</h4></div></div></div><p>
						Use the <code class="literal">getent</code> and <code class="literal">chown</code> utilities to verify that the operating system can retrieve domain users and groups
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To query the <code class="literal">administrator</code> account in the <code class="literal">AD</code> domain:
							</p><pre class="literallayout"># getent passwd "AD\administrator"
AD\administrator:*:10000:10000::/home/administrator@AD:/bin/bash</pre></li><li class="listitem"><p class="simpara">
								To query the members of the <code class="literal">Domain Users</code> group in the <code class="literal">AD</code> domain:
							</p><pre class="literallayout"># getent group "AD\Domain Users"
AD\domain users:x:10000:<span class="emphasis"><em>user1</em></span>,<span class="emphasis"><em>user2</em></span></pre></li><li class="listitem"><p class="simpara">
								Verify that you can use domain users and groups when you set permissions on files and directories. For example, to set the owner of the <code class="literal filename">/srv/samba/example.txt</code> file to <code class="literal">AD\administrator</code> and the group to <code class="literal">AD\Domain Users</code>:
							</p><pre class="literallayout"># chown "AD\administrator":"AD\Domain Users" /srv/samba/example.txt</pre></li></ol></div></section><section class="section" id="verifying-if-ad-domain-users-can-obtain-a-kerberos-ticket_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h4 class="title">2.5.2.2. Verifying if AD domain users can obtain a Kerberos ticket</h4></div></div></div><p>
						In an AD environment, users can obtain a Kerberos ticket from the DC.
					</p><p>
						The procedure in this section describes how to verify if the <code class="literal">administrator</code> user can obtain a Kerberos ticket.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Install the <code class="literal package">krb5-workstation</code> package on the Samba domain member
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								On the AD domain member, obtain a ticket for the <a class="link" href="mailto:administrator@AD.EXAMPLE.COM">administrator@AD.EXAMPLE.COM</a> principal:
							</p><pre class="literallayout"># kinit administrator@AD.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
								Display the cached Kerberos ticket:
							</p><pre class="literallayout"># klist
Ticket cache: KCM:0
Default principal: administrator@AD.EXAMPLE.COM

Valid starting       Expires              Service principal
01.11.2018 10:00:00  01.11.2018 20:00:00  krbtgt/AD.EXAMPLE.COM@AD.EXAMPLE.COM
        renew until 08.11.2018 05:00:00</pre></li></ol></div></section><section class="section" id="listing-the-available-domains_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h4 class="title">2.5.2.3. Listing the available domains</h4></div></div></div><p>
						Use the <code class="literal">wbinfo</code> utility to list all domains available through the <code class="literal">winbindd</code> service.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							
<pre class="literallayout"># wbinfo --all-domains</pre>

						</p></div><p>
						If Samba was successfully joined as a domain member, the command displays the built-in and local host name, as well as the domain Samba is a member of including trusted domains.
					</p><div class="example" id="idm140042830621696"><p class="title"><strong>Example 2.1. Displaying the available domains</strong></p><div class="example-contents"><p>
							The following is an example of the <code class="literal">wbinfo --all-domains</code> command’s output:
						</p><pre class="literallayout"># wbinfo --all-domains
BUILTIN
SAMBA-SERVER
AD</pre></div></div></section></section><section class="section" id="using-the-local-authorization-plug-in-for-mit-kerberos_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h3 class="title">2.5.3. Using the local authorization plug-in for MIT Kerberos</h3></div></div></div><p>
					The <code class="literal">winbind</code> service provides Active Directory users to the domain member. In certain situations, administrators want to enable domain users to authenticate to local services, such as an SSH server, which are running on the domain member. When using Kerberos to authenticate the domain users, enable the <code class="literal">winbind_krb5_localauth</code> plug-in to correctly map Kerberos principals to Active Directory accounts through the <code class="literal">winbind</code> service.
				</p><p>
					For example, if the <code class="literal">sAMAccountName</code> attribute of an Active Directory user is set to <code class="literal">EXAMPLE</code> and the user tries to log with the user name lowercase, Kerberos returns the user name in upper case. As a consequence, the entries do not match an authentication fails.
				</p><p>
					Using the <code class="literal">winbind_krb5_localauth</code> plug-in, the account names are mapped correctly. Note that this only applies to GSSAPI authentication and not for getting the initial ticket granting ticket (TGT).
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Samba is configured as a member of an Active Directory.
						</li><li class="listitem">
							Red Hat Enterprise Linux authenticates log in attempts against Active Directory.
						</li><li class="listitem">
							The <code class="literal">winbind</code> service is running.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Edit the <code class="literal filename">/etc/krb5.conf</code> file and add the following section:
					</p></div><pre class="literallayout">[plugins]
localauth = {
     module = winbind:/usr/lib64/samba/krb5/winbind_krb5_localauth.so
     enable_only = winbind
}</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							See the <code class="literal">winbind_krb5_localauth(8)</code> man page.
						</li></ul></div></section><section class="section" id="assembly_samba-id-mapping_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h3 class="title">2.5.4. Samba ID mapping</h3></div></div></div><p>
					Windows domains distinguish users and groups by unique Security Identifiers (SID). However, Linux requires unique UIDs and GIDs for each user and group. If you run Samba as a domain member, the <code class="literal">winbindd</code> service is responsible for providing information about domain users and groups to the operating system.
				</p><p>
					To enable the <code class="literal">winbindd</code> service to provide unique IDs for users and groups to Linux, you must configure ID mapping in the <code class="literal filename">/etc/samba/smb.conf</code> file for:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The local database (default domain)
						</li><li class="listitem">
							The AD or NT4 domain the Samba server is a member of
						</li><li class="listitem">
							Each trusted domain from which users must be able to access resources on this Samba server
						</li></ul></div><section class="section" id="con_planning-samba-id-ranges_assembly_samba-id-mapping"><div class="titlepage"><div><div><h4 class="title">2.5.4.1. Planning Samba ID ranges</h4></div></div></div><p>
						Regardless of whether you store the Linux UIDs and GIDs in AD or if you configure Samba to generate them, each domain configuration requires a unique ID range that must not overlap with any of the other domains.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							If you set overlapping ID ranges, Samba fails to work correctly.
						</p></div></div><div class="example" id="idm140042829852944"><p class="title"><strong>Example 2.2. Unique ID Ranges</strong></p><div class="example-contents"><p>
							The following shows non-overlapping ID mapping ranges for the default (<code class="literal">*</code>), <code class="literal">AD-DOM</code>, and the <code class="literal">TRUST-DOM</code> domains.
						</p><pre class="literallayout">[global]
...
idmap config * : backend = tdb
idmap config * : range = 10000-999999

idmap config AD-DOM:backend = rid
idmap config AD-DOM:range = 2000000-2999999

idmap config TRUST-DOM:backend = rid
idmap config TRUST-DOM:range = 4000000-4999999</pre></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You can only assign one range per domain. Therefore, leave enough space between the domains ranges. This enables you to extend the range later if your domain grows.
						</p><p>
							If you later assign a different range to a domain, the ownership of files and directories previously created by these users and groups will be lost.
						</p></div></div></section><section class="section" id="con_the-asterisk-default-domain_assembly_samba-id-mapping"><div class="titlepage"><div><div><h4 class="title">2.5.4.2. The * default domain</h4></div></div></div><p>
						In a domain environment, you add one ID mapping configuration for each of the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The domain the Samba server is a member of
							</li><li class="listitem">
								Each trusted domain that should be able to access the Samba server
							</li></ul></div><p>
						However, for all other objects, Samba assigns IDs from the default domain. This includes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Local Samba users and groups
							</li><li class="listitem">
								Samba built-in accounts and groups, such as <code class="literal">BUILTIN\Administrators</code>
							</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You must configure the default domain as described in this section to enable Samba to operate correctly.
						</p></div></div><p>
						The default domain back end must be writable to permanently store the assigned IDs.
					</p><p>
						For the default domain, you can use one of the following back ends:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">tdb</code></span></dt><dd><p class="simpara">
									When you configure the default domain to use the <code class="literal">tdb</code> back end, set an ID range that is big enough to include objects that will be created in the future and that are not part of a defined domain ID mapping configuration.
								</p><p class="simpara">
									For example, set the following in the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file:
								</p><pre class="literallayout">idmap config * : backend = tdb
idmap config * : range = 10000-999999</pre><p class="simpara">
									For further details, see <a class="xref" href="index.html#proc_using-the-tdb-id-mapping-back-end_assembly_the-different-samba-id-mapping-back-ends" title="2.5.5.1. Using the tdb ID mapping back end">Section 2.5.5.1, “Using the tdb ID mapping back end”</a>.
								</p></dd><dt><span class="term"><code class="literal">autorid</code></span></dt><dd><p class="simpara">
									When you configure the default domain to use the <code class="literal">autorid</code> back end, adding additional ID mapping configurations for domains is optional.
								</p><p class="simpara">
									For example, set the following in the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file:
								</p><pre class="literallayout">idmap config * : backend = autorid
idmap config * : range = 10000-999999</pre><p class="simpara">
									For further details, see <a class="xref" href="index.html#proc_using-the-autorid-id-mapping-back-end_assembly_the-different-samba-id-mapping-back-ends" title="2.5.5.4. Using the autorid ID mapping back end">Section 2.5.5.4, “Using the autorid ID mapping back end”</a>.
								</p></dd></dl></div></section></section><section class="section" id="assembly_the-different-samba-id-mapping-back-ends_assembly_setting-up-samba-as-an-ad-domain-member-server"><div class="titlepage"><div><div><h3 class="title">2.5.5. The different Samba ID mapping back ends</h3></div></div></div><p>
					Samba provides different ID mapping back ends for specific configurations. The most frequently used back ends are:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140042831747728" scope="col">Back end</th><th align="left" valign="top" id="idm140042831746640" scope="col">Use case</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140042831747728"> <p>
									<code class="literal">tdb</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140042831746640"> <p>
									The <code class="literal">*</code> default domain only
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140042831747728"> <p>
									<code class="literal">ad</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140042831746640"> <p>
									AD domains only
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140042831747728"> <p>
									<code class="literal">rid</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140042831746640"> <p>
									AD and NT4 domains
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140042831747728"> <p>
									<code class="literal">autorid</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140042831746640"> <p>
									AD, NT4, and the <code class="literal">*</code> default domain
								</p>
								 </td></tr></tbody></table></div><p>
					The following sections describe the benefits, recommended scenarios where to use the back end, and how to configure it.
				</p><section class="section" id="proc_using-the-tdb-id-mapping-back-end_assembly_the-different-samba-id-mapping-back-ends"><div class="titlepage"><div><div><h4 class="title">2.5.5.1. Using the tdb ID mapping back end</h4></div></div></div><p>
						The <code class="literal">winbindd</code> service uses the writable <code class="literal">tdb</code> ID mapping back end by default to store Security Identifier (SID), UID, and GID mapping tables. This includes local users, groups, and built-in principals.
					</p><p>
						Use this back end only for the <code class="literal">*</code> default domain. For example:
					</p><pre class="literallayout">idmap config * : backend = tdb
idmap config * : range = 10000-999999</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#con_the-asterisk-default-domain_assembly_samba-id-mapping" title="2.5.4.2. The * default domain">Section 2.5.4.2, “The * default domain”</a>.
							</li></ul></div></section><section class="section" id="proc_using-the-ad-id-mapping-back-end_assembly_the-different-samba-id-mapping-back-ends"><div class="titlepage"><div><div><h4 class="title">2.5.5.2. Using the ad ID mapping back end</h4></div></div></div><p>
						This section describes how to configure a Samba AD member to use the <code class="literal">ad</code> ID mapping back end.
					</p><p>
						The <code class="literal">ad</code> ID mapping back end implements a read-only API to read account and group information from AD. This provides the following benefits:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								All user and group settings are stored centrally in AD.
							</li><li class="listitem">
								User and group IDs are consistent on all Samba servers that use this back end.
							</li><li class="listitem">
								The IDs are not stored in a local database which can corrupt, and therefore file ownerships cannot be lost.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">ad</code> ID mapping back end does not support Active Directory domains with one-way trusts. If you configure a domain member in an Active Directory with one-way trusts, use instead one of the following ID mapping back ends: <code class="literal">tdb</code>, <code class="literal">rid</code>, or <code class="literal">autorid</code>.
						</p></div></div><p>
						The ad back end reads the following attributes from AD:
					</p><div class="informaltable" id="table_proc_using-the-ad-id-mapping-back-end_assembly_the-different-samba-id-mapping-back-ends"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 50%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140042827205360" scope="col">AD attribute name</th><th align="left" valign="top" id="idm140042827204272" scope="col">Object type</th><th align="left" valign="top" id="idm140042827203184" scope="col">Mapped to</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140042827205360"> <p>
										<code class="literal">sAMAccountName</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140042827204272"> <p>
										User and group
									</p>
									 </td><td align="left" valign="top" headers="idm140042827203184"> <p>
										User or group name, depending on the object
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140042827205360"> <p>
										<code class="literal">uidNumber</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140042827204272"> <p>
										User
									</p>
									 </td><td align="left" valign="top" headers="idm140042827203184"> <p>
										User ID (UID)
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140042827205360"> <p>
										<code class="literal">gidNumber</code>
									</p>
									 </td><td align="left" valign="top" headers="idm140042827204272"> <p>
										Group
									</p>
									 </td><td align="left" valign="top" headers="idm140042827203184"> <p>
										Group ID (GID)
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140042827205360"> <p>
										<code class="literal">loginShell</code> <a href="index.html#ftn.sambaloginshell" class="footnote"><sup class="footnote" id="sambaloginshell">[a]</sup></a>
									</p>
									 </td><td align="left" valign="top" headers="idm140042827204272"> <p>
										User
									</p>
									 </td><td align="left" valign="top" headers="idm140042827203184"> <p>
										Path to the shell of the user
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140042827205360"> <p>
										<code class="literal">unixHomeDirectory</code> <a href="index.html#ftn.sambaloginshell" class="footnoteref"><sup class="footnoteref">[a]</sup></a>
									</p>
									 </td><td align="left" valign="top" headers="idm140042827204272"> <p>
										User
									</p>
									 </td><td align="left" valign="top" headers="idm140042827203184"> <p>
										Path to the home directory of the user
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140042827205360"> <p>
										<code class="literal">primaryGroupID</code> <a href="index.html#ftn.samba_primarygroupid" class="footnote"><sup class="footnote" id="samba_primarygroupid">[b]</sup></a>
									</p>
									 </td><td align="left" valign="top" headers="idm140042827204272"> <p>
										User
									</p>
									 </td><td align="left" valign="top" headers="idm140042827203184"> <p>
										Primary group ID
									</p>
									 </td></tr></tbody><tbody class="footnotes"><tr><td colspan="3"><div id="ftn.sambaloginshell" class="footnote"><div class="para"><a href="index.html#sambaloginshell" class="simpara"><sup class="simpara">[a] </sup></a>
											Samba only reads this attribute if you set <code class="literal">idmap config <span class="emphasis"><em>DOMAIN</em></span>:unix_nss_info = yes</code>.
										</div></div><div id="ftn.samba_primarygroupid" class="footnote"><div class="para"><a href="index.html#samba_primarygroupid" class="simpara"><sup class="simpara">[b] </sup></a>
											Samba only reads this attribute if you set <code class="literal">idmap config <span class="emphasis"><em>DOMAIN</em></span>:unix_primary_group = yes</code>.
										</div></div></td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
							To use the <code class="literal">ad</code> ID mapping back end:
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Both users and groups must have unique IDs set in AD, and the IDs must be within the range configured in the <code class="literal filename">/etc/samba/smb.conf</code> file. Objects whose IDs are outside of the range will not be available on the Samba server.
							</li><li class="listitem">
								Users and groups must have all required attributes set in AD. If required attributes are missing, the user or group will not be available on the Samba server. The required attributes depend on your configuration.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Add an ID mapping configuration for the default domain (<code class="literal">*</code>) if it does not exist. For example:
									</p><pre class="literallayout">idmap config * : backend = tdb
idmap config * : range = <span class="emphasis"><em>10000-999999</em></span></pre></li><li class="listitem"><p class="simpara">
										Enable the <code class="literal">ad</code> ID mapping back end for the AD domain:
									</p><pre class="literallayout">idmap config <span class="emphasis"><em>DOMAIN</em></span> : backend = ad</pre></li><li class="listitem"><p class="simpara">
										Set the range of IDs that is assigned to users and groups in the AD domain. For example:
									</p><pre class="literallayout">idmap config <span class="emphasis"><em>DOMAIN</em></span> : range = <span class="emphasis"><em>2000000-2999999</em></span></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											The range must not overlap with any other domain configuration on this server. Additionally, the range must be set big enough to include all IDs assigned in the future. For further details, see <a class="xref" href="index.html#con_planning-samba-id-ranges_assembly_samba-id-mapping" title="2.5.4.1. Planning Samba ID ranges">Section 2.5.4.1, “Planning Samba ID ranges”</a>.
										</p></div></div></li><li class="listitem"><p class="simpara">
										Set that Samba uses the <a class="link" href="https://tools.ietf.org/html/rfc2307">RFC 2307</a> schema when reading attributes from AD:
									</p><pre class="literallayout">idmap config <span class="emphasis"><em>DOMAIN</em></span> : schema_mode = rfc2307</pre></li><li class="listitem"><p class="simpara">
										To enable Samba to read the login shell and the path to the users home directory from the corresponding AD attribute, set:
									</p><pre class="literallayout">idmap config <span class="emphasis"><em>DOMAIN</em></span> : unix_nss_info = yes</pre><p class="simpara">
										Alternatively, you can set a uniform domain-wide home directory path and login shell that is applied to all users. For example:
									</p><pre class="literallayout">template shell = <span class="emphasis"><em>/bin/bash</em></span>
template homedir = <span class="emphasis"><em>/home/%U</em></span></pre></li><li class="listitem"><p class="simpara">
										By default, Samba uses the <code class="literal">primaryGroupID</code> attribute of a user object as the user’s primary group on Linux. Alternatively, you can configure Samba to use the value set in the <code class="literal">gidNumber</code> attribute instead:
									</p><pre class="literallayout">idmap config <span class="emphasis"><em>DOMAIN</em></span> : unix_primary_group = yes</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Reload the Samba configuration:
							</p><pre class="literallayout"># smbcontrol all reload-config</pre></li><li class="listitem">
								Verify that the settings work as expected. See <a class="xref" href="index.html#verifying-that-the-operating-system-can-retrieve-domain-user-accounts-and-groups_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.2.1. Verifying that the operating system can retrieve domain user accounts and groups">Section 2.5.2.1, “Verifying that the operating system can retrieve domain user accounts and groups”</a>.
							</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#con_the-asterisk-default-domain_assembly_samba-id-mapping" title="2.5.4.2. The * default domain">Section 2.5.4.2, “The * default domain”</a>
							</li><li class="listitem">
								For further details about the parameters used in the procedure, see the <code class="literal">smb.conf(5)</code> and <code class="literal">idmap_ad(8)</code> man pages.
							</li><li class="listitem">
								For details about variable substitution, see the <code class="literal">VARIABLE SUBSTITUTIONS</code> section in the <code class="literal">smb.conf(5)</code> man page.
							</li><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section><section class="section" id="proc_using-the-rid-id-mapping-back-end_assembly_the-different-samba-id-mapping-back-ends"><div class="titlepage"><div><div><h4 class="title">2.5.5.3. Using the rid ID mapping back end</h4></div></div></div><p>
						This section describes how to configure a Samba domain member to use the <code class="literal">rid</code> ID mapping back end.
					</p><p>
						Samba can use the relative identifier (RID) of a Windows SID to generate an ID on Red Hat Enterprise Linux.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The RID is the last part of a SID. For example, if the SID of a user is <code class="literal">S-1-5-21-5421822485-1151247151-421485315-30014</code>, then <code class="literal">30014</code> is the corresponding RID.
						</p></div></div><p>
						The <code class="literal">rid</code> ID mapping back end implements a read-only API to calculate account and group information based on an algorithmic mapping scheme for AD and NT4 domains. When you configure the back end, you must set the lowest and highest RID in the <code class="literal">idmap config <span class="emphasis"><em>DOMAIN</em></span> : <span class="emphasis"><em>range</em></span></code> parameter. Samba will not map users or groups with a lower or higher RID than set in this parameter.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							As a read-only back end, <code class="literal">rid</code> cannot assign new IDs, such as for <code class="literal">BUILTIN</code> groups. Therefore, do not use this back end for the <code class="literal">*</code> default domain.
						</p></div></div><h6 id="benefits_of_using_the_rid_back_end">Benefits of using the rid back end</h6><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								All domain users and groups that have an RID within the configured range are automatically available on the domain member.
							</li><li class="listitem">
								You do not need to manually assign IDs, home directories, and login shells.
							</li></ul></div><h6 id="drawbacks_of_using_the_rid_back_end">Drawbacks of using the rid back end</h6><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								All domain users get the same login shell and home directory assigned. However, you can use variables.
							</li><li class="listitem">
								User and group IDs are only the same across Samba domain members if all use the <code class="literal">rid</code> back end with the same ID range settings.
							</li><li class="listitem">
								You cannot exclude individual users or groups from being available on the domain member. Only users and groups outside of the configured range are excluded.
							</li><li class="listitem">
								Based on the formulas the <code class="literal">winbindd</code> service uses to calculate the IDs, duplicate IDs can occur in multi-domain environments if objects in different domains have the same RID.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Add an ID mapping configuration for the default domain (<code class="literal">*</code>) if it does not exist. For example:
									</p><pre class="literallayout">idmap config * : backend = tdb
idmap config * : range = <span class="emphasis"><em>10000-999999</em></span></pre></li><li class="listitem"><p class="simpara">
										Enable the <code class="literal">rid</code> ID mapping back end for the domain:
									</p><pre class="literallayout">idmap config <span class="emphasis"><em>DOMAIN</em></span> : backend = rid</pre></li><li class="listitem"><p class="simpara">
										Set a range that is big enough to include all RIDs that will be assigned in the future. For example:
									</p><pre class="literallayout">idmap config <span class="emphasis"><em>DOMAIN</em></span> : range = <span class="emphasis"><em>2000000-2999999</em></span></pre><p class="simpara">
										Samba ignores users and groups whose RIDs in this domain are not within the range.
									</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											The range must not overlap with any other domain configuration on this server. For further details, see <a class="xref" href="index.html#con_planning-samba-id-ranges_assembly_samba-id-mapping" title="2.5.4.1. Planning Samba ID ranges">Section 2.5.4.1, “Planning Samba ID ranges”</a>.
										</p></div></div></li><li class="listitem"><p class="simpara">
										Set a shell and home directory path that will be assigned to all mapped users. For example:
									</p><pre class="literallayout">template shell = <span class="emphasis"><em>/bin/bash</em></span>
template homedir = <span class="emphasis"><em>/home/%U</em></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Reload the Samba configuration:
							</p><pre class="literallayout"># smbcontrol all reload-config</pre><p class="simpara">
								Verify that the settings work as expected. See <a class="xref" href="index.html#verifying-that-the-operating-system-can-retrieve-domain-user-accounts-and-groups_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.2.1. Verifying that the operating system can retrieve domain user accounts and groups">Section 2.5.2.1, “Verifying that the operating system can retrieve domain user accounts and groups”</a>.
							</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#con_the-asterisk-default-domain_assembly_samba-id-mapping" title="2.5.4.2. The * default domain">Section 2.5.4.2, “The * default domain”</a>
							</li><li class="listitem">
								For details about variable substitution, see the <code class="literal">VARIABLE SUBSTITUTIONS</code> section in the <code class="literal">smb.conf(5)</code> man page.
							</li><li class="listitem">
								For details, how Samba calculates the local ID from a RID, see the <code class="literal">idmap_rid(8)</code> man page.
							</li><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section><section class="section" id="proc_using-the-autorid-id-mapping-back-end_assembly_the-different-samba-id-mapping-back-ends"><div class="titlepage"><div><div><h4 class="title">2.5.5.4. Using the autorid ID mapping back end</h4></div></div></div><p>
						This section describes how to configure a Samba domain member to use the <code class="literal">autorid</code> ID mapping back end.
					</p><p>
						The <code class="literal">autorid</code> back end works similar to the <code class="literal">rid</code> ID mapping back end, but can automatically assign IDs for different domains. This enables you to use the <code class="literal">autorid</code> back end in the following situations:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only for the <code class="literal">*</code> default domain
							</li><li class="listitem">
								For the <code class="literal">*</code> default domain and additional domains, without the need to create ID mapping configurations for each of the additional domains
							</li><li class="listitem">
								Only for specific domains
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you use <code class="literal">autorid</code> for the default domain, adding additional ID mapping configuration for domains is optional.
						</p></div></div><p>
						Parts of this section were adopted from the <a class="link" href="https://wiki.samba.org/index.php/Idmap_config_autorid">idmap config autorid</a> documentation published in the Samba Wiki. License: <a class="link" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Authors and contributors: See the <a class="link" href="https://wiki.samba.org/index.php?title=Idmap_config_autorid&amp;action=history">history</a> tab on the Wiki page.
					</p><h6 id="benefits_of_using_the_autorid_back_end">Benefits of using the autorid back end</h6><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								All domain users and groups whose calculated UID and GID is within the configured range are automatically available on the domain member.
							</li><li class="listitem">
								You do not need to manually assign IDs, home directories, and login shells.
							</li><li class="listitem">
								No duplicate IDs, even if multiple objects in a multi-domain environment have the same RID.
							</li></ul></div><h6 id="drawbacks">Drawbacks</h6><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								User and group IDs are not the same across Samba domain members.
							</li><li class="listitem">
								All domain users get the same login shell and home directory assigned. However, you can use variables.
							</li><li class="listitem">
								You cannot exclude individual users or groups from being available on the domain member. Only users and groups whose calculated UID or GID is outside of the configured range are excluded.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Edit the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Enable the <code class="literal">autorid</code> ID mapping back end for the <code class="literal">*</code> default domain:
									</p><pre class="literallayout">idmap config * : backend = autorid</pre></li><li class="listitem"><p class="simpara">
										Set a range that is big enough to assign IDs for all existing and future objects. For example:
									</p><pre class="literallayout">idmap config * : range = <span class="emphasis"><em>10000-999999</em></span></pre><p class="simpara">
										Samba ignores users and groups whose calculated IDs in this domain are not within the range.
									</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											After you set the range and Samba starts using it, you can only increase the upper limit of the range. Any other change to the range can result in new ID assignments, and thus in losing file ownerships.
										</p></div></div></li><li class="listitem"><p class="simpara">
										Optionally, set a range size. For example:
									</p><pre class="literallayout">idmap config * : rangesize = <span class="emphasis"><em>200000</em></span></pre><p class="simpara">
										Samba assigns this number of continuous IDs for each domain’s object until all IDs from the range set in the <code class="literal">idmap config * : <span class="emphasis"><em>range</em></span></code> parameter are taken.
									</p></li><li class="listitem"><p class="simpara">
										Set a shell and home directory path that will be assigned to all mapped users. For example:
									</p><pre class="literallayout">template shell = <span class="emphasis"><em>/bin/bash</em></span>
template homedir = <span class="emphasis"><em>/home/%U</em></span></pre></li><li class="listitem"><p class="simpara">
										Optionally, add additional ID mapping configuration for domains. If no configuration for an individual domain is available, Samba calculates the ID using the <code class="literal">autorid</code> back end settings in the previously configured <code class="literal">*</code> default domain.
									</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											If you configure additional back ends for individual domains, the ranges for all ID mapping configuration must not overlap. For further details, see <a class="xref" href="index.html#con_planning-samba-id-ranges_assembly_samba-id-mapping" title="2.5.4.1. Planning Samba ID ranges">Section 2.5.4.1, “Planning Samba ID ranges”</a>.
										</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Reload the Samba configuration:
							</p><pre class="literallayout"># smbcontrol all reload-config</pre></li><li class="listitem">
								Verify that the settings work as expected. See <a class="xref" href="index.html#verifying-that-the-operating-system-can-retrieve-domain-user-accounts-and-groups_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.2.1. Verifying that the operating system can retrieve domain user accounts and groups">Section 2.5.2.1, “Verifying that the operating system can retrieve domain user accounts and groups”</a>.
							</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								For details about how the back end calculated IDs, see the <code class="literal">THE MAPPING FORMULAS</code> section in the <code class="literal">idmap_autorid(8)</code> man page.
							</li><li class="listitem">
								For details about using the <code class="literal">idmap config</code> <code class="literal">rangesize</code> parameter, see the <code class="literal">rangesize</code> parameter description in the <code class="literal">idmap_autorid(8)</code> man page.
							</li><li class="listitem">
								For details about variable substitution, see the <code class="literal">VARIABLE SUBSTITUTIONS</code> section in the <code class="literal">smb.conf(5)</code> man page.
							</li><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section></section></section><section class="section" id="setting-up-samba-on-an-idm-domain-member_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.6. Setting up Samba on an IdM domain member</h2></div></div></div><p>
				This section describes how to set up Samba on a host that is joined to a Red Hat Identity Management (IdM) domain. Users from IdM and also, if available, from trusted Active Directory (AD) domains, can access shares and printer services provided by Samba.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Using Samba on an IdM domain member is an unsupported Technology Preview feature.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The host is joined as a client to the IdM domain.
					</li><li class="listitem">
						Both the IdM servers and the client must run on RHEL 8.1 or later.
					</li></ul></div><section class="section" id="preparing-the-idm-domain-for-installing-samba-on-domain-members_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h3 class="title">2.6.1. Preparing the IdM domain for installing Samba on domain members</h3></div></div></div><p>
					Before you can establish a trust with AD and if you want to set up Samba on an IdM client, you must prepare the IdM domain using the <code class="literal">ipa-adtrust-install</code> utility on an IdM server. However, even if both situations apply, you must run <code class="literal">ipa-adtrust-install</code> only once on an IdM master.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							IdM is installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the required packages:
						</p><pre class="literallayout">[root@ipaserver ~]# yum install ipa-server ipa-server-trust-ad samba-client</pre></li><li class="listitem"><p class="simpara">
							Authenticate as the IdM administrative user:
						</p><pre class="literallayout">[root@ipaserver ~]# kinit admin</pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa-adtrust-install</code> utility:
						</p><pre class="literallayout">[root@ipaserver ~]# ipa-adtrust-install</pre><p class="simpara">
							The DNS service records are created automatically if IdM was installed with an integrated DNS server.
						</p><p class="simpara">
							If IdM was installed without an integrated DNS server, <code class="literal">ipa-adtrust-install</code> prints a list of service records that must be manually added to DNS before you can continue.
						</p></li><li class="listitem"><p class="simpara">
							The script prompts you that the <code class="literal">/etc/samba/smb.conf</code> already exists and will be rewritten:
						</p><pre class="literallayout">WARNING: The smb.conf already exists. Running ipa-adtrust-install will break your existing Samba configuration.

Do you wish to continue? [no]: yes</pre></li><li class="listitem"><p class="simpara">
							The script prompts you to configure the <code class="literal">slapi-nis</code> plug-in, a compatibility plug-in that allows older Linux clients to work with trusted users:
						</p><pre class="literallayout">Do you want to enable support for trusted domains in Schema Compatibility plugin?
This will allow clients older than SSSD 1.9 and non-Linux clients to work with trusted users.

Enable trusted domains support in slapi-nis? [no]: yes</pre></li><li class="listitem"><p class="simpara">
							When prompted, enter the NetBIOS name for the IdM domain or press <span class="strong strong"><strong>Enter</strong></span> to accept the name suggested:
						</p><pre class="literallayout">Trust is configured but no NetBIOS domain name found, setting it now.
Enter the NetBIOS name for the IPA domain.
Only up to 15 uppercase ASCII letters, digits and dashes are allowed.
Example: EXAMPLE.

NetBIOS domain name [IDM]:</pre></li><li class="listitem"><p class="simpara">
							You are prompted to run the SID generation task to create a SID for any existing users:
						</p><pre class="literallayout">Do you want to run the ipa-sidgen task? [no]: yes</pre><p class="simpara">
							When the directory is first installed, at least one user (the IdM administrator) exists and as this is a resource-intensive task, if you have a high number of users, you can run this at another time.
						</p></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal systemitem">ipa</code> service:
						</p><pre class="literallayout">[root@ipaserver ~]# systemctl restart ipa</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal systemitem">smbclient</code> utility to verify that Samba responds to Kerberos authentication from the IdM side:
						</p><pre class="literallayout">[root@ipaserver ~]# smbclient -L server.idm.example.com -k
lp_load_ex: changing to config backend registry
    Sharename       Type      Comment
    ---------       ----      -------
    IPC$            IPC       IPC Service (Samba 4.10.4)
...</pre></li></ol></div></section><section class="section" id="enabling-the-aes-encryption-type-in-active-directory-using-a-gpo_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h3 class="title">2.6.2. Enabling the AES encryption type in Active Directory using a GPO</h3></div></div></div><p>
					This section describes how to enable the AES encryption type in Active Directory (AD) using a group policy object (GPO). Certain Identity Management (IdM) features, such as running a Samba server on an IdM client, require this encryption type.
				</p><p>
					Note that RHEL 8 does not support the weak DES and RC4 encryption types.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You are logged into AD as a user who can edit group policies.
						</li><li class="listitem">
							The <code class="literal application">Group Policy Management Console</code> is installed on the computer.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open the <code class="literal application">Group Policy Management Console</code>.
						</li><li class="listitem">
							Right-click <code class="literal gui">Default Domain Policy</code>, and select <code class="literal gui">Edit</code>. The <code class="literal application">Group Policy Management Editor</code> opens.
						</li><li class="listitem">
							Navigate to <code class="literal gui">Computer Configuration</code> → <code class="literal gui">Policies</code> → <code class="literal gui">Windows Settings</code> → <code class="literal gui">Security Settings</code> → <code class="literal gui">Local Policies</code> → <code class="literal gui">Security Options</code>.
						</li><li class="listitem">
							Double-click the <code class="literal gui">Network security: Configure encryption types allowed for Kerberos</code> policy.
						</li><li class="listitem">
							Select <code class="literal gui">AES256_HMAC_SHA1</code> and, optionally, <code class="literal gui">Future encryption types</code>.
						</li><li class="listitem">
							Click <span class="guibutton">OK</span>.
						</li><li class="listitem">
							Close the <code class="literal application">Group Policy Management Editor</code>.
						</li><li class="listitem">
							Repeat the steps for the <code class="literal gui">Default Domain Controller Policy</code>.
						</li><li class="listitem"><p class="simpara">
							Wait until the Windows domain controllers (DC) applied the group policy automatically. Alternatively, to apply the GPO manually on a DC, enter the following command using an account that has administrator permissions:
						</p><pre class="literallayout">C:\&gt; gpupdate /force /target:computer</pre></li></ol></div></section><section class="section" id="installing-and-configuring-samba-on-an-idm-client_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h3 class="title">2.6.3. Installing and configuring a Samba server on an IdM client</h3></div></div></div><p>
					This section describes how to install and configure Samba on a client enrolled in an IdM domain.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Both the IdM servers and the client must run on RHEL 8.1 or later.
						</li><li class="listitem">
							The IdM domain is prepared as described in <a class="xref" href="index.html#preparing-the-idm-domain-for-installing-samba-on-domain-members_setting-up-samba-on-an-idm-domain-member" title="2.6.1. Preparing the IdM domain for installing Samba on domain members">Section 2.6.1, “Preparing the IdM domain for installing Samba on domain members”</a>.
						</li><li class="listitem">
							If IdM has a trust configured with AD, enable the AES encryption type for Kerberos. For example, use a group policy object (GPO) to enable the AES encryption type. For details, see <a class="xref" href="index.html#enabling-the-aes-encryption-type-in-active-directory-using-a-gpo_setting-up-samba-on-an-idm-domain-member" title="2.6.2. Enabling the AES encryption type in Active Directory using a GPO">Section 2.6.2, “Enabling the AES encryption type in Active Directory using a GPO”</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the <code class="literal package">ipa-client-samba</code> package:
						</p><pre class="literallayout">[root@idm_client]# yum install ipa-client-samba</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa-client-samba</code> utility to prepare the client and create an initial Samba configuration:
						</p><pre class="literallayout">[root@idm_client]# ipa-client-samba
Searching for IPA server...
IPA server: DNS discovery
Chosen IPA master: <span class="emphasis"><em>idm_server.idm.example.com</em></span>
SMB principal to be created: cifs/<span class="emphasis"><em>idm_client.idm.example.com</em></span>@<span class="emphasis"><em>IDM.EXAMPLE.COM</em></span>
NetBIOS name to be used: <span class="emphasis"><em>IDM_CLIENT</em></span>
Discovered domains to use:

 Domain name: <span class="emphasis"><em>idm.example.com</em></span>
NetBIOS name: <span class="emphasis"><em>IDM</em></span>
         SID: <span class="emphasis"><em>S-1-5-21-525930803-952335037-206501584</em></span>
    ID range: <span class="emphasis"><em>212000000 - 212199999</em></span>

 Domain name: <span class="emphasis"><em>ad.example.com</em></span>
NetBIOS name: <span class="emphasis"><em>AD</em></span>
         SID: None
    ID range: <span class="emphasis"><em>1918400000 - 1918599999</em></span>

Continue to configure the system with these values? [no]: <span class="strong strong"><strong>yes</strong></span>
Samba domain member is configured. Please check configuration at /etc/samba/smb.conf and start smb and winbind services</pre></li><li class="listitem"><p class="simpara">
							By default, <code class="literal">ipa-client-samba</code> automatically adds the <code class="literal systemitem">[homes]</code> section to the <code class="literal filename">/etc/samba.smb.conf</code> file that dynamically shares a user’s home directory when the user connects. If users do not have home directories on this server, or if you do not want to share them, remove the following lines from <code class="literal filename">/etc/samba.smb.conf</code>:
						</p><pre class="literallayout">[homes]
    read only = no</pre></li><li class="listitem"><p class="simpara">
							Share directories and printers. For details, see:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="xref" href="index.html#assembly_configuring-file-shares-on-a-samba-server_assembly_using-samba-as-a-server" title="2.7. Configuring file shares on a Samba server">Section 2.7, “Configuring file shares on a Samba server”</a>
								</li><li class="listitem">
									<a class="xref" href="index.html#assembly_setting-up-samba-as-a-print-server_assembly_using-samba-as-a-server" title="2.8. Setting up Samba as a print server">Section 2.8, “Setting up Samba as a print server”</a>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Open the ports required for a Samba client in the local firewall:
						</p><pre class="literallayout">[root@idm_client]# firewall-cmd --permanent --add-service=samba-client
[root@idm_client]# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
							Enable and start the <code class="literal systemitem">smb</code> and <code class="literal systemitem">winbind</code> services:
						</p><pre class="literallayout">[root@idm_client]# systemctl enable --now smb winbind</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
						Run the following verification steps on a different IdM domain member that has the <code class="literal package">samba-client</code> package installed:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Authenticate and obtain a Kerberos ticket-granting ticket:
						</p><pre class="literallayout">$ kinit <span class="emphasis"><em>example_user</em></span></pre></li><li class="listitem"><p class="simpara">
							List the shares on the Samba server using Kerberos authentication:
						</p><pre class="literallayout">$ smbclient -L <span class="emphasis"><em>idm_client.idm.example.com</em></span> -k
lp_load_ex: changing to config backend registry

    Sharename       Type      Comment
    ---------       ----      -------
    <span class="emphasis"><em>example</em></span>         Disk
    IPC$            IPC       IPC Service (Samba 4.10.4)
...</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For details about which steps <code class="literal systemitem">ipa-client-samba</code> performs during the configuration, see the <code class="literal citetitle">ipa-client-samba(1)</code> man page.
						</li></ul></div></section><section class="section" id="manually-adding-an-id-mapping-configuration-if-idm-trusts-a-new-domain_setting-up-samba-on-an-idm-domain-member"><div class="titlepage"><div><div><h3 class="title">2.6.4. Manually adding an ID mapping configuration if IdM trusts a new domain</h3></div></div></div><p>
					Samba requires an ID mapping configuration for each domain from which users access resources. On an existing Samba server running on an IdM client, you must manually add an ID mapping configuration after the administrator added a new trust to an Active Directory (AD) domain.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You configured Samba on an IdM client as described in <a class="xref" href="index.html#installing-and-configuring-samba-on-an-idm-client_setting-up-samba-on-an-idm-domain-member" title="2.6.3. Installing and configuring a Samba server on an IdM client">Section 2.6.3, “Installing and configuring a Samba server on an IdM client”</a>. Afterward, new trust was added to IdM.
						</li><li class="listitem">
							The DES and RC4 encryption types for Kerberos must be disabled in the trusted AD domain. For security reasons, RHEL 8 does not support these weak encryption types.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Authenticate using the host’s keytab:
						</p><pre class="literallayout">[root@idm_client]# kinit -k</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal command">ipa idrange-find</code> command to display both the base ID and the ID range size of the new domain. For example, the following command displays the values for the <code class="literal systemitem">ad.example.com</code> domain:
						</p><pre class="literallayout">[root@idm_client]# ipa idrange-find --name="<span class="emphasis"><em>AD.EXAMPLE.COM</em></span>_id_range" --raw
---------------
1 range matched
---------------
  cn: <span class="emphasis"><em>AD.EXAMPLE.COM</em></span>_id_range
  ipabaseid: <span class="emphasis"><em>1918400000</em></span>
  ipaidrangesize: <span class="emphasis"><em>200000</em></span>
  ipabaserid: 0
  ipanttrusteddomainsid: <span class="emphasis"><em>S-1-5-21-968346183-862388825-1738313271</em></span>
  iparangetype: ipa-ad-trust
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
							You need the values from the <code class="literal parameter">ipabaseid</code> and <code class="literal parameter">ipaidrangesize</code> attributes in the next steps.
						</p></li><li class="listitem"><p class="simpara">
							To calculate the highest usable ID, use the following formula:
						</p><pre class="literallayout">maximum_range = ipabaseid + ipaidrangesize - 1</pre><p class="simpara">
							With the values from the previous step, the highest usable ID for the <code class="literal systemitem">ad.example.com</code> domain is <code class="literal command">1918599999</code> (1918400000 + 200000 - 1).
						</p></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/samba/smb.conf</code> file, and add the ID mapping configuration for the domain to the <code class="literal parameter">[global]</code> section:
						</p><pre class="literallayout">idmap config <span class="emphasis"><em>AD</em></span> : range = <span class="emphasis"><em>1918400000</em></span> - <span class="emphasis"><em>1918599999</em></span>
idmap config <span class="emphasis"><em>AD</em></span> : backend = sss</pre><p class="simpara">
							Specify the value from <code class="literal parameter">ipabaseid</code> attribute as the lowest and the computed value from the previous step as the highest value of the range.
						</p></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal systemitem">smb</code> and <code class="literal">winbind</code> services:
						</p><pre class="literallayout">[root@idm_client]# systemctl restart smb winbind</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Authenticate as a user from the new domain and obtain a Kerberos ticket-granting ticket:
						</p><pre class="literallayout">$ kinit <span class="emphasis"><em>example_user</em></span></pre></li><li class="listitem"><p class="simpara">
							List the shares on the Samba server using Kerberos authentication:
						</p><pre class="literallayout">$ smbclient -L <span class="emphasis"><em>idm_client.idm.example.com</em></span> -k
lp_load_ex: changing to config backend registry

    Sharename       Type      Comment
    ---------       ----      -------
    <span class="emphasis"><em>example</em></span>         Disk
    IPC$            IPC       IPC Service (Samba 4.10.4)
...</pre></li></ol></div></section><section class="section" id="additional_resources_2"><div class="titlepage"><div><div><h3 class="title">2.6.5. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For details about joining RHEL 8 to an IdM domain, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/installing-an-ipa-client-basic-scenario_installing-identity-management"><code class="literal citetitle">Installing an Identity Management client</code></a> section in the <code class="literal citetitle">Installing Identity Management</code> guide.
						</li></ul></div></section></section><section class="section" id="assembly_configuring-file-shares-on-a-samba-server_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.7. Configuring file shares on a Samba server</h2></div></div></div><p>
				To use Samba as a file server, add shares to the <code class="literal filename">/etc/samba/smb.conf</code> file of your standalone server or domain member configuration.
			</p><p>
				You can add shares that uses either:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						POSIX ACLs. See <a class="xref" href="index.html#assembly_setting-up-a-share-that-uses-posix-acls_assembly_configuring-file-shares-on-a-samba-server" title="2.7.1. Setting up a share that uses POSIX ACLs">Section 2.7.1, “Setting up a share that uses POSIX ACLs”</a>.
					</li><li class="listitem">
						Fine-granular Windows ACLs. See <a class="xref" href="index.html#assembly_setting-up-a-share-that-uses-windows-acls_assembly_configuring-file-shares-on-a-samba-server" title="2.7.2. Setting up a share that uses Windows ACLs">Section 2.7.2, “Setting up a share that uses Windows ACLs”</a>.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					Samba has been set up in one of the following modes:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="index.html#assembly_setting-up-samba-as-a-standalone-server_assembly_using-samba-as-a-server" title="2.4. Setting up Samba as a standalone server">Standalone server</a>
					</li><li class="listitem">
						<a class="link" href="index.html#assembly_setting-up-samba-as-an-ad-domain-member-server_assembly_using-samba-as-a-server" title="2.5. Setting up Samba as an AD domain member server">Domain member</a>
					</li></ul></div><section class="section" id="assembly_setting-up-a-share-that-uses-posix-acls_assembly_configuring-file-shares-on-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.7.1. Setting up a share that uses POSIX ACLs</h3></div></div></div><p>
					As a Linux service, Samba supports shares with POSIX ACLs. They enable you to manage permissions locally on the Samba server using utilities, such as <code class="literal">chmod</code>. If the share is stored on a file system that supports extended attributes, you can define ACLs with multiple users and groups.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you need to use fine-granular Windows ACLs instead, see <a class="xref" href="index.html#assembly_setting-up-a-share-that-uses-windows-acls_assembly_configuring-file-shares-on-a-samba-server" title="2.7.2. Setting up a share that uses Windows ACLs">Section 2.7.2, “Setting up a share that uses Windows ACLs”</a>.
					</p></div></div><p>
					Parts of this section were adopted from the <a class="link" href="https://wiki.samba.org/index.php/Setting_up_a_Share_Using_POSIX_ACLs">Setting up a Share Using POSIX ACLs</a> documentation published in the Samba Wiki. License: <a class="link" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Authors and contributors: See the <a class="link" href="https://wiki.samba.org/index.php?title=Setting_up_a_Share_Using_POSIX_ACLs&amp;action=history">history</a> tab on the Wiki page.
				</p><section class="section" id="proc_adding-a-share-that-uses-posix-acls_assembly_setting-up-a-share-that-uses-posix-acls"><div class="titlepage"><div><div><h4 class="title">2.7.1.1. Adding a share that uses POSIX ACLs</h4></div></div></div><p>
						This section describes how to create a share named <code class="literal">example</code> that provides the content of the <code class="literal filename">/srv/samba/example/</code> directory, and uses POSIX ACLs.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the folder if it does not exist. For example:
							</p><pre class="literallayout"># mkdir -p /srv/samba/example/</pre></li><li class="listitem"><p class="simpara">
								If you run SELinux in <code class="literal">enforcing</code> mode, set the <code class="literal">samba_share_t</code> context on the directory:
							</p><pre class="literallayout"># semanage fcontext -a -t samba_share_t "/srv/samba/example(/.*)?"
# restorecon -Rv /srv/samba/example/</pre></li><li class="listitem">
								Set file system ACLs on the directory. See <a class="xref" href="index.html#assembly_setting-up-a-share-that-uses-posix-acls_assembly_configuring-file-shares-on-a-samba-server" title="2.7.1. Setting up a share that uses POSIX ACLs">Section 2.7.1, “Setting up a share that uses POSIX ACLs”</a>.
							</li><li class="listitem"><p class="simpara">
								Add the example share to the <code class="literal filename">/etc/samba/smb.conf</code> file. For example, to add the share write-enabled:
							</p><pre class="literallayout">[example]
	path = /srv/samba/example/
	read only = no</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Regardless of the file system ACLs; if you do not set <code class="literal">read only = no</code>, Samba shares the directory in read-only mode.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Open the required ports and reload the firewall configuration using the <code class="literal">firewall-cmd</code> utility:
							</p><pre class="literallayout"># firewall-cmd --permanent --add-service=samba
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
								Restart the <code class="literal">smb</code> service:
							</p><pre class="literallayout"># systemctl restart smb</pre></li><li class="listitem"><p class="simpara">
								Optionally, enable the smb service to start automatically at boot time:
							</p><pre class="literallayout"># systemctl enable smb</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section><section class="section" id="assembly_setting-acls-on-a-share-that-uses-posix-acls_assembly_setting-up-a-share-that-uses-posix-acls"><div class="titlepage"><div><div><h4 class="title">2.7.1.2. Setting ACLs on a share that uses POSIX ACLs</h4></div></div></div><p>
						This section describes how to set ACLs on a share that uses POSIX ACLs.
					</p><p>
						Shares that use POSIX ACLs support:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Standard Linux ACLs. For details, see <a class="xref" href="index.html#proc_setting-standard-linux-acls_assembly_setting-acls-on-a-share-that-uses-posix-acls" title="2.7.1.2.1. Setting standard Linux ACLs">Section 2.7.1.2.1, “Setting standard Linux ACLs”</a>.
							</li><li class="listitem">
								Extended ACLs. For details, see <a class="xref" href="index.html#proc_setting-extended-acls_assembly_setting-acls-on-a-share-that-uses-posix-acls" title="2.7.1.2.2. Setting extended ACLs">Section 2.7.1.2.2, “Setting extended ACLs”</a>.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A share with POSIX ACLs has been set up according to <a class="xref" href="index.html#proc_adding-a-share-that-uses-posix-acls_assembly_setting-up-a-share-that-uses-posix-acls" title="2.7.1.1. Adding a share that uses POSIX ACLs">Section 2.7.1.1, “Adding a share that uses POSIX ACLs”</a>.
							</li></ul></div><section class="section" id="proc_setting-standard-linux-acls_assembly_setting-acls-on-a-share-that-uses-posix-acls"><div class="titlepage"><div><div><h5 class="title">2.7.1.2.1. Setting standard Linux ACLs</h5></div></div></div><p>
							The standard ACLs on Linux support setting permissions for one owner, one group, and for all other undefined users. You can use the <code class="literal">chown</code>, <code class="literal">chgrp</code>, and <code class="literal">chmod</code> utility to update the ACLs. If you require precise control, then you use the more complex POSIX ACLs, see <a class="xref" href="index.html#proc_setting-extended-acls_assembly_setting-acls-on-a-share-that-uses-posix-acls" title="2.7.1.2.2. Setting extended ACLs">Section 2.7.1.2.2, “Setting extended ACLs”</a>.
						</p><p>
							The following procedure sets the owner of the <code class="literal filename">/srv/samba/example/</code> directory to the <code class="literal">root</code> user, grant read and write permissions to the <code class="literal">Domain Users</code> group, and deny access to all other users.
						</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								
<pre class="literallayout"># chown root:"Domain Users" /srv/samba/example/
# chmod 2770 /srv/samba/example/</pre>

							</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Enabling the set-group-ID (SGID) bit on a directory automatically sets the default group for all new files and subdirectories to that of the directory group, instead of the usual behavior of setting it to the primary group of the user who created the new directory entry.
							</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									For further details about permissions, see the <code class="literal">chown(1)</code> and <code class="literal">chmod(1)</code> man pages.
								</li></ul></div></section><section class="section" id="proc_setting-extended-acls_assembly_setting-acls-on-a-share-that-uses-posix-acls"><div class="titlepage"><div><div><h5 class="title">2.7.1.2.2. Setting extended ACLs</h5></div></div></div><p>
							If the file system the shared directory is stored on supports extended ACLs, you can use them to set complex permissions. Extended ACLs can contain permissions for multiple users and groups.
						</p><p>
							Extended POSIX ACLs enable you to configure complex ACLs with multiple users and groups. However, you can only set the following permissions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									No access
								</li><li class="listitem">
									Read access
								</li><li class="listitem">
									Write access
								</li><li class="listitem">
									Full control
								</li></ul></div><p>
							If you require the fine-granular Windows permissions, such as <code class="literal">Create folder / append data</code>, configure the share to use Windows ACLs. See <a class="xref" href="index.html#assembly_setting-up-a-share-that-uses-windows-acls_assembly_configuring-file-shares-on-a-samba-server" title="2.7.2. Setting up a share that uses Windows ACLs">Section 2.7.2, “Setting up a share that uses Windows ACLs”</a>.
						</p><p>
							The following procedure shows how to enable extended ACLs on a share. Additionally, it contains an example about setting extended ACLs.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Enable the following parameter in the share’s section in the <code class="literal filename">/etc/samba/smb.conf</code> file to enable ACL inheritance of extended ACLs:
								</p><pre class="literallayout">inherit acls = yes</pre><p class="simpara">
									For details, see the parameter description in the <code class="literal">smb.conf(5</code>) man page.
								</p></li><li class="listitem"><p class="simpara">
									Restart the <code class="literal">smb</code> service:
								</p><pre class="literallayout"># systemctl restart smb</pre></li><li class="listitem"><p class="simpara">
									Set the ACLs on the directory. For example:
								</p><div class="example" id="ex.setting-extended-acls_proc_setting-extended-acls_assembly_setting-acls-on-a-share-that-uses-posix-acls"><p class="title"><strong>Example 2.3. Setting Extended ACLs</strong></p><div class="example-contents"><p>
										The following procedure sets read, write, and execute permissions for the <code class="literal">Domain Admins</code> group, read, and execute permissions for the <code class="literal">Domain Users</code> group, and deny access to everyone else on the <code class="literal filename">/srv/samba/example/</code> directory:
									</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
												Disable auto-granting permissions to the primary group of user accounts:
											</p><pre class="literallayout"># setfacl -m group::--- /srv/samba/example/
# setfacl -m default:group::--- /srv/samba/example/</pre><p class="simpara">
												The primary group of the directory is additionally mapped to the dynamic <code class="literal">CREATOR GROUP</code> principal. When you use extended POSIX ACLs on a Samba share, this principal is automatically added and you cannot remove it.
											</p></li><li class="listitem"><p class="simpara">
												Set the permissions on the directory:
											</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
														Grant read, write, and execute permissions to the <code class="literal">Domain Admins</code> group:
													</p><pre class="literallayout"># setfacl -m group:"<span class="emphasis"><em>DOMAIN</em></span>\Domain Admins":rwx /srv/samba/example/</pre></li><li class="listitem"><p class="simpara">
														Grant read and execute permissions to the <code class="literal">Domain Users</code> group:
													</p><pre class="literallayout"># setfacl -m group:"<span class="emphasis"><em>DOMAIN</em></span>\Domain Users":r-x /srv/samba/example/</pre></li><li class="listitem"><p class="simpara">
														Set permissions for the <code class="literal">other</code> ACL entry to deny access to users that do not match the other ACL entries:
													</p><pre class="literallayout"># setfacl -R -m other::--- /srv/samba/example/</pre></li></ol></div><p class="simpara">
												These settings apply only to this directory. In Windows, these ACLs are mapped to the <code class="literal">This folder only</code> mode.
											</p></li><li class="listitem"><p class="simpara">
												To enable the permissions set in the previous step to be inherited by new file system objects created in this directory:
											</p><pre class="literallayout"># setfacl -m default:group:"<span class="emphasis"><em>DOMAIN</em></span>\Domain Admins":rwx /srv/samba/example/
# setfacl -m default:group:"<span class="emphasis"><em>DOMAIN</em></span>\Domain Users":r-x /srv/samba/example/
# setfacl -m default:other::--- /srv/samba/example/</pre><p class="simpara">
												With these settings, the <code class="literal">This folder only</code> mode for the principals is now set to <code class="literal">This folder, subfolders, and files</code>.
											</p></li></ol></div><p>
										Samba maps the permissions set in the procedure to the following Windows ACLs:
									</p><div class="informaltable" id="table_example_proc_setting-extended-acls_assembly_setting-acls-on-a-share-that-uses-posix-acls"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 40%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col><col style="width: 40%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140042824394640" scope="col">Principal</th><th align="left" valign="top" id="idm140042824393552" scope="col">Access</th><th align="left" valign="top" id="idm140042824392464" scope="col">Applies to</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140042824394640"> <p>
														<span class="emphasis"><em>Domain</em></span>\Domain Admins
													</p>
													 </td><td align="left" valign="top" headers="idm140042824393552"> <p>
														Full control
													</p>
													 </td><td align="left" valign="top" headers="idm140042824392464"> <p>
														This folder, subfolders, and files
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042824394640"> <p>
														<span class="emphasis"><em>Domain</em></span>\Domain Users
													</p>
													 </td><td align="left" valign="top" headers="idm140042824393552"> <p>
														Read &amp; execute
													</p>
													 </td><td align="left" valign="top" headers="idm140042824392464"> <p>
														This folder, subfolders, and files
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042824394640"> <p>
														<code class="literal">Everyone</code> <a href="index.html#ftn.idm140042827179552" class="footnote"><sup class="footnote" id="idm140042827179552">[a]</sup></a>
													</p>
													 </td><td align="left" valign="top" headers="idm140042824393552"> <p>
														None
													</p>
													 </td><td align="left" valign="top" headers="idm140042824392464"> <p>
														This folder, subfolders, and files
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042824394640"> <p>
														<span class="emphasis"><em>owner</em></span> (<span class="emphasis"><em>Unix User\owner</em></span>) <a href="index.html#ftn.idm140042826995040" class="footnote"><sup class="footnote" id="idm140042826995040">[b]</sup></a>
													</p>
													 </td><td align="left" valign="top" headers="idm140042824393552"> <p>
														Full control
													</p>
													 </td><td align="left" valign="top" headers="idm140042824392464"> <p>
														This folder only
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042824394640"> <p>
														<span class="emphasis"><em>primary_group</em></span> (<span class="emphasis"><em>Unix User\primary_group</em></span>) <a href="index.html#ftn.idm140042826106912" class="footnote"><sup class="footnote" id="idm140042826106912">[c]</sup></a>
													</p>
													 </td><td align="left" valign="top" headers="idm140042824393552"> <p>
														None
													</p>
													 </td><td align="left" valign="top" headers="idm140042824392464"> <p>
														This folder only
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042824394640"> <p>
														<code class="literal">CREATOR OWNER</code> <a href="index.html#ftn.idm140042826100160" class="footnote"><sup class="footnote" id="idm140042826100160">[d]</sup></a> <a href="index.html#ftn.sambawinaclcreatorowner" class="footnote"><sup class="footnote" id="sambawinaclcreatorowner">[e]</sup></a>
													</p>
													 </td><td align="left" valign="top" headers="idm140042824393552"> <p>
														Full control
													</p>
													 </td><td align="left" valign="top" headers="idm140042824392464"> <p>
														Subfolders and files only
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042824394640"> <p>
														<code class="literal">CREATOR GROUP</code> <a href="index.html#ftn.sambawinaclcreatorowner" class="footnoteref"><sup class="footnoteref">[e]</sup></a> <a href="index.html#ftn.idm140042827230176" class="footnote"><sup class="footnote" id="idm140042827230176">[f]</sup></a>
													</p>
													 </td><td align="left" valign="top" headers="idm140042824393552"> <p>
														None
													</p>
													 </td><td align="left" valign="top" headers="idm140042824392464"> <p>
														Subfolders and files only
													</p>
													 </td></tr></tbody><tbody class="footnotes"><tr><td colspan="3"><div id="ftn.idm140042827179552" class="footnote"><div class="para"><a href="index.html#idm140042827179552" class="simpara"><sup class="simpara">[a] </sup></a>
															Samba maps the permissions for this principal from the <code class="literal">other</code> ACL entry.
														</div></div><div id="ftn.idm140042826995040" class="footnote"><div class="para"><a href="index.html#idm140042826995040" class="simpara"><sup class="simpara">[b] </sup></a>
															Samba maps the owner of the directory to this entry.
														</div></div><div id="ftn.idm140042826106912" class="footnote"><div class="para"><a href="index.html#idm140042826106912" class="simpara"><sup class="simpara">[c] </sup></a>
															Samba maps the primary group of the directory to this entry.
														</div></div><div id="ftn.idm140042826100160" class="footnote"><div class="para"><a href="index.html#idm140042826100160" class="simpara"><sup class="simpara">[d] </sup></a>
															On new file system objects, the creator inherits automatically the permissions of this principal.
														</div></div><div id="ftn.sambawinaclcreatorowner" class="footnote"><div class="para"><a href="index.html#sambawinaclcreatorowner" class="simpara"><sup class="simpara">[e] </sup></a>
															Configuring or removing these principals from the ACLs not supported on shares that use POSIX ACLs.
														</div></div><div id="ftn.idm140042827230176" class="footnote"><div class="para"><a href="index.html#idm140042827230176" class="simpara"><sup class="simpara">[f] </sup></a>
															On new file system objects, the creator’s primary group inherits automatically the permissions of this principal.
														</div></div></td></tr></tbody></table></div></div></div></li></ol></div></section></section><section class="section" id="assembly_setting-permissions-on-a-share-that-uses-posix-acls_assembly_setting-up-a-share-that-uses-posix-acls"><div class="titlepage"><div><div><h4 class="title">2.7.1.3. Setting permissions on a share that uses POSIX ACLs</h4></div></div></div><p>
						Optionally, to limit or grant access to a Samba share, you can set certain parameters in the share’s section in the <code class="literal filename">/etc/samba/smb.conf</code> file.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Share-based permissions manage if a user, group, or host is able to access a share. These settings do not affect file system ACLs.
						</p></div></div><p>
						Use share-based settings to restrict access to shares, for example, to deny access from specific hosts.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A share with POSIX ACLs has been set up according to <a class="xref" href="index.html#proc_adding-a-share-that-uses-posix-acls_assembly_setting-up-a-share-that-uses-posix-acls" title="2.7.1.1. Adding a share that uses POSIX ACLs">Section 2.7.1.1, “Adding a share that uses POSIX ACLs”</a>.
							</li></ul></div><section class="section" id="proc_configuring-user-and-group-based-share-access_assembly_setting-permissions-on-a-share-that-uses-posix-acls"><div class="titlepage"><div><div><h5 class="title">2.7.1.3.1. Configuring user and group-based share access</h5></div></div></div><p>
							User and group-based access control enables you to grant or deny access to a share for certain users and groups.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									For example, to enable all members of the <code class="literal">Domain Users</code> group to access a share while access is denied for the <code class="literal">user</code> account, add the following parameters to the share’s configuration:
								</p><pre class="literallayout">valid users = +<span class="emphasis"><em>DOMAIN</em></span>\"Domain Users"
invalid users = <span class="emphasis"><em>DOMAIN</em></span>\user</pre><p class="simpara">
									The <code class="literal">invalid users</code> parameter has a higher priority than the <code class="literal">valid users</code> parameter. For example, if the <code class="literal">user</code> account is a member of the <code class="literal">Domain Users</code> group, access is denied to this account when you use the previous example.
								</p></li><li class="listitem"><p class="simpara">
									Reload the Samba configuration:
								</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									For further details, see the parameter descriptions in the <code class="literal">smb.conf(5)</code> man page.
								</li></ul></div></section><section class="section" id="proc_configuring-host-based-share-access_assembly_setting-permissions-on-a-share-that-uses-posix-acls"><div class="titlepage"><div><div><h5 class="title">2.7.1.3.2. Configuring host-based share access</h5></div></div></div><p>
							Host-based access control enables you to grant or deny access to a share based on client’s host names, IP addresses, or IP range.
						</p><p>
							The following procedure explains how to enable the <code class="literal">127.0.0.1</code> IP address, the <code class="literal">192.0.2.0/24</code> IP range, and the <code class="literal">client1.example.com</code> host to access a share, and additionally deny access for the <code class="literal">client2.example.com</code> host:
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Add the following parameters to the configuration of the share in the <code class="literal filename">/etc/samba/smb.conf</code> file:
								</p><pre class="literallayout">hosts allow = 127.0.0.1 192.0.2.0/24 client1.example.com
hosts deny = client2.example.com</pre><p class="simpara">
									The <code class="literal">hosts deny</code> parameter has a higher priority than <code class="literal">hosts allow</code>. For example, if <code class="literal">client1.example.com</code> resolves to an IP address that is listed in the <code class="literal">hosts allow</code> parameter, access for this host is denied.
								</p></li><li class="listitem"><p class="simpara">
									Reload the Samba configuration:
								</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									For further details, see the parameter descriptions in the <code class="literal">smb.conf(5)</code> man page.
								</li></ul></div></section></section></section><section class="section" id="assembly_setting-up-a-share-that-uses-windows-acls_assembly_configuring-file-shares-on-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.7.2. Setting up a share that uses Windows ACLs</h3></div></div></div><p>
					Samba supports setting Windows ACLs on shares and file system object. This enables you to:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Use the fine-granular Windows ACLs
						</li><li class="listitem">
							Manage share permissions and file system ACLs using Windows
						</li></ul></div><p>
					Alternatively, you can configure a share to use POSIX ACLs. For details, see <a class="xref" href="index.html#assembly_setting-up-a-share-that-uses-posix-acls_assembly_configuring-file-shares-on-a-samba-server" title="2.7.1. Setting up a share that uses POSIX ACLs">Section 2.7.1, “Setting up a share that uses POSIX ACLs”</a>.
				</p><p>
					Parts of this section were adopted from the <a class="link" href="https://wiki.samba.org/index.php/Setting_up_a_Share_Using_Windows_ACLs">Setting up a Share Using Windows ACLs</a> documentation published in the Samba Wiki. License: <a class="link" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Authors and contributors: See the <a class="link" href="https://wiki.samba.org/index.php?title=Setting_up_a_Share_Using_Windows_ACLs&amp;action=history">history</a> tab on the Wiki page.
				</p><section class="section" id="proc_granting-the-sediskoperatorprivilege-privilege_assembly_setting-up-a-share-that-uses-windows-acls"><div class="titlepage"><div><div><h4 class="title">2.7.2.1. Granting the SeDiskOperatorPrivilege privilege</h4></div></div></div><p>
						Only users and groups having the <code class="literal">SeDiskOperatorPrivilege</code> privilege granted can configure permissions on shares that use Windows ACLs.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								For example, to grant the <code class="literal">SeDiskOperatorPrivilege</code> privilege to the <code class="literal"><span class="emphasis"><em>DOMAIN</em></span>\Domain Admins</code> group:
							</p><pre class="literallayout"># net rpc rights grant "<span class="emphasis"><em>DOMAIN</em></span>\Domain Admins" SeDiskOperatorPrivilege \
       -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
Successfully granted rights.</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									In a domain environment, grant <code class="literal">SeDiskOperatorPrivilege</code> to a domain group. This enables you to centrally manage the privilege by updating a user’s group membership.
								</p></div></div></li><li class="listitem"><p class="simpara">
								To list all users and groups having <code class="literal">SeDiskOperatorPrivilege</code> granted:
							</p><pre class="literallayout"># net rpc rights list privileges SeDiskOperatorPrivilege \
       -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter administrator's password:
SeDiskOperatorPrivilege:
  BUILTIN\Administrators
  <span class="emphasis"><em>DOMAIN</em></span>\Domain Admins</pre></li></ol></div></section><section class="section" id="proc_enabling-windows-acl-support_assembly_setting-up-a-share-that-uses-windows-acls"><div class="titlepage"><div><div><h4 class="title">2.7.2.2. Enabling Windows ACL support</h4></div></div></div><p>
						To configure shares that support Windows ACLs, you must enable this feature in Samba.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A user share is configured on the Samba server.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To enable it globally for all shares, add the following settings to the <code class="literal">[global]</code> section of the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout">vfs objects = acl_xattr
map acl inherit = yes
store dos attributes = yes</pre><p class="simpara">
								Alternatively, you can enable Windows ACL support for individual shares, by adding the same parameters to a share’s section instead.
							</p></li><li class="listitem"><p class="simpara">
								Restart the <code class="literal">smb</code> service:
							</p><pre class="literallayout"># systemctl restart smb</pre></li></ol></div></section><section class="section" id="proc_adding-a-share-that-uses-windows-acls_assembly_setting-up-a-share-that-uses-windows-acls"><div class="titlepage"><div><div><h4 class="title">2.7.2.3. Adding a share that uses Windows ACLs</h4></div></div></div><p>
						This section describes how to create a share named <code class="literal">example</code>, that shares the content of the <code class="literal filename">/srv/samba/example/</code> directory, and uses Windows ACLs.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the folder if it does not exists. For example:
							</p><pre class="literallayout"># mkdir -p /srv/samba/example/</pre></li><li class="listitem"><p class="simpara">
								If you run SELinux in <code class="literal">enforcing</code> mode, set the <code class="literal">samba_share_t</code> context on the directory:
							</p><pre class="literallayout"># semanage fcontext -a -t samba_share_t "/srv/samba/example(/.*)?"
# restorecon -Rv /srv/samba/example/</pre></li><li class="listitem"><p class="simpara">
								Add the example share to the <code class="literal filename">/etc/samba/smb.conf</code> file. For example, to add the share write-enabled:
							</p><pre class="literallayout">[example]
	path = /srv/samba/example/
	read only = no</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Regardless of the file system ACLs; if you do not set <code class="literal">read only = no</code>, Samba shares the directory in read-only mode.
								</p></div></div></li><li class="listitem"><p class="simpara">
								If you have not enabled Windows ACL support in the <code class="literal">[global]</code> section for all shares, add the following parameters to the <code class="literal">[example]</code> section to enable this feature for this share:
							</p><pre class="literallayout">vfs objects = acl_xattr
map acl inherit = yes
store dos attributes = yes</pre></li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Open the required ports and reload the firewall configuration using the <code class="literal">firewall-cmd</code> utility:
							</p><pre class="literallayout"># firewall-cmd --permanent --add-service=samba
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
								Restart the <code class="literal">smb</code> service:
							</p><pre class="literallayout"># systemctl restart smb</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section><section class="section" id="proc_managing-share-permissions-and-file-system-acls-of-a-share-that-uses-windows-acls_assembly_setting-up-a-share-that-uses-windows-acls"><div class="titlepage"><div><div><h4 class="title">2.7.2.4. Managing share permissions and file system ACLs of a share that uses Windows ACLs</h4></div></div></div><p>
						To manage share permissions and file system ACLs on a Samba share that uses Windows ACLs, use a Windows applications, such as <code class="literal">Computer Management</code>. For details, see the Windows documentation. Alternatively, use the <code class="literal">smbcacls</code> utility to manage ACLs.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							To modify the file system permissions from Windows, you must use an account that has the <code class="literal">SeDiskOperatorPrivilege</code> privilege granted.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#assembly_managing-acls-on-an-smb-share-using-smbcacls_assembly_configuring-file-shares-on-a-samba-server" title="2.7.3. Managing ACLs on an SMB share using smbcacls">Section 2.7.3, “Managing ACLs on an SMB share using smbcacls”</a>
							</li><li class="listitem">
								<a class="xref" href="index.html#proc_granting-the-sediskoperatorprivilege-privilege_assembly_setting-up-a-share-that-uses-windows-acls" title="2.7.2.1. Granting the SeDiskOperatorPrivilege privilege">Section 2.7.2.1, “Granting the SeDiskOperatorPrivilege privilege”</a>
							</li></ul></div></section></section><section class="section" id="assembly_managing-acls-on-an-smb-share-using-smbcacls_assembly_configuring-file-shares-on-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.7.3. Managing ACLs on an SMB share using smbcacls</h3></div></div></div><p>
					The <code class="literal">smbcacls</code> utility can list, set, and delete ACLs of files and directories stored on an SMB share. You can use <code class="literal">smbcacls</code> to manage file system ACLs:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							On a local or remote Samba server that uses advanced Windows ACLs or POSIX ACLs
						</li><li class="listitem">
							On Red Hat Enterprise Linux to remotely manage ACLs on a share hosted on Windows
						</li></ul></div><section class="section" id="con_access-control-entries_assembly_managing-acls-on-an-smb-share-using-smbcacls"><div class="titlepage"><div><div><h4 class="title">2.7.3.1. Access control entries</h4></div></div></div><p>
						Each ACL entry of a file system object contains Access Control Entries (ACE) in the following format:
					</p><pre class="literallayout"><span class="emphasis"><em>security_principal</em></span>:<span class="emphasis"><em>access_right</em></span>/<span class="emphasis"><em>inheritance_information</em></span>/<span class="emphasis"><em>permissions</em></span></pre><div class="example" id="idm140042827801232"><p class="title"><strong>Example 2.4. Access control entries</strong></p><div class="example-contents"><p>
							If the <code class="literal">AD\Domain Users</code> group has <code class="literal">Modify</code> permissions that apply to <code class="literal">This folder, subfolders, and files</code> on Windows, the ACL contains the following ACE:
						</p><pre class="literallayout">AD\Domain Users:ALLOWED/OI|CI/CHANGE</pre></div></div><p>
						An ACE contains the following parts:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Security principal</span></dt><dd>
									The security principal is the user, group, or SID the permissions in the ACL are applied to.
								</dd><dt><span class="term">Access right</span></dt><dd>
									Defines if access to an object is granted or denied. The value can be <code class="literal">ALLOWED</code> or <code class="literal">DENIED</code>.
								</dd><dt><span class="term">Inheritance information</span></dt><dd><p class="simpara">
									The following values exist:
								</p><div class="table" id="idm140042824314496"><p class="title"><strong>Table 2.1. Inheritance settings</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 14%; " class="col_1"><!--Empty--></col><col style="width: 29%; " class="col_2"><!--Empty--></col><col style="width: 57%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042824308736" scope="col">Value</th><th style="text-align: left; vertical-align: top; " id="idm140042824307648" scope="col">Description</th><th style="text-align: left; vertical-align: top; " id="idm140042822620192" scope="col">Maps to</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042824308736"> <p>
													<code class="literal">OI</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042824307648"> <p>
													Object Inherit
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042822620192"> <p>
													This folder and files
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042824308736"> <p>
													<code class="literal">CI</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042824307648"> <p>
													Container Inherit
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042822620192"> <p>
													This folder and subfolders
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042824308736"> <p>
													<code class="literal">IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042824307648"> <p>
													Inherit Only
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042822620192"> <p>
													The ACE does not apply to the current file or directory
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042824308736"> <p>
													<code class="literal">ID</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042824307648"> <p>
													Inherited
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042822620192"> <p>
													The ACE was inherited from the parent directory
												</p>
												 </td></tr></tbody></table></div></div><p class="simpara">
									Additionally, the values can be combined as follows:
								</p><div class="table" id="idm140042825696016"><p class="title"><strong>Table 2.2. Inheritance settings combinations</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042825827568" scope="col">Value combinations</th><th style="text-align: left; vertical-align: top; " id="idm140042825826480" scope="col">Maps to the Windows <code class="literal">Applies to</code> setting</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042825827568"> <p>
													<code class="literal">OI|CI</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042825826480"> <p>
													This folder, subfolders, and files
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042825827568"> <p>
													<code class="literal">OI|CI|IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042825826480"> <p>
													Subfolders and files only
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042825827568"> <p>
													<code class="literal">CI|IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042825826480"> <p>
													Subfolders only
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042825827568"> <p>
													<code class="literal">OI|IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042825826480"> <p>
													Files only
												</p>
												 </td></tr></tbody></table></div></div></dd><dt><span class="term">Permissions</span></dt><dd><p class="simpara">
									This value can be either a hex value that represents one or more Windows permissions or an <code class="literal">smbcacls</code> alias:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											A hex value that represents one or more Windows permissions.
										</p><p class="simpara">
											The following table displays the advanced Windows permissions and their corresponding value in hex format:
										</p><div class="table" id="table_windows-permissions-hex-values_assembly_managing-acls-on-an-smb-share-using-smbcacls"><p class="title"><strong>Table 2.3. Windows permissions and their corresponding smbcacls value in hex format</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 67%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042827310320" scope="col">Windows permissions</th><th style="text-align: left; vertical-align: top; " id="idm140042827309232" scope="col">Hex values</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Full control
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x001F01FF</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Traverse folder / execute file
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100020</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															List folder / read data
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100001</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Read attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100080</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Read extended attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100008</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Create files / write data
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100002</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Create folders / append data
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100004</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Write attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100100</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Write extended attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100010</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Delete subfolders and files
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00100040</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Delete
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00110000</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Read permissions
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00120000</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Change permissions
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00140000</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827310320"> <p>
															Take ownership
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827309232"> <p>
															<code class="literal">0x00180000</code>
														</p>
														 </td></tr></tbody></table></div></div><p class="simpara">
											Multiple permissions can be combined as a single hex value using the bit-wise <code class="literal">OR</code> operation. For details, see <a class="xref" href="index.html#con_ace-mask-calculation_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="2.7.3.3. ACE mask calculation">Section 2.7.3.3, “ACE mask calculation”</a>.
										</p></li><li class="listitem"><p class="simpara">
											An <code class="literal">smbcacls</code> alias. The following table displays the available aliases:
										</p><div class="table" id="table_smbcacls-aliases_assembly_managing-acls-on-an-smb-share-using-smbcacls"><p class="title"><strong>Table 2.4. Existing smbcacls aliases and their corresponding Windows permission</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042827616368" scope="col"><code class="literal">smbcacls</code> alias</th><th style="text-align: left; vertical-align: top; " id="idm140042827614960" scope="col">Maps to Windows permission</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">R</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Read
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">READ</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Read &amp; execute
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">W</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Special:
														</p>
														 <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
																	Create files / write data
																</li><li class="listitem">
																	Create folders / append data
																</li><li class="listitem">
																	Write attributes
																</li><li class="listitem">
																	Write extended attributes
																</li><li class="listitem">
																	Read permissions
																</li></ul></div>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">D</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Delete
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">P</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Change permissions
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">O</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Take ownership
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">X</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Traverse / execute
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">CHANGE</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Modify
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042827616368"> <p>
															<code class="literal">FULL</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042827614960"> <p>
															Full control
														</p>
														 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												You can combine single-letter aliases when you set permissions. For example, you can set <code class="literal">RD</code> to apply the Windows permission <code class="literal">Read</code> and <code class="literal">Delete</code>. However, you can neither combine multiple non-single-letter aliases nor combine aliases and hex values.
											</p></div></div></li></ul></div></dd></dl></div></section><section class="section" id="proc_displaying-acls-using-smbcacls_assembly_managing-acls-on-an-smb-share-using-smbcacls"><div class="titlepage"><div><div><h4 class="title">2.7.3.2. Displaying ACLs using smbcacls</h4></div></div></div><p>
						To display ACLs on an SMB share, use the <code class="literal">smbcacls</code> utility. If you run <code class="literal">smbcacls</code> without any operation parameter, such as <code class="literal">--add</code>, the utility displays the ACLs of a file system object.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							For example, to list the ACLs of the root directory of the <code class="literal">//server/example</code> share:
						</p></div><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
REVISION:1
CONTROL:SR|PD|DI|DP
OWNER:AD\Administrators
GROUP:AD\Domain Users
ACL:AD\Administrator:ALLOWED/OI|CI/FULL
ACL:AD\Domain Users:ALLOWED/OI|CI/CHANGE
ACL:AD\Domain Guests:ALLOWED/OI|CI/0x00100021</pre><p>
						The output of the command displays:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">REVISION</code>: The internal Windows NT ACL revision of the security descriptor
							</li><li class="listitem">
								<code class="literal">CONTROL</code>: Security descriptor control
							</li><li class="listitem">
								<code class="literal">OWNER</code>: Name or SID of the security descriptor’s owner
							</li><li class="listitem">
								<code class="literal">GROUP</code>: Name or SID of the security descriptor’s group
							</li><li class="listitem">
								<code class="literal">ACL</code> entries. For details, see <a class="xref" href="index.html#con_access-control-entries_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="2.7.3.1. Access control entries">Section 2.7.3.1, “Access control entries”</a>.
							</li></ul></div></section><section class="section" id="con_ace-mask-calculation_assembly_managing-acls-on-an-smb-share-using-smbcacls"><div class="titlepage"><div><div><h4 class="title">2.7.3.3. ACE mask calculation</h4></div></div></div><p>
						In most situations, when you add or update an ACE, you use the <code class="literal">smbcacls</code> aliases listed in <a class="xref" href="index.html#table_smbcacls-aliases_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="Table 2.4. Existing smbcacls aliases and their corresponding Windows permission">Table 2.4, “Existing smbcacls aliases and their corresponding Windows permission”</a>.
					</p><p>
						However, if you want to set advanced Windows permissions as listed in <a class="xref" href="index.html#table_windows-permissions-hex-values_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="Table 2.3. Windows permissions and their corresponding smbcacls value in hex format">Table 2.3, “Windows permissions and their corresponding smbcacls value in hex format”</a>, you must use the bit-wise <code class="literal">OR</code> operation to calculate the correct value. You can use the following shell command to calculate the value:
					</p><pre class="literallayout"># echo $(printf '0x%X' $(( hex_value_1 | hex_value_2 | ... )))</pre><div class="example" id="idm140042825682448"><p class="title"><strong>Example 2.5. Calculating an ACE Mask</strong></p><div class="example-contents"><p>
							You want to set the following permissions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Traverse folder / execute file (0x00100020)
								</li><li class="listitem">
									List folder / read data (0x00100001)
								</li><li class="listitem">
									Read attributes (0x00100080)
								</li></ul></div><p>
							To calculate the hex value for the previous permissions, enter:
						</p><pre class="literallayout"># echo $(printf '0x%X' $(( 0x00100020 | 0x00100001 | 0x00100080 )))
<code class="literal">0x1000A1</code></pre><p>
							Use the returned value when you set or update an ACE.
						</p></div></div></section><section class="section" id="proc_adding-updating-and-removing-an-acl-using-smbcacls_assembly_managing-acls-on-an-smb-share-using-smbcacls"><div class="titlepage"><div><div><h4 class="title">2.7.3.4. Adding, updating, and removing an ACL using smbcacls</h4></div></div></div><p>
						Depending on the parameter you pass to the <code class="literal">smbcacls</code> utility, you can add, update, and remove ACLs from a file or directory.
					</p><h6 id="adding_an_acl">Adding an ACL</h6><p>
						To add an ACL to the root of the <code class="literal">//server/example</code> share that grants <code class="literal">CHANGE</code> permissions for <code class="literal">This folder, subfolders, and files</code> to the <code class="literal">AD\Domain Users</code> group:
					</p><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator \
       --add ACL:"AD\Domain Users":ALLOWED/OI|CI/CHANGE</pre><h6 id="updating_an_acl">Updating an ACL</h6><p>
						Updating an ACL is similar to adding a new ACL. You update an ACL by overriding the ACL using the <code class="literal">--modify</code> parameter with an existing security principal. If <code class="literal">smbcacls</code> finds the security principal in the ACL list, the utility updates the permissions. Otherwise the command fails with an error:
					</p><pre class="literallayout">ACL for SID <span class="emphasis"><em>principal_name</em></span> not found</pre><p>
						For example, to update the permissions of the <code class="literal">AD\Domain Users</code> group and set them to <code class="literal">READ</code> for <code class="literal">This folder, subfolders, and files</code>:
					</p><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator \
       --modify ACL:"AD\Domain Users":ALLOWED/OI|CI/READ</pre><h6 id="deleting_an_acl">Deleting an ACL</h6><p>
						To delete an ACL, pass the <code class="literal">--delete</code> parameter with the exact ACL to the <code class="literal">smbcacls</code> utility. For example:
					</p><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator \
       --delete ACL:"AD\Domain Users":ALLOWED/OI|CI/READ</pre></section></section><section class="section" id="assembly_enabling-users-to-share-directories-on-a-samba-server_assembly_configuring-file-shares-on-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.7.4. Enabling users to share directories on a Samba server</h3></div></div></div><p>
					On a Samba server, you can configure that users can share directories without root permissions.
				</p><section class="section" id="proc_enabling-the-user-shares-feature_assembly_enabling-users-to-share-directories-on-a-samba-server"><div class="titlepage"><div><div><h4 class="title">2.7.4.1. Enabling the user shares feature</h4></div></div></div><p>
						Before users can share directories, the administrator must enable user shares in Samba.
					</p><p>
						For example, to enable only members of the local <code class="literal">example</code> group to create user shares.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the local <code class="literal">example</code> group, if it does not exist:
							</p><pre class="literallayout"># groupadd example</pre></li><li class="listitem"><p class="simpara">
								Prepare the directory for Samba to store the user share definitions and set its permissions properly. For example:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create the directory:
									</p><pre class="literallayout"># mkdir -p /var/lib/samba/usershares/</pre></li><li class="listitem"><p class="simpara">
										Set write permissions for the <code class="literal">example</code> group:
									</p><pre class="literallayout"># chgrp example /var/lib/samba/usershares/
# chmod 1770 /var/lib/samba/usershares/</pre></li><li class="listitem">
										Set the sticky bit to prevent users to rename or delete files stored by other users in this directory.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Edit the <code class="literal filename">/etc/samba/smb.conf</code> file and add the following to the <code class="literal">[global]</code> section:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Set the path to the directory you configured to store the user share definitions. For example:
									</p><pre class="literallayout">usershare path = /var/lib/samba/usershares/</pre></li><li class="listitem"><p class="simpara">
										Set how many user shares Samba allows to be created on this server. For example:
									</p><pre class="literallayout">usershare max shares = 100</pre><p class="simpara">
										If you use the default of <code class="literal">0</code> for the <code class="literal">usershare max shares</code> parameter, user shares are disabled.
									</p></li><li class="listitem"><p class="simpara">
										Optionally, set a list of absolute directory paths. For example, to configure that Samba only allows to share subdirectories of the <code class="literal filename">/data</code> and <code class="literal filename">/srv</code> directory to be shared, set:
									</p><pre class="literallayout">usershare prefix allow list = /data /srv</pre></li></ol></div><p class="simpara">
								For a list of further user share-related parameters you can set, see the <code class="literal">USERSHARES</code> section in the <code class="literal">smb.conf(5)</code> man page.
							</p></li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Reload the Samba configuration:
							</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><p>
						Users are now able to create user shares. For details, see <a class="xref" href="index.html#proc_adding-a-user-share_assembly_enabling-users-to-share-directories-on-a-samba-server" title="2.7.4.2. Adding a user share">Section 2.7.4.2, “Adding a user share”</a>.
					</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section><section class="section" id="proc_adding-a-user-share_assembly_enabling-users-to-share-directories-on-a-samba-server"><div class="titlepage"><div><div><h4 class="title">2.7.4.2. Adding a user share</h4></div></div></div><p>
						After you configured Samba according to <a class="xref" href="index.html#proc_enabling-the-user-shares-feature_assembly_enabling-users-to-share-directories-on-a-samba-server" title="2.7.4.1. Enabling the user shares feature">Section 2.7.4.1, “Enabling the user shares feature”</a>, users can share directories on the Samba server without <code class="literal">root</code> permissions by running the <code class="literal">net usershare add</code> command.
					</p><p>
						Synopsis of the <code class="literal">net usershare add</code> command:
					</p><p>
						<code class="literal">net usershare add</code> share_name path [[ comment ] | [ ACLs ]] [ guest_ok=y|n ]
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If you set ACLs when you create a user share, you must specify the comment parameter prior to the ACLs. To set an empty comment, use an empty string in double quotes.
						</p></div></div><p>
						Note that users can only enable guest access on a user share, if the administrator set <code class="literal">usershare allow guests = yes</code> in the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file.
					</p><div class="example" id="idm140042814160224"><p class="title"><strong>Example 2.6. Adding a user share</strong></p><div class="example-contents"><p>
							A user wants to share the <code class="literal filename">/srv/samba/</code> directory on a Samba server. The share should be named <code class="literal">example</code>, have no comment set, and should be accessible by guest users. Additionally, the share permissions should be set to full access for the <code class="literal">AD\Domain Users</code> group and read permissions for other users. To add this share, run as the user:
						</p><pre class="literallayout">$ net usershare add example /srv/samba/ "" \
       "AD\Domain Users":F,Everyone:R guest_ok=yes</pre></div></div></section><section class="section" id="proc_updating-settings-of-a-user-share_assembly_enabling-users-to-share-directories-on-a-samba-server"><div class="titlepage"><div><div><h4 class="title">2.7.4.3. Updating settings of a user share</h4></div></div></div><p>
						To update settings of a user share, override the share by using the <code class="literal">net usershare add</code> command with the same share name and the new settings. See <a class="xref" href="index.html#proc_adding-a-user-share_assembly_enabling-users-to-share-directories-on-a-samba-server" title="2.7.4.2. Adding a user share">Section 2.7.4.2, “Adding a user share”</a>.
					</p></section><section class="section" id="proc_displaying-information-about-existing-user-shares_assembly_enabling-users-to-share-directories-on-a-samba-server"><div class="titlepage"><div><div><h4 class="title">2.7.4.4. Displaying information about existing user shares</h4></div></div></div><p>
						Users can enter the <code class="literal">net usershare info</code> command on a Samba server to display user shares and their settings.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A user share is configured on the Samba server.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To display all user shares created by any user:
							</p><pre class="literallayout">$ net usershare info -l
[<span class="emphasis"><em>share_1</em></span>]
path=<span class="emphasis"><em>/srv/samba/</em></span>
comment=
usershare_acl=<span class="emphasis"><em>Everyone:R,host_name\user:F,</em></span>
guest_ok=<span class="emphasis"><em>y</em></span>
...</pre><p class="simpara">
								To list only shares created by the user who runs the command, omit the <code class="literal">-l</code> parameter.
							</p></li><li class="listitem"><p class="simpara">
								To display only the information about specific shares, pass the share name or wild cards to the command. For example, to display the information about shares whose name starts with <code class="literal">share_</code>:
							</p><pre class="literallayout">$ net usershare info -l share_*</pre></li></ol></div></section><section class="section" id="proc_listing-user-shares_assembly_enabling-users-to-share-directories-on-a-samba-server"><div class="titlepage"><div><div><h4 class="title">2.7.4.5. Listing user shares</h4></div></div></div><p>
						If you want to list only the available user shares without their settings on a Samba server, use the <code class="literal">net usershare list</code> command.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A user share is configured on the Samba server.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To list the shares created by any user:
							</p><pre class="literallayout">$ net usershare list -l
<span class="emphasis"><em>share_1</em></span>
<span class="emphasis"><em>share_2</em></span>
...</pre><p class="simpara">
								To list only shares created by the user who runs the command, omit the <code class="literal">-l</code> parameter.
							</p></li><li class="listitem"><p class="simpara">
								To list only specific shares, pass the share name or wild cards to the command. For example, to list only shares whose name starts with <code class="literal">share_</code>:
							</p><pre class="literallayout">$ net usershare list -l share_*</pre></li></ol></div></section><section class="section" id="proc_deleting-a-user-share_assembly_enabling-users-to-share-directories-on-a-samba-server"><div class="titlepage"><div><div><h4 class="title">2.7.4.6. Deleting a user share</h4></div></div></div><p>
						To delete a user share, use the command <code class="literal">net usershare delete</code> command as the user who created the share or as the <code class="literal">root</code> user.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								A user share is configured on the Samba server.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							
<pre class="literallayout">$ net usershare delete <span class="emphasis"><em>share_name</em></span></pre>

						</p></div></section></section><section class="section" id="proc_enabling-guest-access-to-a-share_assembly_configuring-file-shares-on-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.7.5. Enabling guest access to a share</h3></div></div></div><p>
					In certain situations, you want to share a directory to which users can connect without authentication. To configure this, enable guest access on a share.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Shares that do not require authentication can be a security risk.
					</p></div></div><p>
					If guest access is enabled on a share, Samba maps guest connections to the operating system account set in the <code class="literal">guest account</code> parameter. Guest users can access files on this share if at least one of the following conditions is satisfied:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The account is listed in file system ACLs
						</li><li class="listitem">
							The POSIX permissions for <code class="literal">other</code> users allow it
						</li></ul></div><div class="example" id="idm140042815493136"><p class="title"><strong>Example 2.7. Guest share permissions</strong></p><div class="example-contents"><p>
						If you configured Samba to map the guest account to <code class="literal">nobody</code>, which is the default, the ACLs in the following example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Allow guest users to read <code class="literal">file1.txt</code>
							</li><li class="listitem">
								Allow guest users to read and modify <code class="literal">file2.txt</code>
							</li><li class="listitem">
								Prevent guest users to read or modify <code class="literal">file3.txt</code>
							</li></ul></div><pre class="literallayout">-rw-r--r--. 1 root       root      1024 1. Sep 10:00 file1.txt
-rw-r-----. 1 nobody     root      1024 1. Sep 10:00 file2.txt
-rw-r-----. 1 root       root      1024 1. Sep 10:00 file3.txt</pre></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If this is the first guest share you set up on this server:
								</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p class="simpara">
											Set <code class="literal">map to guest = Bad User</code> in the <code class="literal">[global]</code> section:
										</p><pre class="literallayout">[global]
        ...
        map to guest = Bad User</pre><p class="simpara">
											With this setting, Samba rejects login attempts that use an incorrect password unless the user name does not exist. If the specified user name does not exist and guest access is enabled on a share, Samba treats the connection as a guest log in.
										</p></li><li class="listitem"><p class="simpara">
											By default, Samba maps the guest account to the <code class="literal">nobody</code> account on Red Hat Enterprise Linux. Alternatively, you can set a different account. For example:
										</p><pre class="literallayout">[global]
        ...
        guest account = user_name</pre><p class="simpara">
											The account set in this parameter must exist locally on the Samba server. For security reasons, Red Hat recommends using an account that does not have a valid shell assigned.
										</p></li></ol></div></li><li class="listitem"><p class="simpara">
									Add the <code class="literal">guest ok = yes</code> setting to the <code class="literal">[example]</code> share section:
								</p><pre class="literallayout">[example]
        ...
        guest ok = yes</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
							Reload the Samba configuration:
						</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
						</li></ul></div></section><section class="section" id="optimizing-the-samba-configuration-for-providing-file-shares-for-macos-clients_assembly_configuring-file-shares-on-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.7.6. Optimizing the Samba configuration for providing file shares for macOS clients</h3></div></div></div><p>
					The <code class="literal systemitem">fruit</code> virtual file system (VFS) Samba module provides enhanced compatibility with Apple server message block (SMB) clients. This section describes how to configure the <code class="literal systemitem">fruit</code> module for all Samba shares hosted on the server.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat recommends enabling the <code class="literal systemitem">fruit</code> module globally. Clients using macOS negotiate the server SMB2 Apple (AAPL) protocol extensions when the client establishes the first connection to the server. If the client first connects to a share without AAPL extensions enabled, the client does not use the extensions for any share of the server.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Samba is configured as a file server.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/samba/smb.conf</code> file, and enable the <code class="literal systemitem">fruit</code> and <code class="literal systemitem">streams_xattr</code> VFS modules in the <code class="literal systemitem">[global]</code> section:
						</p><pre class="literallayout">vfs objects = fruit streams_xattr</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								You must enable the <code class="literal systemitem">fruit</code> module before enabling <code class="literal systemitem">streams_xattr</code>. The <code class="literal systemitem">fruit</code> module uses alternate data streams (ADS). For this reason, you must also enable the <code class="literal systemitem">streams_xattr</code> module.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Optionally, to provide macOS Time Machine support on a share, add the following setting to the share configuration in the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout">fruit:time machine = yes</pre></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
							Reload the Samba configuration:
						</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For further details about the <code class="literal systemitem">fruit</code> VFS module, see the <code class="literal citetitle">vfs_fruit(8)</code> man page.
						</li><li class="listitem">
							For details about configuring file shares, see <a class="xref" href="index.html#assembly_configuring-file-shares-on-a-samba-server_assembly_using-samba-as-a-server" title="2.7. Configuring file shares on a Samba server">Section 2.7, “Configuring file shares on a Samba server”</a>.
						</li></ul></div></section></section><section class="section" id="assembly_setting-up-samba-as-a-print-server_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.8. Setting up Samba as a print server</h2></div></div></div><p>
				If you set up Samba as a print server, clients in your network can use Samba to print. Additionally, Windows clients can, if configured, download the driver from the Samba server.
			</p><p>
				Parts of this section were adopted from the <a class="link" href="https://wiki.samba.org/index.php/Setting_up_Samba_as_a_Print_Server">Setting up Samba as a Print Server</a> documentation published in the Samba Wiki. License: <a class="link" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Authors and contributors: See the <a class="link" href="https://wiki.samba.org/index.php?title=Setting_up_Samba_as_a_Print_Server&amp;action=history">history</a> tab on the Wiki page.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					Samba has been set up in one of the following modes:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="index.html#assembly_setting-up-samba-as-a-standalone-server_assembly_using-samba-as-a-server" title="2.4. Setting up Samba as a standalone server">Standalone server</a>
					</li><li class="listitem">
						<a class="link" href="index.html#assembly_setting-up-samba-as-an-ad-domain-member-server_assembly_using-samba-as-a-server" title="2.5. Setting up Samba as an AD domain member server">Domain member</a>
					</li></ul></div><section class="section" id="proc_the-samba-spoolssd-service_assembly_setting-up-samba-as-a-print-server"><div class="titlepage"><div><div><h3 class="title">2.8.1. The Samba spoolssd service</h3></div></div></div><p>
					The Samba <code class="literal">spoolssd</code> is a service that is integrated into the <code class="literal">smbd</code> service. Enable <code class="literal">spoolssd</code> in the Samba configuration to significantly increase the performance on print servers with a high number of jobs or printers.
				</p><p>
					Without <code class="literal">spoolssd</code>, Samba forks the <code class="literal">smbd</code> process and initializes the <code class="literal">printcap</code> cache for each print job. In case of a large number of printers, the <code class="literal">smbd</code> service can become unresponsive for multiple seconds while the cache is initialized. The <code class="literal">spoolssd</code> service enables you to start pre-forked <code class="literal">smbd</code> processes that are processing print jobs without any delays. The main <code class="literal">spoolssd</code> <code class="literal">smbd</code> process uses a low amount of memory, and forks and terminates child processes.
				</p><p>
					The following procedure explains how to enable the <code class="literal">spoolssd</code> service.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Add the following parameters:
								</p><pre class="literallayout">rpc_server:spoolss = external
rpc_daemon:spoolssd = fork</pre></li><li class="listitem"><p class="simpara">
									Optionally, you can set the following parameters:
								</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 43%; " class="col_1"><!--Empty--></col><col style="width: 14%; " class="col_2"><!--Empty--></col><col style="width: 43%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140042813399904" scope="col">Parameter</th><th align="left" valign="top" id="idm140042813398816" scope="col">Default</th><th align="left" valign="top" id="idm140042813397728" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140042813399904"> <p>
													<code class="literal">spoolssd:prefork_min_children</code>
												</p>
												 </td><td align="left" valign="top" headers="idm140042813398816"> <p>
													5
												</p>
												 </td><td align="left" valign="top" headers="idm140042813397728"> <p>
													Minimum number of child processes
												</p>
												 </td></tr><tr><td align="left" valign="top" headers="idm140042813399904"> <p>
													<code class="literal">spoolssd:prefork_max_children</code>
												</p>
												 </td><td align="left" valign="top" headers="idm140042813398816"> <p>
													25
												</p>
												 </td><td align="left" valign="top" headers="idm140042813397728"> <p>
													Maximum number of child processes
												</p>
												 </td></tr><tr><td align="left" valign="top" headers="idm140042813399904"> <p>
													<code class="literal">spoolssd:prefork_spawn_rate</code>
												</p>
												 </td><td align="left" valign="top" headers="idm140042813398816"> <p>
													5
												</p>
												 </td><td align="left" valign="top" headers="idm140042813397728"> <p>
													Samba forks the number of new child processes set in this parameter, up to the value set in <code class="literal">spoolssd:prefork_max_children</code>, if a new connection is established
												</p>
												 </td></tr><tr><td align="left" valign="top" headers="idm140042813399904"> <p>
													<code class="literal">spoolssd:prefork_max_allowed_clients</code>
												</p>
												 </td><td align="left" valign="top" headers="idm140042813398816"> <p>
													100
												</p>
												 </td><td align="left" valign="top" headers="idm140042813397728"> <p>
													Number of clients, a child process serves
												</p>
												 </td></tr><tr><td align="left" valign="top" headers="idm140042813399904"> <p>
													<code class="literal">spoolssd:prefork_child_min_life</code>
												</p>
												 </td><td align="left" valign="top" headers="idm140042813398816"> <p>
													60
												</p>
												 </td><td align="left" valign="top" headers="idm140042813397728"> <p>
													Minimum lifetime of a child process in seconds. 60 seconds is the minimum.
												</p>
												 </td></tr></tbody></table></div></li></ol></div></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal">smb</code> service:
						</p><pre class="literallayout"># systemctl restart smb</pre><p class="simpara">
							After you restarted the service, Samba automatically starts <code class="literal">smbd</code> child processes:
						</p><pre class="literallayout"># ps axf
...
30903 smbd
30912  \_ smbd
30913      \_ smbd
30914      \_ smbd
30915      \_ smbd
...</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
						</li></ul></div></section><section class="section" id="proc_enabling-print-server-support-in-samba_assembly_setting-up-samba-as-a-print-server"><div class="titlepage"><div><div><h3 class="title">2.8.2. Enabling print server support in Samba</h3></div></div></div><p>
					This section explains how to enable the print server support in Samba.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On the Samba server, set up CUPS and add the printer to the CUPS back end. For details about configuring printers in CUPS; see the documentation provided in the CUPS web console (https://<span class="emphasis"><em>print_server_host_name</em></span>:631/help) on the print server.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Samba can only forward the print jobs to CUPS if CUPS is installed locally on the Samba print server.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If you want to enable the <code class="literal">spoolssd</code> service, add the following parameters to the <code class="literal">[global]</code> section:
								</p><pre class="literallayout">rpc_server:spoolss = external
rpc_daemon:spoolssd = fork</pre></li><li class="listitem"><p class="simpara">
									To configure the printing back end, add the <code class="literal">[printers]</code> section:
								</p><pre class="literallayout">[printers]
        comment = All Printers
        path = /var/tmp/
        printable = yes
        create mask = 0600</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										The <code class="literal">[printers]</code> share name is hard-coded and cannot be changed.
									</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
							Open the required ports and reload the firewall configuration using the <code class="literal">firewall-cmd</code> utility:
						</p><pre class="literallayout"># firewall-cmd --permanent --add-service=samba
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal">smb</code> service:
						</p><pre class="literallayout"># systemctl restart smb</pre></li></ol></div><p>
					After restarting the service, Samba automatically shares all printers that are configured in the CUPS back end. If you want to manually share only specific printers, see <a class="xref" href="index.html#proc_manually-sharing-specific-printers_assembly_setting-up-samba-as-a-print-server" title="2.8.3. Manually sharing specific printers">Section 2.8.3, “Manually sharing specific printers”</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For further details and <code class="literal">spoolssd</code> parameters you can set, see <a class="xref" href="index.html#proc_the-samba-spoolssd-service_assembly_setting-up-samba-as-a-print-server" title="2.8.1. The Samba spoolssd service">Section 2.8.1, “The Samba spoolssd service”</a>
						</li><li class="listitem">
							<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
						</li></ul></div></section><section class="section" id="proc_manually-sharing-specific-printers_assembly_setting-up-samba-as-a-print-server"><div class="titlepage"><div><div><h3 class="title">2.8.3. Manually sharing specific printers</h3></div></div></div><p>
					If you configured Samba as a print server, by default, Samba shares all printers that are configured in the CUPS back end. The following procedure explains how to share only specific printers.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Samba is set up as a print server
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Edit the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									In the <code class="literal">[global]</code> section, disable automatic printer sharing by setting:
								</p><pre class="literallayout">load printers = no</pre></li><li class="listitem"><p class="simpara">
									Add a section for each printer you want to share. For example, to share the printer named <code class="literal">example</code> in the CUPS back end as <code class="literal">Example-Printer</code> in Samba, add the following section:
								</p><pre class="literallayout">[Example-Printer]
        path = /var/tmp/
        printable = yes
        printer name = example</pre><p class="simpara">
									You do not need individual spool directories for each printer. You can set the same spool directory in the <code class="literal">path</code> parameter for the printer as you set in the <code class="literal">[printers]</code> section.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
							Reload the Samba configuration:
						</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
						</li></ul></div></section><section class="section" id="assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients_assembly_setting-up-samba-as-a-print-server"><div class="titlepage"><div><div><h3 class="title">2.8.4. Setting up automatic printer driver downloads for Windows clients</h3></div></div></div><p>
					If you are running a Samba print server for Windows clients, you can upload drivers and preconfigure printers. If a user connects to a printer, Windows automatically downloads and installs the driver locally on the client. The user does not require local administrator permissions for the installation. Additionally, Windows applies preconfigured driver settings, such as the number of trays.
				</p><p>
					Parts of this section were adopted from the <a class="link" href="https://wiki.samba.org/index.php/Setting_up_Automatic_Printer_Driver_Downloads_for_Windows_Clients">Setting up Automatic Printer Driver Downloads for Windows Clients</a> documentation published in the Samba Wiki. License: <a class="link" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Authors and contributors: See the <a class="link" href="https://wiki.samba.org/index.php?title=Setting_up_Automatic_Printer_Driver_Downloads_for_Windows_Clients&amp;action=history">history</a> tab on the Wiki page.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Samba is set up as a print server
						</li></ul></div><section class="section" id="con_basic-information-about-printer-drivers_assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients"><div class="titlepage"><div><div><h4 class="title">2.8.4.1. Basic information about printer drivers</h4></div></div></div><p>
						This section provides general information about printer drivers.
					</p><h6 id="supported_driver_model_version">Supported driver model version</h6><p>
						Samba only supports the printer driver model version 3 which is supported in Windows 2000 and later, and Windows Server 2000 and later. Samba does not support the driver model version 4, introduced in Windows 8 and Windows Server 2012. However, these and later Windows versions also support version 3 drivers.
					</p><h6 id="package_aware_drivers">Package-aware drivers</h6><p>
						Samba does not support package-aware drivers.
					</p><h6 id="preparing_a_printer_driver_for_being_uploaded">Preparing a printer driver for being uploaded</h6><p>
						Before you can upload a driver to a Samba print server:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Unpack the driver if it is provided in a compressed format.
							</li><li class="listitem"><p class="simpara">
								Some drivers require to start a setup application that installs the driver locally on a Windows host. In certain situations, the installer extracts the individual files into the operating system’s temporary folder during the setup runs. To use the driver files for uploading:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Start the installer.
									</li><li class="listitem">
										Copy the files from the temporary folder to a new location.
									</li><li class="listitem">
										Cancel the installation.
									</li></ol></div></li></ul></div><p>
						Ask your printer manufacturer for drivers that support uploading to a print server.
					</p><h6 id="providing_32_bit_and_64_bit_drivers_for_a_printer_to_a_client">Providing 32-bit and 64-bit drivers for a printer to a client</h6><p>
						To provide the driver for a printer for both 32-bit and 64-bit Windows clients, you must upload a driver with exactly the same name for both architectures. For example, if you are uploading the 32-bit driver named <code class="literal">Example PostScript</code> and the 64-bit driver named <code class="literal">Example PostScript (v1.0)</code>, the names do not match. Consequently, you can only assign one of the drivers to a printer and the driver will not be available for both architectures.
					</p></section><section class="section" id="proc_enabling-users-to-upload-and-preconfigure-drivers_assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients"><div class="titlepage"><div><div><h4 class="title">2.8.4.2. Enabling users to upload and preconfigure drivers</h4></div></div></div><p>
						To be able to upload and preconfigure printer drivers, a user or a group needs to have the <code class="literal">SePrintOperatorPrivilege</code> privilege granted. A user must be added into the <code class="literal">printadmin</code> group. Red Hat Enterprise Linux automatically creates this group when you install the <code class="literal package">samba</code> package. The <code class="literal">printadmin</code> group gets assigned the lowest available dynamic system GID that is lower than 1000.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								For example, to grant the <code class="literal">SePrintOperatorPrivilege</code> privilege to the <code class="literal">printadmin</code> group:
							</p><pre class="literallayout"># net rpc rights grant "printadmin" SePrintOperatorPrivilege \
       -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
Successfully granted rights.</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									In a domain environment, grant <code class="literal">SePrintOperatorPrivilege</code> to a domain group. This enables you to centrally manage the privilege by updating a user’s group membership.
								</p></div></div></li><li class="listitem"><p class="simpara">
								To list all users and groups having <code class="literal">SePrintOperatorPrivilege</code> granted:
							</p><pre class="literallayout"># net rpc rights list privileges SePrintOperatorPrivilege \
       -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter administrator's password:
SePrintOperatorPrivilege:
  BUILTIN\Administrators
  <span class="emphasis"><em>DOMAIN</em></span>\printadmin</pre></li></ol></div></section><section class="section" id="proc_setting-up-the-print-share_assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients"><div class="titlepage"><div><div><h4 class="title">2.8.4.3. Setting up the print$ share</h4></div></div></div><p>
						Windows operating systems download printer drivers from a share named <code class="literal">print$</code> from a print server. This share name is hard-coded in Windows and cannot be changed.
					</p><p>
						The following procedure explains how to share the <code class="literal filename">/var/lib/samba/drivers/</code> directory as <code class="literal">print$</code>, and enable members of the local <code class="literal">printadmin</code> group to upload printer drivers.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Add the <code class="literal">[print$]</code> section to the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout">[print$]
        path = /var/lib/samba/drivers/
        read only = no
        write list = @printadmin
        force group = @printadmin
        create mask = 0664
        directory mask = 2775</pre><p class="simpara">
								Using these settings:
							</p><p class="simpara">
								Only members of the <code class="literal">printadmin</code> group can upload printer drivers to the share.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The group of new created files and directories will be set to <code class="literal">printadmin</code>.
									</li><li class="listitem">
										The permissions of new files will be set to <code class="literal">664</code>.
									</li><li class="listitem">
										The permissions of new directories will be set to <code class="literal">2775</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								To upload only 64-bit drivers for a printer, include this setting in the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout">spoolss: architecture = Windows x64</pre><p class="simpara">
								Without this setting, Windows only displays drivers for which you have uploaded at least the 32-bit version.
							</p></li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Reload the Samba configuration
							</p><pre class="literallayout"># smbcontrol all reload-config</pre></li><li class="listitem"><p class="simpara">
								Create the <code class="literal">printadmin</code> group if it does not exists:
							</p><pre class="literallayout"># groupadd printadmin</pre></li><li class="listitem"><p class="simpara">
								Grant the <code class="literal">SePrintOperatorPrivilege</code> privilege to the <code class="literal">printadmin</code> group.
							</p><pre class="literallayout"># net rpc rights grant "printadmin" SePrintOperatorPrivilege \
       -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
Successfully granted rights.</pre></li><li class="listitem"><p class="simpara">
								If you run SELinux in <code class="literal">enforcing</code> mode, set the <code class="literal">samba_share_t</code> context on the directory:
							</p><pre class="literallayout"># semanage fcontext -a -t samba_share_t "/var/lib/samba/drivers(/.*)?"
# restorecon -Rv /var/lib/samba/drivers/</pre></li><li class="listitem"><p class="simpara">
								Set the permissions on the <code class="literal filename">/var/lib/samba/drivers/</code> directory:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										If you use POSIX ACLs, set:
									</p><pre class="literallayout"># chgrp -R "printadmin" /var/lib/samba/drivers/
# chmod -R 2775 /var/lib/samba/drivers/</pre></li><li class="listitem"><p class="simpara">
										If you use Windows ACLs, set:
									</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 40%; " class="col_2"><!--Empty--></col><col style="width: 40%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140042814751824" scope="col">Principal</th><th align="left" valign="top" id="idm140042814750736" scope="col">Access</th><th align="left" valign="top" id="idm140042814749648" scope="col">Apply to</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140042814751824"> <p>
														<code class="literal">CREATOR OWNER</code>
													</p>
													 </td><td align="left" valign="top" headers="idm140042814750736"> <p>
														Full control
													</p>
													 </td><td align="left" valign="top" headers="idm140042814749648"> <p>
														Subfolders and files only
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042814751824"> <p>
														<code class="literal">Authenticated Users</code>
													</p>
													 </td><td align="left" valign="top" headers="idm140042814750736"> <p>
														Read &amp; execute, List folder contents, Read
													</p>
													 </td><td align="left" valign="top" headers="idm140042814749648"> <p>
														This folder, subfolders, and files
													</p>
													 </td></tr><tr><td align="left" valign="top" headers="idm140042814751824"> <p>
														<code class="literal">printadmin</code>
													</p>
													 </td><td align="left" valign="top" headers="idm140042814750736"> <p>
														Full control
													</p>
													 </td><td align="left" valign="top" headers="idm140042814749648"> <p>
														This folder, subfolders, and files
													</p>
													 </td></tr></tbody></table></div><p class="simpara">
										For details about setting ACLs on Windows, see the Windows documentation.
									</p></li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#proc_enabling-users-to-upload-and-preconfigure-drivers_assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients" title="2.8.4.2. Enabling users to upload and preconfigure drivers">Section 2.8.4.2, “Enabling users to upload and preconfigure drivers”</a>.
							</li><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section><section class="section" id="proc_creating-a-gpo-to-enable-clients-to-trust-the-samba-print-server_assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients"><div class="titlepage"><div><div><h4 class="title">2.8.4.4. Creating a GPO to enable clients to trust the Samba print server</h4></div></div></div><p>
						For security reasons, recent Windows operating systems prevent clients from downloading non-package-aware printer drivers from an untrusted server. If your print server is a member in an AD, you can create a Group Policy Object (GPO) in your domain to trust the Samba server.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The Samba print server is a member of an AD domain.
							</li><li class="listitem">
								The Windows computer you are using to create the GPO must have the Windows Remote Server Administration Tools (RSAT) installed. For details, see the Windows documentation.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log into a Windows computer using an account that is allowed to edit group policies, such as the AD domain <code class="literal">Administrator</code> user.
							</li><li class="listitem">
								Open the <code class="literal">Group Policy Management Console</code>.
							</li><li class="listitem"><p class="simpara">
								Right-click to your AD domain and select <code class="literal">Create a GPO in this domain, and Link it here</code>.
							</p><div class="informalfigure"><div class="mediaobject"><img src="samba_create_new_GPO.png" alt="samba create new GPO"/></div></div></li><li class="listitem">
								Enter a name for the GPO, such as <code class="literal">Legacy Printer Driver Policy</code> and click <code class="literal">OK</code>. The new GPO will be displayed under the domain entry.
							</li><li class="listitem">
								Right-click to the newly-created GPO and select <code class="literal">Edit</code> to open the <code class="literal">Group Policy Management Editor</code>.
							</li><li class="listitem"><p class="simpara">
								Navigate to <span class="guimenu">Computer Configuration</span> → <span class="guisubmenu">Policies</span> → <span class="guisubmenu">Administrative Templates</span> → <span class="guimenuitem">Printers</span>.
							</p><div class="informalfigure"><div class="mediaobject"><img src="samba_select_printer_GPO_group.png" alt="samba select printer GPO group"/></div></div></li><li class="listitem"><p class="simpara">
								On the right side of the window, double-click <code class="literal">Point and Print Restriction</code> to edit the policy:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Enable the policy and set the following options:
									</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
												Select <code class="literal">Users can only point and print to these servers</code> and enter the fully-qualified domain name (FQDN) of the Samba print server to the field next to this option.
											</li><li class="listitem"><p class="simpara">
												In both check boxes under <code class="literal">Security Prompts</code>, select <code class="literal">Do not show warning or elevation prompt</code>.
											</p><div class="informalfigure"><div class="mediaobject"><img src="samba_GPO_point_and_print.png" alt="samba GPO point and print"/></div></div></li></ol></div></li><li class="listitem">
										Click OK.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Double-click <code class="literal">Package Point and Print - Approved servers</code> to edit the policy:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Enable the policy and click the <code class="literal">Show</code> button.
									</li><li class="listitem"><p class="simpara">
										Enter the FQDN of the Samba print server.
									</p><div class="informalfigure"><div class="mediaobject"><img src="samba_GPO_approved_servers.png" alt="samba GPO approved servers"/></div></div></li><li class="listitem">
										Close both the <code class="literal">Show Contents</code> and the policy’s properties window by clicking <code class="literal">OK</code>.
									</li></ol></div></li><li class="listitem">
								Close the <code class="literal">Group Policy Management Editor</code>.
							</li><li class="listitem">
								Close the <code class="literal">Group Policy Management Console</code>.
							</li></ol></div><p>
						After the Windows domain members applied the group policy, printer drivers are automatically downloaded from the Samba server when a user connects to a printer.
					</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								For further details about using group policies, see the Windows documentation.
							</li></ul></div></section><section class="section" id="proc_uploading-drivers-and-preconfiguring-printers_assembly_setting-up-automatic-printer-driver-downloads-for-windows-clients"><div class="titlepage"><div><div><h4 class="title">2.8.4.5. Uploading drivers and preconfiguring printers</h4></div></div></div><p>
						Use the <code class="literal">Print Management</code> application on a Windows client to upload drivers and preconfigure printers hosted on the Samba print server. For further details, see the Windows documentation.
					</p></section></section></section><section class="section" id="assembly_tuning-the-performance-of-a-samba-server_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.9. Tuning the performance of a Samba server</h2></div></div></div><p>
				This chapter describes what settings can improve the performance of Samba in certain situations, and which settings can have a negative performance impact.
			</p><p>
				Parts of this section were adopted from the <a class="link" href="https://wiki.samba.org/index.php/Performance_Tuning">Performance Tuning</a> documentation published in the Samba Wiki. License: <a class="link" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Authors and contributors: See the <a class="link" href="https://wiki.samba.org/index.php?title=Performance_Tuning&amp;action=history">history</a> tab on the Wiki page.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Samba is set up as a file or print server
					</li></ul></div><section class="section" id="proc_setting-the-smb-protocol-version_assembly_tuning-the-performance-of-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.9.1. Setting the SMB protocol version</h3></div></div></div><p>
					Each new SMB version adds features and improves the performance of the protocol. The recent Windows and Windows Server operating systems always supports the latest protocol version. If Samba also uses the latest protocol version, Windows clients connecting to Samba benefit from the performance improvements. In Samba, the default value of the server max protocol is set to the latest supported stable SMB protocol version.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						To always have the latest stable SMB protocol version enabled, do not set the <code class="literal">server max protocol</code> parameter. If you set the parameter manually, you will need to modify the setting with each new version of the SMB protocol, to have the latest protocol version enabled.
					</p></div></div><p>
					The following procedure explains how to use the default value in the <code class="literal">server max protocol</code> parameter.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Remove the <code class="literal">server max protocol</code> parameter from the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file.
						</li><li class="listitem"><p class="simpara">
							Reload the Samba configuration
						</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div></section><section class="section" id="proc_tuning-shares-with-directories-that-contain-a-large-number-of-files_assembly_tuning-the-performance-of-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.9.2. Tuning shares with directories that contain a large number of files</h3></div></div></div><p>
					Linux supports case-sensitive file names. For this reason, Samba needs to scan directories for uppercase and lowercase file names when searching or accessing a file. You can configure a share to create new files only in lowercase or uppercase, which improves the performance.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Samba is configured as a file server
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Rename all files on the share to lowercase.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Using the settings in this procedure, files with names other than in lowercase will no longer be displayed.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Set the following parameters in the share’s section:
						</p><pre class="literallayout">case sensitive = true
default case = lower
preserve case = no
short preserve case = no</pre><p class="simpara">
							For details about the parameters, see their descriptions in the <code class="literal">smb.conf(5)</code> man page.
						</p></li><li class="listitem"><p class="simpara">
							Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
						</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
							Reload the Samba configuration:
						</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><p>
					After you applied these settings, the names of all newly created files on this share use lowercase. Because of these settings, Samba no longer needs to scan the directory for uppercase and lowercase, which improves the performance.
				</p><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
						samba docs
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
						</li></ul></div></section><section class="section" id="con_settings-that-can-have-a-negative-performance-impact_assembly_tuning-the-performance-of-a-samba-server"><div class="titlepage"><div><div><h3 class="title">2.9.3. Settings that can have a negative performance impact</h3></div></div></div><p>
					By default, the kernel in Red Hat Enterprise Linux is tuned for high network performance. For example, the kernel uses an auto-tuning mechanism for buffer sizes. Setting the <code class="literal">socket options</code> parameter in the <code class="literal filename">/etc/samba/smb.conf</code> file overrides these kernel settings. As a result, setting this parameter decreases the Samba network performance in most cases.
				</p><p>
					To use the optimized settings from the Kernel, remove the <code class="literal">socket options</code> parameter from the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code>.
				</p></section></section><section class="section" id="setting-the-minimum-smb-protocol-version-supported-by-a-samba-server_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.10. Setting the minimum SMB protocol version supported by a Samba server</h2></div></div></div><p>
				In Samba, the <code class="literal parameter">server min protocol</code> parameter in the <code class="literal filename">/etc/samba/smb.conf</code> file defines the minimum server message block (SMB) protocol version the Samba server supports. This section describes how to change the minimum SMB protocol version.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, Samba on RHEL 8.2 and later supports only SMB2 and newer protocol versions. Red Hat recommends to not use the deprecated SMB1 protocol. However, if your environment requires SMB1, you can manually set the <code class="literal parameter">server min protocol</code> parameter to <code class="literal">NT1</code> to re-enable SMB1.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Samba is installed and configured.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/samba/smb.conf</code> file, add the <code class="literal parameter">server min protocol</code> parameter, and set the parameter to the minimum SMB protocol version the server should support. For example, to set the minimum SMB protocol version to <code class="literal">SMB3</code>, add:
					</p><pre class="literallayout">server min protocol = SMB3</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">smb</code> service:
					</p><pre class="literallayout"># systemctl restart smb</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For a list of protocol versions you can set in <code class="literal">server min protocol</code> parameter, see the description of the <code class="literal">server max protocol</code> parameter in the <code class="literal citetitle">smb.conf(5)</code> man page.
					</li></ul></div></section><section class="section" id="assembly_frequently-used-samba-command-line-utilities_assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.11. Frequently used Samba command-line utilities</h2></div></div></div><p>
				This chapter describes frequently used commands when working with a Samba server.
			</p><section class="section" id="assembly_using-the-net-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.1. Using the net utility</h3></div></div></div><p>
					The <code class="literal">net</code> utility enables you to perform several administration tasks on a Samba server. This section describes the most frequently used subcommands of the <code class="literal">net</code> utility.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-common-tools</code> package is installed.
						</li></ul></div><section class="section" id="proc_using-the-net-ads-join-and-net-rpc-join-commands_assembly_using-the-net-utility"><div class="titlepage"><div><div><h4 class="title">2.11.1.1. Using the net ads join and net rpc join commands</h4></div></div></div><p>
						Using the <code class="literal">join</code> subcommand of the <code class="literal">net</code> utility, you can join Samba to an AD or NT4 domain. To join the domain, you must create the <code class="literal filename">/etc/samba/smb.conf</code> file manually, and optionally update additional configurations, such as PAM.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Red Hat recommends using the <code class="literal">realm</code> utility to join a domain. The <code class="literal">realm</code> utility automatically updates all involved configuration files. For details, see <a class="xref" href="index.html#proc_joining-samba-to-a-domain_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.1. Joining Samba to a Domain">Section 2.5.1, “Joining Samba to a Domain”</a>.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Manually create the <code class="literal filename">/etc/samba/smb.conf</code> file with the following settings:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										For an AD domain member:
									</p><pre class="literallayout">[global]
workgroup = <span class="emphasis"><em>domain_name</em></span>
security = ads
passdb backend = tdbsam
realm = <span class="emphasis"><em>AD_REALM</em></span></pre></li><li class="listitem"><p class="simpara">
										For an NT4 domain member:
									</p><pre class="literallayout">[global]
workgroup = <span class="emphasis"><em>domain_name</em></span>
security = user
passdb backend = tdbsam</pre></li></ul></div></li><li class="listitem">
								Add an ID mapping configuration for the <code class="literal">*</code> default domain and for the domain you want to join to the <code class="literal">[global</code>] section in the <code class="literal filename">/etc/samba/smb.conf</code> file. For details, see <a class="xref" href="index.html#assembly_samba-id-mapping_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.4. Samba ID mapping">Section 2.5.4, “Samba ID mapping”</a>.
							</li><li class="listitem"><p class="simpara">
								Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
							</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
								Join the domain as the domain administrator:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To join an AD domain:
									</p><pre class="literallayout"># net ads join -U "DOMAIN\administrator"</pre></li><li class="listitem"><p class="simpara">
										To join an NT4 domain:
									</p><pre class="literallayout"># net rpc join -U "DOMAIN\administrator"</pre></li></ul></div></li><li class="listitem"><p class="simpara">
								Append the <code class="literal">winbind</code> source to the <code class="literal">passwd</code> and <code class="literal">group</code> database entry in the <code class="literal filename">/etc/nsswitch.conf</code> file:
							</p><pre class="literallayout">passwd:     files <code class="literal">winbind</code>
group:      files <code class="literal">winbind</code></pre></li><li class="listitem"><p class="simpara">
								Enable and start the <code class="literal">winbind</code> service:
							</p><pre class="literallayout"># systemctl enable winbind
# systemctl start winbind</pre></li><li class="listitem"><p class="simpara">
								Optionally, configure PAM using the <code class="literal">authselect</code> utility.
							</p><p class="simpara">
								For details, see the <code class="literal">authselect(8)</code> man page.
							</p></li><li class="listitem"><p class="simpara">
								Optionally for AD environments, configure the Kerberos client.
							</p><p class="simpara">
								For details, see the documentation of your Kerberos client.
							</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
							</li></ul></div></section><section class="section" id="proc_using-the-net-rpc-rights-command_assembly_using-the-net-utility"><div class="titlepage"><div><div><h4 class="title">2.11.1.2. Using the net rpc rights command</h4></div></div></div><p>
						In Windows, you can assign privileges to accounts and groups to perform special operations, such as setting ACLs on a share or upload printer drivers. On a Samba server, you can use the <code class="literal">net rpc rights</code> command to manage privileges.
					</p><h6 id="listing_privileges_you_can_set">Listing privileges you can set</h6><p>
						To list all available privileges and their owners, use the <code class="literal">net rpc rights list</code> command. For example:
					</p><pre class="literallayout">net rpc rights list -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
     SeMachineAccountPrivilege  Add machines to domain
      SeTakeOwnershipPrivilege  Take ownership of files or other objects
             SeBackupPrivilege  Back up files and directories
            SeRestorePrivilege  Restore files and directories
     SeRemoteShutdownPrivilege  Force shutdown from a remote system
      SePrintOperatorPrivilege  Manage printers
           SeAddUsersPrivilege  Add users and groups to the domain
       SeDiskOperatorPrivilege  Manage disk shares
           SeSecurityPrivilege  System security</pre><h6 id="granting_privileges">Granting privileges</h6><p>
						To grant a privilege to an account or group, use the <code class="literal">net rpc rights grant</code> command.
					</p><p>
						For example, grant the <code class="literal">SePrintOperatorPrivilege</code> privilege to the <code class="literal"><span class="emphasis"><em>DOMAIN</em></span>\printadmin</code> group:
					</p><pre class="literallayout"># net rpc rights grant "<span class="emphasis"><em>DOMAIN</em></span>\printadmin" SePrintOperatorPrivilege \
       -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
Successfully granted rights.</pre><h6 id="revoking_privileges">Revoking privileges</h6><p>
						To revoke a privilege from an account or group, use the <code class="literal">net rpc rights revoke</code> command.
					</p><p>
						For example, to revoke the <code class="literal">SePrintOperatorPrivilege</code> privilege from the <code class="literal"><span class="emphasis"><em>DOMAIN</em></span>\printadmin</code> group:
					</p><pre class="literallayout"># net rpc rights remoke "<span class="emphasis"><em>DOMAIN</em></span>\printadmin" SePrintOperatorPrivilege \
       -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
Successfully revoked rights.</pre></section><section class="section" id="proc_using-the-net-rpc-share-command_assembly_using-the-net-utility"><div class="titlepage"><div><div><h4 class="title">2.11.1.3. Using the net rpc share command</h4></div></div></div><p>
						The <code class="literal">net rpc share</code> command provides the capability to list, add, and remove shares on a local or remote Samba or Windows server.
					</p><h6 id="listing_shares">Listing shares</h6><p>
						To list the shares on an SMB server, use the <code class="literal">net rpc share list</code> command. Optionally, pass the <code class="literal">-S <span class="emphasis"><em>server_name</em></span></code> parameter to the command to list the shares of a remote server. For example:
					</p><pre class="literallayout"># net rpc share list -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator" -S <span class="emphasis"><em>server_name</em></span>
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
IPC$
<span class="emphasis"><em>share_1</em></span>
<span class="emphasis"><em>share_2</em></span>
...</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Shares hosted on a Samba server that have <code class="literal">browseable = no</code> set in their section in the <code class="literal filename">/etc/samba/smb.conf</code> file are not displayed in the output.
						</p></div></div><h6 id="adding_a_share">Adding a share</h6><p>
						The <code class="literal">net rpc share add</code> command enables you to add a share to an SMB server.
					</p><p>
						For example, to add a share named <code class="literal">example</code> on a remote Windows server that shares the <code class="literal">C:\example\</code> directory:
					</p><pre class="literallayout"># net rpc share add example="C:\example" -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator" -S <span class="emphasis"><em>server_name</em></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You must omit the trailing backslash in the path when specifying a Windows directory name.
						</p></div></div><p>
						To use the command to add a share to a Samba server:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The user specified in the <code class="literal">-U</code> parameter must have the <code class="literal">SeDiskOperatorPrivilege</code> privilege granted on the destination server.
							</li><li class="listitem">
								You must write a script that adds a share section to the <code class="literal filename">/etc/samba/smb.conf</code> file and reloads Samba. The script must be set in the <code class="literal">add share command</code> parameter in the <code class="literal">[global]</code> section in <code class="literal filename">/etc/samba/smb.conf</code>. For further details, see the <code class="literal">add share command</code> description in the <code class="literal">smb.conf(5)</code> man page.
							</li></ul></div><h6 id="removing_a_share">Removing a share</h6><p>
						The <code class="literal">net rpc share delete</code> command enables you to remove a share from an SMB server.
					</p><p>
						For example, to remove the share named example from a remote Windows server:
					</p><pre class="literallayout"># net rpc share delete example -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator" -S <span class="emphasis"><em>server_name</em></span></pre><p>
						To use the command to remove a share from a Samba server:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The user specified in the <code class="literal">-U</code> parameter must have the <code class="literal">SeDiskOperatorPrivilege</code> privilege granted.
							</li><li class="listitem">
								You must write a script that removes the share’s section from the <code class="literal filename">/etc/samba/smb.conf</code> file and reloads Samba. The script must be set in the <code class="literal">delete share command</code> parameter in the <code class="literal">[global]</code> section in <code class="literal filename">/etc/samba/smb.conf</code>. For further details, see the <code class="literal">delete share command</code> description in the <code class="literal">smb.conf(5)</code> man page.
							</li></ul></div></section><section class="section" id="proc_using-the-net-user-command_assembly_using-the-net-utility"><div class="titlepage"><div><div><h4 class="title">2.11.1.4. Using the net user command</h4></div></div></div><p>
						The <code class="literal">net user</code> command enables you to perform the following actions on an AD DC or NT4 PDC:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								List all user accounts
							</li><li class="listitem">
								Add users
							</li><li class="listitem">
								Remove Users
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Specifying a connection method, such as <code class="literal">ads</code> for AD domains or <code class="literal">rpc</code> for NT4 domains, is only required when you list domain user accounts. Other user-related subcommands can auto-detect the connection method.
						</p></div></div><p>
						Pass the <code class="literal">-U <span class="emphasis"><em>user_name</em></span></code> parameter to the command to specify a user that is allowed to perform the requested action.
					</p><h6 id="listing_domain_user_accounts">Listing domain user accounts</h6><p>
						To list all users in an AD domain:
					</p><pre class="literallayout"># net ads user -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"</pre><p>
						To list all users in an NT4 domain:
					</p><pre class="literallayout"># net rpc user -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"</pre><h6 id="adding_a_user_account_to_the_domain">Adding a user account to the domain</h6><p>
						On a Samba domain member, you can use the <code class="literal">net user add</code> command to add a user account to the domain.
					</p><p>
						For example, add the <code class="literal">user</code> account to the domain:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Add the account:
							</p><pre class="literallayout"># net user add <span class="emphasis"><em>user</em></span> <span class="emphasis"><em>password</em></span> -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
User <span class="emphasis"><em>user</em></span> added</pre></li><li class="listitem"><p class="simpara">
								Optionally, use the remote procedure call (RPC) shell to enable the account on the AD DC or NT4 PDC. For example:
							</p><pre class="literallayout"># net rpc shell -U <span class="emphasis"><em>DOMAIN</em></span>\administrator -S <span class="emphasis"><em>DC_or_PDC_name</em></span>
Talking to domain DOMAIN (<span class="emphasis"><em>S-1-5-21-1424831554-512457234-5642315751</em></span>)

net rpc&gt; user edit disabled <span class="emphasis"><em>user</em></span>: no
Set <span class="emphasis"><em>user</em></span>'s disabled flag from [yes] to [no]

net rpc&gt; exit</pre></li></ol></div><h6 id="deleting_a_user_account_from_the_domain">Deleting a user account from the domain</h6><p>
						On a Samba domain member, you can use the <code class="literal">net user delete</code> command to remove a user account from the domain.
					</p><p>
						For example, to remove the <code class="literal">user</code> account from the domain:
					</p><pre class="literallayout"># net user delete <span class="emphasis"><em>user</em></span> -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
User <span class="emphasis"><em>user</em></span> deleted</pre></section><section class="section" id="assembly_using-the-net-usershare-command_assembly_using-the-net-utility"><div class="titlepage"><div><div><h4 class="title">2.11.1.5. Using the net usershare command</h4></div></div></div><p>
						On a Samba server, you can configure that users can share directories without root permissions.
					</p><section class="section" id="proc_enabling-the-user-shares-feature_assembly_using-the-net-usershare-command"><div class="titlepage"><div><div><h5 class="title">2.11.1.5.1. Enabling the user shares feature</h5></div></div></div><p>
							Before users can share directories, the administrator must enable user shares in Samba.
						</p><p>
							For example, to enable only members of the local <code class="literal">example</code> group to create user shares.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Create the local <code class="literal">example</code> group, if it does not exist:
								</p><pre class="literallayout"># groupadd example</pre></li><li class="listitem"><p class="simpara">
									Prepare the directory for Samba to store the user share definitions and set its permissions properly. For example:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Create the directory:
										</p><pre class="literallayout"># mkdir -p /var/lib/samba/usershares/</pre></li><li class="listitem"><p class="simpara">
											Set write permissions for the <code class="literal">example</code> group:
										</p><pre class="literallayout"># chgrp example /var/lib/samba/usershares/
# chmod 1770 /var/lib/samba/usershares/</pre></li><li class="listitem">
											Set the sticky bit to prevent users to rename or delete files stored by other users in this directory.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									Edit the <code class="literal filename">/etc/samba/smb.conf</code> file and add the following to the <code class="literal">[global]</code> section:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											Set the path to the directory you configured to store the user share definitions. For example:
										</p><pre class="literallayout">usershare path = /var/lib/samba/usershares/</pre></li><li class="listitem"><p class="simpara">
											Set how many user shares Samba allows to be created on this server. For example:
										</p><pre class="literallayout">usershare max shares = 100</pre><p class="simpara">
											If you use the default of <code class="literal">0</code> for the <code class="literal">usershare max shares</code> parameter, user shares are disabled.
										</p></li><li class="listitem"><p class="simpara">
											Optionally, set a list of absolute directory paths. For example, to configure that Samba only allows to share subdirectories of the <code class="literal filename">/data</code> and <code class="literal filename">/srv</code> directory to be shared, set:
										</p><pre class="literallayout">usershare prefix allow list = /data /srv</pre></li></ol></div><p class="simpara">
									For a list of further user share-related parameters you can set, see the <code class="literal">USERSHARES</code> section in the <code class="literal">smb.conf(5)</code> man page.
								</p></li><li class="listitem"><p class="simpara">
									Verify the <code class="literal filename">/etc/samba/smb.conf</code> file:
								</p><pre class="literallayout"># testparm</pre></li><li class="listitem"><p class="simpara">
									Reload the Samba configuration:
								</p><pre class="literallayout"># smbcontrol all reload-config</pre></li></ol></div><p>
							Users are now able to create user shares. For details, see <a class="xref" href="index.html#proc_adding-a-user-share_assembly_enabling-users-to-share-directories-on-a-samba-server" title="2.7.4.2. Adding a user share">Section 2.7.4.2, “Adding a user share”</a>.
						</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="xref" href="index.html#proc_verifying-the-smb-conf-file-by-using-the-testparm-utility_assembly_using-samba-as-a-server" title="2.2. Verifying the smb.conf file by using the testparm utility">Section 2.2, “Verifying the smb.conf file by using the testparm utility”</a>
								</li></ul></div></section><section class="section" id="proc_adding-a-user-share_assembly_using-the-net-usershare-command"><div class="titlepage"><div><div><h5 class="title">2.11.1.5.2. Adding a user share</h5></div></div></div><p>
							After you configured Samba according to <a class="xref" href="index.html#proc_enabling-the-user-shares-feature_assembly_enabling-users-to-share-directories-on-a-samba-server" title="2.7.4.1. Enabling the user shares feature">Section 2.7.4.1, “Enabling the user shares feature”</a>, users can share directories on the Samba server without <code class="literal">root</code> permissions by running the <code class="literal">net usershare add</code> command.
						</p><p>
							Synopsis of the <code class="literal">net usershare add</code> command:
						</p><p>
							<code class="literal">net usershare add</code> share_name path [[ comment ] | [ ACLs ]] [ guest_ok=y|n ]
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								If you set ACLs when you create a user share, you must specify the comment parameter prior to the ACLs. To set an empty comment, use an empty string in double quotes.
							</p></div></div><p>
							Note that users can only enable guest access on a user share, if the administrator set <code class="literal">usershare allow guests = yes</code> in the <code class="literal">[global]</code> section in the <code class="literal filename">/etc/samba/smb.conf</code> file.
						</p><div class="example" id="idm140042818035568"><p class="title"><strong>Example 2.8. Adding a user share</strong></p><div class="example-contents"><p>
								A user wants to share the <code class="literal filename">/srv/samba/</code> directory on a Samba server. The share should be named <code class="literal">example</code>, have no comment set, and should be accessible by guest users. Additionally, the share permissions should be set to full access for the <code class="literal">AD\Domain Users</code> group and read permissions for other users. To add this share, run as the user:
							</p><pre class="literallayout">$ net usershare add example /srv/samba/ "" \
       "AD\Domain Users":F,Everyone:R guest_ok=yes</pre></div></div></section><section class="section" id="proc_updating-settings-of-a-user-share_assembly_using-the-net-usershare-command"><div class="titlepage"><div><div><h5 class="title">2.11.1.5.3. Updating settings of a user share</h5></div></div></div><p>
							To update settings of a user share, override the share by using the <code class="literal">net usershare add</code> command with the same share name and the new settings. See <a class="xref" href="index.html#proc_adding-a-user-share_assembly_enabling-users-to-share-directories-on-a-samba-server" title="2.7.4.2. Adding a user share">Section 2.7.4.2, “Adding a user share”</a>.
						</p></section><section class="section" id="proc_displaying-information-about-existing-user-shares_assembly_using-the-net-usershare-command"><div class="titlepage"><div><div><h5 class="title">2.11.1.5.4. Displaying information about existing user shares</h5></div></div></div><p>
							Users can enter the <code class="literal">net usershare info</code> command on a Samba server to display user shares and their settings.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									A user share is configured on the Samba server.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									To display all user shares created by any user:
								</p><pre class="literallayout">$ net usershare info -l
[<span class="emphasis"><em>share_1</em></span>]
path=<span class="emphasis"><em>/srv/samba/</em></span>
comment=
usershare_acl=<span class="emphasis"><em>Everyone:R,host_name\user:F,</em></span>
guest_ok=<span class="emphasis"><em>y</em></span>
...</pre><p class="simpara">
									To list only shares created by the user who runs the command, omit the <code class="literal">-l</code> parameter.
								</p></li><li class="listitem"><p class="simpara">
									To display only the information about specific shares, pass the share name or wild cards to the command. For example, to display the information about shares whose name starts with <code class="literal">share_</code>:
								</p><pre class="literallayout">$ net usershare info -l share_*</pre></li></ol></div></section><section class="section" id="proc_listing-user-shares_assembly_using-the-net-usershare-command"><div class="titlepage"><div><div><h5 class="title">2.11.1.5.5. Listing user shares</h5></div></div></div><p>
							If you want to list only the available user shares without their settings on a Samba server, use the <code class="literal">net usershare list</code> command.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									A user share is configured on the Samba server.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									To list the shares created by any user:
								</p><pre class="literallayout">$ net usershare list -l
<span class="emphasis"><em>share_1</em></span>
<span class="emphasis"><em>share_2</em></span>
...</pre><p class="simpara">
									To list only shares created by the user who runs the command, omit the <code class="literal">-l</code> parameter.
								</p></li><li class="listitem"><p class="simpara">
									To list only specific shares, pass the share name or wild cards to the command. For example, to list only shares whose name starts with <code class="literal">share_</code>:
								</p><pre class="literallayout">$ net usershare list -l share_*</pre></li></ol></div></section><section class="section" id="proc_deleting-a-user-share_assembly_using-the-net-usershare-command"><div class="titlepage"><div><div><h5 class="title">2.11.1.5.6. Deleting a user share</h5></div></div></div><p>
							To delete a user share, use the command <code class="literal">net usershare delete</code> command as the user who created the share or as the <code class="literal">root</code> user.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									A user share is configured on the Samba server.
								</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								
<pre class="literallayout">$ net usershare delete <span class="emphasis"><em>share_name</em></span></pre>

							</p></div></section></section></section><section class="section" id="proc_using-the-rpcclient-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.2. Using the rpcclient utility</h3></div></div></div><p>
					The <code class="literal">rpcclient</code> utility enables you to manually execute client-side Microsoft Remote Procedure Call (MS-RPC) functions on a local or remote SMB server. However, most of the features are integrated into separate utilities provided by Samba. Use <code class="literal">rpcclient</code> only for testing MS-PRC functions.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-client</code> package is installed.
						</li></ul></div><h5 id="examples">Examples</h5><p>
					For example, you can use the <code class="literal">rpcclient</code> utility to:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Manage the printer Spool Subsystem (SPOOLSS).
						</p><div class="example" id="idm140042849848784"><p class="title"><strong>Example 2.9. Assigning a Driver to a Printer</strong></p><div class="example-contents"><pre class="literallayout"># rpcclient <span class="emphasis"><em>server_name</em></span> -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator" \
       -c 'setdriver "<span class="emphasis"><em>printer_name</em></span>" "<span class="emphasis"><em>driver_name</em></span>"'
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrators password:
Successfully set <span class="emphasis"><em>printer_name</em></span> to driver <span class="emphasis"><em>driver_name</em></span>.</pre></div></div></li><li class="listitem"><p class="simpara">
							Retrieve information about an SMB server.
						</p><div class="example" id="idm140042849842592"><p class="title"><strong>Example 2.10. Listing all File Shares and Shared Printers</strong></p><div class="example-contents"><pre class="literallayout"># rpcclient <span class="emphasis"><em>server_name</em></span> -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator" -c 'netshareenum'
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrators password:
netname: <span class="emphasis"><em>Example_Share</em></span>
	remark:
	path:   <span class="emphasis"><em>C:\srv\samba\example_share\</em></span>
	password:
netname: <span class="emphasis"><em>Example_Printer</em></span>
	remark:
	path:   <span class="emphasis"><em>C:\var\spool\samba\</em></span>
	password:</pre></div></div></li><li class="listitem"><p class="simpara">
							Perform actions using the Security Account Manager Remote (SAMR) protocol.
						</p><div class="example" id="idm140042849836352"><p class="title"><strong>Example 2.11. Listing Users on an SMB Server</strong></p><div class="example-contents"><pre class="literallayout"># rpcclient <span class="emphasis"><em>server_name</em></span> -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator" -c 'enumdomusers'
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrators password:
user:[<span class="emphasis"><em>user1</em></span>] rid:[<span class="emphasis"><em>0x3e8</em></span>]
user:[<span class="emphasis"><em>user2</em></span>] rid:[<span class="emphasis"><em>0x3e9</em></span>]</pre></div></div><p class="simpara">
							If you run the command against a standalone server or a domain member, it lists the users in the local database. Running the command against an AD DC or NT4 PDC lists the domain users.
						</p></li></ul></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
						For a complete list of supported subcommands, see the <code class="literal">COMMANDS</code> section in the <code class="literal">rpcclient(1)</code> man page.
					</p></div></section><section class="section" id="proc_using-the-samba-regedit-application_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.3. Using the samba-regedit application</h3></div></div></div><p>
					Certain settings, such as printer configurations, are stored in the registry on the Samba server. You can use the ncurses-based <code class="literal">samba-regedit</code> application to edit the registry of a Samba server.
				</p><p>
					<span class="inlinemediaobject"><img src="samba-regedit.png" alt="samba regedit"/></span>

				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-client</code> package is installed.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To start the application, enter:
					</p></div><pre class="literallayout"># samba-regedit</pre><p>
					Use the following keys:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Cursor up and cursor down: Navigate through the registry tree and the values.
						</li><li class="listitem">
							<span class="keycap"><strong>Enter</strong></span>: Opens a key or edits a value.
						</li><li class="listitem">
							<span class="keycap"><strong>Tab</strong></span>: Switches between the <code class="literal">Key</code> and <code class="literal">Value</code> pane.
						</li><li class="listitem">
							<span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span>: Closes the application.
						</li></ul></div></section><section class="section" id="assembly_using-the-smbcacls-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.4. Using the smbcacls utility</h3></div></div></div><p>
					The <code class="literal">smbcacls</code> utility can list, set, and delete ACLs of files and directories stored on an SMB share. You can use <code class="literal">smbcacls</code> to manage file system ACLs:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							On a local or remote Samba server that uses advanced Windows ACLs or POSIX ACLs
						</li><li class="listitem">
							On Red Hat Enterprise Linux to remotely manage ACLs on a share hosted on Windows
						</li></ul></div><section class="section" id="con_access-control-entries_assembly_using-the-smbcacls-utility"><div class="titlepage"><div><div><h4 class="title">2.11.4.1. Access control entries</h4></div></div></div><p>
						Each ACL entry of a file system object contains Access Control Entries (ACE) in the following format:
					</p><pre class="literallayout"><span class="emphasis"><em>security_principal</em></span>:<span class="emphasis"><em>access_right</em></span>/<span class="emphasis"><em>inheritance_information</em></span>/<span class="emphasis"><em>permissions</em></span></pre><div class="example" id="idm140042814467072"><p class="title"><strong>Example 2.12. Access control entries</strong></p><div class="example-contents"><p>
							If the <code class="literal">AD\Domain Users</code> group has <code class="literal">Modify</code> permissions that apply to <code class="literal">This folder, subfolders, and files</code> on Windows, the ACL contains the following ACE:
						</p><pre class="literallayout">AD\Domain Users:ALLOWED/OI|CI/CHANGE</pre></div></div><p>
						An ACE contains the following parts:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Security principal</span></dt><dd>
									The security principal is the user, group, or SID the permissions in the ACL are applied to.
								</dd><dt><span class="term">Access right</span></dt><dd>
									Defines if access to an object is granted or denied. The value can be <code class="literal">ALLOWED</code> or <code class="literal">DENIED</code>.
								</dd><dt><span class="term">Inheritance information</span></dt><dd><p class="simpara">
									The following values exist:
								</p><div class="table" id="idm140042834060336"><p class="title"><strong>Table 2.5. Inheritance settings</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 14%; " class="col_1"><!--Empty--></col><col style="width: 29%; " class="col_2"><!--Empty--></col><col style="width: 57%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042834054576" scope="col">Value</th><th style="text-align: left; vertical-align: top; " id="idm140042834053488" scope="col">Description</th><th style="text-align: left; vertical-align: top; " id="idm140042834052400" scope="col">Maps to</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042834054576"> <p>
													<code class="literal">OI</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834053488"> <p>
													Object Inherit
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834052400"> <p>
													This folder and files
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042834054576"> <p>
													<code class="literal">CI</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834053488"> <p>
													Container Inherit
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834052400"> <p>
													This folder and subfolders
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042834054576"> <p>
													<code class="literal">IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834053488"> <p>
													Inherit Only
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834052400"> <p>
													The ACE does not apply to the current file or directory
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042834054576"> <p>
													<code class="literal">ID</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834053488"> <p>
													Inherited
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042834052400"> <p>
													The ACE was inherited from the parent directory
												</p>
												 </td></tr></tbody></table></div></div><p class="simpara">
									Additionally, the values can be combined as follows:
								</p><div class="table" id="idm140042815388368"><p class="title"><strong>Table 2.6. Inheritance settings combinations</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042815383520" scope="col">Value combinations</th><th style="text-align: left; vertical-align: top; " id="idm140042815382432" scope="col">Maps to the Windows <code class="literal">Applies to</code> setting</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815383520"> <p>
													<code class="literal">OI|CI</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815382432"> <p>
													This folder, subfolders, and files
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815383520"> <p>
													<code class="literal">OI|CI|IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815382432"> <p>
													Subfolders and files only
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815383520"> <p>
													<code class="literal">CI|IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815382432"> <p>
													Subfolders only
												</p>
												 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815383520"> <p>
													<code class="literal">OI|IO</code>
												</p>
												 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815382432"> <p>
													Files only
												</p>
												 </td></tr></tbody></table></div></div></dd><dt><span class="term">Permissions</span></dt><dd><p class="simpara">
									This value can be either a hex value that represents one or more Windows permissions or an <code class="literal">smbcacls</code> alias:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											A hex value that represents one or more Windows permissions.
										</p><p class="simpara">
											The following table displays the advanced Windows permissions and their corresponding value in hex format:
										</p><div class="table" id="table_windows-permissions-hex-values_assembly_using-the-smbcacls-utility"><p class="title"><strong>Table 2.7. Windows permissions and their corresponding smbcacls value in hex format</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 67%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042814207552" scope="col">Windows permissions</th><th style="text-align: left; vertical-align: top; " id="idm140042818593376" scope="col">Hex values</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Full control
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x001F01FF</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Traverse folder / execute file
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100020</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															List folder / read data
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100001</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Read attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100080</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Read extended attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100008</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Create files / write data
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100002</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Create folders / append data
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100004</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Write attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100100</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Write extended attributes
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100010</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Delete subfolders and files
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00100040</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Delete
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00110000</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Read permissions
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00120000</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Change permissions
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00140000</code>
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042814207552"> <p>
															Take ownership
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042818593376"> <p>
															<code class="literal">0x00180000</code>
														</p>
														 </td></tr></tbody></table></div></div><p class="simpara">
											Multiple permissions can be combined as a single hex value using the bit-wise <code class="literal">OR</code> operation. For details, see <a class="xref" href="index.html#con_ace-mask-calculation_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="2.7.3.3. ACE mask calculation">Section 2.7.3.3, “ACE mask calculation”</a>.
										</p></li><li class="listitem"><p class="simpara">
											An <code class="literal">smbcacls</code> alias. The following table displays the available aliases:
										</p><div class="table" id="table_smbcacls-aliases_assembly_using-the-smbcacls-utility"><p class="title"><strong>Table 2.8. Existing smbcacls aliases and their corresponding Windows permission</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 67%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140042815979248" scope="col"><code class="literal">smbcacls</code> alias</th><th style="text-align: left; vertical-align: top; " id="idm140042815977840" scope="col">Maps to Windows permission</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">R</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Read
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">READ</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Read &amp; execute
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">W</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Special:
														</p>
														 <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
																	Create files / write data
																</li><li class="listitem">
																	Create folders / append data
																</li><li class="listitem">
																	Write attributes
																</li><li class="listitem">
																	Write extended attributes
																</li><li class="listitem">
																	Read permissions
																</li></ul></div>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">D</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Delete
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">P</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Change permissions
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">O</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Take ownership
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">X</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Traverse / execute
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">CHANGE</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Modify
														</p>
														 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140042815979248"> <p>
															<code class="literal">FULL</code>
														</p>
														 </td><td style="text-align: left; vertical-align: top; " headers="idm140042815977840"> <p>
															Full control
														</p>
														 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
												You can combine single-letter aliases when you set permissions. For example, you can set <code class="literal">RD</code> to apply the Windows permission <code class="literal">Read</code> and <code class="literal">Delete</code>. However, you can neither combine multiple non-single-letter aliases nor combine aliases and hex values.
											</p></div></div></li></ul></div></dd></dl></div></section><section class="section" id="proc_displaying-acls-using-smbcacls_assembly_using-the-smbcacls-utility"><div class="titlepage"><div><div><h4 class="title">2.11.4.2. Displaying ACLs using smbcacls</h4></div></div></div><p>
						To display ACLs on an SMB share, use the <code class="literal">smbcacls</code> utility. If you run <code class="literal">smbcacls</code> without any operation parameter, such as <code class="literal">--add</code>, the utility displays the ACLs of a file system object.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							For example, to list the ACLs of the root directory of the <code class="literal">//server/example</code> share:
						</p></div><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator"
Enter <span class="emphasis"><em>DOMAIN</em></span>\administrator's password:
REVISION:1
CONTROL:SR|PD|DI|DP
OWNER:AD\Administrators
GROUP:AD\Domain Users
ACL:AD\Administrator:ALLOWED/OI|CI/FULL
ACL:AD\Domain Users:ALLOWED/OI|CI/CHANGE
ACL:AD\Domain Guests:ALLOWED/OI|CI/0x00100021</pre><p>
						The output of the command displays:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">REVISION</code>: The internal Windows NT ACL revision of the security descriptor
							</li><li class="listitem">
								<code class="literal">CONTROL</code>: Security descriptor control
							</li><li class="listitem">
								<code class="literal">OWNER</code>: Name or SID of the security descriptor’s owner
							</li><li class="listitem">
								<code class="literal">GROUP</code>: Name or SID of the security descriptor’s group
							</li><li class="listitem">
								<code class="literal">ACL</code> entries. For details, see <a class="xref" href="index.html#con_access-control-entries_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="2.7.3.1. Access control entries">Section 2.7.3.1, “Access control entries”</a>.
							</li></ul></div></section><section class="section" id="con_ace-mask-calculation_assembly_using-the-smbcacls-utility"><div class="titlepage"><div><div><h4 class="title">2.11.4.3. ACE mask calculation</h4></div></div></div><p>
						In most situations, when you add or update an ACE, you use the <code class="literal">smbcacls</code> aliases listed in <a class="xref" href="index.html#table_smbcacls-aliases_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="Table 2.4. Existing smbcacls aliases and their corresponding Windows permission">Table 2.4, “Existing smbcacls aliases and their corresponding Windows permission”</a>.
					</p><p>
						However, if you want to set advanced Windows permissions as listed in <a class="xref" href="index.html#table_windows-permissions-hex-values_assembly_managing-acls-on-an-smb-share-using-smbcacls" title="Table 2.3. Windows permissions and their corresponding smbcacls value in hex format">Table 2.3, “Windows permissions and their corresponding smbcacls value in hex format”</a>, you must use the bit-wise <code class="literal">OR</code> operation to calculate the correct value. You can use the following shell command to calculate the value:
					</p><pre class="literallayout"># echo $(printf '0x%X' $(( hex_value_1 | hex_value_2 | ... )))</pre><div class="example" id="idm140042814629296"><p class="title"><strong>Example 2.13. Calculating an ACE Mask</strong></p><div class="example-contents"><p>
							You want to set the following permissions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Traverse folder / execute file (0x00100020)
								</li><li class="listitem">
									List folder / read data (0x00100001)
								</li><li class="listitem">
									Read attributes (0x00100080)
								</li></ul></div><p>
							To calculate the hex value for the previous permissions, enter:
						</p><pre class="literallayout"># echo $(printf '0x%X' $(( 0x00100020 | 0x00100001 | 0x00100080 )))
<code class="literal">0x1000A1</code></pre><p>
							Use the returned value when you set or update an ACE.
						</p></div></div></section><section class="section" id="proc_adding-updating-and-removing-an-acl-using-smbcacls_assembly_using-the-smbcacls-utility"><div class="titlepage"><div><div><h4 class="title">2.11.4.4. Adding, updating, and removing an ACL using smbcacls</h4></div></div></div><p>
						Depending on the parameter you pass to the <code class="literal">smbcacls</code> utility, you can add, update, and remove ACLs from a file or directory.
					</p><h6 id="adding_an_acl_2">Adding an ACL</h6><p>
						To add an ACL to the root of the <code class="literal">//server/example</code> share that grants <code class="literal">CHANGE</code> permissions for <code class="literal">This folder, subfolders, and files</code> to the <code class="literal">AD\Domain Users</code> group:
					</p><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator \
       --add ACL:"AD\Domain Users":ALLOWED/OI|CI/CHANGE</pre><h6 id="updating_an_acl_2">Updating an ACL</h6><p>
						Updating an ACL is similar to adding a new ACL. You update an ACL by overriding the ACL using the <code class="literal">--modify</code> parameter with an existing security principal. If <code class="literal">smbcacls</code> finds the security principal in the ACL list, the utility updates the permissions. Otherwise the command fails with an error:
					</p><pre class="literallayout">ACL for SID <span class="emphasis"><em>principal_name</em></span> not found</pre><p>
						For example, to update the permissions of the <code class="literal">AD\Domain Users</code> group and set them to <code class="literal">READ</code> for <code class="literal">This folder, subfolders, and files</code>:
					</p><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator \
       --modify ACL:"AD\Domain Users":ALLOWED/OI|CI/READ</pre><h6 id="deleting_an_acl_2">Deleting an ACL</h6><p>
						To delete an ACL, pass the <code class="literal">--delete</code> parameter with the exact ACL to the <code class="literal">smbcacls</code> utility. For example:
					</p><pre class="literallayout"># smbcacls //server/example / -U "<span class="emphasis"><em>DOMAIN</em></span>\administrator \
       --delete ACL:"AD\Domain Users":ALLOWED/OI|CI/READ</pre></section></section><section class="section" id="assembly_using-the-smbclient-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.5. Using the smbclient utility</h3></div></div></div><p>
					The smbclient utility enables you to access file shares on an SMB server, similarly to a command-line FTP client. You can use it, for example, to upload and download files to and from a share.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-client</code> package is installed.
						</li></ul></div><section class="section" id="con_how-the-smbclient-interactive-mode-works_assembly_using-the-smbclient-utility"><div class="titlepage"><div><div><h4 class="title">2.11.5.1. How the smbclient interactive mode works</h4></div></div></div><p>
						For example, to authenticate to the <code class="literal">example</code> share hosted on <code class="literal">server</code> using the <code class="literal"><span class="emphasis"><em>DOMAIN\user</em></span></code> account:
					</p><pre class="literallayout"># smbclient -U "<span class="emphasis"><em>DOMAIN\user</em></span>" //<span class="emphasis"><em>server</em></span>/<span class="emphasis"><em>example</em></span>
Enter <span class="emphasis"><em>domain\user</em></span>'s password:
Try "help" to get a list of possible commands.
smb: \&gt;</pre><p>
						After <code class="literal">smbclient</code> connected successfully to the share, the utility enters the interactive mode and shows the following prompt:
					</p><pre class="literallayout">smb: \&gt;</pre><p>
						To display all available commands in the interactive shell, enter:
					</p><pre class="literallayout">smb: \&gt; help</pre><p>
						To display the help for a specific command, enter:
					</p><pre class="literallayout">smb: \&gt; help <span class="emphasis"><em>command_name</em></span></pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								For further details and descriptions of the commands available in the interactive shell, see the <code class="literal">smbclient(1)</code> man page.
							</li></ul></div></section><section class="section" id="proc_using-smbclient-in-interactive-mode_assembly_using-the-smbclient-utility"><div class="titlepage"><div><div><h4 class="title">2.11.5.2. Using smbclient in interactive mode</h4></div></div></div><p>
						If you use <code class="literal">smbclient</code> without the <code class="literal">-c</code> parameter, the utility enters the interactive mode. The following procedure shows how to connect to an SMB share and download a file from a subdirectory.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Connect to the share:
							</p><pre class="literallayout"># smbclient -U "<span class="emphasis"><em>DOMAIN\user_name</em></span>" //<span class="emphasis"><em>server_name</em></span>/<span class="emphasis"><em>share_name</em></span></pre></li><li class="listitem"><p class="simpara">
								Change into the <code class="literal">/example/</code> directory:
							</p><pre class="literallayout">smb: \&gt; cd /example/</pre></li><li class="listitem"><p class="simpara">
								List the files in the directory:
							</p><pre class="literallayout">smb: \example\&gt; ls
  .                    D         0  Thu Nov 1 10:00:00 2018
  ..                   D         0  Thu Nov 1 10:00:00 2018
  example.txt          N   1048576  Thu Nov 1 10:00:00 2018

         9950208 blocks of size 1024. 8247144 blocks available</pre></li><li class="listitem"><p class="simpara">
								Download the <code class="literal">example.txt</code> file:
							</p><pre class="literallayout">smb: \example\&gt; get example.txt
getting file \directory\subdirectory\example.txt of size 1048576 as example.txt (511975,0 KiloBytes/sec) (average 170666,7 KiloBytes/sec)</pre></li><li class="listitem"><p class="simpara">
								Disconnect from the share:
							</p><pre class="literallayout">smb: \example\&gt; exit</pre></li></ol></div></section><section class="section" id="proc_using-smbclient-in-scripting-mode_assembly_using-the-smbclient-utility"><div class="titlepage"><div><div><h4 class="title">2.11.5.3. Using smbclient in scripting mode</h4></div></div></div><p>
						If you pass the <code class="literal">-c</code> parameter to <code class="literal">smbclient</code>, you can automatically execute the commands on the remote SMB share. This enables you to use <code class="literal">smbclient</code> in scripts.
					</p><p>
						The following procedure shows how to connect to an SMB share and download a file from a subdirectory.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							
<pre class="literallayout"># smbclient -U <span class="emphasis"><em>DOMAIN\user_name</em></span> //<span class="emphasis"><em>server_name</em></span>/<span class="emphasis"><em>share_name</em></span> \
       -c "cd /example/ ; get example.txt ; exit"</pre>

						</p></div></section></section><section class="section" id="proc_using-the-smbcontrol-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.6. Using the smbcontrol utility</h3></div></div></div><p>
					The <code class="literal">smbcontrol</code> utility enables you to send command messages to the <code class="literal">smbd</code>, <code class="literal">nmbd</code>, <code class="literal">winbindd</code>, or all of these services. These control messages instruct the service, for example, to reload its configuration.
				</p><p>
					The procedure in this section shows how to to reload the configuration of the <code class="literal">smbd</code>, <code class="literal">nmbd</code>, <code class="literal">winbindd</code> services by sending the <code class="literal">reload-config</code> message type to the <code class="literal">all</code> destination.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-common-tools</code> package is installed.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						
<pre class="literallayout"># smbcontrol all reload-config</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
						For further details and a list of available command message types, see the <code class="literal">smbcontrol(1)</code> man page.
					</p></div></section><section class="section" id="proc_using-the-smbpasswd-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.7. Using the smbpasswd utility</h3></div></div></div><p>
					The <code class="literal">smbpasswd</code> utility manages user accounts and passwords in the local Samba database.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-common-tools</code> package is installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							If you run the command as a user, <code class="literal">smbpasswd</code> changes the Samba password of the user who run the command. For example:
						</p><pre class="literallayout">[user@server ~]$ smbpasswd
New SMB password: <span class="emphasis"><em>password</em></span>
Retype new SMB password: <span class="emphasis"><em>password</em></span></pre></li><li class="listitem"><p class="simpara">
							If you run <code class="literal">smbpasswd</code> as the <code class="literal">root</code> user, you can use the utility, for example, to:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Create a new user:
								</p><pre class="literallayout">[root@server ~]# smbpasswd -a <span class="emphasis"><em>user_name</em></span>
New SMB password: <span class="emphasis"><em>password</em></span>
Retype new SMB password: <span class="emphasis"><em>password</em></span>
Added user <span class="emphasis"><em>user_name</em></span>.</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Before you can add a user to the Samba database, you must create the account in the local operating system. See the <a class="link" href="https://doc-stage.usersys.redhat.com/documentation/en-us/red_hat_enterprise_linux/8_test/html/getting_started_with_system_administration/managing-users-groups-permissions/#sec-users-tools-users-add">Adding a new user</a> section in the Configuring and managing system administration guide.
									</p></div></div></li><li class="listitem"><p class="simpara">
									Enable a Samba user:
								</p><pre class="literallayout">[root@server ~]# smbpasswd -e <span class="emphasis"><em>user_name</em></span>
Enabled user <span class="emphasis"><em>user_name</em></span>.</pre></li><li class="listitem"><p class="simpara">
									Disable a Samba user:
								</p><pre class="literallayout">[root@server ~]# smbpasswd -x <span class="emphasis"><em>user_name</em></span>
Disabled user <span class="emphasis"><em>ser_name</em></span></pre></li><li class="listitem"><p class="simpara">
									Delete a user:
								</p><pre class="literallayout">[root@server ~]# smbpasswd -x <span class="emphasis"><em>user_name</em></span>
Deleted user <span class="emphasis"><em>user_name</em></span>.</pre></li></ul></div></li></ol></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
						For further details, see the <code class="literal">smbpasswd(8)</code> man page.
					</p></div></section><section class="section" id="proc_using-the-smbstatus-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.8. Using the smbstatus utility</h3></div></div></div><p>
					The <code class="literal">smbstatus</code> utility reports on:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Connections per PID of each <code class="literal">smbd</code> daemon to the Samba server. This report includes the user name, primary group, SMB protocol version, encryption, and signing information.
						</li><li class="listitem">
							Connections per Samba share. This report includes the PID of the <code class="literal">smbd</code> daemon, the IP of the connecting machine, the time stamp when the connection was established, encryption, and signing information.
						</li><li class="listitem">
							A list of locked files. The report entries include further details, such as opportunistic lock (oplock) types
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba</code> package is installed.
						</li><li class="listitem">
							The <code class="literal">smbd</code> service is running.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						
<pre class="literallayout"># smbstatus

Samba version 4.7.1
PID  Username              Group                Machine                            Protocol Version  Encryption  Signing
-----------------------------------------------------------------------------------------------------------------------------
963  <span class="emphasis"><em>DOMAIN</em></span>\administrator  <span class="emphasis"><em>DOMAIN</em></span>\domain users  client-pc  (ipv4:192.0.2.1:57786)  SMB3_02           -           AES-128-CMAC

Service  pid  Machine    Connected at                  Encryption  Signing:
-------------------------------------------------------------------------------
example  969  192.0.2.1  Thu Nov  1 10:00:00 2018 CEST  -           AES-128-CMAC

Locked files:
Pid  Uid    DenyMode   Access    R/W     Oplock      SharePath           Name      Time
------------------------------------------------------------------------------------------------------------
969  10000  DENY_WRITE 0x120089  RDONLY  LEASE(RWH)  /srv/samba/example  file.txt  Thu Nov  1 10:00:00 2018</pre>

					</p></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
						For further details, see the <code class="literal">smbstatus(1)</code> man page.
					</p></div></section><section class="section" id="proc_using-the-smbtar-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.9. Using the smbtar utility</h3></div></div></div><p>
					The <code class="literal">smbtar</code> utility backs up the content of an SMB share or a subdirectory of it and stores the content in a <code class="literal">tar</code> archive. Alternatively, you can write the content to a tape device.
				</p><p>
					The procedure in this section describes how to back up the content of the <code class="literal">demo</code> directory on the <code class="literal">//server/example/</code> share and store the content in the <code class="literal">/root/example.tar</code> archive.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-client</code> package is installed.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						
<pre class="literallayout"># smbtar -s <span class="emphasis"><em>server</em></span> -x <span class="emphasis"><em>example</em></span> -u <span class="emphasis"><em>user_name</em></span> -p <span class="emphasis"><em>password</em></span> -t <span class="emphasis"><em>/root/example.tar</em></span></pre>

					</p></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
						For further details, see the <code class="literal">smbtar(1)</code> man page.
					</p></div></section><section class="section" id="proc_using-the-testparm-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.10. Using the testparm utility</h3></div></div></div><p>
					The <code class="literal">testparm</code> utility verifies that the Samba configuration in the <code class="literal filename">/etc/samba/smb.conf</code> file is correct. The utility detects invalid parameters and values, but also incorrect settings, such as for ID mapping. If <code class="literal">testparm</code> reports no problem, the Samba services will successfully load the <code class="literal filename">/etc/samba/smb.conf</code> file. Note that <code class="literal">testparm</code> cannot verify that the configured services will be available or work as expected.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Red Hat recommends that you verify the <code class="literal filename">/etc/samba/smb.conf</code> file by using <code class="literal">testparm</code> after each modification of this file.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal">testparm</code> utility as the <code class="literal">root</code> user:
						</p><pre class="literallayout"># testparm
Load smb config files from /etc/samba/smb.conf
rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)
<span class="strong strong"><strong>Unknown parameter encountered: "log levell"</strong></span>
Processing section "[example_share]"
Loaded services file OK.
<span class="strong strong"><strong>ERROR: The idmap range for the domain * (tdb) overlaps with the range of DOMAIN (ad)!</strong></span>

Server role: ROLE_DOMAIN_MEMBER

Press enter to see a dump of your service definitions

# Global parameters
[global]
	...

[example_share]
	...</pre><p class="simpara">
							The previous example output reports a non-existent parameter and an incorrect ID mapping configuration.
						</p></li><li class="listitem">
							If <code class="literal">testparm</code> reports incorrect parameters, values, or other errors in the configuration, fix the problem and run the utility again.
						</li></ol></div></section><section class="section" id="proc_using-the-wbinfo-utility_assembly_frequently-used-samba-command-line-utilities"><div class="titlepage"><div><div><h3 class="title">2.11.11. Using the wbinfo utility</h3></div></div></div><p>
					The <code class="literal">wbinfo</code> utility queries and returns information created and used by the <code class="literal">winbindd</code> service.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">samba-winbind-clients</code> package is installed.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						You can use <code class="literal">wbinfo</code>, for example, to:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							List domain users:
						</p><pre class="literallayout"># wbinfo -u
AD\administrator
AD\guest
...</pre></li><li class="listitem"><p class="simpara">
							List domain groups:
						</p><pre class="literallayout"># wbinfo -g
AD\domain computers
AD\domain admins
AD\domain users
...</pre></li><li class="listitem"><p class="simpara">
							Display the SID of a user:
						</p><pre class="literallayout"># wbinfo --name-to-sid="AD\administrator"
<span class="emphasis"><em>S-1-5-21-1762709870-351891212-3141221786-500</em></span> SID_USER (1)</pre></li><li class="listitem"><p class="simpara">
							Display information about domains and trusts:
						</p><pre class="literallayout"># wbinfo --trusted-domains --verbose
Domain Name   DNS Domain            Trust Type  Transitive  In   Out
BUILTIN                             None        Yes         Yes  Yes
<span class="emphasis"><em>server</em></span>                              None        Yes         Yes  Yes
<span class="emphasis"><em>DOMAIN1</em></span>       <span class="emphasis"><em>domain1.example.com</em></span>   None        Yes         Yes  Yes
<span class="emphasis"><em>DOMAIN2</em></span>       <span class="emphasis"><em>domain2.example.com</em></span>   External    No          Yes  Yes</pre></li></ul></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
						For further details, see the <code class="literal">wbinfo(1)</code> man page.
					</p></div></section></section><section class="section" id="related-information-assembly_using-samba-as-a-server"><div class="titlepage"><div><div><h2 class="title">2.12. Related information</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The Red Hat Samba packages include manual pages for all Samba commands and configuration files the package installs. For example, to display the man page of the <code class="literal filename">/etc/samba/smb.conf</code> file that explains all configuration parameters you can set in this file:
					</p><pre class="literallayout"># man 5 smb.conf</pre></li><li class="listitem">
						The <code class="literal">/usr/share/docs/samba-version/</code> directory contains general documentation, example scripts, and LDAP schema files, provided by the Samba project.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_gluster_storage/3.3/html/administration_guide/sect-smb">Red Hat Cluster Storage Administration Guide</a>: Provides information about setting up Samba and the Clustered Trivial Database (CDTB) to share directories stored on an GlusterFS volume.
					</li><li class="listitem">
						For details about mounting an SMB share on Red Hat Enterprise Linux, see the corresponding section in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_storage_and_filesystems/assembly_mounting-an-smb-share-on-red-hat-enterprise-linux_configuring-and-managing-storage-and-filesystems">Configuring and managing storage and file systems</a> documentation.
					</li></ul></div></section></section><section class="chapter" id="exporting-nfs-shares_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Exporting NFS shares</h1></div></div></div><p>
			As a system administrator, you can use the NFS server to share a directory on your system over network.
		</p><section class="section" id="introduction-to-nfs_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.1. Introduction to NFS</h2></div></div></div><p>
				This section explains the basic concepts of the NFS service.
			</p><p>
				A Network File System (NFS) allows remote hosts to mount file systems over a network and interact with those file systems as though they are mounted locally. This enables you to consolidate resources onto centralized servers on the network.
			</p><p>
				The NFS server refers to the <code class="literal filename">/etc/exports</code> configuration file to determine whether the client is allowed to access any exported file systems. Once verified, all file and directory operations are available to the user.
			</p></section><section class="section" id="supported-nfs-versions_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.2. Supported NFS versions</h2></div></div></div><p>
				This section lists versions of NFS supported in Red Hat Enterprise Linux and their features.
			</p><p>
				Currently, Red Hat Enterprise Linux 8 supports the following major versions of NFS:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						NFS version 3 (NFSv3) supports safe asynchronous writes and is more robust at error handling than the previous NFSv2; it also supports 64-bit file sizes and offsets, allowing clients to access more than 2 GB of file data.
					</li><li class="listitem">
						NFS version 4 (NFSv4) works through firewalls and on the Internet, no longer requires an <code class="literal">rpcbind</code> service, supports Access Control Lists (ACLs), and utilizes stateful operations.
					</li></ul></div><p>
				NFS version 2 (NFSv2) is no longer supported by Red Hat.
			</p><h4 id="default_nfs_version">Default NFS version</h4><p>
				The default NFS version in Red Hat Enterprise Linux 8 is 4.2. NFS clients attempt to mount using NFSv4.2 by default, and fall back to NFSv4.1 when the server does not support NFSv4.2. The mount later falls back to NFSv4.0 and then to NFSv3.
			</p><h4 id="features_of_minor_nfs_versions">Features of minor NFS versions</h4><p>
				Following are the features of NFSv4.2 in Red Hat Enterprise Linux 8:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Server-side copy</span></dt><dd>
							Enables the NFS client to efficiently copy data without wasting network resources using the <code class="literal">copy_file_range()</code> system call.
						</dd><dt><span class="term">Sparse files</span></dt><dd>
							Enables files to have one or more <span class="emphasis"><em>holes</em></span>, which are unallocated or uninitialized data blocks consisting only of zeroes. The <code class="literal">lseek()</code> operation in NFSv4.2 supports <code class="literal">seek_hole()</code> and <code class="literal">seek_data()</code>, which enables applications to map out the location of holes in the sparse file.
						</dd><dt><span class="term">Space reservation</span></dt><dd>
							Permits storage servers to reserve free space, which prohibits servers to run out of space. NFSv4.2 supports the <code class="literal">allocate()</code> operation to reserve space, the <code class="literal">deallocate()</code> operation to unreserve space, and the <code class="literal">fallocate()</code> operation to preallocate or deallocate space in a file.
						</dd><dt><span class="term">Labeled NFS</span></dt><dd>
							Enforces data access rights and enables SELinux labels between a client and a server for individual files on an NFS file system.
						</dd><dt><span class="term">Layout enhancements</span></dt><dd>
							Provides the <code class="literal">layoutstats()</code> operation, which enables some Parallel NFS (pNFS) servers to collect better performance statistics.
						</dd></dl></div><p>
				Following are the features of NFSv4.1:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Enhances performance and security of network, and also includes client-side support for pNFS.
					</li><li class="listitem">
						No longer requires a separate TCP connection for callbacks, which allows an NFS server to grant delegations even when it cannot contact the client: for example, when NAT or a firewall interferes.
					</li><li class="listitem">
						Provides exactly once semantics (except for reboot operations), preventing a previous issue whereby certain operations sometimes returned an inaccurate result if a reply was lost and the operation was sent twice.
					</li></ul></div></section><section class="section" id="the-tcp-and-udp-protocols-in-nfsv3-and-nfsv4_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.3. The TCP and UDP protocols in NFSv3 and NFSv4</h2></div></div></div><p>
				NFSv4 requires the Transmission Control Protocol (TCP) running over an IP network.
			</p><p>
				NFSv3 could also use the User Datagram Protocol (UDP) in earlier Red Hat Enterprise Linux versions. In Red Hat Enterprise Linux 8, NFS over UDP is no longer supported. By default, UDP is disabled in the NFS server.
			</p></section><section class="section" id="services-required-by-nfs_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.4. Services required by NFS</h2></div></div></div><p>
				This section lists system services that are required for running an NFS server or mounting NFS shares. Red Hat Enterprise Linux starts these services automatically.
			</p><p>
				Red Hat Enterprise Linux uses a combination of kernel-level support and service processes to provide NFS file sharing. All NFS versions rely on Remote Procedure Calls (RPC) between clients and servers. To share or mount NFS file systems, the following services work together depending on which version of NFS is implemented:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">nfsd</code></span></dt><dd>
							The NFS server kernel module that services requests for shared NFS file systems.
						</dd><dt><span class="term"><code class="literal">rpcbind</code></span></dt><dd>
							Accepts port reservations from local RPC services. These ports are then made available (or advertised) so the corresponding remote RPC services can access them. The <code class="literal">rpcbind</code> service responds to requests for RPC services and sets up connections to the requested RPC service. This is not used with NFSv4.
						</dd><dt><span class="term"><code class="literal">rpc.mountd</code></span></dt><dd>
							This process is used by an NFS server to process <code class="literal">MOUNT</code> requests from NFSv3 clients. It checks that the requested NFS share is currently exported by the NFS server, and that the client is allowed to access it. If the mount request is allowed, the <code class="literal">nfs-mountd</code> service replies with a Success status and provides the File-Handle for this NFS share back to the NFS client.
						</dd><dt><span class="term"><code class="literal">rpc.nfsd</code></span></dt><dd>
							This process enables explicit NFS versions and protocols the server advertises to be defined. It works with the Linux kernel to meet the dynamic demands of NFS clients, such as providing server threads each time an NFS client connects. This process corresponds to the <code class="literal">nfs-server</code> service.
						</dd><dt><span class="term"><code class="literal">lockd</code></span></dt><dd>
							This is a kernel thread that runs on both clients and servers. It implements the Network Lock Manager (NLM) protocol, which enables NFSv3 clients to lock files on the server. It is started automatically whenever the NFS server is run and whenever an NFS file system is mounted.
						</dd><dt><span class="term"><code class="literal">rpc.statd</code></span></dt><dd>
							This process implements the Network Status Monitor (NSM) RPC protocol, which notifies NFS clients when an NFS server is restarted without being gracefully brought down. The <code class="literal">rpc-statd</code> service is started automatically by the <code class="literal">nfs-server</code> service, and does not require user configuration. This is not used with NFSv4.
						</dd><dt><span class="term"><code class="literal">rpc.rquotad</code></span></dt><dd>
							This process provides user quota information for remote users. The <code class="literal">rpc-rquotad</code> service is started automatically by the <code class="literal">nfs-server</code> service and does not require user configuration.
						</dd><dt><span class="term"><code class="literal">rpc.idmapd</code></span></dt><dd><p class="simpara">
							This process provides NFSv4 client and server upcalls, which map between on-the-wire NFSv4 names (strings in the form of <code class="literal"><span class="emphasis"><em>user</em></span>@<span class="emphasis"><em>domain</em></span></code>) and local UIDs and GIDs. For <code class="literal">idmapd</code> to function with NFSv4, the <code class="literal filename">/etc/idmapd.conf</code> file must be configured. At a minimum, the <code class="literal">Domain</code> parameter should be specified, which defines the NFSv4 mapping domain. If the NFSv4 mapping domain is the same as the DNS domain name, this parameter can be skipped. The client and server must agree on the NFSv4 mapping domain for ID mapping to function properly.
						</p><p class="simpara">
							Only the NFSv4 server uses <code class="literal">rpc.idmapd</code>, which is started by the <code class="literal">nfs-idmapd</code> service. The NFSv4 client uses the keyring-based <code class="literal">nfsidmap</code> utility, which is called by the kernel on-demand to perform ID mapping. If there is a problem with <code class="literal">nfsidmap</code>, the client falls back to using <code class="literal">rpc.idmapd</code>.
						</p></dd></dl></div><h4 id="the_rpc_services_with_nfsv4">The RPC services with NFSv4</h4><p>
				The mounting and locking protocols have been incorporated into the NFSv4 protocol. The server also listens on the well-known TCP port 2049. As such, NFSv4 does not need to interact with <code class="literal">rpcbind</code>, <code class="literal">lockd</code>, and <code class="literal">rpc-statd</code> services. The <code class="literal">nfs-mountd</code> service is still required on the NFS server to set up the exports, but is not involved in any over-the-wire operations.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To configure an NFSv4-only server, which does not require <code class="literal">rpcbind</code>, see <a class="xref" href="index.html#configuring-an-nfsv4-only-server_exporting-nfs-shares" title="3.14. Configuring an NFSv4-only server">Section 3.14, “Configuring an NFSv4-only server”</a>.
					</li></ul></div></section><section class="section" id="nfs-host-name-formats_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.5. NFS host name formats</h2></div></div></div><p>
				This section describes different formats that you can use to specify a host when mounting or exporting an NFS share.
			</p><p>
				You can specify the host in the following formats:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Single machine</span></dt><dd><p class="simpara">
							Either of the following:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A fully-qualified domain name (that can be resolved by the server)
								</li><li class="listitem">
									Host name (that can be resolved by the server)
								</li><li class="listitem">
									An IP address.
								</li></ul></div></dd><dt><span class="term">Series of machines specified with wildcards</span></dt><dd><p class="simpara">
							You can use the <code class="literal">*</code> or <code class="literal">?</code> characters to specify a string match.
						</p><p class="simpara">
							Wildcards are not to be used with IP addresses; however, they might accidentally work if reverse DNS lookups fail. When specifying wildcards in fully qualified domain names, dots (<code class="literal">.</code>) are not included in the wildcard. For example, <code class="literal">*.example.com</code> includes <code class="literal">one.example.com</code> but does not include <code class="literal">one.two.example.com</code>.
						</p></dd><dt><span class="term">IP networks</span></dt><dd><p class="simpara">
							Either of the following formats is valid:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="emphasis"><em><span class="replaceable replaceable"><code class="literal">a.b.c.d/z</code></span></em></span>, where <span class="emphasis"><em><span class="replaceable replaceable"><code class="literal">a.b.c.d</code></span></em></span> is the network and <span class="emphasis"><em><span class="replaceable replaceable"><code class="literal">z</code></span></em></span> is the number of bits in the netmask; for example <code class="literal">192.168.0.0/24</code>.
								</li><li class="listitem">
									<span class="emphasis"><em><span class="replaceable replaceable"><code class="literal">a.b.c.d/netmask</code></span></em></span>, where <span class="emphasis"><em><span class="replaceable replaceable"><code class="literal">a.b.c.d</code></span></em></span> is the network and <span class="emphasis"><em><span class="replaceable replaceable"><code class="literal">netmask</code></span></em></span> is the netmask; for example, <code class="literal">192.168.100.8/255.255.255.0</code>.
								</li></ul></div></dd><dt><span class="term">Netgroups</span></dt><dd>
							The <code class="literal">@<span class="emphasis"><em>group-name</em></span></code> format , where <span class="emphasis"><em><span class="replaceable replaceable"><code class="literal">group-name</code></span></em></span> is the NIS netgroup name.
						</dd></dl></div></section><section class="section" id="nfs-server-configuration_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.6. NFS server configuration</h2></div></div></div><p>
				This section describes the syntax and options of two ways to configure exports on an NFS server:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Manually editing the <code class="literal filename">/etc/exports</code> configuration file
					</li><li class="listitem">
						Using the <code class="literal">exportfs</code> utility on the command line
					</li></ul></div><section class="section" id="the-etc-exports-configuration-file_exporting-nfs-shares"><div class="titlepage"><div><div><h3 class="title">3.6.1. The /etc/exports configuration file</h3></div></div></div><p>
					The <code class="literal filename">/etc/exports</code> file controls which file systems are exported to remote hosts and specifies options. It follows the following syntax rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Blank lines are ignored.
						</li><li class="listitem">
							To add a comment, start a line with the hash mark (<code class="literal">#</code>).
						</li><li class="listitem">
							You can wrap long lines with a backslash (<code class="literal">\</code>).
						</li><li class="listitem">
							Each exported file system should be on its own individual line.
						</li><li class="listitem">
							Any lists of authorized hosts placed after an exported file system must be separated by space characters.
						</li><li class="listitem">
							Options for each of the hosts must be placed in parentheses directly after the host identifier, without any spaces separating the host and the first parenthesis.
						</li></ul></div><h5 id="export_entry">Export entry</h5><p>
					Each entry for an exported file system has the following structure:
				</p><pre class="screen"><span class="emphasis"><em><span class="replaceable replaceable">export</span></em></span> <span class="emphasis"><em><span class="replaceable replaceable">host</span></em></span>(<span class="emphasis"><em><span class="replaceable replaceable">options</span></em></span>)</pre><p>
					It is also possible to specify multiple hosts, along with specific options for each host. To do so, list them on the same line as a space-delimited list, with each host name followed by its respective options (in parentheses), as in:
				</p><pre class="screen"><span class="emphasis"><em><span class="replaceable replaceable">export</span></em></span> <span class="emphasis"><em><span class="replaceable replaceable">host1</span></em></span>(<span class="emphasis"><em><span class="replaceable replaceable">options1</span></em></span>) <span class="emphasis"><em><span class="replaceable replaceable">host2</span></em></span>(<span class="emphasis"><em><span class="replaceable replaceable">options2</span></em></span>) <span class="emphasis"><em><span class="replaceable replaceable">host3</span></em></span>(<span class="emphasis"><em><span class="replaceable replaceable">options3</span></em></span>)</pre><p>
					In this structure:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="emphasis"><em><span class="replaceable replaceable">export</span></em></span></span></dt><dd>
								The directory being exported
							</dd><dt><span class="term"><span class="emphasis"><em><span class="replaceable replaceable">host</span></em></span></span></dt><dd>
								The host or network to which the export is being shared
							</dd><dt><span class="term"><span class="emphasis"><em><span class="replaceable replaceable">options</span></em></span></span></dt><dd>
								The options to be used for host
							</dd></dl></div><div class="example" id="idm140042817294032"><p class="title"><strong>Example 3.1. A simple /etc/exports file</strong></p><div class="example-contents"><p>
						In its simplest form, the <code class="literal filename">/etc/exports</code> file only specifies the exported directory and the hosts permitted to access it:
					</p><pre class="screen">/exported/directory bob.example.com</pre><p>
						Here, <code class="literal">bob.example.com</code> can mount <code class="literal filename">/exported/directory/</code> from the NFS server. Because no options are specified in this example, NFS uses default options.
					</p></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The format of the <code class="literal filename">/etc/exports</code> file is very precise, particularly in regards to use of the space character. Remember to always separate exported file systems from hosts and hosts from one another with a space character. However, there should be no other space characters in the file except on comment lines.
					</p><p>
						For example, the following two lines do not mean the same thing:
					</p><pre class="screen">/home bob.example.com(rw)
/home bob.example.com (rw)</pre><p>
						The first line allows only users from <code class="literal">bob.example.com</code> read and write access to the <code class="literal filename">/home</code> directory. The second line allows users from <code class="literal">bob.example.com</code> to mount the directory as read-only (the default), while the rest of the world can mount it read/write.
					</p></div></div><h5 id="default_options">Default options</h5><p>
					The default options for an export entry are:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal option">ro</code></span></dt><dd>
								The exported file system is read-only. Remote hosts cannot change the data shared on the file system. To allow hosts to make changes to the file system (that is, read and write), specify the rw option.
							</dd><dt><span class="term"><code class="literal options">sync</code></span></dt><dd>
								The NFS server will not reply to requests before changes made by previous requests are written to disk. To enable asynchronous writes instead, specify the option <code class="literal option">async</code>.
							</dd><dt><span class="term"><code class="literal option">wdelay</code></span></dt><dd>
								The NFS server will delay writing to the disk if it suspects another write request is imminent. This can improve performance as it reduces the number of times the disk must be accessed by separate write commands, thereby reducing write overhead. To disable this, specify the <code class="literal option">no_wdelay</code> option, which is available only if the default sync option is also specified.
							</dd><dt><span class="term"><code class="literal option">root_squash</code></span></dt><dd><p class="simpara">
								This prevents root users connected remotely (as opposed to locally) from having root privileges; instead, the NFS server assigns them the user ID <code class="literal">nfsnobody</code>. This effectively "squashes" the power of the remote root user to the lowest local user, preventing possible unauthorized writes on the remote server. To disable root squashing, specify the <code class="literal option">no_root_squash</code> option.
							</p><p class="simpara">
								To squash every remote user (including root), use the <code class="literal option">all_squash</code> option. To specify the user and group IDs that the NFS server should assign to remote users from a particular host, use the <code class="literal option">anonuid</code> and <code class="literal option">anongid</code> options, respectively, as in:
							</p><pre class="screen"><span class="emphasis"><em><span class="replaceable replaceable">export</span></em></span> <span class="emphasis"><em><span class="replaceable replaceable">host</span></em></span>(anonuid=<span class="emphasis"><em><span class="replaceable replaceable">uid</span></em></span>,anongid=<span class="emphasis"><em><span class="replaceable replaceable">gid</span></em></span>)</pre><p class="simpara">
								Here, <span class="emphasis"><em><span class="replaceable replaceable">uid</span></em></span> and <span class="emphasis"><em><span class="replaceable replaceable">gid</span></em></span> are user ID number and group ID number, respectively. The <code class="literal option">anonuid</code> and <code class="literal option">anongid</code> options enable you to create a special user and group account for remote NFS users to share.
							</p></dd></dl></div><p>
					By default, access control lists (ACLs) are supported by NFS under Red Hat Enterprise Linux. To disable this feature, specify the <code class="literal option">no_acl</code> option when exporting the file system.
				</p><h5 id="default_and_overridden_options">Default and overridden options</h5><p>
					Each default for every exported file system must be explicitly overridden. For example, if the <code class="literal">rw</code> option is not specified, then the exported file system is shared as read-only. The following is a sample line from <code class="literal filename">/etc/exports</code> which overrides two default options:
				</p><pre class="screen">/another/exported/directory 192.168.0.3(rw,async)</pre><p>
					In this example, <code class="literal">192.168.0.3</code> can mount <code class="literal filename">/another/exported/directory/</code> read and write, and all writes to disk are asynchronous.
				</p></section><section class="section" id="the-exportfs-utility_exporting-nfs-shares"><div class="titlepage"><div><div><h3 class="title">3.6.2. The exportfs utility</h3></div></div></div><p>
					The <code class="literal">exportfs</code> utility enables the root user to selectively export or unexport directories without restarting the NFS service. When given the proper options, the <code class="literal">exportfs</code> utility writes the exported file systems to <code class="literal filename">/var/lib/nfs/xtab</code>. Because the <code class="literal">nfs-mountd</code> service refers to the <code class="literal">xtab</code> file when deciding access privileges to a file system, changes to the list of exported file systems take effect immediately.
				</p><h5 id="common_exportfs_options">Common exportfs options</h5><p>
					The following is a list of commonly-used options available for <code class="literal">exportfs</code>:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal option">-r</code></span></dt><dd>
								Causes all directories listed in <code class="literal filename">/etc/exports</code> to be exported by constructing a new export list in <code class="literal filename">/etc/lib/nfs/xtab</code>. This option effectively refreshes the export list with any changes made to <code class="literal filename">/etc/exports</code>.
							</dd><dt><span class="term"><code class="literal option">-a</code></span></dt><dd>
								Causes all directories to be exported or unexported, depending on what other options are passed to <code class="literal">exportfs</code>. If no other options are specified, <code class="literal">exportfs</code> exports all file systems specified in <code class="literal filename">/etc/exports</code>.
							</dd><dt><span class="term"><code class="literal option">-o <span class="emphasis"><em><span class="replaceable replaceable">file-systems</span></em></span></code></span></dt><dd>
								Specifies directories to be exported that are not listed in <code class="literal filename">/etc/exports</code>. Replace <span class="emphasis"><em><span class="replaceable replaceable">file-systems</span></em></span> with additional file systems to be exported. These file systems must be formatted in the same way they are specified in <code class="literal filename">/etc/exports</code>. This option is often used to test an exported file system before adding it permanently to the list of exported file systems.
							</dd><dt><span class="term"><code class="literal option">-i</code></span></dt><dd>
								Ignores <code class="literal filename">/etc/exports</code>; only options given from the command line are used to define exported file systems.
							</dd><dt><span class="term"><code class="literal option">-u</code></span></dt><dd>
								Unexports all shared directories. The command <code class="literal command">exportfs -ua</code> suspends NFS file sharing while keeping all NFS services up. To re-enable NFS sharing, use <code class="literal command">exportfs -r</code>.
							</dd><dt><span class="term"><code class="literal option">-v</code></span></dt><dd>
								Verbose operation, where the file systems being exported or unexported are displayed in greater detail when the <code class="literal">exportfs</code> command is executed.
							</dd></dl></div><p>
					If no options are passed to the <code class="literal">exportfs</code> utility, it displays a list of currently exported file systems.
				</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For information on different methods for specifying host names, see <a class="xref" href="index.html#nfs-host-name-formats_exporting-nfs-shares" title="3.5. NFS host name formats">Section 3.5, “NFS host name formats”</a>.
						</li><li class="listitem">
							For a complete list of export options, see the <code class="literal">exports(5)</code> man page.
						</li><li class="listitem">
							For more information about the <code class="literal">exportfs</code> utility, see the <code class="literal">exportfs(8)</code> man page.
						</li></ul></div></section></section><section class="section" id="nfs-and-rpcbind_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.7. NFS and rpcbind</h2></div></div></div><p>
				This section explains the purpose of the <code class="literal">rpcbind</code> service, which is required by NFSv3.
			</p><p>
				The <code class="literal">rpcbind</code> service maps Remote Procedure Call (RPC) services to the ports on which they listen. RPC processes notify <code class="literal">rpcbind</code> when they start, registering the ports they are listening on and the RPC program numbers they expect to serve. The client system then contacts <code class="literal">rpcbind</code> on the server with a particular RPC program number. The <code class="literal">rpcbind</code> service redirects the client to the proper port number so it can communicate with the requested service.
			</p><p>
				Because RPC-based services rely on <code class="literal">rpcbind</code> to make all connections with incoming client requests, <code class="literal">rpcbind</code> must be available before any of these services start.
			</p><p>
				Access control rules for <code class="literal">rpcbind</code> affect all RPC-based services. Alternatively, it is possible to specify access control rules for each of the NFS RPC daemons.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For the precise syntax of access control rules, see the <code class="literal">rpc.mountd(8)</code> and <code class="literal">rpc.statd(8)</code> man pages.
					</li></ul></div></section><section class="section" id="installing-nfs_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.8. Installing NFS</h2></div></div></div><p>
				This procedure installs all packages necessary to mount or export NFS shares.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Install the <code class="literal">nfs-utils</code> package:
					</p><pre class="screen"># yum install nfs-utils</pre></li></ul></div></section><section class="section" id="starting-the-nfs-server_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.9. Starting the NFS server</h2></div></div></div><p>
				This procedure describes how to start the NFS server, which is required to export NFS shares.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						For servers that support NFSv2 or NFSv3 connections, the <code class="literal">rpcbind</code> service must be running. To verify that <code class="literal">rpcbind</code> is active, use the following command:
					</p><pre class="screen">$ systemctl status rpcbind</pre><p class="simpara">
						If the service is stopped, start and enable it:
					</p><pre class="screen">$ systemctl enable --now rpcbind</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To start the NFS server and enable it to start automatically at boot, use the following command:
					</p><pre class="screen"># systemctl enable --now nfs-server</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To configure an NFSv4-only server, which does not require <code class="literal">rpcbind</code>, see <a class="xref" href="index.html#configuring-an-nfsv4-only-server_exporting-nfs-shares" title="3.14. Configuring an NFSv4-only server">Section 3.14, “Configuring an NFSv4-only server”</a>.
					</li></ul></div></section><section class="section" id="troubleshooting-nfs-and-rpcbind_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.10. Troubleshooting NFS and rpcbind</h2></div></div></div><p>
				Because the <code class="literal">rpcbind</code> service provides coordination between RPC services and the port numbers used to communicate with them, it is useful to view the status of current RPC services using <code class="literal">rpcbind</code> when troubleshooting. The <code class="literal">rpcinfo</code> utility shows each RPC-based service with port numbers, an RPC program number, a version number, and an IP protocol type (TCP or UDP).
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To make sure the proper NFS RPC-based services are enabled for <code class="literal">rpcbind</code>, use the following command:
					</p><pre class="screen"># rpcinfo -p</pre><div class="example" id="idm140042814151040"><p class="title"><strong>Example 3.2. rpcinfo -p command output</strong></p><div class="example-contents"><p>
							The following is sample output from this command:
						</p><pre class="screen">   program vers proto   port  service
    100000    4   tcp    111  portmapper
    100000    3   tcp    111  portmapper
    100000    2   tcp    111  portmapper
    100000    4   udp    111  portmapper
    100000    3   udp    111  portmapper
    100000    2   udp    111  portmapper
    100005    1   udp  20048  mountd
    100005    1   tcp  20048  mountd
    100005    2   udp  20048  mountd
    100005    2   tcp  20048  mountd
    100005    3   udp  20048  mountd
    100005    3   tcp  20048  mountd
    100024    1   udp  37769  status
    100024    1   tcp  49349  status
    100003    3   tcp   2049  nfs
    100003    4   tcp   2049  nfs
    100227    3   tcp   2049  nfs_acl
    100021    1   udp  56691  nlockmgr
    100021    3   udp  56691  nlockmgr
    100021    4   udp  56691  nlockmgr
    100021    1   tcp  46193  nlockmgr
    100021    3   tcp  46193  nlockmgr
    100021    4   tcp  46193  nlockmgr</pre></div></div><p class="simpara">
						If one of the NFS services does not start up correctly, <code class="literal">rpcbind</code> will be unable to map RPC requests from clients for that service to the correct port.
					</p></li><li class="listitem"><p class="simpara">
						In many cases, if NFS is not present in <code class="literal">rpcinfo</code> output, restarting NFS causes the service to correctly register with <code class="literal">rpcbind</code> and begin working:
					</p><pre class="screen"># systemctl restart nfs-server</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information and a list of <code class="literal">rpcinfo</code> options, see the <code class="literal">rpcinfo(8)</code> man page.
					</li><li class="listitem">
						To configure an NFSv4-only server, which does not require <code class="literal">rpcbind</code>, see <a class="xref" href="index.html#configuring-an-nfsv4-only-server_exporting-nfs-shares" title="3.14. Configuring an NFSv4-only server">Section 3.14, “Configuring an NFSv4-only server”</a>.
					</li></ul></div></section><section class="section" id="configuring-the-nfs-server-to-run-behind-a-firewall_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.11. Configuring the NFS server to run behind a firewall</h2></div></div></div><p>
				NFS requires the <code class="literal">rpcbind</code> service, which dynamically assigns ports for RPC services and can cause issues for configuring firewall rules. This procedure describes how to configure the NFS server to work behind a firewall.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To allow clients to access NFS shares behind a firewall, set which ports the RPC services run on in the <code class="literal">[mountd]</code> section of the <code class="literal filename">/etc/nfs.conf</code> file:
					</p><pre class="screen">[mountd]

port=<span class="emphasis"><em><span class="replaceable replaceable">port-number</span></em></span></pre><p class="simpara">
						This adds the <code class="literal option">-p <span class="emphasis"><em><span class="replaceable replaceable">port-number</span></em></span></code> option to the <code class="literal">rpc.mount</code> command line: <code class="literal command">rpc.mount -p <span class="emphasis"><em><span class="replaceable replaceable">port-number</span></em></span></code>.
					</p></li><li class="listitem"><p class="simpara">
						To allow clients to access NFS shares behind a firewall, configure the firewall by running the following commands on the NFS server:
					</p><pre class="screen">firewall-cmd --permanent --add-service mountd
firewall-cmd --permanent --add-service rpc-bind
firewall-cmd --permanent --add-service nfs
firewall-cmd --permanent --add-port=<span class="emphasis"><em>&lt;mountd-port&gt;</em></span>/tcp
firewall-cmd --permanent --add-port=<span class="emphasis"><em>&lt;mountd-port&gt;</em></span>/udp
firewall-cmd --reload</pre><p class="simpara">
						In the commands, replace <span class="emphasis"><em>&lt;mountd-port&gt;</em></span> with the intended port or a port range. When specifying a port range, use the <span class="emphasis"><em>--add-port=&lt;mountd-port&gt;-&lt;mountd-port&gt;/udp</em></span> syntax.
					</p></li><li class="listitem"><p class="simpara">
						To allow NFSv4.0 callbacks to pass through firewalls, set <code class="literal filename">/proc/sys/fs/nfs/nfs_callback_tcpport</code> and allow the server to connect to that port on the client.
					</p><p class="simpara">
						This step is not needed for NFSv4.1 or higher, and the other ports for <code class="literal">mountd</code>, <code class="literal">statd</code>, and <code class="literal">lockd</code> are not required in a pure NFSv4 environment.
					</p></li><li class="listitem">
						To specify the ports to be used by the RPC service <code class="literal">nlockmgr</code>, set the port number for the <code class="literal">nlm_tcpport</code> and <code class="literal">nlm_udpport</code> options in the <code class="literal filename">/etc/modprobe.d/lockd.conf</code> file.
					</li><li class="listitem"><p class="simpara">
						Restart the NFS server:
					</p><pre class="screen">#  systemctl restart nfs-server</pre><p class="simpara">
						If NFS fails to start, check <code class="literal filename">/var/log/messages</code>. Commonly, NFS fails to start if you specify a port number that is already in use.
					</p></li><li class="listitem"><p class="simpara">
						Confirm the changes have taken effect:
					</p><pre class="screen"># rpcinfo -p</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To configure an NFSv4-only server, which does not require <code class="literal">rpcbind</code>, see <a class="xref" href="index.html#configuring-an-nfsv4-only-server_exporting-nfs-shares" title="3.14. Configuring an NFSv4-only server">Section 3.14, “Configuring an NFSv4-only server”</a>.
					</li></ul></div></section><section class="section" id="exporting-rpc-quota-through-a-firewall_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.12. Exporting RPC quota through a firewall</h2></div></div></div><p>
				If you export a file system that uses disk quotas, you can use the quota Remote Procedure Call (RPC) service to provide disk quota data to NFS clients.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal">rpc-rquotad</code> service:
					</p><pre class="screen"># systemctl enable --now rpc-rquotad</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">rpc-rquotad</code> service is, if enabled, started automatically after starting the nfs-server service.
						</p></div></div></li><li class="listitem"><p class="simpara">
						To make the quota RPC service accessible behind a firewall, the TCP (or UDP, if UDP is enabled) port 875 need to be open. The default port number is defined in the <code class="literal filename">/etc/services</code> file.
					</p><p class="simpara">
						You can override the default port number by appending <code class="literal option">-p port-number</code> to the <code class="literal">RPCRQUOTADOPTS</code> variable in the <code class="literal filename">/etc/sysconfig/rpc-rquotad</code> file.
					</p></li><li class="listitem">
						By default, remote hosts can only read quotas. If you want to allow clients to set quotas, append the <code class="literal option">-S</code> option to the <code class="literal">RPCRQUOTADOPTS</code> variable in the <code class="literal filename">/etc/sysconfig/rpc-rquotad</code> file.
					</li><li class="listitem"><p class="simpara">
						Restart <code class="literal">rpc-rquotad</code> for the changes in the <code class="literal filename">/etc/sysconfig/rpc-rquotad</code> file to take effect:
					</p><pre class="screen"># systemctl restart rpc-rquotad</pre></li></ol></div></section><section class="section" id="enabling-nfs-over-rdma-nfsordma_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.13. Enabling NFS over RDMA (NFSoRDMA)</h2></div></div></div><p>
				The remote direct memory access (RDMA) service works automatically in Red Hat Enterprise Linux 8 if there is RDMA-capable hardware present.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">rdma-core</code> package:
					</p><pre class="screen"># yum install rdma-core</pre></li><li class="listitem"><p class="simpara">
						To enable automatic loading of NFSoRDMA <span class="emphasis"><em>server</em></span> modules, add the <code class="literal option">SVCRDMA_LOAD=yes</code> option on a new line in the <code class="literal filename">/etc/rdma/rdma.conf</code> configuration file.
					</p><p class="simpara">
						The <code class="literal">rdma=20049</code> option in the <code class="literal">[nfsd]</code> section of the <code class="literal filename">/etc/nfs.conf</code> file specifies the port number on which the NFSoRDMA service listens for clients. The RFC 5667 standard specifies that servers must listen on port <code class="literal">20049</code> when providing NFSv4 services over RDMA.
					</p><p class="simpara">
						The <code class="literal filename">/etc/rdma/rdma.conf</code> file contains a line that sets the <code class="literal option">XPRTRDMA_LOAD=yes</code> option by default, which requests the <code class="literal">rdma</code> service to load the NFSoRDMA <span class="emphasis"><em>client</em></span> module.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">nfs-server</code> service:
					</p><pre class="screen"># systemctl restart nfs-server</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The RFC 5667 standard: <a class="link" href="https://tools.ietf.org/html/rfc5667">https://tools.ietf.org/html/rfc5667</a>.
					</li></ul></div></section><section class="section" id="configuring-an-nfsv4-only-server_exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.14. Configuring an NFSv4-only server</h2></div></div></div><p>
				As an NFS server administrator, you can configure the NFS server to support only NFSv4, which minimizes the number of open ports and running services on the system.
			</p><section class="section" id="benefits-and-drawbacks-of-an-nfsv4-only-server_configuring-an-nfsv4-only-server"><div class="titlepage"><div><div><h3 class="title">3.14.1. Benefits and drawbacks of an NFSv4-only server</h3></div></div></div><p>
					This section explains the benefits and drawbacks of configuring the NFS server to only support NFSv4.
				</p><p>
					By default, the NFS server supports NFSv2, NFSv3, and NFSv4 connections in Red Hat Enterprise Linux 8. However, you can also configure NFS to support only NFS version 4.0 and later. This minimizes the number of open ports and running services on the system, because NFSv4 does not require the <code class="literal">rpcbind</code> service to listen on the network.
				</p><p>
					When your NFS server is configured as NFSv4-only, clients attempting to mount shares using NFSv2 or NFSv3 fail with an error like the following:
				</p><pre class="screen">Requested NFS version or transport protocol is not supported.</pre><p>
					Optionally, you can also disable listening for the <code class="literal">RPCBIND</code>, <code class="literal">MOUNT</code>, and <code class="literal">NSM</code> protocol calls, which are not necessary in the NFSv4-only case.
				</p><p>
					The effects of disabling these additional options are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Clients that attempt to mount shares from your server using NFSv2 or NFSv3 become unresponsive.
						</li><li class="listitem">
							The NFS server itself is unable to mount NFSv2 and NFSv3 file systems.
						</li></ul></div></section><section class="section" id="nfs-and-rpcbind_configuring-an-nfsv4-only-server"><div class="titlepage"><div><div><h3 class="title">3.14.2. NFS and rpcbind</h3></div></div></div><p>
					This section explains the purpose of the <code class="literal">rpcbind</code> service, which is required by NFSv3.
				</p><p>
					The <code class="literal">rpcbind</code> service maps Remote Procedure Call (RPC) services to the ports on which they listen. RPC processes notify <code class="literal">rpcbind</code> when they start, registering the ports they are listening on and the RPC program numbers they expect to serve. The client system then contacts <code class="literal">rpcbind</code> on the server with a particular RPC program number. The <code class="literal">rpcbind</code> service redirects the client to the proper port number so it can communicate with the requested service.
				</p><p>
					Because RPC-based services rely on <code class="literal">rpcbind</code> to make all connections with incoming client requests, <code class="literal">rpcbind</code> must be available before any of these services start.
				</p><p>
					Access control rules for <code class="literal">rpcbind</code> affect all RPC-based services. Alternatively, it is possible to specify access control rules for each of the NFS RPC daemons.
				</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For the precise syntax of access control rules, see the <code class="literal">rpc.mountd(8)</code> and <code class="literal">rpc.statd(8)</code> man pages.
						</li></ul></div></section><section class="section" id="configuring-the-nfs-server-to-support-only-nfsv4_configuring-an-nfsv4-only-server"><div class="titlepage"><div><div><h3 class="title">3.14.3. Configuring the NFS server to support only NFSv4</h3></div></div></div><p>
					This procedure describes how to configure your NFS server to support only NFS version 4.0 and later.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Disable NFSv2 and NFSv3 by adding the following lines to the <code class="literal">[nfsd]</code> section of the <code class="literal filename">/etc/nfs.conf</code> configuration file:
						</p><pre class="screen">[nfsd]

vers2=no
vers3=no</pre></li><li class="listitem"><p class="simpara">
							Optionally, disable listening for the <code class="literal">RPCBIND</code>, <code class="literal">MOUNT</code>, and <code class="literal">NSM</code> protocol calls, which are not necessary in the NFSv4-only case. Disable related services:
						</p><pre class="screen"># systemctl mask --now rpc-statd.service rpcbind.service rpcbind.socket</pre></li><li class="listitem"><p class="simpara">
							Restart the NFS server:
						</p><pre class="screen"># systemctl restart nfs-server</pre></li></ol></div><p>
					The changes take effect as soon as you start or restart the NFS server.
				</p></section><section class="section" id="verifying-the-nfsv4-only-configuration_configuring-an-nfsv4-only-server"><div class="titlepage"><div><div><h3 class="title">3.14.4. Verifying the NFSv4-only configuration</h3></div></div></div><p>
					This procedure describes how to verify that your NFS server is configured in the NFSv4-only mode by using the <code class="literal">netstat</code> utility.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the <code class="literal">netstat</code> utility to list services listening on the TCP and UDP protocols:
						</p><pre class="screen"># netstat --listening --tcp --udp</pre><div class="example" id="idm140042818107936"><p class="title"><strong>Example 3.3. Output on an NFSv4-only server</strong></p><div class="example-contents"><p>
								The following is an example <code class="literal">netstat</code> output on an NFSv4-only server; listening for <code class="literal">RPCBIND</code>, <code class="literal">MOUNT</code>, and <code class="literal">NSM</code> is also disabled. Here, <code class="literal">nfs</code> is the only listening NFS service:
							</p><pre class="screen"># netstat --listening --tcp --udp

Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 0.0.0.0:ssh             0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:nfs             0.0.0.0:*               LISTEN
tcp6       0      0 [::]:ssh                [::]:*                  LISTEN
tcp6       0      0 [::]:nfs                [::]:*                  LISTEN
udp        0      0 localhost.locald:bootpc 0.0.0.0:*</pre></div></div><div class="example" id="idm140042818103008"><p class="title"><strong>Example 3.4. Output before configuring an NFSv4-only server</strong></p><div class="example-contents"><p>
								In comparison, the <code class="literal">netstat</code> output before configuring an NFSv4-only server includes the <code class="literal">sunrpc</code> and <code class="literal">mountd</code> services:
							</p><pre class="screen"># netstat --listening --tcp --udp

Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address State
tcp        0      0 0.0.0.0:ssh             0.0.0.0:*       LISTEN
tcp        0      0 0.0.0.0:40189           0.0.0.0:*       LISTEN
tcp        0      0 0.0.0.0:46813           0.0.0.0:*       LISTEN
tcp        0      0 0.0.0.0:nfs             0.0.0.0:*       LISTEN
tcp        0      0 0.0.0.0:sunrpc          0.0.0.0:*       LISTEN
tcp        0      0 0.0.0.0:mountd          0.0.0.0:*       LISTEN
tcp6       0      0 [::]:ssh                [::]:*          LISTEN
tcp6       0      0 [::]:51227              [::]:*          LISTEN
tcp6       0      0 [::]:nfs                [::]:*          LISTEN
tcp6       0      0 [::]:sunrpc             [::]:*          LISTEN
tcp6       0      0 [::]:mountd             [::]:*          LISTEN
tcp6       0      0 [::]:45043              [::]:*          LISTEN
udp        0      0 localhost:1018          0.0.0.0:*
udp        0      0 localhost.locald:bootpc 0.0.0.0:*
udp        0      0 0.0.0.0:mountd          0.0.0.0:*
udp        0      0 0.0.0.0:46672           0.0.0.0:*
udp        0      0 0.0.0.0:sunrpc          0.0.0.0:*
udp        0      0 0.0.0.0:33494           0.0.0.0:*
udp6       0      0 [::]:33734              [::]:*
udp6       0      0 [::]:mountd             [::]:*
udp6       0      0 [::]:sunrpc             [::]:*
udp6       0      0 [::]:40243              [::]:*</pre></div></div></li></ul></div></section></section><section class="section" id="related-information-exporting-nfs-shares"><div class="titlepage"><div><div><h2 class="title">3.15. Related information</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The Linux NFS wiki: <a class="link" href="https://linux-nfs.org">https://linux-nfs.org</a>
					</li></ul></div></section></section><section class="chapter" id="securing-nfs_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Securing NFS</h1></div></div></div><p>
			To minimize NFS security risks and protect data on the server, consider the following sections when exporting NFS file systems on a server or mounting them on a client.
		</p><section class="section" id="nfs-security-with-auth_sys-and-export-controls_securing-nfs"><div class="titlepage"><div><div><h2 class="title">4.1. NFS security with AUTH_SYS and export controls</h2></div></div></div><p>
				NFS provides the following traditional options in order to control access to exported files:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The server restricts which hosts are allowed to mount which file systems either by IP address or by host name.
					</li><li class="listitem">
						The server enforces file system permissions for users on NFS clients in the same way it does for local users. Traditionally, NFS does this using the <code class="literal">AUTH_SYS</code> call message (also called <code class="literal">AUTH_UNIX</code>), which relies on the client to state the UID and GIDs of the user. Be aware that this means that a malicious or misconfigured client might easily get this wrong and allow a user access to files that it should not.
					</li></ul></div><p>
				To limit the potential risks, administrators often limits the access to read-only or squash user permissions to a common user and group ID. Unfortunately, these solutions prevent the NFS share from being used in the way it was originally intended.
			</p><p>
				Additionally, if an attacker gains control of the DNS server used by the system exporting the NFS file system, they can point the system associated with a particular hostname or fully qualified domain name to an unauthorized machine. At this point, the unauthorized machine <span class="emphasis"><em>is</em></span> the system permitted to mount the NFS share, because no username or password information is exchanged to provide additional security for the NFS mount.
			</p><p>
				Wildcards should be used sparingly when exporting directories through NFS, as it is possible for the scope of the wildcard to encompass more systems than intended.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information on securing NFS and <code class="literal command">rpcbind</code>, see the <code class="literal">iptables</code> man page.
					</li></ul></div></section><section class="section" id="nfs-security-with-auth_gss_securing-nfs"><div class="titlepage"><div><div><h2 class="title">4.2. NFS security with <code class="literal">AUTH_GSS</code></h2></div></div></div><p>
				All version of NFS support RPCSEC_GSS and the Kerberos mechanism.
			</p><p>
				Unlike AUTH_SYS, with the RPCSEC_GSS Kerberos mechanism, the server does not depend on the client to correctly represent which user is accessing the file. Instead, cryptography is used to authenticate users to the server, which prevents a malicious client from impersonating a user without having that user’s Kerberos credentials. Using the RPCSEC_GSS Kerberos mechanism is the most straightforward way to secure mounts because after configuring Kerberos, no additional setup is needed.
			</p></section><section class="section" id="configuring-an-nfs-server-and-client-to-use-kerberos_securing-nfs"><div class="titlepage"><div><div><h2 class="title">4.3. Configuring an NFS server and client to use Kerberos</h2></div></div></div><p>
				Kerberos is a network authentication system that allows clients and servers to authenticate to each other by using symmetric encryption and a trusted third party, the KDC. Red Hat recommends using Identity Management (IdM) for setting up Kerberos.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Kerberos Key Distribution Centre (<code class="literal">KDC</code>) is installed and configured.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">

					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Create the <code class="literal">nfs/hostname.<span class="emphasis"><em>domain@REALM</em></span></code> principal on the NFS server side.
							</li><li class="listitem">
								Create the <code class="literal">host/hostname.<span class="emphasis"><em>domain@REALM</em></span></code> principal on both the server and the client side.
							</li><li class="listitem">
								Add the corresponding keys to keytabs for the client and server.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						On the server side, use the <code class="literal option">sec=</code> option to enable the wanted security flavors. To enable all security flavors as well as non-cryptographic mounts:
					</p><pre class="screen">/export *(sec=sys:krb5:krb5i:krb5p)</pre><p class="simpara">
						Valid security flavors to use with the <code class="literal option">sec=</code> option are:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">sys</code>: no cryptographic protection, the default
							</li><li class="listitem">
								<code class="literal">krb5</code>: authentication only
							</li><li class="listitem">
								<code class="literal">krb5i</code>: integrity protection
							</li><li class="listitem">
								<code class="literal">krb5p</code>: privacy protection
							</li></ul></div></li><li class="listitem"><p class="simpara">
						On the client side, add <code class="literal">sec=krb5</code> (or <code class="literal">sec=krb5i</code>, or <code class="literal">sec=krb5p</code>, depending on the setup) to the mount options:
					</p><pre class="screen"># mount -o sec=krb5 server:/export /mnt</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						If you need to write files as root on the Kerberos-secured NFS share and keep root ownership on these files, see <a class="link" href="https://access.redhat.com/articles/4040141">https://access.redhat.com/articles/4040141</a>. Note that this configuration is not recommended.
					</li><li class="listitem">
						For more information on NFS configuration, see the <span class="strong strong"><strong>exports</strong></span>(5) and <span class="strong strong"><strong>nfs</strong></span>(5) man pages.
					</li></ul></div></section><section class="section" id="nfsv4-security-options_securing-nfs"><div class="titlepage"><div><div><h2 class="title">4.4. NFSv4 security options</h2></div></div></div><p>
				NFSv4 includes ACL support based on the Microsoft Windows NT model, not the POSIX model, because of the Microsoft Windows NT model’s features and wide deployment.
			</p><p>
				Another important security feature of NFSv4 is the removal of the use of the <code class="literal">MOUNT</code> protocol for mounting file systems. The <code class="literal">MOUNT</code> protocol presented a security risk because of the way the protocol processed file handles.
			</p></section><section class="section" id="file-permissions-on-mounted-nfs-exports_securing-nfs"><div class="titlepage"><div><div><h2 class="title">4.5. File permissions on mounted NFS exports</h2></div></div></div><p>
				Once the NFS file system is mounted as either read or read and write by a remote host, the only protection each shared file has is its permissions. If two users that share the same user ID value mount the same NFS file system on different client systems, they can modify each others' files. Additionally, anyone logged in as root on the client system can use the <code class="literal command">su -</code> command to access any files with the NFS share.
			</p><p>
				By default, access control lists (ACLs) are supported by NFS under Red Hat Enterprise Linux. Red Hat recommends to keep this feature enabled.
			</p><p>
				By default, NFS uses <span class="emphasis"><em>root squashing</em></span> when exporting a file system. This sets the user ID of anyone accessing the NFS share as the root user on their local machine to <code class="literal">nobody</code>. Root squashing is controlled by the default option <code class="literal command">root_squash</code>; for more information about this option, see <a class="xref" href="index.html#nfs-server-configuration_exporting-nfs-shares" title="3.6. NFS server configuration">Section 3.6, “NFS server configuration”</a>.
			</p><p>
				When exporting an NFS share as read-only, consider using the <code class="literal option">all_squash</code> option. This option makes every user accessing the exported file system take the user ID of the <code class="literal">nfsnobody</code> user.
			</p></section></section><section class="chapter" id="enabling-pnfs-scsi-layouts-in-nfs_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Enabling pNFS SCSI layouts in NFS</h1></div></div></div><p>
			You can configure the NFS server and client to use the pNFS SCSI layout for accessing data. pNFS SCSI is beneficial in use cases that involve longer-duration single-client access to a file.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					Both the client and the server must be able to send SCSI commands to the same block device. That is, the block device must be on a shared SCSI bus.
				</li><li class="listitem">
					The block device must contain an XFS file system.
				</li><li class="listitem">
					The SCSI device must support SCSI Persistent Reservations as described in the SCSI-3 Primary Commands specification.
				</li></ul></div><section class="section" id="the-pnfs-technology_enabling-pnfs-scsi-layouts-in-nfs"><div class="titlepage"><div><div><h2 class="title">5.1. The pNFS technology</h2></div></div></div><p>
				The pNFS architecture improves the scalability of NFS. When a server implements pNFS, the client is able to access data through multiple servers concurrently. This can lead to performance improvements.
			</p><p>
				pNFS supports the following storage protocols or layouts on RHEL:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Files
					</li><li class="listitem">
						Flexfiles
					</li><li class="listitem">
						SCSI
					</li></ul></div></section><section class="section" id="pnfs-scsi-layouts_enabling-pnfs-scsi-layouts-in-nfs"><div class="titlepage"><div><div><h2 class="title">5.2. pNFS SCSI layouts</h2></div></div></div><p>
				The SCSI layout builds on the work of pNFS block layouts. The layout is defined across SCSI devices. It contains a sequential series of fixed-size blocks as logical units (LUs) that must be capable of supporting SCSI persistent reservations. The LU devices are identified by their SCSI device identification.
			</p><p>
				pNFS SCSI performs well in use cases that involve longer-duration single-client access to a file. An example might be a mail server or a virtual machine housing a cluster.
			</p><h4 id="operations_between_the_client_and_the_server">Operations between the client and the server</h4><p>
				When an NFS client reads from a file or writes to it, the client performs a <code class="literal">LAYOUTGET</code> operation. The server responds with the location of the file on the SCSI device. The client might need to perform an additional operation of <code class="literal">GETDEVICEINFO</code> to determine which SCSI device to use. If these operations work correctly, the client can issue I/O requests directly to the SCSI device instead of sending <code class="literal">READ</code> and <code class="literal">WRITE</code> operations to the server.
			</p><p>
				Errors or contention between clients might cause the server to recall layouts or not issue them to the clients. In those cases, the clients fall back to issuing <code class="literal">READ</code> and <code class="literal">WRITE</code> operations to the server instead of sending I/O requests directly to the SCSI device.
			</p><p>
				To monitor the operations, see <a class="xref" href="index.html#monitoring-pnfs-scsi-layouts-functionality_enabling-pnfs-scsi-layouts-in-nfs" title="5.7. Monitoring pNFS SCSI layouts functionality">Section 5.7, “Monitoring pNFS SCSI layouts functionality”</a>.
			</p><h4 id="device_reservations">Device reservations</h4><p>
				pNFS SCSI handles fencing through the assignment of reservations. Before the server issues layouts to clients, it reserves the SCSI device to ensure that only registered clients may access the device. If a client can issue commands to that SCSI device but is not registered with the device, many operations from the client on that device fail. For example, the <code class="literal">blkid</code> command on the client fails to show the UUID of the XFS file system if the server has not given a layout for that device to the client.
			</p><p>
				The server does not remove its own persistent reservation. This protects the data within the file system on the device across restarts of clients and servers. In order to repurpose the SCSI device, you might need to manually remove the persistent reservation on the NFS server.
			</p></section><section class="section" id="checking-for-a-scsi-device-compatible-with-pnfs_enabling-pnfs-scsi-layouts-in-nfs"><div class="titlepage"><div><div><h2 class="title">5.3. Checking for a SCSI device compatible with pNFS</h2></div></div></div><p>
				This procedure checks if a SCSI device supports the pNFS SCSI layout.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">sg3_utils</code> package:
					</p><pre class="screen"># yum install sg3_utils</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On both the server and client, check for the proper SCSI device support:
					</p><pre class="screen"># sg_persist --in --report-capabilities --verbose <span class="emphasis"><em><span class="replaceable replaceable">path-to-scsi-device</span></em></span></pre><p class="simpara">
						Ensure that the <span class="emphasis"><em>Persist Through Power Loss Active</em></span> (<code class="literal">PTPL_A</code>) bit is set.
					</p><div class="example" id="idm140042817211408"><p class="title"><strong>Example 5.1. A SCSI device that supports pNFS SCSI</strong></p><div class="example-contents"><p>
							The following is an example of <code class="literal">sg_persist</code> output for a SCSI device that supports pNFS SCSI. The <code class="literal">PTPL_A</code> bit reports <code class="literal">1</code>.
						</p><pre class="screen">    inquiry cdb: 12 00 00 00 24 00
    Persistent Reservation In cmd: 5e 02 00 00 00 00 00 20 00 00
  LIO-ORG   block11           4.0
  Peripheral device type: disk
Report capabilities response:
  Compatible Reservation Handling(CRH): 1
  Specify Initiator Ports Capable(SIP_C): 1
  All Target Ports Capable(ATP_C): 1
  Persist Through Power Loss Capable(PTPL_C): 1
  Type Mask Valid(TMV): 1
  Allow Commands: 1
  <span class="strong strong"><strong>Persist Through Power Loss Active(PTPL_A): 1</strong></span>
    Support indicated in Type mask:
      Write Exclusive, all registrants: 1
      Exclusive Access, registrants only: 1
      Write Exclusive, registrants only: 1
      Exclusive Access: 1
      Write Exclusive: 1
      Exclusive Access, all registrants: 1</pre></div></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">sg_persist(8)</code> man page
					</li></ul></div></section><section class="section" id="setting-up-pnfs-scsi-on-the-server_enabling-pnfs-scsi-layouts-in-nfs"><div class="titlepage"><div><div><h2 class="title">5.4. Setting up pNFS SCSI on the server</h2></div></div></div><p>
				This procedure configures an NFS server to export a pNFS SCSI layout.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						On the server, mount the XFS file system created on the SCSI device.
					</li><li class="listitem"><p class="simpara">
						Configure the NFS server to export NFS version 4.1 or higher. Set the following option in the <code class="literal">[nfsd]</code> section of the <code class="literal filename">/etc/nfs.conf</code> file:
					</p><pre class="screen">[nfsd]

vers4.1=y</pre></li><li class="listitem"><p class="simpara">
						Configure the NFS server to export the XFS file system over NFS with the <code class="literal">pnfs</code> option:
					</p><div class="example" id="idm140042817195392"><p class="title"><strong>Example 5.2. An entry in /etc/exports to export pNFS SCSI</strong></p><div class="example-contents"><p>
							The following entry in the <code class="literal filename">/etc/exports</code> configuration file exports the file system mounted at <code class="literal filename">/exported/directory/</code> to the <code class="literal">allowed.example.com</code> client as a pNFS SCSI layout:
						</p><pre class="screen">/exported/directory allowed.example.com(pnfs)</pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information on configuring an NFS server, see <a class="xref" href="index.html#exporting-nfs-shares_Deploying-different-types-of-servers" title="Chapter 3. Exporting NFS shares">Chapter 3, <em>Exporting NFS shares</em></a>.
					</li></ul></div></section><section class="section" id="setting-up-pnfs-scsi-on-the-client_enabling-pnfs-scsi-layouts-in-nfs"><div class="titlepage"><div><div><h2 class="title">5.5. Setting up pNFS SCSI on the client</h2></div></div></div><p>
				This procedure configures an NFS client to mount a pNFS SCSI layout.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The NFS server is configured to export an XFS file system over pNFS SCSI. See <a class="xref" href="index.html#setting-up-pnfs-scsi-on-the-server_enabling-pnfs-scsi-layouts-in-nfs" title="5.4. Setting up pNFS SCSI on the server">Section 5.4, “Setting up pNFS SCSI on the server”</a>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the client, mount the exported XFS file system using NFS version 4.1 or higher:
					</p><pre class="screen"># mount -t nfs -o nfsvers=4.1 <span class="emphasis"><em><span class="replaceable replaceable">host:/remote/export</span></em></span> <span class="emphasis"><em><span class="replaceable replaceable">/local/directory</span></em></span></pre><p class="simpara">
						Do not mount the XFS file system directly without NFS.
					</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information on mounting NFS shares, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_file_systems/mounting-nfs-shares_managing-file-systems">Mounting NFS shares</a>.
					</li></ul></div></section><section class="section" id="releasing-the-pnfs-scsi-reservation-on-the-server_enabling-pnfs-scsi-layouts-in-nfs"><div class="titlepage"><div><div><h2 class="title">5.6. Releasing the pNFS SCSI reservation on the server</h2></div></div></div><p>
				This procedure releases the persistent reservation that an NFS server holds on a SCSI device. This enables you to repurpose the SCSI device when you no longer need to export pNFS SCSI.
			</p><p>
				You must remove the reservation from the server. It cannot be removed from a different IT Nexus.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">sg3_utils</code> package:
					</p><pre class="screen"># yum install sg3_utils</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Query an existing reservation on the server:
					</p><pre class="screen"># sg_persist --read-reservation <span class="emphasis"><em><span class="replaceable replaceable">path-to-scsi-device</span></em></span></pre><div class="example" id="idm140042814328928"><p class="title"><strong>Example 5.3. Querying a reservation on /dev/sda</strong></p><div class="example-contents"><pre class="screen"># sg_persist --read-reservation /dev/sda

  LIO-ORG   block_1           4.0
  Peripheral device type: disk
  PR generation=0x8, Reservation follows:
    Key=0x100000000000000
    scope: LU_SCOPE,  type: Exclusive Access, registrants only</pre></div></div></li><li class="listitem"><p class="simpara">
						Remove the existing registration on the server:
					</p><pre class="screen"># sg_persist --out \
             --release \
             --param-rk=<span class="emphasis"><em><span class="replaceable replaceable">reservation-key</span></em></span> \
             --prout-type=6 \
             <span class="emphasis"><em><span class="replaceable replaceable">path-to-scsi-device</span></em></span></pre><div class="example" id="idm140042814323952"><p class="title"><strong>Example 5.4. Removing a reservation on /dev/sda</strong></p><div class="example-contents"><pre class="screen"># sg_persist --out \
             --release \
             --param-rk=0x100000000000000 \
             --prout-type=6 \
             /dev/sda

  LIO-ORG   block_1           4.0
  Peripheral device type: disk</pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">sg_persist(8)</code> man page
					</li></ul></div></section><section class="section" id="monitoring-pnfs-scsi-layouts-functionality_enabling-pnfs-scsi-layouts-in-nfs"><div class="titlepage"><div><div><h2 class="title">5.7. Monitoring pNFS SCSI layouts functionality</h2></div></div></div><p>
				You can monitor if the pNFS client and server exchange proper pNFS SCSI operations or if they fall back on regular NFS operations.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A pNFS SCSI client and server are configured.
					</li></ul></div><section class="section" id="checking-pnfs-scsi-operations-from-the-server-using-nfsstat_monitoring-pnfs-scsi-layouts-functionality"><div class="titlepage"><div><div><h3 class="title">5.7.1. Checking pNFS SCSI operations from the server using nfsstat</h3></div></div></div><p>
					This procedure uses the <code class="literal">nfsstat</code> utility to monitor pNFS SCSI operations from the server.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Monitor the operations serviced from the server:
						</p><pre class="screen"># watch --differences \
        "nfsstat --server | egrep --after-context=1 read\|write\|layout"

Every 2.0s: nfsstat --server | egrep --after-context=1 read\|write\|layout

putrootfh    read         readdir      readlink     remove	 rename
2         0% 0         0% 1         0% 0         0% 0         0% 0         0%
--
setcltidconf verify	  write        rellockowner bc_ctl	 bind_conn
0         0% 0         0% 0         0% 0         0% 0         0% 0         0%
--
getdevlist   layoutcommit layoutget    layoutreturn secinfononam sequence
0         0% 29        1% 49        1% 5         0% 0         0% 2435     86%</pre></li><li class="listitem"><p class="simpara">
							The client and server use pNFS SCSI operations when:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">layoutget</code>, <code class="literal">layoutreturn</code>, and <code class="literal">layoutcommit</code> counters increment. This means that the server is serving layouts.
								</li><li class="listitem">
									The server <code class="literal">read</code> and <code class="literal">write</code> counters do not increment. This means that the clients are performing I/O requests directly to the SCSI devices.
								</li></ul></div></li></ol></div></section><section class="section" id="checking-pnfs-scsi-operations-from-the-client-using-mountstats_monitoring-pnfs-scsi-layouts-functionality"><div class="titlepage"><div><div><h3 class="title">5.7.2. Checking pNFS SCSI operations from the client using mountstats</h3></div></div></div><p>
					This procedure uses the <code class="literal filename">/proc/self/mountstats</code> file to monitor pNFS SCSI operations from the client.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							List the per-mount operation counters:
						</p><pre class="screen"># cat /proc/self/mountstats \
      | awk /scsi_lun_0/,/^$/ \
      | egrep device\|READ\|WRITE\|LAYOUT

device 192.168.122.73:/exports/scsi_lun_0 mounted on /mnt/rhel7/scsi_lun_0 with fstype nfs4 statvers=1.1
    nfsv4:  bm0=0xfdffbfff,bm1=0x40f9be3e,bm2=0x803,acl=0x3,sessions,pnfs=LAYOUT_SCSI
            READ: 0 0 0 0 0 0 0 0
           WRITE: 0 0 0 0 0 0 0 0
        READLINK: 0 0 0 0 0 0 0 0
         READDIR: 0 0 0 0 0 0 0 0
       LAYOUTGET: 49 49 0 11172 9604 2 19448 19454
    LAYOUTCOMMIT: 28 28 0 7776 4808 0 24719 24722
    LAYOUTRETURN: 0 0 0 0 0 0 0 0
     LAYOUTSTATS: 0 0 0 0 0 0 0 0</pre></li><li class="listitem"><p class="simpara">
							In the results:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">LAYOUT</code> statistics indicate requests where the client and server use pNFS SCSI operations.
								</li><li class="listitem">
									The <code class="literal">READ</code> and <code class="literal">WRITE</code> statistics indicate requests where the client and server fall back to NFS operations.
								</li></ul></div></li></ol></div></section></section></section><section class="chapter" id="configuring-the-squid-caching-proxy-server_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Configuring the Squid caching proxy server</h1></div></div></div><p>
			Squid is a proxy server that caches content to reduce bandwidth and load web pages more quickly. This chapter describes how to set up Squid as a proxy for the HTTP, HTTPS, and FTP protocol, as well as authentication and restricting access.
		</p><section class="section" id="setting-up-squid-as-a-caching-proxy-without-authentication_configuring-the-squid-caching-proxy-server"><div class="titlepage"><div><div><h2 class="title">6.1. Setting up Squid as a caching proxy without authentication</h2></div></div></div><p>
				This section describes a basic configuration of Squid as a caching proxy without authentication. The procedure limits access to the proxy based on IP ranges.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The procedure assumes that the <code class="literal filename">/etc/squid/squid.conf</code> file is as provided by the <code class="literal package">squid</code> package. If you edited this file before, remove the file and reinstall the package.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">squid</code> package:
					</p><pre class="literallayout"># yum install squid</pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/squid/squid.conf</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Adapt the <code class="literal systemitem">localnet</code> access control lists (ACL) to match the IP ranges that should be allowed to use the proxy:
							</p><pre class="literallayout">acl localnet src 192.0.2.0/24
acl localnet 2001:db8::/32</pre><p class="simpara">
								By default, the <code class="literal filename">/etc/squid/squid.conf</code> file contains the <code class="literal command">http_access allow localnet</code> rule that allows using the proxy from all IP ranges specified in <code class="literal command">localnet</code> ACLs. Note that you must specify all <code class="literal command">localnet</code> ACLs before the <code class="literal command">http_access allow localnet</code> rule.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Remove all existing <code class="literal command">acl localnet</code> entries that do not match your environment.
								</p></div></div></li><li class="listitem"><p class="simpara">
								The following ACL exists in the default configuration and defines <code class="literal systemitem">443</code> as a port that uses the HTTPS protocol:
							</p><pre class="literallayout">acl SSL_ports port 443</pre><p class="simpara">
								If users should be able to use the HTTPS protocol also on other ports, add an ACL for each of these port:
							</p><pre class="literallayout">acl SSL_ports port <span class="emphasis"><em>port_number</em></span></pre></li><li class="listitem"><p class="simpara">
								Update the list of <code class="literal command">acl Safe_ports</code> rules to configure to which ports Squid can establish a connection. For example, to configure that clients using the proxy can only access resources on port 21 (FTP), 80 (HTTP), and 443 (HTTPS), keep only the following <code class="literal command">acl Safe_ports</code> statements in the configuration:
							</p><pre class="literallayout">acl Safe_ports port 21
acl Safe_ports port 80
acl Safe_ports port 443</pre><p class="simpara">
								By default, the configuration contains the <code class="literal command">http_access deny !Safe_ports</code> rule that defines access denial to ports that are not defined in <code class="literal command">Safe_ports</code> ACLs.
							</p></li><li class="listitem"><p class="simpara">
								Configure the cache type, the path to the cache directory, the cache size, and further cache type-specific settings in the <code class="literal parameter">cache_dir</code> parameter:
							</p><pre class="literallayout">cache_dir ufs /var/spool/squid 10000 16 256</pre><p class="simpara">
								With these settings:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Squid uses the <code class="literal systemitem">ufs</code> cache type.
									</li><li class="listitem">
										Squid stores its cache in the <code class="literal filename">/var/spool/squid/</code> directory.
									</li><li class="listitem">
										The cache grows up to <code class="literal command">10000</code> MB.
									</li><li class="listitem">
										Squid creates <code class="literal command">16</code> level-1 sub-directories in the <code class="literal filename">/var/spool/squid/</code> directory.
									</li><li class="listitem"><p class="simpara">
										Squid creates <code class="literal command">256</code> sub-directories in each level-1 directory.
									</p><p class="simpara">
										If you do not set a <code class="literal command">cache_dir</code> directive, Squid stores the cache in memory.
									</p></li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
						If you set a different cache directory than <code class="literal filename">/var/spool/squid/</code> in the <code class="literal parameter">cache_dir</code> parameter:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the cache directory:
							</p><pre class="literallayout"># mkdir -p <span class="emphasis"><em>path_to_cache_directory</em></span></pre></li><li class="listitem"><p class="simpara">
								Configure the permissions for the cache directory:
							</p><pre class="literallayout"># chown squid:squid <span class="emphasis"><em>path_to_cache_directory</em></span></pre></li><li class="listitem"><p class="simpara">
								If you run SELinux in <code class="literal command">enforcing</code> mode, set the <code class="literal systemitem">squid_cache_t</code> context for the cache directory:
							</p><pre class="literallayout"># semanage fcontext -a -t squid_cache_t "<span class="emphasis"><em>path_to_cache_directory</em></span>(/.*)?"
# restorecon -Rv <span class="emphasis"><em>path_to_cache_directory</em></span></pre><p class="simpara">
								If the <code class="literal systemitem">semanage</code> utility is not available on your system, install the <code class="literal package">policycoreutils-python-utils</code> package.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Open the <code class="literal command">3128</code> port in the firewall:
					</p><pre class="literallayout"># firewall-cmd --permanent --add-port=3128/tcp
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">squid</code> service:
					</p><pre class="literallayout"># systemctl enable --now squid</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To verify that the proxy works correctly, download a web page using the <code class="literal systemitem">curl</code> utility:
				</p></div><pre class="literallayout"># curl -O -L "<span class="emphasis"><em>https://www.redhat.com/index.html</em></span>" -x "<span class="emphasis"><em>proxy.example.com:3128</em></span>"</pre><p>
				If <code class="literal systemitem">curl</code> does not display any error and the <code class="literal filename">index.html</code> file was downloaded to the current directory, the proxy works.
			</p></section><section class="section" id="setting-up-squid-as-a-caching-proxy-with-ldap-authentication_configuring-the-squid-caching-proxy-server"><div class="titlepage"><div><div><h2 class="title">6.2. Setting up Squid as a caching proxy with LDAP authentication</h2></div></div></div><p>
				This section describes a basic configuration of Squid as a caching proxy that uses LDAP to authenticate users. The procedure configures that only authenticated users can use the proxy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The procedure assumes that the <code class="literal filename">/etc/squid/squid.conf</code> file is as provided by the <code class="literal package">squid</code> package. If you edited this file before, remove the file and reinstall the package.
					</li><li class="listitem">
						An service user, such as <code class="literal systemitem">uid=proxy_user,cn=users,cn=accounts,dc=example,dc=com</code> exists in the LDAP directory. Squid uses this account only to search for the authenticating user. If the authenticating user exists, Squid binds as this user to the directory to verify the authentication.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">squid</code> package:
					</p><pre class="literallayout"># yum install squid</pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/squid/squid.conf</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								To configure the <code class="literal systemitem">basic_ldap_auth</code> helper utility, add the following configuration entry to the top of <code class="literal filename">/etc/squid/squid.conf</code>:
							</p><pre class="literallayout">auth_param basic program /usr/lib64/squid/basic_ldap_auth -b "<span class="emphasis"><em>cn=users,cn=accounts,dc=example,dc=com</em></span>" -D "<span class="emphasis"><em>uid=proxy_user,cn=users,cn=accounts,dc=example,dc=com</em></span>" -W <span class="emphasis"><em>/etc/squid/ldap_password</em></span> -f "<span class="emphasis"><em>(&amp;(objectClass=person)(uid=%s))</em></span>" -ZZ -H <span class="emphasis"><em>ldap://ldap_server.example.com:389</em></span></pre><p class="simpara">
								The following describes the parameters passed to the <code class="literal systemitem">basic_ldap_auth</code> helper utility in the example above:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal parameter">-B <span class="emphasis"><em>base_DN</em></span></code> sets the LDAP search base.
									</li><li class="listitem">
										<code class="literal parameter">-D <span class="emphasis"><em>proxy_service_user_DN</em></span></code> sets the distinguished name (DN) of the account Squid uses to search for the authenticating user in the directory.
									</li><li class="listitem">
										<code class="literal parameter">-W <span class="emphasis"><em>path_to_password_file</em></span></code> sets the path to the file that contains the password of the proxy service user. Using a password file prevents that the password is visible in the operating system’s process list.
									</li><li class="listitem"><p class="simpara">
										<code class="literal parameter">-f <span class="emphasis"><em>LDAP_filter</em></span></code> specifies the LDAP search filter. Squid replaces the <code class="literal parameter">%s</code> variable with the user name provided by the authenticating user.
									</p><p class="simpara">
										The <code class="literal command">(&amp;(objectClass=person)(uid=%s))</code> filter in the example defines that the user name must match the value set in the <code class="literal parameter">uid</code> attribute and that the directory entry contains the <code class="literal command">person</code> object class.
									</p></li><li class="listitem"><p class="simpara">
										<code class="literal parameter">-ZZ</code> enforces a TLS-encrypted connection over the LDAP protocol using the <code class="literal command">STARTTLS</code> command. Omit the <code class="literal parameter">-ZZ</code> in the following situations:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												The LDAP server does not support encrypted connections.
											</li><li class="listitem">
												The port specified in the URL uses the LDAPS protocol.
											</li></ul></div></li><li class="listitem">
										The -H LDAP_URL parameter specifies the protocol, the host name or IP address, and the port of the LDAP server in URL format.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Add the following ACL and rule to configure that Squid allows only authenticated users to use the proxy:
							</p><pre class="literallayout">acl <span class="emphasis"><em>ldap-auth</em></span> proxy_auth REQUIRED
http_access allow <span class="emphasis"><em>ldap-auth</em></span></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Specify these settings before the <code class="literal command">http_access deny</code> all rule.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Remove the following rule to disable bypassing the proxy authentication from IP ranges specified in <code class="literal systemitem">localnet</code> ACLs:
							</p><pre class="literallayout">http_access allow localnet</pre></li><li class="listitem"><p class="simpara">
								The following ACL exists in the default configuration and defines <code class="literal systemitem">443</code> as a port that uses the HTTPS protocol:
							</p><pre class="literallayout">acl SSL_ports port 443</pre><p class="simpara">
								If users should be able to use the HTTPS protocol also on other ports, add an ACL for each of these port:
							</p><pre class="literallayout">acl SSL_ports port port_number</pre></li><li class="listitem"><p class="simpara">
								Update the list of <code class="literal command">acl Safe_ports</code> rules to configure to which ports Squid can establish a connection. For example, to configure that clients using the proxy can only access resources on port 21 (FTP), 80 (HTTP), and 443 (HTTPS), keep only the following <code class="literal command">acl Safe_ports</code> statements in the configuration:
							</p><pre class="literallayout">acl Safe_ports port 21
acl Safe_ports port 80
acl Safe_ports port 443</pre><p class="simpara">
								By default, the configuration contains the <code class="literal command">http_access deny !Safe_ports</code> rule that defines access denial to ports that are not defined in <code class="literal command">Safe_ports ACLs</code>.
							</p></li><li class="listitem"><p class="simpara">
								Configure the cache type, the path to the cache directory, the cache size, and further cache type-specific settings in the <code class="literal parameter">cache_dir</code> parameter:
							</p><pre class="literallayout">cache_dir ufs /var/spool/squid 10000 16 256</pre><p class="simpara">
								With these settings:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Squid uses the <code class="literal systemitem">ufs</code> cache type.
									</li><li class="listitem">
										Squid stores its cache in the <code class="literal filename">/var/spool/squid/</code> directory.
									</li><li class="listitem">
										The cache grows up to <code class="literal command">10000</code> MB.
									</li><li class="listitem">
										Squid creates <code class="literal command">16</code> level-1 sub-directories in the <code class="literal filename">/var/spool/squid/</code> directory.
									</li><li class="listitem"><p class="simpara">
										Squid creates <code class="literal command">256</code> sub-directories in each level-1 directory.
									</p><p class="simpara">
										If you do not set a <code class="literal command">cache_dir</code> directive, Squid stores the cache in memory.
									</p></li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
						If you set a different cache directory than <code class="literal filename">/var/spool/squid/</code> in the <code class="literal parameter">cache_dir</code> parameter:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the cache directory:
							</p><pre class="literallayout"># mkdir -p <span class="emphasis"><em>path_to_cache_directory</em></span></pre></li><li class="listitem"><p class="simpara">
								Configure the permissions for the cache directory:
							</p><pre class="literallayout"># chown squid:squid <span class="emphasis"><em>path_to_cache_directory</em></span></pre></li><li class="listitem"><p class="simpara">
								If you run SELinux in <code class="literal command">enforcing</code> mode, set the <code class="literal systemitem">squid_cache_t</code> context for the cache directory:
							</p><pre class="literallayout"># semanage fcontext -a -t squid_cache_t "<span class="emphasis"><em>path_to_cache_directory</em></span>(/.*)?"
# restorecon -Rv <span class="emphasis"><em>path_to_cache_directory</em></span></pre><p class="simpara">
								If the <code class="literal systemitem">semanage</code> utility is not available on your system, install the <code class="literal package">policycoreutils-python-utils</code> package.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Store the password of the LDAP service user in the <code class="literal filename">/etc/squid/ldap_password</code> file, and set appropriate permissions for the file:
					</p><pre class="literallayout"># echo "<span class="emphasis"><em>password</em></span>" &gt; /etc/squid/ldap_password
# chown root:squid /etc/squid/ldap_password
# chmod 640 /etc/squid/ldap_password</pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal command">3128</code> port in the firewall:
					</p><pre class="literallayout"># firewall-cmd --permanent --add-port=3128/tcp
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">squid</code> service:
					</p><pre class="literallayout"># systemctl enable --now squid</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To verify that the proxy works correctly, download a web page using the <code class="literal systemitem">curl</code> utility:
				</p></div><pre class="literallayout"># curl -O -L "<span class="emphasis"><em>https://www.redhat.com/index.html</em></span>" -x "<span class="emphasis"><em>user_name:password@proxy.example.com:3128</em></span>"</pre><p>
				If curl does not display any error and the <code class="literal filename">index.html</code> file was downloaded to the current directory, the proxy works.
			</p><div class="formalpara"><p class="title"><strong>Troubleshooting steps</strong></p><p>
					To verify that the helper utility works correctly:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Manually start the helper utility with the same settings you used in the <code class="literal parameter">auth_param</code> parameter:
					</p><pre class="literallayout"># /usr/lib64/squid/basic_ldap_auth -b "<span class="emphasis"><em>cn=users,cn=accounts,dc=example,dc=com</em></span>" -D "<span class="emphasis"><em>uid=proxy_user,cn=users,cn=accounts,dc=example,dc=com</em></span>" -W <span class="emphasis"><em>/etc/squid/ldap_password</em></span> -f "<span class="emphasis"><em>(&amp;(objectClass=person)(uid=%s))</em></span>" -ZZ -H <span class="emphasis"><em>ldap://ldap_server.example.com:389</em></span></pre></li><li class="listitem"><p class="simpara">
						Enter a valid user name and password, and press <span class="keycap"><strong>Enter</strong></span>:
					</p><pre class="literallayout"><span class="emphasis"><em>user_name</em></span> <span class="emphasis"><em>password</em></span></pre><p class="simpara">
						If the helper utility returns <code class="literal command">OK</code>, authentication succeeded.
					</p></li></ol></div></section><section class="section" id="setting-up-squid-as-a-caching-proxy-with-kerberos-authentication_configuring-the-squid-caching-proxy-server"><div class="titlepage"><div><div><h2 class="title">6.3. Setting up Squid as a caching proxy with kerberos authentication</h2></div></div></div><p>
				This section describes a basic configuration of Squid as a caching proxy that authenticates users to an Active Directory (AD) using Kerberos. The procedure configures that only authenticated users can use the proxy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The procedure assumes that the <code class="literal filename">/etc/squid/squid.conf</code> file is as provided by the <code class="literal package">squid</code> package. If you edited this file before, remove the file and reinstall the package.
					</li><li class="listitem">
						The server on which you want to install Squid is a member of the AD domain. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/assembly_using-samba-as-a-server_deploying-different-types-of-servers#assembly_setting-up-samba-as-an-ad-domain-member-server_assembly_using-samba-as-a-server">Setting up Samba as a Domain Member</a> in the Red Hat Enterprise Linux 8 <code class="literal citetitle">Deploying different types of servers</code> documentation.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the following packages:
					</p><pre class="literallayout">yum install squid krb5-workstation</pre></li><li class="listitem"><p class="simpara">
						Authenticate as the AD domain administrator:
					</p><pre class="literallayout"># kinit administrator@<span class="emphasis"><em>AD.EXAMPLE.COM</em></span></pre></li><li class="listitem"><p class="simpara">
						Create a keytab for Squid and store it in the <code class="literal filename">/etc/squid/HTTP.keytab</code> file:
					</p><pre class="literallayout"># export KRB5_KTNAME=FILE:/etc/squid/HTTP.keytab
# net ads keytab CREATE -U administrator</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal systemitem">HTTP</code> service principal to the keytab:
					</p><pre class="literallayout"># net ads keytab ADD HTTP -U administrator</pre></li><li class="listitem"><p class="simpara">
						Set the owner of the keytab file to the <code class="literal systemitem">squid</code> user:
					</p><pre class="literallayout"># chown squid /etc/squid/HTTP.keytab</pre></li><li class="listitem"><p class="simpara">
						Optionally, verify that the keytab file contains the <code class="literal systemitem">HTTP</code> service principal for the fully-qualified domain name (FQDN) of the proxy server:
					</p><pre class="literallayout">#  klist -k /etc/squid/HTTP.keytab
Keytab name: FILE:/etc/squid/HTTP.keytab
KVNO Principal
---- ---------------------------------------------------
...
   2 HTTP/proxy.ad.example.com@AD.EXAMPLE.COM
...</pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/squid/squid.conf</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								To configure the <code class="literal systemitem">negotiate_kerberos_auth</code> helper utility, add the following configuration entry to the top of <code class="literal filename">/etc/squid/squid.conf</code>:
							</p><pre class="literallayout">auth_param negotiate program /usr/lib64/squid/negotiate_kerberos_auth -k /etc/squid/HTTP.keytab -s HTTP/<span class="emphasis"><em>proxy.ad.example.com</em></span>@<span class="emphasis"><em>AD.EXAMPLE.COM</em></span></pre><p class="simpara">
								The following describes the parameters passed to the <code class="literal systemitem">negotiate_kerberos_auth</code> helper utility in the example above:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal parameter">-k <span class="emphasis"><em>file</em></span></code> sets the path to the key tab file. Note that the squid user must have read permissions on this file.
									</li><li class="listitem"><p class="simpara">
										<code class="literal parameter">-s HTTP/<span class="emphasis"><em>host_name</em></span>@<span class="emphasis"><em>kerberos_realm</em></span></code> sets the Kerberos principal that Squid uses.
									</p><p class="simpara">
										Optionally, you can enable logging by passing one or both of the following parameters to the helper utility:
									</p></li><li class="listitem">
										<code class="literal parameter">-i</code> logs informational messages, such as the authenticating user.
									</li><li class="listitem"><p class="simpara">
										<code class="literal parameter">-d</code> enables debug logging.
									</p><p class="simpara">
										Squid logs the debugging information from the helper utility to the <code class="literal filename">/var/log/squid/cache.log</code> file.
									</p></li></ul></div></li><li class="listitem"><p class="simpara">
								Add the following ACL and rule to configure that Squid allows only authenticated users to use the proxy:
							</p><pre class="literallayout">acl <span class="emphasis"><em>kerb-auth</em></span> proxy_auth REQUIRED
http_access allow <span class="emphasis"><em>kerb-auth</em></span></pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Specify these settings before the <code class="literal command">http_access deny all</code> rule.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Remove the following rule to disable bypassing the proxy authentication from IP ranges specified in <code class="literal systemitem">localnet</code> ACLs:
							</p><pre class="literallayout">http_access allow localnet</pre></li><li class="listitem"><p class="simpara">
								The following ACL exists in the default configuration and defines <code class="literal systemitem">443</code> as a port that uses the HTTPS protocol:
							</p><pre class="literallayout">acl SSL_ports port 443</pre><p class="simpara">
								If users should be able to use the HTTPS protocol also on other ports, add an ACL for each of these port:
							</p><pre class="literallayout">acl SSL_ports port <span class="emphasis"><em>port_number</em></span></pre></li><li class="listitem"><p class="simpara">
								Update the list of <code class="literal command">acl Safe_ports</code> rules to configure to which ports Squid can establish a connection. For example, to configure that clients using the proxy can only access resources on port 21 (FTP), 80 (HTTP), and 443 (HTTPS), keep only the following <code class="literal command">acl Safe_ports</code> statements in the configuration:
							</p><pre class="literallayout">acl Safe_ports port 21
acl Safe_ports port 80
acl Safe_ports port 443</pre><p class="simpara">
								By default, the configuration contains the <code class="literal command">http_access deny !Safe_ports</code> rule that defines access denial to ports that are not defined in <code class="literal command">Safe_ports</code> ACLs.
							</p></li><li class="listitem"><p class="simpara">
								Configure the cache type, the path to the cache directory, the cache size, and further cache type-specific settings in the <code class="literal parameter">cache_dir</code> parameter:
							</p><pre class="literallayout">cache_dir ufs /var/spool/squid 10000 16 256</pre><p class="simpara">
								With these settings:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Squid uses the <code class="literal systemitem">ufs</code> cache type.
									</li><li class="listitem">
										Squid stores its cache in the <code class="literal filename">/var/spool/squid/</code> directory.
									</li><li class="listitem">
										The cache grows up to <code class="literal command">10000</code> MB.
									</li><li class="listitem">
										Squid creates <code class="literal command">16</code> level-1 sub-directories in the <code class="literal filename">/var/spool/squid/</code> directory.
									</li><li class="listitem"><p class="simpara">
										Squid creates <code class="literal command">256</code> sub-directories in each level-1 directory.
									</p><p class="simpara">
										If you do not set a <code class="literal command">cache_dir</code> directive, Squid stores the cache in memory.
									</p></li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
						If you set a different cache directory than <code class="literal filename">/var/spool/squid/</code> in the <code class="literal parameter">cache_dir</code> parameter:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the cache directory:
							</p><pre class="literallayout"># mkdir -p <span class="emphasis"><em>path_to_cache_directory</em></span></pre></li><li class="listitem"><p class="simpara">
								Configure the permissions for the cache directory:
							</p><pre class="literallayout"># chown squid:squid <span class="emphasis"><em>path_to_cache_directory</em></span></pre></li><li class="listitem"><p class="simpara">
								If you run SELinux in <code class="literal command">enforcing</code> mode, set the <code class="literal systemitem">squid_cache_t</code> context for the cache directory:
							</p><pre class="literallayout"># semanage fcontext -a -t squid_cache_t "<span class="emphasis"><em>path_to_cache_directory</em></span>(/.*)?"
# restorecon -Rv <span class="emphasis"><em>path_to_cache_directory</em></span></pre><p class="simpara">
								If the <code class="literal systemitem">semanage</code> utility is not available on your system, install the <code class="literal package">policycoreutils-python-utils</code> package.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Open the <code class="literal command">3128</code> port in the firewall:
					</p><pre class="literallayout"># firewall-cmd --permanent --add-port=3128/tcp
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">squid</code> service:
					</p><pre class="literallayout"># systemctl enable --now squid</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To verify that the proxy works correctly, download a web page using the <code class="literal systemitem">curl</code> utility:
				</p></div><pre class="literallayout"># curl -O -L "<span class="emphasis"><em>https://www.redhat.com/index.html</em></span>" --proxy-negotiate -u : -x "<span class="emphasis"><em>proxy.ad.example.com:3128</em></span>"</pre><p>
				If <code class="literal systemitem">curl</code> does not display any error and the <code class="literal filename">index.html</code> file exists in the current directory, the proxy works.
			</p><div class="formalpara"><p class="title"><strong>Troubleshooting steps</strong></p><p>
					To manually test Kerberos authentication:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Obtain a Kerberos ticket for the AD account:
					</p><pre class="literallayout"># kinit user@<span class="emphasis"><em>AD.EXAMPLE.COM</em></span></pre></li><li class="listitem"><p class="simpara">
						Optionally, display the ticket:
					</p><pre class="literallayout"># klist</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal systemitem">negotiate_kerberos_auth_test</code> utility to test the authentication:
					</p><pre class="literallayout"># /usr/lib64/squid/negotiate_kerberos_auth_test <span class="emphasis"><em>proxy.ad.example.com</em></span></pre><p class="simpara">
						If the helper utility returns a token, the authentication succeeded:
					</p><pre class="literallayout">Token: YIIFtAYGKwYBBQUCoIIFqDC...</pre></li></ol></div></section><section class="section" id="configuring-a-domain-blacklist-in-squid_configuring-the-squid-caching-proxy-server"><div class="titlepage"><div><div><h2 class="title">6.4. Configuring a domain blacklist in Squid</h2></div></div></div><p>
				Frequently, administrators want to block access to specific domains. This section describes how to configure a domain blacklist in Squid.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Squid is configured, and users can use the proxy.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/squid/squid.conf</code> file and add the following settings:
					</p><pre class="literallayout">acl domain_blacklist dstdomain "/etc/squid/domain_blacklist.txt"
http_access deny all domain_blacklist</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Add these entries before the first <code class="literal command">http_access allow</code> statement that allows access to users or clients.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create the <code class="literal filename">/etc/squid/domain_blacklist.txt</code> file and add the domains you want to block. For example, to block access to <code class="literal systemitem">example.com</code> including subdomains and to block <code class="literal systemitem">example.net</code>, add:
					</p><pre class="literallayout">.example.com
example.net</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If you referred to the <code class="literal filename">/etc/squid/domain_blacklist.txt</code> file in the squid configuration, this file must not be empty. If the file is empty, Squid fails to start.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">squid</code> service:
					</p><pre class="literallayout"># systemctl restart squid</pre></li></ol></div></section><section class="section" id="configuring-the-squid-service-to-listen-on-a-specific-port-or-ip-address_configuring-the-squid-caching-proxy-server"><div class="titlepage"><div><div><h2 class="title">6.5. Configuring the Squid service to listen on a specific port or IP address</h2></div></div></div><p>
				By default, the Squid proxy service listens on the <code class="literal systemitem">3128</code> port on all network interfaces. This section describes how to change the port and configuring Squid to listen on a specific IP address.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal package">squid</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/squid/squid.conf</code> file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To set the port on which the Squid service listens, set the port number in the <code class="literal parameter">http_port</code> parameter. For example, to set the port to <code class="literal systemitem">8080</code>, set:
							</p><pre class="literallayout">http_port 8080</pre></li><li class="listitem"><p class="simpara">
								To configure on which IP address the Squid service listens, set the IP address and port number in the <code class="literal parameter">http_port</code> parameter. For example, to configure that Squid listens only on the <code class="literal systemitem">192.0.2.1</code> IP address on port <code class="literal systemitem">3128</code>, set:
							</p><pre class="literallayout">http_port 192.0.2.1:3128</pre><p class="simpara">
								Add multiple <code class="literal parameter">http_port</code> parameters to the configuration file to configure that Squid listens on multiple ports and IP addresses:
							</p><pre class="literallayout">http_port 192.0.2.1:3128
http_port 192.0.2.1:8080</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						If you configured that Squid uses a different port as the default (<code class="literal systemitem">3128</code>):
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Open the port in the firewall:
							</p><pre class="literallayout"># firewall-cmd --permanent --add-port=<span class="emphasis"><em>port_number</em></span>/tcp
# firewall-cmd --reload</pre></li><li class="listitem"><p class="simpara">
								If you run SELinux in enforcing mode, assign the port to the <code class="literal systemitem">squid_port_t</code> port type definition:
							</p><pre class="literallayout"># semanage port -a -t squid_port_t -p tcp <span class="emphasis"><em>port_number</em></span></pre><p class="simpara">
								If the <code class="literal systemitem">semanage</code> utility is not available on your system, install the <code class="literal package">policycoreutils-python-utils</code> package.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">squid</code> service:
					</p><pre class="literallayout"># systemctl restart squid</pre></li></ol></div></section><section class="section" id="additional_resources_3"><div class="titlepage"><div><div><h2 class="title">6.6. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal filename">usr/share/doc/squid-&lt;version&gt;/squid.conf.documented</code> file for a list of all configuration parameters you can set in the <code class="literal filename">/etc/squid/squid.conf</code> file together with a detailed description.
					</li></ul></div></section></section><section class="chapter" id="using-databases"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Database servers</h1></div></div></div><section class="section" id="introduction-to-databases_using-databases"><div class="titlepage"><div><div><h2 class="title">7.1. Introduction to database servers</h2></div></div></div><p>
				A database server is a hardware device which has a certain amount of main memory, and a database (DB) application installed. This DB application provides services as a means of writing the cached data from the main memory, which is usually small and expensive, to DB files (database). These services are provided to multiple clients on a network. There can be as many DB servers as a machine’s main memory and storage allows.
			</p><p>
				Red Hat Enterprise Linux 8 provides the following database applications:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						MariaDB 10.3
					</li><li class="listitem">
						MySQL 8.0
					</li><li class="listitem">
						PostgreSQL 10
					</li><li class="listitem">
						PostgreSQL 9.6
					</li></ul></div></section><section class="section" id="using-mariadb"><div class="titlepage"><div><div><h2 class="title">7.2. Using MariaDB</h2></div></div></div><section class="section" id="introduction-to-mariadb_using-mariadb"><div class="titlepage"><div><div><h3 class="title">7.2.1. Getting started with MariaDB</h3></div></div></div><p>
					The <span class="strong strong"><strong>MariaDB</strong></span> server is an open source fast and robust database server that is based on MySQL technology.
				</p><p>
					<span class="strong strong"><strong>MariaDB</strong></span> is a relational database which converts data into structured information and provides an SQL interface for accessing data. It includes multiple storage engines and plug-ins, as well as geographic information system (GIS) and JavaScript Object Notation (JSON) features.
				</p><p>
					This section describes how to install the <span class="strong strong"><strong>MariaDB</strong></span> server in <a class="link" href="index.html#installing-mariadb_using-mariadb" title="7.2.2. Installing MariaDB">Installing MariaDB</a> or how to migrate from the Red Hat Enterprise Linux 7 default version, <span class="strong strong"><strong>MariaDB 5.5</strong></span>, to the Red Hat Enterprise Linux 8 default version, <span class="strong strong"><strong>MariaDB 10.3</strong></span>, in <a class="link" href="index.html#migrating-to-mariadb_10_3_using-mariadb" title="7.2.5. Migrating to MariaDB 10.3">Migrating to MariaDB 10.3</a>, and also how to back up MariaDB data. Performing data backup is one of the prerequisites for MariaDB migration.
				</p></section><section class="section" id="installing-mariadb_using-mariadb"><div class="titlepage"><div><div><h3 class="title">7.2.2. Installing MariaDB</h3></div></div></div><p>
					To install <span class="strong strong"><strong>MariaDB</strong></span>, follow this procedure:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Ensure that all necessary packages for MariaDB server are available on the system by installing the <code class="literal">mariadb</code> module using a specific stream:
						</p><pre class="literallayout"># yum module install mariadb:10.3/server</pre></li><li class="listitem"><p class="simpara">
							Start the <code class="literal">mariadb</code> service:
						</p><pre class="literallayout"># systemctl start mariadb.service</pre></li><li class="listitem"><p class="simpara">
							Enable the <code class="literal">mariadb</code> service to start at boot:
						</p><pre class="literallayout"># systemctl enable mariadb.service</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Note that the <span class="strong strong"><strong>MariaDB</strong></span> and <span class="strong strong"><strong>MySQL</strong></span> database servers cannot be installed in parallel in Red Hat Enterprise Linux 8.0 due to conflicting RPM packages. Parallel installation of components is possible in Red Hat Software Collections for Red Hat Enterprise Linux 6 and Red Hat Enterprise Linux 7. In Red Hat Enterprise Linux 8, different versions of database servers can be used in containers.
					</p></div></div><section class="section" id="sect-mariadb-secure-configurations"><div class="titlepage"><div><div><h4 class="title">7.2.2.1. Improving MariaDB installation security</h4></div></div></div><p>
						To improve security when installing <span class="strong strong"><strong>MariaDB</strong></span>, run the following command.
					</p><p>
						The command launches a fully interactive script, which prompts for each step in the process.
					</p><pre class="literallayout"># mysql_secure_installation</pre><p>
						The script enables to improve security in the following ways:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Setting a password for root accounts
							</li><li class="listitem">
								Removing anonymous users
							</li><li class="listitem">
								Disallowing remote (outside the local host) root logins
							</li></ul></div></section></section><section class="section" id="configuring-mariadb_using-mariadb"><div class="titlepage"><div><div><h3 class="title">7.2.3. Configuring MariaDB</h3></div></div></div><section class="section" id="configuring_the_mariadb_server_for_networking"><div class="titlepage"><div><div><h4 class="title">7.2.3.1. Configuring the MariaDB server for networking</h4></div></div></div><p>
						To configure the <span class="strong strong"><strong>MariaDB</strong></span> server for networking, use the <code class="literal">[mysqld]</code> section of the <code class="literal filename">/etc/my.cnf.d/mariadb-server.cnf</code> file, where you can set the following configuration directives:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<code class="literal">bind-address</code>
							</p><p class="simpara">
								Bind-address is the address on which the server will listen.
							</p><p class="simpara">
								Possible options are: a host name, an IPv4 address, or an IPv6 address.
							</p></li><li class="listitem"><p class="simpara">
								<code class="literal">skip-networking</code>
							</p><p class="simpara">
								Possible values are:
							</p><p class="simpara">
								0 - to listen for all clients
							</p><p class="simpara">
								1 - to listen for local clients only
							</p></li><li class="listitem"><p class="simpara">
								<code class="literal">port</code>
							</p><p class="simpara">
								The port on which <span class="strong strong"><strong>MariaDB</strong></span> listens for TCP/IP connections.
							</p></li></ul></div></section></section><section class="section" id="backing-up-mariadb-data_using-mariadb"><div class="titlepage"><div><div><h3 class="title">7.2.4. Backing up MariaDB data</h3></div></div></div><p>
					There are two main ways to back up data from a MariaDB database:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Logical backup
						</li><li class="listitem">
							Physical backup
						</li></ul></div><p>
					<span class="strong strong"><strong>Logical backup</strong></span> consists of the SQL statements necessary to restore the data. This type of backup exports information and records in plain text files.
				</p><p>
					The main advantage of logical backup over physical backup is portability and flexibility. The data can be restored on other hardware configurations, MariaDB versions or Database Management System (DBMS), which is not possible with physical backups.
				</p><p>
					Note that logical backup can be performed if the <code class="literal">mariadb.service</code> is running. Logical backup does not include log and configuration files.
				</p><p>
					<span class="strong strong"><strong>Physical backup</strong></span> consists of copies of files and directories that store the content.
				</p><p>
					Physical backup has the following advantages compared to logical backup:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Output is more compact.
						</li><li class="listitem">
							Backup is smaller in size.
						</li><li class="listitem">
							Backup and restore are faster.
						</li><li class="listitem">
							Backup includes log and configuration files.
						</li></ul></div><p>
					Note that physical backup must be performed when the <code class="literal">mariadb.service</code> is not running or all tables in the database are locked to prevent changes during the backup.
				</p><p>
					You can use one of the following <span class="strong strong"><strong>MariaDB</strong></span> backup approaches to back up data from a <span class="strong strong"><strong>MariaDB</strong></span> database:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Logical backup with mysqldump
						</li><li class="listitem">
							Physical online backup using the Mariabackup tool
						</li><li class="listitem">
							File system backup
						</li><li class="listitem">
							Replication as a backup solution
						</li></ul></div><section class="section" id="performing-logical-backup-with-mysqldump_backing-up-mariadb-data"><div class="titlepage"><div><div><h4 class="title">7.2.4.1. Performing logical backup with mysqldump</h4></div></div></div><p>
						The <span class="strong strong"><strong><span class="application application">mysqldump</span></strong></span> client is a backup utility, which can can be used to dump a database or a collection of databases for the purpose of a backup or transfer to another database server. The output of <span class="strong strong"><strong><span class="application application">mysqldump</span></strong></span> typically consists of SQL statements to re-create the server table structure, populate it with data, or both. Alternatively, <span class="strong strong"><strong><span class="application application">mysqldump</span></strong></span> can also generate files in other formats, including CSV or other delimited text formats, and XML.
					</p><p>
						To perform the <span class="strong strong"><strong><span class="application application">mysqldump</span></strong></span> backup, you can use one of the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Back up a selected database
							</li><li class="listitem">
								Back up a subset of tables from one database
							</li><li class="listitem">
								Back up multiple databases
							</li><li class="listitem">
								Back up all databases
							</li></ul></div><section class="section" id="backing-up-an-entire-database_performing-logical-backup-with-mysqldump"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.1. Backing up an entire database with mysqldump</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To back up an entire database, run:
								</p><pre class="literallayout"># mysqldump [options] db_name &gt; backup-file.sql</pre></li></ul></div></section><section class="section" id="using-myslqldump-to-back-up-a-set-of-tables-from-one-database_performing-logical-backup-with-mysqldump"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.2. Using mysqldump to back up a set of tables from one database</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To back up a subset of tables from one database, add a list of the chosen tables at the end of the <code class="literal command">mysqldump</code> command:
								</p><pre class="literallayout"># mysqldump [options] db_name [tbl_name …​]</pre></li></ul></div></section><section class="section" id="using-the-mysqldump-to-load-the-dump-file-back-into-a-server_performing-logical-backup-with-mysqldump"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.3. Using mysqldump to load the dump file back into a server</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To load the dump file back into a server, use either of these:
								</p><pre class="literallayout"># mysql db_name &lt; backup-file.sql</pre><pre class="literallayout"># mysql -e "source /path-to-backup/backup-file.sql" db_name</pre></li></ul></div></section><section class="section" id="using-mysqldump-to-copy-data-between-two-databases_performing-logical-backup-with-mysqldump"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.4. Using mysqldump to copy data between two databases</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To populate databases by copying data from one <span class="strong strong"><strong>MariaDB</strong></span> server to another, run:
								</p><pre class="literallayout"># mysqldump --opt db_name | mysql --host=remote_host -C db_name</pre></li></ul></div></section><section class="section" id="dumping-multiple-databases-with-mysqldump_performing-logical-backup-with-mysqldump"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.5. Dumping multiple databases with mysqldump</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To dump multiple databases at once, run:
								</p><pre class="literallayout"># mysqldump [options] --databases db_name1 [db_name2 …​] &gt; my_databases.sql</pre></li></ul></div></section><section class="section" id="dumping-all-databases-with-mysqldump_performing-logical-backup-with-mysqldump"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.6. Dumping all databases with mysqldump</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To dump all databases, run:
								</p><pre class="literallayout"># mysqldump [options] --all-databases &gt; all_databases.sql</pre></li></ul></div></section><section class="section" id="reviewing-mysqldump-options_performing-logical-backup-with-mysqldump"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.7. Reviewing mysqldump options</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To see a list of the options that mysqldump supports, run:
								</p><pre class="literallayout">$ mysqldump --help</pre></li></ul></div></section><section class="section" id="additional_resources_4"><div class="titlepage"><div><div><h5 class="title">7.2.4.1.8. Additional resources</h5></div></div></div><p>
							For more information on logical backup with <span class="strong strong"><strong><span class="application application">mysqldump</span></strong></span>, see the <a class="link" href="https://mariadb.com/kb/en/library/mysqldump/">MariaDB Documentation</a>.
						</p></section></section><section class="section" id="performing-physical-online-backup_backing-up-mariadb-data"><div class="titlepage"><div><div><h4 class="title">7.2.4.2. Performing physical online backup using the Mariabackup tool</h4></div></div></div><p>
						<span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> is a tool based on the Percona XtraBackup technology, which enables performing physical online backups of InnoDB, Aria, and MyISAM tables.
					</p><p>
						<span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span>, provided by the <code class="literal package">mariadb-backup</code> package from the AppStream repository, supports full backup capability for <span class="strong strong"><strong>MariaDB</strong></span> server, which includes encrypted and compressed data.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The <code class="literal package">mariadb-backup</code> package is installed on the system:
							</p><pre class="literallayout"># yum install mariadb-backup</pre></li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> needs to be provided with credentials for the user by which the backup will be run. You can either provide the credentials on the command line, as shown in the procedure, or by a configuration file before applying the procedure. To set the credentials using the configuration file, first create the file (for example, <code class="literal filename">/etc/my.cnf.d/mariabackup.cnf</code>), and than add the following lines into the <code class="literal">[xtrabackup]</code> or <code class="literal">[mysqld]</code> section of the new file:
							</p><pre class="literallayout">[xtrabackup]
user=myuser
password=mypassword</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									<span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> does not read options in the <code class="literal">[mariadb]</code> section of configuration files. If a non-default data directory is specified on a <span class="strong strong"><strong>MariaDB</strong></span> server, you must specify this directory in the <code class="literal">[xtrabackup]</code> or <code class="literal">[mysqld]</code> sections of configuration files, so that <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> is able to find the data directory.
								</p><p>
									To specify such a data directory, include the following line in the <code class="literal">[xtrabackup]</code> or <code class="literal">[mysqld]</code> sections of <span class="strong strong"><strong>MariaDB</strong></span> configuration files:
								</p><pre class="literallayout">datadir=/var/mycustomdatadir</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Users of <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> must have the <code class="literal">RELOAD</code>, <code class="literal">LOCK TABLES</code>, and <code class="literal">REPLICATION CLIENT</code> privileges to be able to work with the backup.
								</p></div></div></li></ul></div><p>
						To create a backup of a database using <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span>, use the following procedure:
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Run the following command:
							</p><pre class="literallayout">$ mariabackup --backup --target-dir &lt;backup_directory&gt; --user &lt;backup_user&gt; --password &lt;backup_passwd&gt;</pre><p class="simpara">
								The <code class="literal option">target-dir</code> option defines the directory where the backup files are stored. If you want to perform a full backup, the target directory must be empty or not exist.
							</p><p class="simpara">
								The <code class="literal option">user</code> and <code class="literal option">password</code> options allow you to configure the user name and the password. Do not use these options if you already configured the user name and the password in the configuration file as described in prerequisites.
							</p></li></ul></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
							For more information on performing backups with <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span>, see <a class="link" href="https://mariadb.com/kb/en/library/full-backup-and-restore-with-mariadb-backup/">Full Backup and Restore with Mariabackup</a>.
						</p></div></section><section class="section" id="restoring-data-using-the-mariabackup-tool_backing-up-mariadb-data"><div class="titlepage"><div><div><h4 class="title">7.2.4.3. Restoring data using the Mariabackup tool</h4></div></div></div><p>
						When the backup is complete, you can restore the data from the backup by using the <code class="literal command">mariabackup</code> command with one of the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal option">--copy-back</code>
							</li><li class="listitem">
								<code class="literal option">--move-back</code>
							</li></ul></div><p>
						The <code class="literal option">--copy-back</code> option allows you to keep the original backup files. The <code class="literal option">--move-back</code> option moves the backup files to the data directory, and removes the original backup files.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Make sure that the <code class="literal">mariadb</code> service is not running:
							</p><pre class="literallayout"># systemctl stop mariadb.service</pre></li><li class="listitem">
								Make sure that the data directory is empty.
							</li></ul></div><section class="section" id="restoring-data-using-copy-back_restoring-data-using-the-mariabackup-tool"><div class="titlepage"><div><div><h5 class="title">7.2.4.3.1. Restoring data with Mariabackup while keeping the backup files</h5></div></div></div><p>
							To restore the data while keeping the original backup files, use the following procedure.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the <code class="literal command">mariabackup</code> command with the <code class="literal option">--copy-back</code> option:
								</p><pre class="literallayout">$ mariabackup --copy-back --target-dir=/var/mariadb/backup/</pre></li><li class="listitem"><p class="simpara">
									Fix the file permissions.
								</p><p class="simpara">
									When restoring a database, <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> preserves the file and directory privileges of the backup. However, <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> writes the files to disk as the user and group restoring the database. Consequently, after restoring a backup, you may need to adjust the owner of the data directory to match the user and group for the <span class="strong strong"><strong>MariaDB</strong></span> Server, typically <code class="literal">mysql</code> for both.
								</p><p class="simpara">
									For example, to recursively change ownership of the files to the <code class="literal">mysql</code> user and group:
								</p><pre class="literallayout"># chown -R mysql:mysql /var/lib/mysql/</pre></li><li class="listitem"><p class="simpara">
									Start the <code class="literal">mariadb</code> service:
								</p><pre class="literallayout"># systemctl start mariadb.service</pre></li></ol></div></section><section class="section" id="restoring-data-using-move-back_restoring-data-using-the-mariabackup-tool"><div class="titlepage"><div><div><h5 class="title">7.2.4.3.2. Restoring data with Mariabackup while removing the backup files</h5></div></div></div><p>
							To restore the data, and not keep the original backup files, use the following procedure.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Run the <code class="literal command">mariabackup</code> command with the <code class="literal option">--move-back</code> option:
								</p><pre class="literallayout">$ mariabackup --move-back --target-dir=/var/mariadb/backup/</pre></li><li class="listitem"><p class="simpara">
									Fix the file permissions.
								</p><p class="simpara">
									When restoring a database, <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> preserves the file and directory privileges of the backup. However, <span class="strong strong"><strong><span class="application application">Mariabackup</span></strong></span> writes the files to disk as the user and group restoring the database. Consequently, after restoring a backup, you may need to adjust the owner of the data directory to match the user and group for the <span class="strong strong"><strong>MariaDB</strong></span> Server, typically <code class="literal">mysql</code> for both.
								</p><p class="simpara">
									For example, to recursively change ownership of the files to the <code class="literal">mysql</code> user and group:
								</p><pre class="literallayout"># chown -R mysql:mysql /var/lib/mysql/</pre></li><li class="listitem"><p class="simpara">
									Start the <code class="literal">mariadb</code> service:
								</p><pre class="literallayout"># systemctl start mariadb.service</pre></li></ol></div></section><section class="section" id="additional_resources_5"><div class="titlepage"><div><div><h5 class="title">7.2.4.3.3. Additional resources</h5></div></div></div><p>
							For more information see <a class="link" href="https://mariadb.com/kb/en/library/full-backup-and-restore-with-mariabackup/">Full Backup and Restore with Mariabackup</a>.
						</p></section></section><section class="section" id="performing-file-system-backup_backing-up-mariadb-data"><div class="titlepage"><div><div><h4 class="title">7.2.4.4. Performing file system backup</h4></div></div></div><p>
						To create a file system backup of <span class="strong strong"><strong>MariaDB</strong></span> data files, switch to the <code class="literal">root</code> user, and copy the content of the <span class="strong strong"><strong>MariaDB</strong></span> data directory to your backup location.
					</p><p>
						To back up also your current configuration or the log files, use the optional steps of the following procedure.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Stop the <code class="literal">mariadb</code> service:
							</p><pre class="literallayout"># systemctl stop mariadb.service</pre></li><li class="listitem"><p class="simpara">
								Copy the data files to the required location:
							</p><pre class="literallayout"># cp -r /var/lib/mysql /backup-location</pre></li><li class="listitem"><p class="simpara">
								Optionally, copy the configuration files to the required location:
							</p><pre class="literallayout"># cp -r /etc/my.cnf /etc/my.cnf.d /backup-location/configuration</pre></li><li class="listitem"><p class="simpara">
								Optionally, copy the log files to the required location:
							</p><pre class="literallayout"># cp /var/log/mariadb/* /backup-location/logs</pre></li><li class="listitem"><p class="simpara">
								Start the <code class="literal">mariadb</code> service:
							</p><pre class="literallayout"># systemctl start mariadb.service</pre></li></ol></div></section><section class="section" id="introduction-to-replication-as-a-backup-solution_backing-up-mariadb-data"><div class="titlepage"><div><div><h4 class="title">7.2.4.5. Introduction to replication as a backup solution</h4></div></div></div><p>
						Replication is an alternative backup solution for master servers. If a master server replicates to a slave server, backups can be run on the slave without any impact on the master. Master can still run while you shut down the slave, and back the data up from him.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Replication itself is not a sufficient backup solution. Replication protects master servers against hardware failures, but it does not ensure protection against data loss. It is recommended that you use any other backup solution on the replication slave together with this method.
						</p></div></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
							For more information on replication as a backup solution, see <a class="link" href="https://mariadb.com/kb/en/library/replication-as-a-backup-solution/">MariaDB Documentation</a>.
						</p></div></section></section><section class="section" id="migrating-to-mariadb_10_3_using-mariadb"><div class="titlepage"><div><div><h3 class="title">7.2.5. Migrating to MariaDB 10.3</h3></div></div></div><p>
					Red Hat Enterprise Linux 7 contains <span class="strong strong"><strong>MariaDB 5.5</strong></span> as the default implementation of a server from the MySQL databases family. Later versions of the <span class="strong strong"><strong>MariaDB</strong></span> database server are available as Software Collections for Red Hat Enterprise Linux 6 and Red Hat Enterprise Linux 7. Red Hat Enterprise Linux 8 provides <span class="strong strong"><strong>MariaDB 10.3</strong></span> and <span class="strong strong"><strong>MySQL 8.0</strong></span>.
				</p><section class="section" id="notable-differences-in-mariadb-rhel7-rhel8"><div class="titlepage"><div><div><h4 class="title">7.2.5.1. Notable differences between the RHEL 7 and RHEL 8 versions of MariaDB</h4></div></div></div><p>
						The most important changes between <span class="strong strong"><strong>MariaDB 5.5</strong></span> and <span class="strong strong"><strong>MariaDB</strong></span> 10.3 are as follows:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>MariaDB</strong></span> Galera Cluster, a synchronous multi-master cluster, is a standard part of <span class="strong strong"><strong>MariaDB</strong></span> since 10.1.
							</li><li class="listitem">
								The ARCHIVE storage engine is no longer enabled by default, and the plug-in needs to be specifically enabled.
							</li><li class="listitem">
								The BLACKHOLE storage engine is no longer enabled by default, and the plug-in needs to be specifically enabled.
							</li><li class="listitem"><p class="simpara">
								InnoDB is used as the default storage engine instead of XtraDB, which was used in <span class="strong strong"><strong>MariaDB 10.1</strong></span> and earlier versions.
							</p><p class="simpara">
								For more details, see <a class="link" href="https://mariadb.com/kb/en/library/why-does-mariadb-102-use-innodb-instead-of-xtradb/">Why does MariaDB 10.2 use InnoDB instead of XtraDB?</a>.
							</p></li><li class="listitem">
								The new <code class="literal package">mariadb-connector-c</code> packages provide a common client library for MySQL and MariaDB. This library is usable with any version of the <span class="strong strong"><strong>MySQL</strong></span> and <span class="strong strong"><strong>MariaDB</strong></span> database servers. As a result, the user is able to connect one build of an application to any of the MySQL and <span class="strong strong"><strong>MariaDB</strong></span> servers distributed with Red Hat Enterprise Linux 8.
							</li></ul></div><p>
						To migrate from <span class="strong strong"><strong>MariaDB 5.5</strong></span> to <span class="strong strong"><strong>MariaDB 10.3</strong></span>, you need to perform multiple configuration changes as described in <a class="xref" href="index.html#migrating-to-mariadb_10_3_conf_changes" title="7.2.5.2. Configuration changes">Section 7.2.5.2, “Configuration changes”</a>.
					</p></section><section class="section" id="migrating-to-mariadb_10_3_conf_changes"><div class="titlepage"><div><div><h4 class="title">7.2.5.2. Configuration changes</h4></div></div></div><p>
						The recommended migration path from <span class="strong strong"><strong>MariaDB 5.5</strong></span> to <span class="strong strong"><strong>MariaDB 10.3</strong></span> is to upgrade to <span class="strong strong"><strong>MariaDB 10.0</strong></span> first, and then upgrade by one version successively.
					</p><p>
						The main advantage of upgrading one by one version is better adaptation of the database, including both data and configuration to the changes. The upgrade ends on the same major version as is available in RHEL 8 (MariaDB 10.3), which significantly reduces configuration changes or other issues.
					</p><p>
						For more information about configuration changes when migrating from <span class="strong strong"><strong>MariaDB 5.5</strong></span> to <span class="strong strong"><strong>MariaDB 10.0</strong></span>, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_software_collections/2/html-single/2.0_release_notes/#sect-Migration-MariaDB/">Migrating to MariaDB 10.0</a> in Red Hat Software Collections documentation.
					</p><p>
						The migration to following successive versions of <span class="strong strong"><strong>MariaDB</strong></span> and the required configuration changes is described in these documents:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_software_collections/2/html-single/2.2_release_notes/#sect-Migration-MariaDB">Migrating to MariaDB 10.1</a> in Red Hat Software Collections documentation.
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_software_collections/3/html-single/3.0_release_notes/#sect-Migration-MariaDB">Migrating to MariaDB 10.2</a> in Red Hat Software Collections documentation.
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_software_collections/3/html-single/3.3_release_notes/index#sect-Migration-MariaDB">Migrating to MariaDB 10.3</a> in Red Hat Software Collections documentation.
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Migration directly from <span class="strong strong"><strong>MariaDB 5.5</strong></span> to <span class="strong strong"><strong>MariaDB 10.3</strong></span> is also possible, but you must perform all configuration changes that are required by differences described in the migration documents above.
						</p></div></div></section><section class="section" id="mariadb-in-place-upgrade"><div class="titlepage"><div><div><h4 class="title">7.2.5.3. In-place upgrade using the mysql_upgrade tool</h4></div></div></div><p>
						To migrate the database files to Red Hat Enterprise Linux 8, users of <span class="strong strong"><strong>MariaDB</strong></span> on Red Hat Enterprise Linux 7 need to perform the in-place upgrade using the <code class="literal">mysql_upgrade</code> tool. The <code class="literal">mysql_upgrade</code> tool is provided by the <code class="literal">mariadb-server-utils</code> subpackage, which is installed as a dependency of the <code class="literal">mariadb-server</code> package.
					</p><p>
						To perform an in-place upgrade, you need to copy binary data files to the <code class="literal filename">/var/lib/mysql/</code> data directory on the Red Hat Enterprise Linux 8 system and use the <code class="literal">mysql_upgrade</code> tool.
					</p><p>
						You can use this method for migrating data from:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat Enterprise Linux 7 version of <span class="strong strong"><strong>MariaDB 5.5</strong></span>
							</li><li class="listitem"><p class="simpara">
								The Red Hat Software Collections versions of:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<span class="strong strong"><strong>MariaDB 5.5</strong></span> (no longer supported)
									</li><li class="listitem">
										<span class="strong strong"><strong>MariaDB 10.0</strong></span> (no longer supported)
									</li><li class="listitem">
										<span class="strong strong"><strong>MariaDB 10.1</strong></span> (no longer supported)
									</li><li class="listitem">
										<span class="strong strong"><strong>MariaDB 10.2</strong></span>
									</li></ul></div></li></ul></div><p>
						Note that it is recommended to upgrade to <span class="strong strong"><strong>MariaDB 10.2</strong></span> by one version successively. See the respective Migration chapters in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_software_collections/3/">Release Notes for Red Hat Software Collections</a>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you are upgrading from the Red Hat Enterprise Linux 7 version of <span class="strong strong"><strong>MariaDB</strong></span>, the source data is stored in the <code class="literal filename">/var/lib/mysql/</code> directory. In case of Red Hat Software Collections versions of <span class="strong strong"><strong>MariaDB</strong></span>, the source data directory is <code class="literal filename">/var/opt/rh/&lt;collection_name&gt;/lib/mysql/</code> (with the exception of the <code class="literal">mariadb55</code>, which uses the <code class="literal filename">/opt/rh/mariadb55/root/var/lib/mysql/</code> data directory).
						</p></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Before performing the upgrade, back up all your data stored in the <span class="strong strong"><strong>MariaDB</strong></span> databases.
						</p></div></div><p>
						To perform the in-place upgrade, change to the <code class="literal">root</code> user, and use the following procedure:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Ensure that the <code class="literal package">mariadb-server</code> package is installed on the Red Hat Enterprise Linux 8 system:
							</p><pre class="literallayout"># yum install mariadb-server</pre></li><li class="listitem"><p class="simpara">
								Ensure that the mariadb daemon is not running on either of the source and target systems at the time of copying data:
							</p><pre class="literallayout"># systemctl stop mariadb.service</pre></li><li class="listitem">
								Copy the data from the source location to the <code class="literal filename">/var/lib/mysql/</code> directory on the Red Hat Enterprise Linux 8 target system.
							</li><li class="listitem"><p class="simpara">
								Set the appropriate permissions and SELinux context for copied files on the target system:
							</p><pre class="literallayout"># restorecon -vr /var/lib/mysql</pre></li><li class="listitem"><p class="simpara">
								Start the <span class="strong strong"><strong>MariaDB</strong></span> server on the target system:
							</p><pre class="literallayout"># systemctl start mariadb.service</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal command">mysql_upgrade</code> command to check and repair internal tables:
							</p><pre class="literallayout"># systemctl mysql_upgrade</pre></li><li class="listitem">
								When the upgrade is complete, make sure that all configuration files within the <code class="literal filename">/etc/my.cnf.d/</code> directory include only valid options for <span class="strong strong"><strong>MariaDB 10.3</strong></span>.
							</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							There are certain risks and known problems related to in-place upgrade. For example, some queries might not work or they will be run in different order than before the upgrade. For more information on these risks and problems, and for general information about in-place upgrade, see <a class="link" href="https://mariadb.com/kb/en/library/mariadb-1030-release-notes/">MariaDB 10.3 Release Notes</a>.
						</p></div></div></section></section><section class="section" id="replicating-mariadb-with-galera_using-mariadb"><div class="titlepage"><div><div><h3 class="title">7.2.6. Replicating MariaDB with Galera</h3></div></div></div><p>
					This section describes how to replicate a MariaDB database using the Galera solution.
				</p><section class="section" id="introduction-to-galera-replication_replicating-mariadb-with-galera"><div class="titlepage"><div><div><h4 class="title">7.2.6.1. Introduction to MariaDB Galera Cluster</h4></div></div></div><p>
						Galera replication is based on creation of a synchronous multi-master <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span> consisting of multiple MariaDB servers.
					</p><p>
						The interface between Galera replication and a MariaDB database is defined by the write set replication API (<span class="strong strong"><strong>wsrep API</strong></span>).
					</p><p>
						The main features of <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span> are:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Synchronous replication
							</li><li class="listitem">
								Active-active multi-master topology
							</li><li class="listitem">
								Read and write to any cluster node
							</li><li class="listitem">
								Automatic membership control, failed nodes drop from the cluster
							</li><li class="listitem">
								Automatic node joining
							</li><li class="listitem">
								Parallel replication on row level
							</li><li class="listitem">
								Direct client connections (Users can log on to the cluster nodes, and work with the nodes directly while the replication runs.)
							</li></ul></div><p>
						Synchronous replication means that a server replicates a transaction at commit time by broadcasting the write set associated with the transaction to every node in the cluster. The client (user application) connects directly to the Database Management System (DBMS), and experiences behavior that is similar to native MariaDB.
					</p><p>
						Synchronous replication guarantees that a change that happened on one node in the cluster happens on other nodes in the cluster at the same time.
					</p><p>
						Therefore, synchronous replication has the following advantages over asynchronous replication:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								No delay in propagation of the changes between particular cluster nodes
							</li><li class="listitem">
								All cluster nodes are always consistent
							</li><li class="listitem">
								The latest changes are not lost if one of the cluster nodes crashes
							</li><li class="listitem">
								Transactions on all cluster nodes are executed in parallel
							</li><li class="listitem">
								Causality across the whole cluster
							</li></ul></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
							For more detailed information, see the upstream documentation:
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://mariadb.com/kb/en/library/about-galera-replication/">About Galera replication</a>
							</li><li class="listitem">
								<a class="link" href="https://mariadb.com/kb/en/library/what-is-mariadb-galera-cluster/">What is MariaDB Galera Cluster</a>
							</li><li class="listitem">
								<a class="link" href="https://mariadb.com/kb/en/library/getting-started-with-mariadb-galera-cluster/">Getting started with MariaDB Galera Cluster</a>
							</li></ul></div></section><section class="section" id="components-to-build-mariadb-galera-cluster_replicating-mariadb-with-galera"><div class="titlepage"><div><div><h4 class="title">7.2.6.2. Components to build MariaDB Galera Cluster</h4></div></div></div><p>
						To be able to build <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span>, the following packages must be installed on your system:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal package">mariadb-server-galera</code>
							</li><li class="listitem">
								<code class="literal package">mariadb-server</code>
							</li><li class="listitem">
								<code class="literal package">galera</code>
							</li></ul></div><p>
						The <code class="literal package">mariadb-server-galera</code> package contains support files and scripts for <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span>.
					</p><p>
						MariaDB upstream patches the <code class="literal package">mariadb-server</code> package to include the write set replication API (<span class="strong strong"><strong>wsrep API</strong></span>). This API provides the interface between Galera replication and MariaDB.
					</p><p>
						MariaDB upstream also patches the <code class="literal package">galera</code> package to add full support for <span class="strong strong"><strong><span class="application application">MariaDB</span></strong></span>. The <code class="literal package">galera</code> package contains the <span class="strong strong"><strong>Galera Replication Library</strong></span> and the <span class="strong strong"><strong>Galera Arbitrator</strong></span> tool. <span class="strong strong"><strong>Galera Replication Library</strong></span> provides the whole replication functionality. <span class="strong strong"><strong>Galera Arbitrator</strong></span> can be used as a cluster member that participates in voting in split-brain scenarios. However, <span class="strong strong"><strong>Galera Arbitrator</strong></span> cannot participate in the actual replication.
					</p><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
							For more detailed information, see upstream documentation:
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://mariadb.com/kb/en/library/about-galera-replication/#generic-replication-library">Galera Replication Library</a>
							</li><li class="listitem">
								<a class="link" href="https://galeracluster.com/library/documentation/arbitrator.html">Galera Arbitrator</a>
							</li><li class="listitem">
								<a class="link" href="https://github.com/codership/mysql-wsrep">mysql-wsrep project</a>
							</li></ul></div></section><section class="section" id="configuring-mariadb-galera-cluster_replicating-mariadb-with-galera"><div class="titlepage"><div><div><h4 class="title">7.2.6.3. Deploying MariaDB Galera Cluster</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								All software necessary to build <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span> must be installed on the system. To ensure this, install the <code class="literal">galera</code> profile of the <code class="literal">mariadb:10.3</code> module:
							</p><pre class="literallayout"># yum module install mariadb:10.3/galera</pre><p class="simpara">
								As a result, the following packages are installed:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal package">mariadb-server-galera</code>
									</li><li class="listitem">
										<code class="literal package">mariadb-server</code>
									</li><li class="listitem"><p class="simpara">
										<code class="literal package">galera</code>
									</p><p class="simpara">
										The <code class="literal package">mariadb-server-galera</code> package pulls the <code class="literal package">mariadb-server</code> and <code class="literal package">galera</code> packages as its dependency.
									</p><p class="simpara">
										For more information on components to build <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span>, see <a class="xref" href="index.html#components-to-build-mariadb-galera-cluster_replicating-mariadb-with-galera" title="7.2.6.2. Components to build MariaDB Galera Cluster">Section 7.2.6.2, “Components to build MariaDB Galera Cluster”</a>.
									</p></li></ul></div></li><li class="listitem"><p class="simpara">
								The MariaDB server replication configuration must be updated before the system is added to a cluster for the first time.
							</p><p class="simpara">
								The default configuration is shipped in the <code class="literal filename">/etc/my.cnf.d/galera.cnf</code> file.
							</p><p class="simpara">
								Before deploying <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span>, set the <code class="literal option">wsrep_cluster_address</code> option in the <code class="literal filename">/etc/my.cnf.d/galera.cnf</code> file on all nodes to start with the following string:
							</p><pre class="literallayout">gcomm://</pre><p class="simpara">
								For the initial node, it is possible to set <code class="literal option">wsrep_cluster_address</code> as an empty list:
							</p><pre class="literallayout">wsrep_cluster_address="gcomm://"</pre><p class="simpara">
								For all other nodes, set <code class="literal option">wsrep_cluster_address</code> to include an address to any node which is already a part of the running cluster. For example:
							</p><pre class="literallayout">wsrep_cluster_address="gcomm://10.0.0.10"</pre><p class="simpara">
								For more information on how to set Galera Cluster address, see <a class="link" href="https://mariadb.com/kb/en/library/galera-cluster-address/">Galera Cluster Address</a>.
							</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Bootstrap a first node of a new cluster by running the following wrapper on that node:
							</p><pre class="literallayout">$ galera_new_cluster</pre><p class="simpara">
								This wrapper ensures that the MariaDB server daemon (<code class="literal">mysqld</code>) runs with the <code class="literal option">--wsrep-new-cluster</code> option. This option provides the information that there is no existing cluster to connect to. Therefore, the node creates a new UUID to identify the new cluster.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The <code class="literal">mariadb</code> service supports a systemd method for interacting with multiple <span class="strong strong"><strong>MariaDB</strong></span> server processes. Therefore, in cases with multiple running <span class="strong strong"><strong>MariaDB</strong></span> servers, you can bootstrap a specific instance by specifying the instance name as a suffix:
								</p><pre class="literallayout">$ galera_new_cluster <span class="emphasis"><em>mariadb@node1</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Connect other nodes to the cluster by running the following command on each of the nodes:
							</p><pre class="literallayout"># systemctl start mariadb</pre><p class="simpara">
								As a result, the node connects to the cluster, and synchronizes itself with the state of the cluster.
							</p></li></ol></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
							For more information, see <a class="link" href="https://mariadb.com/kb/en/library/getting-started-with-mariadb-galera-cluster/">Getting started with MariaDB Galera Cluster</a>.
						</p></div></section><section class="section" id="adding-a-new-node-to-mariadb-galera-cluster_replicating-mariadb-with-galera"><div class="titlepage"><div><div><h4 class="title">7.2.6.4. Adding a new node to MariaDB Galera Cluster</h4></div></div></div><p>
						To add a new node to <span class="strong strong"><strong>MariaDB Galera Cluster</strong></span>, use the following procedure.
					</p><p>
						Note that you can use this procedure also to reconnect an already existing node.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								On the particular node, provide an address to one or more existing cluster members in the <code class="literal option">wsrep_cluster_address</code> option within the <code class="literal">[mariadb]</code> section of the <code class="literal filename">/etc/my.cnf.d/galera.cnf</code> configuration file :
							</p><pre class="literallayout">[mariadb]
wsrep_cluster_address="<span class="emphasis"><em>gcomm://192.168.0.1</em></span>"</pre><p class="simpara">
								When a new node connects to one of the existing cluster nodes, it is able to see all nodes in the cluster.
							</p><p class="simpara">
								However, preferably list all nodes of the cluster in <code class="literal option">wsrep_cluster_address</code>.
							</p><p class="simpara">
								As a result, any node can join a cluster by connecting to any other cluster node, even if one or more cluster nodes are down. When all members agree on the membership, the cluster’s state is changed. If the new node’s state is different from that of the cluster, it requests either an Incremental State Transfer (IST) or a State Snapshot Transfer (SST) to make itself consistent with the other nodes.
							</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								For more information, see <a class="link" href="https://mariadb.com/kb/en/library/getting-started-with-mariadb-galera-cluster/">Getting started with MariaDB Galera Cluster</a>.
							</li><li class="listitem">
								For detailed information on State Snapshot Transfers (SSTs), see <a class="link" href="https://mariadb.com/kb/en/library/documentation/replication/galera-cluster/state-snapshot-transfers-ssts-in-galera-cluster/introduction-to-state-snapshot-transfers-ssts/">Introduction to State Snapshot Transfers</a>.
							</li></ul></div></section><section class="section" id="restarting-mariadb-galera-cluster_replicating-mariadb-with-galera"><div class="titlepage"><div><div><h4 class="title">7.2.6.5. Restarting MariaDB Galera Cluster</h4></div></div></div><p>
						If you shut down all nodes at the same time, you terminate the cluster, and the running cluster no longer exists. However, the cluster’s data still exist.
					</p><p>
						To restart the cluster, bootstrap a first node as described in <a class="xref" href="index.html#configuring-mariadb-galera-cluster_replicating-mariadb-with-galera" title="7.2.6.3. Deploying MariaDB Galera Cluster">Section 7.2.6.3, “Deploying MariaDB Galera Cluster”</a>.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							If the cluster is not bootstrapped, and <code class="literal">mysqld</code> on the first node is started just with the <code class="literal command">systemctl start mariadb</code> command, the node tries to connect to at least one of the nodes listed in the <code class="literal option">wsrep_cluster_address</code> option in the <code class="literal filename">/etc/my.cnf.d/galera.cnf</code> file. If no nodes are currently running, the restart fails.
						</p></div></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
							For more information, see <a class="link" href="https://mariadb.com/kb/en/library/getting-started-with-mariadb-galera-cluster/">Getting started with MariaDB Galera Cluster</a>.
						</p></div></section></section></section><section class="section" id="using-postgresql"><div class="titlepage"><div><div><h2 class="title">7.3. Using PostgreSQL</h2></div></div></div><section class="section" id="introduction-to-postgresql_using-postgresql"><div class="titlepage"><div><div><h3 class="title">7.3.1. Getting started with PostgreSQL</h3></div></div></div><p>
					The <span class="strong strong"><strong>PostgreSQL</strong></span> server is an open source robust and highly-extensible database server based on the SQL language. It provides an object-relational database system, which allows to manage extensive datasets and a high number of concurrent users. For these reasons, the PostgreSQL servers can be used in clusters to manage high amounts of data.
				</p><p>
					The <span class="strong strong"><strong>PostgreSQL</strong></span> server includes features for ensuring data integrity, building fault-tolerant environments or building applications. It allows to extend a database with user’s own data types, custom functions, or code from different programming languages without the need to recompile the database.
				</p><p>
					This section describes how to install <span class="strong strong"><strong>PostgreSQL</strong></span> in <a class="link" href="index.html#installing-postgresql_using-postgresql" title="7.3.2. Installing PostgreSQL">Installing PostgreSQL</a> or how to migrate to a different version of <span class="strong strong"><strong>PostgreSQL</strong></span> in <a class="link" href="index.html#migrating-to-postgresql_using-postgresql" title="7.3.5. Migrating to a RHEL 8 version of PostgreSQL">Migrating to a RHEL 8 version of PostgreSQL</a>. One of the prerequisites of migration is performing a data backup.
				</p></section><section class="section" id="installing-postgresql_using-postgresql"><div class="titlepage"><div><div><h3 class="title">7.3.2. Installing PostgreSQL</h3></div></div></div><p>
					In RHEL 8, the <span class="strong strong"><strong>PostgreSQL</strong></span> server is available in several versions, each provided by a separate stream:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>PostgreSQL 10</strong></span> - the default stream
						</li><li class="listitem">
							<span class="strong strong"><strong>PostgreSQL 9.6</strong></span>
						</li><li class="listitem">
							<span class="strong strong"><strong>PostgreSQL 12</strong></span> - available since RHEL 8.1.1
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						By design, it is impossible to install more than one version (stream) of the same module in parallel. Thus you need to choose only one of the available streams from the <code class="literal">postgresql</code> module. Parallel installation of components is possible in Red Hat Software Collections for RHEL 7 and RHEL 6. In RHEL 8, different versions of database servers can be used in containers.
					</p></div></div><p>
					To install <span class="strong strong"><strong>PostgreSQL</strong></span>:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enable the stream (version) you wish to install:
						</p><pre class="literallayout"># yum module enable postgresql:stream</pre><p class="simpara">
							Replace <span class="emphasis"><em>stream</em></span> with the selected version of the <span class="strong strong"><strong>PostgreSQL</strong></span> server.
						</p><p class="simpara">
							You can omit this step if you want to use the default stream, which provides <span class="strong strong"><strong>PostgreSQL 10</strong></span>.
						</p></li><li class="listitem"><p class="simpara">
							Ensure that the <code class="literal package">postgresql-server</code> package, available in the AppStream repository, is installed on the required server:
						</p><pre class="literallayout"># yum install postgresql-server</pre></li><li class="listitem"><p class="simpara">
							Initialize the data directory
						</p><pre class="literallayout">postgresql-setup --initdb</pre></li><li class="listitem"><p class="simpara">
							Start the <code class="literal">postgresql</code> service:
						</p><pre class="literallayout"># systemctl start postgresql.service</pre></li><li class="listitem"><p class="simpara">
							Enable the <code class="literal">postgresql</code> service to start at boot:
						</p><pre class="literallayout"># systemctl enable postgresql.service</pre></li></ol></div><p>
					For information about using module streams, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_managing_and_removing_user-space_components/">Installing, managing, and removing user-space components</a>.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						If you want to upgrade from an earlier <code class="literal">postgresql</code> stream within RHEL 8, follow both procedures described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_managing_and_removing_user-space_components/index#switching-to-a-later-stream_managing-versions-of-appstream-content">Switching to a later stream</a> and in <a class="xref" href="index.html#migrating-to-postgresql_using-postgresql" title="7.3.5. Migrating to a RHEL 8 version of PostgreSQL">Section 7.3.5, “Migrating to a RHEL 8 version of PostgreSQL”</a>.
					</p></div></div></section><section class="section" id="configuring-postgresql_using-postgresql"><div class="titlepage"><div><div><h3 class="title">7.3.3. Configuring PostgreSQL</h3></div></div></div><p>
					To change the <span class="strong strong"><strong>PostgreSQL</strong></span> configuration, use the <code class="literal filename">/var/lib/pgsql/data/postgresql.conf</code> file. Afterwards, restart the <code class="literal">postgresql</code> service so that the changes become effective:
				</p><pre class="literallayout">systemctl restart postgresql.service</pre><p>
					Apart from <code class="literal filename">/var/lib/pgsql/data/postgresql.conf</code>, other files to change <span class="strong strong"><strong>PostgreSQL</strong></span> configuration exist:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal filename">postgresql.auto.conf</code>
						</li><li class="listitem">
							<code class="literal filename">pg_ident.conf</code>
						</li><li class="listitem">
							<code class="literal filename">pg_hba.conf</code>
						</li></ul></div><p>
					The <code class="literal filename">postgresql.auto.conf</code> file holds basic <span class="strong strong"><strong>PostgreSQL</strong></span> settings similarly to <code class="literal filename">/var/lib/pgsql/data/postgresql.conf</code>. However, this file is under the server control. It is edited by the <code class="literal">ALTER SYSTEM</code> queries, and cannot be edited manually.
				</p><p>
					The <code class="literal filename">pg_ident.conf</code> file is used for mapping user identities from external authentication mechanisms into the postgresql user identities.
				</p><p>
					The <code class="literal filename">pg_hba.conf</code> file is used for configuring detailed user permissions for <span class="strong strong"><strong>PostgreSQL</strong></span> databases.
				</p><section class="section" id="initializing-database-cluster_using-postgresql"><div class="titlepage"><div><div><h4 class="title">7.3.3.1. Initializing a database cluster</h4></div></div></div><p>
						In a <span class="strong strong"><strong>PostgreSQL</strong></span> database, all data is stored a single directory, which is called a database cluster. You can choose where to store your data but Red Hat recommends to store the data in the default <code class="literal filename">/var/lib/pgsql/data</code> directory.
					</p><p>
						To initialize this data directory, run:
					</p><pre class="literallayout">postgresql-setup --initdb</pre></section></section><section class="section" id="backing-up-postgresql-data_using-postgresql"><div class="titlepage"><div><div><h3 class="title">7.3.4. Backing up PostgreSQL data</h3></div></div></div><p>
					To back up <span class="strong strong"><strong>PostgreSQL</strong></span> data, use one of the following approaches:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							SQL dump
						</li><li class="listitem">
							File system level backup
						</li><li class="listitem">
							Ccontinuous archiving
						</li></ul></div><section class="section" id="backuping-postgresql-sql-dump_backing-up-postgresql-data"><div class="titlepage"><div><div><h4 class="title">7.3.4.1. Backing up PostgreSQL data with an SQL dump</h4></div></div></div><section class="section" id="perforing-sql-dump_backing-up-postgresql-data"><div class="titlepage"><div><div><h5 class="title">7.3.4.1.1. Performing an SQL dump</h5></div></div></div><p>
							The SQL dump method is based on generating a file with SQL commands. When this file is uploaded back to the database server, it recreates the database in the same state as it was at the time of the dump. The SQL dump is ensured by the <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> utility, which is a <span class="strong strong"><strong>PostgreSQL</strong></span> client application. The basic usage of the <code class="literal command">pg_dump</code> command is such that the command writes its result into the standard output:
						</p><pre class="literallayout">pg_dump dbname &gt; dumpfile</pre><p>
							The resulting SQL file can be either in a text format or in other different formats, which allows for parallelism and for more detailed control of object restoration.
						</p><p>
							You can perform the SQL dump from any remote host that has access to the database. The <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> utility does not operate with special permissions, but it must have a read access to all tables that you want to back up. To back up the entire database, you must run it as a database superuser.
						</p><p>
							To specify which database server <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> will contact, use the following command-line options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									The <code class="literal option">-h</code> option to define the host.
								</p><p class="simpara">
									The default host is either the local host or what is specified by the <code class="literal">PGHOST</code> environment variable.
								</p></li><li class="listitem"><p class="simpara">
									The <code class="literal option">-p</code> option to define the port.
								</p><p class="simpara">
									The default port is indicated by the <code class="literal">PGPORT</code> environment variable or the compiled-in default.
								</p></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Note that <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> dumps only a single database. It does not dump information about roles or tablespaces because such information is cluster-wide.
							</p><p>
								To back up each database in a given cluster and to preserve cluster-wide data, such as role and tablespace definitions, use the <code class="literal command">pg_dumpall</code> command:
							</p><pre class="literallayout">pg_dumpall &gt; dumpfile</pre></div></div></section><section class="section" id="restoring-from-sql-dump"><div class="titlepage"><div><div><h5 class="title">7.3.4.1.2. Restoring database from an SQL dump</h5></div></div></div><p>
							To restore a database from an SQL dump:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Create a new database (dbname):
								</p><pre class="literallayout">createdb <code class="literal">dbname</code></pre></li><li class="listitem"><p class="simpara">
									Make sure that all users who own objects or were granted permissions on objects in the dumped database already exist.
								</p><p class="simpara">
									If such users do not exist, the restore fails to recreate the objects with the original ownership and permissions.
								</p></li><li class="listitem"><p class="simpara">
									Run the <span class="strong strong"><strong><span class="application application">psql</span></strong></span> utility to restore a text file dump created by the <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> utility:
								</p><pre class="literallayout">psql dbname &lt; dumpfile</pre></li></ol></div><p>
							where <code class="literal filename">dumpfile</code> is the output of the <code class="literal command">pg_dump</code> command.
						</p><p>
							If you want to restore a non-text file dump, use the <code class="literal command">pg_restore</code> utility:
						</p><pre class="literallayout">pg_restore non-plain-text-file</pre><section class="section" id="restoring_a_database_on_another_server"><div class="titlepage"><div><div><h6 class="title">7.3.4.1.2.1. Restoring a database on another server</h6></div></div></div><p>
								Dumping a database directly from one server to another is possible because <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> and <span class="strong strong"><strong><span class="application application">psql</span></strong></span> can write to and read from pipes.
							</p><p>
								To dump a database from one server to another, run:
							</p><pre class="literallayout">pg_dump -h host1 dbname | psql -h host2 dbname</pre></section><section class="section" id="handling_sql_errors_during_restore"><div class="titlepage"><div><div><h6 class="title">7.3.4.1.2.2. Handling SQL errors during restore</h6></div></div></div><p>
								By default, <span class="strong strong"><strong><span class="application application">psql</span></strong></span> continues to execute if an SQL error occurs. Consequently, the database is restored only partially.
							</p><p>
								If you want to change this default behavior, use one of the following approaches:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Make <span class="strong strong"><strong><span class="application application">psql</span></strong></span> exit with an exit status of 3 if an SQL error occurs by setting the <code class="literal">ON_ERROR_STOP</code> variable:
									</p><pre class="literallayout">psql --set ON_ERROR_STOP=on dbname &lt; dumpfile</pre></li><li class="listitem"><p class="simpara">
										Specify that the whole dump is restored as a single transaction so that the restore is either fully completed or canceled by using <code class="literal">psql</code> with one of the following options:
									</p><pre class="literallayout">psql -1</pre><p class="simpara">
										or
									</p><pre class="literallayout">psql --single-transaction</pre><p class="simpara">
										Note that when using this approach, even a minor error can cancel a restore operation that has already run for many hours.
									</p></li></ul></div></section></section><section class="section" id="advantages-sql-dump_backing-up-postgresql-data"><div class="titlepage"><div><div><h5 class="title">7.3.4.1.3. Advantages and disadvantages of an SQL dump</h5></div></div></div><p>
							An SQL dump has the following advantages compared to other <span class="strong strong"><strong>PostgreSQL</strong></span> backup methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									An SQL dump is the only <span class="strong strong"><strong>PostgreSQL</strong></span> backup method that is not server version-specific. The output of the <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> utility can be reloaded into later versions of <span class="strong strong"><strong>PostgreSQL</strong></span>, which is not possible for file system level backups or continuous archiving.
								</li><li class="listitem">
									An SQL dump is the only method that works when transferring a database to a different machine architecture, such as going from a 32-bit to a 64-bit server.
								</li><li class="listitem">
									An SQL dump provides internally consistent dumps. A dump represents a snapshot of the database at the time pg_dump began running.
								</li><li class="listitem">
									The <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> utility does not block other operations on the database when it is running.
								</li></ul></div><p>
							A disadvantage of an SQL dump is that it takes more time compared to file system level backup.
						</p></section><section class="section" id="additional_resources_6"><div class="titlepage"><div><div><h5 class="title">7.3.4.1.4. Additional resources</h5></div></div></div><p>
							For more information about the SQL dump, see <a class="link" href="https://www.postgresql.org/docs/current/backup-dump.html">PostgreSQL Documentation</a>.
						</p></section></section><section class="section" id="backuping-postgresql-system-level-backup_backing-up-postgresql-data"><div class="titlepage"><div><div><h4 class="title">7.3.4.2. Backing up PostgreSQL data with a file system level backup</h4></div></div></div><section class="section" id="performing_a_file_system_level_backup"><div class="titlepage"><div><div><h5 class="title">7.3.4.2.1. Performing a file system level backup</h5></div></div></div><p>
							To perform a file system level backup, you need to copy the files that <span class="strong strong"><strong>PostgreSQL</strong></span> uses to store the data in the database to another location:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									Choose the location of a database cluster and initialize this cluster as described in <a class="xref" href="index.html#initializing-database-cluster_using-postgresql" title="7.3.3.1. Initializing a database cluster">Section 7.3.3.1, “Initializing a database cluster”</a>.
								</li><li class="listitem"><p class="simpara">
									Stop the postgresql service:
								</p><pre class="literallayout"># systemctl stop postgresql.service</pre></li><li class="listitem"><p class="simpara">
									Use any method to make a file system backup, for example:
								</p><pre class="literallayout">tar -cf backup.tar /var/lib/pgsql/data</pre></li><li class="listitem"><p class="simpara">
									Start the postgresql service:
								</p><pre class="literallayout"># systemctl start postgresql.service</pre></li></ol></div></section><section class="section" id="advantages_and_disadvantages_of_a_file_system_level_backup"><div class="titlepage"><div><div><h5 class="title">7.3.4.2.2. Advantages and disadvantages of a file system level backup</h5></div></div></div><p>
							A file system level backup has the following advantage compared to other <span class="strong strong"><strong>PostgreSQL</strong></span> backup methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									File system level backup is usually faster than SQL dump.
								</li></ul></div><p>
							File system level backup has the following disadvantages compared to other <span class="strong strong"><strong>PostgreSQL</strong></span> backup methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The backup is architecture-specific and Red Hat Enterprise Linux 7-specific. It can only be used as a backup to return to Red Hat Enterprise Linux 7 if the upgrade was not successful, but it cannot be used with <span class="strong strong"><strong>PostgreSQL 10.0</strong></span>.
								</li><li class="listitem">
									The database server must be shut down before data backup and before data restore as well.
								</li><li class="listitem">
									Backup and restore of certain individual files or tables is impossible. The file system backups only work for a complete backup and restoration of an entire database cluster.
								</li></ul></div></section><section class="section" id="alternative_approaches_to_file_system_level_backup"><div class="titlepage"><div><div><h5 class="title">7.3.4.2.3. Alternative approaches to file system level backup</h5></div></div></div><p>
							Alternative approaches to file system backup include:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A consistent snapshot of the data directory
								</li><li class="listitem">
									The rsync utility
								</li></ul></div></section><section class="section" id="additional_resources_7"><div class="titlepage"><div><div><h5 class="title">7.3.4.2.4. Additional resources</h5></div></div></div><p>
							For more information about the file system level backup, see <a class="link" href="https://www.postgresql.org/docs/current/backup-file.html">PostgreSQL Documentation</a>.
						</p></section></section><section class="section" id="backuping-postgresql-continuous-archiving_backing-up-postgresql-data"><div class="titlepage"><div><div><h4 class="title">7.3.4.3. Backing up PostgreSQL data by continuous archiving</h4></div></div></div><section class="section" id="intro-continuous-archiving"><div class="titlepage"><div><div><h5 class="title">7.3.4.3.1. Introduction to continuous archiving</h5></div></div></div><p>
							<span class="strong strong"><strong>PostgreSQL</strong></span> records every change made to the database’s data files into a write ahead log (WAL) file that is available in the <code class="literal filename">pg_wal/</code> subdirectory of the cluster’s data directory. This log is intended primarily for a crash recovery. After a crash, the log entries made since the last checkpoint can be used for restoring the database to a consistency.
						</p><p>
							The continuous archiving method, also known as <code class="literal">online backup</code>, combines the WAL files with a file system level backup. If a database recovery is needed, you can restore the database from the file system backup and then replay log from the backed up WAL files to bring the system to the current state.
						</p><p>
							For this backup method, you need a continuous sequence of archived WAL files that extends back to the start time of your backup at least.
						</p><p>
							If you want to start using the continuous archiving backup method, make sure to set up and test your procedure for archiving WAL files before taking your first base backup.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You cannot use <span class="strong strong"><strong><span class="application application">pg_dump</span></strong></span> and <span class="strong strong"><strong><span class="application application">pg_dumpall</span></strong></span> dumps as a part of a continuous archiving backup solution. These dumps produce logical backups, not file system level backups. As such, they do not contain enough information to be used by a WAL replay.
							</p></div></div></section><section class="section" id="performing-continuous-archiving-backup"><div class="titlepage"><div><div><h5 class="title">7.3.4.3.2. Performing continuous archiving backup</h5></div></div></div><p>
							To perform a database backup and restore using the continuous archiving method, follow these steps:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
									<a class="xref" href="index.html#making-base-backup" title="7.3.4.3.2.1. Making a base backup">Section 7.3.4.3.2.1, “Making a base backup”</a>
								</li><li class="listitem">
									<a class="xref" href="index.html#restoring-database-with-continuous-archiving" title="7.3.4.3.2.2. Restoring the database using a continuous archive backup">Section 7.3.4.3.2.2, “Restoring the database using a continuous archive backup”</a>
								</li></ol></div><section class="section" id="making-base-backup"><div class="titlepage"><div><div><h6 class="title">7.3.4.3.2.1. Making a base backup</h6></div></div></div><p>
								To perform a base backup, use the <span class="strong strong"><strong><span class="application application">pg_basebackup</span></strong></span> tool, which can create a base backup in the form of either individual files or a <code class="literal">tar</code> archive.
							</p><p>
								To use the base backup, you need to keep all the WAL segment files generated during and after the file system backup. The base backup process creates a backup history file that is stored into the WAL archive area and is named after the first WAL segment file that you need for the file system backup. When you have safely archived the file system backup and the WAL segment files used during the backup, which are specified in the backup history file, you can delete all archived WAL segments with names numerically less because they are no longer needed to recover the file system backup. However, consider keeping several backup sets to be certain that you can recover your data.
							</p><p>
								The backup history file is a small text file, which contains the label string that you gave to <span class="strong strong"><strong><span class="application application">pg_basebackup</span></strong></span>, the starting and ending times, and WAL segments of the backup. If you used the label string to identify the associated dump file, then the archived history file is enough to tell you which dump file to restore.
							</p><p>
								With the continuous archiving method, you need to keep all the archived WAL files back to your last base backup. Thus the ideal frequency of base backups depends on:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The storage volume available for archived WAL files.
									</li><li class="listitem"><p class="simpara">
										The maximum possible duration of data recovery in situations when recovery is necessary.
									</p><p class="simpara">
										In cases with long period since the last backup, the system replays more WAL segments, and the recovery thus takes more time.
									</p></li></ul></div><p>
								For more information about making a base backup, see <a class="link" href="https://www.postgresql.org/docs/current/continuous-archiving.html#BACKUP-BASE-BACKUP">PostgreSQL Documentation</a>.
							</p></section><section class="section" id="restoring-database-with-continuous-archiving"><div class="titlepage"><div><div><h6 class="title">7.3.4.3.2.2. Restoring the database using a continuous archive backup</h6></div></div></div><p>
								To restore a database using a continuous backup:
							</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Stop the server:
									</p><pre class="literallayout"># systemctl stop postgresql.service</pre></li><li class="listitem"><p class="simpara">
										Copy the necessary data to a temporary location.
									</p><p class="simpara">
										Preferably, copy the whole cluster data directory and any tablespaces. Note that this requires enough free space on your system to hold two copies of your existing database.
									</p><p class="simpara">
										If you do not have enough space, save the contents of the cluster’s <code class="literal filename">pg_wal</code> directory, which can contain logs that were not archived before the system went down.
									</p></li><li class="listitem">
										Remove all existing files and subdirectories under the cluster data directory and under the root directories of any tablespaces you are using.
									</li><li class="listitem"><p class="simpara">
										Restore the database files from your file system backup.
									</p><p class="simpara">
										Make sure that:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												The files are restored with the correct ownership (the database system user, not <code class="literal">root</code>)
											</li><li class="listitem">
												The files are restored with the correct permissions
											</li><li class="listitem">
												The symbolic links in the <code class="literal filename">pg_tblspc/</code> subdirectory were restored correctly
											</li></ul></div></li><li class="listitem"><p class="simpara">
										Remove any files present in the <code class="literal filename">pg_wal/</code> subdirectory
									</p><p class="simpara">
										These files resulted from the file system backup and are therefore obsolete. If you did not archive <code class="literal filename">pg_wal/</code>, recreate it with proper permissions.
									</p></li><li class="listitem">
										Copy the unarchived WAL segment files that you saved in step 2 into <code class="literal filename">pg_wal/</code> if there are such files.
									</li><li class="listitem">
										Create the <code class="literal filename">recovery.conf</code> recovery command file in the cluster data directory.
									</li><li class="listitem"><p class="simpara">
										Start the server:
									</p><pre class="literallayout"># systemctl start postgresql.service</pre><p class="simpara">
										The server will enter the recovery mode and proceed to read through the archived WAL files that it needs.
									</p><p class="simpara">
										If the recovery is terminated due to an external error, the server can simply be restarted and it will continue the recovery. When the recovery process is completed, the server renames <code class="literal filename">recovery.conf</code> to <code class="literal filename">recovery.done</code> to prevent accidental re-entering the recovery mode later, when the server starts normal database operations.
									</p></li><li class="listitem"><p class="simpara">
										Check the contents of the database to make sure that the database has recovered into the required state.
									</p><p class="simpara">
										If the database has not recovered into the required state, return to step 1. If the database has recovered into the required state, allow the users to connect by restoring the <code class="literal filename">pg_hba.conf</code> file to normal.
									</p></li></ol></div><p>
								For more information about restoring using the continuous backup, see <a class="link" href="https://www.postgresql.org/docs/current/continuous-archiving.html#BACKUP-PITR-RECOVERY">PostgreSQL Documentation</a>.
							</p></section></section><section class="section" id="advantages-continuous-archiving"><div class="titlepage"><div><div><h5 class="title">7.3.4.3.3. Advantages and disadvantages of continuous archiving</h5></div></div></div><p>
							Continuous archiving has the following advantages compared to other <span class="strong strong"><strong>PostgreSQL</strong></span> backup methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									With the continuous backup method, it is possible to use a file system backup that is not entirely consistent because any internal inconsistency in the backup is corrected by the log replay. A file system snapshot is not needed; <code class="literal">tar</code> or a similar archiving tool is sufficient.
								</li><li class="listitem">
									Continuous backup can be achieved by continuing to archive the WAL files because the sequence of WAL files for the log replay can be indefinitely long. This is particularly valuable for large databases.
								</li><li class="listitem">
									Continuous backup supports point-in-time recovery. It is not necessary to replay the WAL entries to the end. The replay can be stopped at any point and the database can be restored to its state at any time since the base backup was taken.
								</li><li class="listitem">
									If the series of WAL files are continuously available to another machine that has been loaded with the same base backup file, it is possible to restore the other machine with a nearly-current copy of the database at any point.
								</li></ul></div><p>
							Continuous archiving has the following disadvantages compared to other <span class="strong strong"><strong>PostgreSQL</strong></span> backup methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Continuous backup method supports only restoration of an entire database cluster, not a subset.
								</li><li class="listitem">
									Continuous backup requires extensive archival storage.
								</li></ul></div></section><section class="section" id="additional_resources_8"><div class="titlepage"><div><div><h5 class="title">7.3.4.3.4. Additional resources</h5></div></div></div><p>
							For more information on continuous archiving method, see <a class="link" href="https://www.postgresql.org/docs/current/continuous-archiving.html">PostgreSQL Documentation</a>.
						</p></section></section></section><section class="section" id="migrating-to-postgresql_using-postgresql"><div class="titlepage"><div><div><h3 class="title">7.3.5. Migrating to a RHEL 8 version of PostgreSQL</h3></div></div></div><p>
					Red Hat Enterprise Linux 7 contains <span class="strong strong"><strong>PostgreSQL 9.2</strong></span> as the default version of the <span class="strong strong"><strong>PostgreSQL</strong></span> server. In addition, several versions of <span class="strong strong"><strong>PostgreSQL</strong></span> are provided as Software Collections for RHEL 7 and RHEL 6.
				</p><p>
					Red Hat Enterprise Linux 8 provides <span class="strong strong"><strong>PostgreSQL 10</strong></span> (the default <code class="literal">postgresql</code> stream), <span class="strong strong"><strong>PostgreSQL 9.6</strong></span>, and <span class="strong strong"><strong>PostgreSQL 12</strong></span>.
				</p><p>
					Users of <span class="strong strong"><strong>PostgreSQL</strong></span> on Red Hat Enterprise Linux can use two migration paths for the database files:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="index.html#postgresql-in-place-upgrade" title="7.3.5.1. Fast upgrade using the pg_upgrade tool">Fast upgrade using the pg_upgrade tool</a>
						</li><li class="listitem">
							<a class="link" href="index.html#postgresql-dump-and-restore-upgrade" title="7.3.5.2. Dump and restore upgrade">Dump and restore upgrade</a>
						</li></ul></div><p>
					Use preferably the fast upgrade method, which is faster than the dump and restore process.
				</p><p>
					However, in certain cases, the fast upgrade does not work, and you can only use the dump and restore process. Such cases include:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Cross-architecture upgrades
						</li><li class="listitem">
							Systems using the <code class="literal">plpython</code> or <code class="literal">plpython2</code> extensions. Note that RHEL 8 AppStream repository includes only the <code class="literal package">postgresql-plpython3</code> package, not the <code class="literal package">postgresql-plpython2</code> package.
						</li><li class="listitem">
							Fast upgrade is not supported for migration from Red Hat Software Collections versions of <span class="strong strong"><strong>PostgreSQL</strong></span>.
						</li></ul></div><p>
					As a prerequisite for migration to a later version of <span class="strong strong"><strong>PostgreSQL</strong></span>, back up all your <span class="strong strong"><strong>PostgreSQL</strong></span> databases.
				</p><p>
					Dumping the databases and performing backup of the SQL files is a necessary part of the dump and restore process. However, you are recommended to do so if performing the fast upgrade as well.
				</p><p>
					Before migrating to a later version of <span class="strong strong"><strong>PostgreSQL</strong></span>, see the <a class="link" href="https://www.postgresql.org/docs/current/release.html">upstream compatibility notes</a> for the version of <span class="strong strong"><strong>PostgreSQL</strong></span> to which you want to migrate, as well as for all skipped <span class="strong strong"><strong>PostgreSQL</strong></span> versions between the one you are migrating from and the target version.
				</p><section class="section" id="postgresql-in-place-upgrade"><div class="titlepage"><div><div><h4 class="title">7.3.5.1. Fast upgrade using the pg_upgrade tool</h4></div></div></div><p>
						During a fast upgrade, you need to copy binary data files to the <code class="literal filename">/var/lib/pgsql/data/</code> directory and use the <code class="literal">pg_upgrade</code> tool.
					</p><p>
						You can use this method for migrating data from an earlier RHEL 8 version of <span class="strong strong"><strong>PostgreSQL</strong></span> to a later one, or from the RHEL 7 system version of <span class="strong strong"><strong>PostgreSQL 9.2</strong></span> to any RHEL 8 version. By default, all data is stored in the <code class="literal filename">/var/lib/pgsql/data/</code> directory on both the RHEL 7 and RHEL 8 systems.
					</p><p>
						If you want to upgrade from an earlier <code class="literal">postgresql</code> stream within RHEL 8, follow the procedure described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_managing_and_removing_user-space_components/index#switching-to-a-later-stream_managing-versions-of-appstream-content">Switching to a later stream</a> and then migrate your <span class="strong strong"><strong>PostgreSQL</strong></span> data.
					</p><p>
						For migration from Red Hat Software Collections versions of <span class="strong strong"><strong>PostgreSQL</strong></span>, use <a class="link" href="index.html#postgresql-dump-and-restore-upgrade" title="7.3.5.2. Dump and restore upgrade">Dump and restore upgrade</a>.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Before performing the upgrade, back up all your data stored in the <span class="strong strong"><strong>PostgreSQL</strong></span> databases.
						</p></div></div><p>
						The following procedure describes migration from the RHEL 7 system version of <span class="strong strong"><strong>Postgreql 9.2</strong></span> to a RHEL 8 version of <span class="strong strong"><strong>PostgreSQL</strong></span>.
					</p><p>
						To perform a fast upgrade:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								On the RHEL 8 system, enable the stream (version) to which you wish to migrate:
							</p><pre class="literallayout"># yum module enable postgresql:stream</pre><p class="simpara">
								Replace <span class="emphasis"><em>stream</em></span> with the selected version of the <span class="strong strong"><strong>PostgreSQL</strong></span> server.
							</p><p class="simpara">
								You can omit this step if you want to use the default stream, which provides <span class="strong strong"><strong>PostgreSQL 10</strong></span>.
							</p></li><li class="listitem"><p class="simpara">
								On the RHEL 8 system, install the <code class="literal package">postgresql-server</code> and <code class="literal package">postgresql-upgrade</code> packages:
							</p><pre class="literallayout"># yum install postgresql-server postgresql-upgrade</pre><p class="simpara">
								Optionally, if you used any <span class="strong strong"><strong>PostgreSQL</strong></span> server modules on RHEL 7, install them also on the RHEL 8 system in two versions, compiled both against <span class="strong strong"><strong>PostgreSQL 9.2</strong></span> (installed as the <code class="literal package">postgresql-upgrade</code> package) and the target version of <span class="strong strong"><strong>PostgreSQL</strong></span> (installed as the <code class="literal package">postgresql-server</code> package). If you need to compile a third-party <span class="strong strong"><strong>PostgreSQL</strong></span> server module, build it both against the <code class="literal package">postgresql-devel</code> and <code class="literal package">postgresql-upgrade-devel</code> packages.
							</p></li><li class="listitem"><p class="simpara">
								Check the following items:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Basic configuration: On the RHEL 8 system, check whether your server uses the default <code class="literal filename">/var/lib/pgsql/data</code> directory and the database is correctly initialized and enabled. In addition, the data files must be stored in the same path as mentioned in the <code class="literal filename">/usr/lib/systemd/system/postgresql.service</code> file.
									</li><li class="listitem">
										<span class="strong strong"><strong>PostgreSQL</strong></span> servers: Your system can run multiple <span class="strong strong"><strong>PostgreSQL</strong></span> servers. Make sure that the data directories for all these servers are handled independently.
									</li><li class="listitem">
										<span class="strong strong"><strong>PostgreSQL</strong></span> server modules: Ensure that the <span class="strong strong"><strong>PostgreSQL</strong></span> server modules that you used on RHEL 7 are installed on your RHEL 8 system as well. Note that plug-ins are installed in the <code class="literal filename">/usr/lib64/pgsql/</code> directory (or in the <code class="literal filename">/usr/lib/pgsql/</code> directory on 32-bit systems).
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Ensure that the <code class="literal">postgresql</code> service is not running on either of the source and target systems at the time of copying data.
							</p><pre class="literallayout"># systemctl stop postgresql.service</pre></li><li class="listitem">
								Copy the database files from the source location to the <code class="literal filename">/var/lib/pgsql/data/</code> directory on the RHEL 8 system.
							</li><li class="listitem"><p class="simpara">
								Perform the upgrade process by running the following command as the <span class="strong strong"><strong>PostgreSQL</strong></span> user:
							</p><pre class="literallayout">$ /bin/postgresql-setup --upgrade</pre><p class="simpara">
								This launches the <code class="literal">pg_upgrade</code> process in the background.
							</p><p class="simpara">
								In case of failure, <code class="literal command">postgresql-setup</code> provides an informative error message.
							</p></li><li class="listitem"><p class="simpara">
								Copy the prior configuration from <code class="literal filename">/var/lib/pgsql/data-old</code> to the new cluster.
							</p><p class="simpara">
								Note that the fast upgrade does not reuse the prior configuration in the newer data stack and the configuration is generated from scratch. If you want to combine the old and new configurations manually, use the *.conf files in the data directories.
							</p></li><li class="listitem"><p class="simpara">
								Start the new <span class="strong strong"><strong>PostgreSQL</strong></span> server:
							</p><pre class="literallayout"># systemctl start postgresql.service</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">analyze_new_cluster.sh</code> script located in the <span class="strong strong"><strong>PostgreSQL</strong></span> home directory:
							</p><pre class="literallayout">su postgres -c '~/analyze_new_cluster.sh'</pre></li><li class="listitem"><p class="simpara">
								If you want the new <span class="strong strong"><strong>PostgreSQL</strong></span> server to be automatically started on boot, run:
							</p><pre class="literallayout"># systemctl enable postgresql.service</pre></li></ol></div></section><section class="section" id="postgresql-dump-and-restore-upgrade"><div class="titlepage"><div><div><h4 class="title">7.3.5.2. Dump and restore upgrade</h4></div></div></div><p>
						When using the dump and restore upgrade, you need to dump all databases contents into an SQL file dump file.
					</p><p>
						Note that the dump and restore upgrade is slower than the fast upgrade method and it may require some manual fixing in the generated SQL file.
					</p><p>
						You can use this method for migrating data from:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Red Hat Enterprise Linux 7 system version of <span class="strong strong"><strong>PostgreSQL 9.2</strong></span>
							</li><li class="listitem">
								Any earlier Red Hat Enterprise Linux 8 version of <span class="strong strong"><strong>PostgreSQL</strong></span>
							</li><li class="listitem"><p class="simpara">
								An earlier or equal version of <span class="strong strong"><strong>PostgreSQL</strong></span> from Red Hat Software Collections:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<span class="strong strong"><strong>PostgreSQL 9.2</strong></span> (no longer supported)
									</li><li class="listitem">
										<span class="strong strong"><strong>PostgreSQL 9.4</strong></span> (no longer supported)
									</li><li class="listitem">
										<span class="strong strong"><strong>PostgreSQL 9.6</strong></span>
									</li><li class="listitem">
										<span class="strong strong"><strong>PostgreSQL 10</strong></span>
									</li><li class="listitem">
										<span class="strong strong"><strong>PostgreSQL 12</strong></span>
									</li></ul></div></li></ul></div><p>
						On Red Hat Enterprise Linux 7 and Red Hat Enterprise Linux 8 systems, <span class="strong strong"><strong>PostgreSQL</strong></span> data is stored in the <code class="literal filename">/var/lib/pgsql/data/</code> directory by default. In case of Red Hat Software Collections versions of <span class="strong strong"><strong>PostgreSQL</strong></span>, the default data directory is <code class="literal filename">/var/opt/rh/collection_name/lib/pgsql/data/</code> (with the exception of <code class="literal">postgresql92</code>, which uses the <code class="literal filename">/opt/rh/postgresql92/root/var/lib/pgsql/data/</code> directory).
					</p><p>
						If you want to upgrade from an earlier <code class="literal">postgresql</code> stream within RHEL 8, follow the procedure described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_managing_and_removing_user-space_components/index#switching-to-a-later-stream_managing-versions-of-appstream-content">Switching to a later stream</a> and then migrate your <span class="strong strong"><strong>PostgreSQL</strong></span> data.
					</p><p>
						To perform the dump and restore upgrade, change the user to <code class="literal">root</code>.
					</p><p>
						The following procedure describes migration from the RHEL 7 system version of <span class="strong strong"><strong>Postgreql 9.2</strong></span> to a RHEL 8 version of <span class="strong strong"><strong>PostgreSQL</strong></span>.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								On your RHEL 7 system, start the <span class="strong strong"><strong>PostgreSQL 9.2</strong></span> server:
							</p><pre class="literallayout"># systemctl start postgresql.service</pre></li><li class="listitem"><p class="simpara">
								On the RHEL 7 system, dump all databases contents into the <code class="literal filename">pgdump_file.sql</code> file:
							</p><pre class="literallayout">su - postgres -c "pg_dumpall &gt; ~/pgdump_file.sql"</pre></li><li class="listitem"><p class="simpara">
								Make sure that the databases were dumped correctly:
							</p><pre class="literallayout">su - postgres -c 'less "$HOME/pgdump_file.sql"'</pre><p class="simpara">
								As a result, the path to the dumped sql file is displayed: <code class="literal filename">/var/lib/pgsql/pgdump_file.sql</code>.
							</p></li><li class="listitem"><p class="simpara">
								On the RHEL 8 system, enable the stream (version) to which you wish to migrate:
							</p><pre class="literallayout"># yum module enable postgresql:stream</pre><p class="simpara">
								Replace <span class="emphasis"><em>stream</em></span> with the selected version of the <span class="strong strong"><strong>PostgreSQL</strong></span> server.
							</p><p class="simpara">
								You can omit this step if you want to use the default stream, which provides <span class="strong strong"><strong>PostgreSQL 10</strong></span>.
							</p></li><li class="listitem"><p class="simpara">
								On the RHEL 8 system, install the <code class="literal package">postgresql-server</code> package:
							</p><pre class="literallayout"># yum install postgresql-server</pre><p class="simpara">
								Optionally, if you used any <span class="strong strong"><strong>PostgreSQL</strong></span> server modules on RHEL 7, install them also on the RHEL 8 system. If you need to compile a third-party <span class="strong strong"><strong>PostgreSQL</strong></span> server module, build it against the <code class="literal package">postgresql-devel</code> package.
							</p></li><li class="listitem"><p class="simpara">
								On the RHEL 8 system, initialize the data directory for the new <span class="strong strong"><strong>PostgreSQL</strong></span> server:
							</p><pre class="literallayout"># postgresql-setup --initdb</pre></li><li class="listitem"><p class="simpara">
								On the RHEL 8 system, copy the <code class="literal filename">pgdump_file.sql</code> into the <span class="strong strong"><strong>PostgreSQL</strong></span> home directory, and check that the file was copied correctly:
							</p><pre class="literallayout">su - postgres -c 'test -e "$HOME/pgdump_file.sql" &amp;&amp; echo exists'</pre></li><li class="listitem"><p class="simpara">
								Copy the configuration files from the RHEL 7 system:
							</p><pre class="literallayout">su - postgres -c 'ls -1 $PGDATA/*.conf'</pre><p class="simpara">
								The configuration files to be copied are:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal filename">/var/lib/pgsql/data/pg_hba.conf</code>
									</li><li class="listitem">
										<code class="literal filename">/var/lib/pgsql/data/pg_ident.conf</code>
									</li><li class="listitem">
										<code class="literal filename">/var/lib/pgsql/data/postgresql.conf</code>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								On the RHEL 8 system, start the new <span class="strong strong"><strong>PostgreSQL</strong></span> server:
							</p><pre class="literallayout"># systemctl start postgresql.service</pre></li><li class="listitem"><p class="simpara">
								On the RHEL 8 system, import data from the dumped sql file:
							</p><pre class="literallayout">su - postgres -c 'psql -f ~/pgdump_file.sql postgres'</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When upgrading from a Red Hat Software Collections version of <span class="strong strong"><strong>PostgreSQL</strong></span>, adjust the commands to include <code class="literal">scl enable collection_name.</code> For example, to dump data from the <code class="literal">rh-postgresql96</code> Software Collection, use the following command:
						</p><pre class="literallayout">su - postgres -c 'scl enable rh-postgresql96 "pg_dumpall &gt; ~/pgdump_file.sql"'</pre></div></div></section></section></section></section><section class="chapter" id="configuring-printing_Deploying-different-types-of-servers"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Configuring printing</h1></div></div></div><p>
			Printing on Red Hat Enterprise Linux 8 is based on the Common Unix Printing System (CUPS).
		</p><p>
			This documentation describes how to configure a machine to be able to operate as a CUPS server.
		</p><section class="section" id="activating-cups-service_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.1. Activating the cups service</h2></div></div></div><p>
				This section describes how activate the <code class="literal">cups</code> service on your system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal package">cups</code> package, which is available in the Appstream repository, must be installed on your system:
					</p><pre class="literallayout"># yum install cups</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Start the <code class="literal">cups</code> service:
					</p><pre class="literallayout"># systemctl start cups</pre></li><li class="listitem"><p class="simpara">
						Configure the <code class="literal">cups</code> service to be automatically started at boot time:
					</p><pre class="literallayout"># systemctl enable cups</pre></li><li class="listitem"><p class="simpara">
						Optionally, check the status of the <code class="literal">cups</code> service:
					</p><pre class="literallayout">$ systemctl status cups</pre></li></ol></div></section><section class="section" id="print-settings-tools_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.2. Print settings tools</h2></div></div></div><p>
				To achieve various tasks related to printing, you can choose one of the following tools:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong><span class="application application">CUPS web user interface (UI)</span></strong></span>
					</li><li class="listitem">
						<span class="strong strong"><strong><span class="application application">GNOME Control center</span></strong></span>
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <span class="strong strong"><strong><span class="application application">Print Settings</span></strong></span> configuration tool, which was used in Red Hat Enterprise Linux 7, is no longer available.
				</p></div></div><p>
				Tasks that you can achieve by using these tools include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Adding and configuring a new printer
					</li><li class="listitem">
						Maintaining printer configuration
					</li><li class="listitem">
						Managing printer classes
					</li></ul></div><p>
				Note that this documentation covers only printing in <span class="strong strong"><strong><span class="application application">CUPS web user interface (UI)</span></strong></span>. If you want to print using <span class="strong strong"><strong><span class="application application">GNOME Control center</span></strong></span>, you need to have a GUI available. For more information about printing using <span class="strong strong"><strong><span class="application application">GNOME Control center</span></strong></span>, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8-beta/html/managing_rhel_systems_from_your_desktop/">Managing RHEL systems from your desktop</a>.
			</p></section><section class="section" id="starting-cups-web-ui_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.3. Accessing and configuring the CUPS web UI</h2></div></div></div><p>
				This section describes how to access the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span> and how to configure it to be able to manage printing through this interface.
			</p><p>
				To access the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Allow the CUPS server to listen for connections from network by setting <code class="literal">Port 631</code> in the <code class="literal filename">/etc/cups/cupsd.conf</code> file:
					</p><pre class="literallayout">#Listen localhost:631
Port 631</pre></li><li class="listitem"><p class="simpara">
						Allow your machine to access the CUPS server by including the following in the <code class="literal filename">/etc/cups/cupsd.conf</code> file:
					</p><pre class="literallayout">&lt;Location /&gt;
Allow from &lt;your_ip_address&gt;
Order allow,deny
&lt;/Location&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Replace <code class="literal">&lt;your_ip_address&gt;</code> with the real IP address of your system.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Restart the cups.service:
					</p><pre class="literallayout"># systemctl restart cups</pre></li><li class="listitem">
						Open you browser, and go to <a class="link" href="http://&lt;IP_address_of_the_CUPS_server&gt;:631/">http://&lt;IP_address_of_the_CUPS_server&gt;:631/</a>.
					</li></ol></div><div class="informalfigure"><div class="mediaobject"><img src="cups_ui_intro.png" alt="cups ui intro"/></div></div><p>
				All menus except for the <code class="literal">Administration</code> menu are now available.
			</p><p>
				If you click on the <code class="literal">Administration</code> menu, you receive the <span class="strong strong"><strong>Forbidden</strong></span> message:
			</p><div class="informalfigure"><div class="mediaobject"><img src="forbidden-message.png" alt="forbidden message"/></div></div><p>
				To acquire the access to the <code class="literal">Administration</code> menu, follow the instructions in <a class="xref" href="index.html#acquiring-administration-access-to-cups-web-ui_configuring-printing" title="8.3.1. Acquiring administration access to the CUPS web UI">Section 8.3.1, “Acquiring administration access to the CUPS web UI”</a>.
			</p><section class="section" id="acquiring-administration-access-to-cups-web-ui_configuring-printing"><div class="titlepage"><div><div><h3 class="title">8.3.1. Acquiring administration access to the CUPS web UI</h3></div></div></div><p>
					This section describes how to acquire administration access to the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To be able to access the <code class="literal">Administation</code> menu in the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>, include the following in the <code class="literal filename">/etc/cups/cupsd.conf</code> file:
						</p><pre class="literallayout">&lt;Location /admin&gt;
Allow from &lt;your_ip_address&gt;
Order allow,deny
&lt;/Location&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Replace <code class="literal">&lt;your_ip_address&gt;</code> with the real IP address of your system.
							</p></div></div></li><li class="listitem"><p class="simpara">
							To be able to access configuration files in the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>, include the following in the <code class="literal filename">/etc/cups/cupsd.conf</code> file:
						</p><pre class="literallayout">&lt;Location /admin/conf&gt;
AuthType Default
Require user @SYSTEM
Allow from &lt;your_ip_address&gt;
Order allow,deny
&lt;/Location&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Replace <code class="literal">&lt;your_ip_address&gt;</code> with the real IP address of your system.
							</p></div></div></li><li class="listitem"><p class="simpara">
							To be able to access log files in the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>, include the following in the <code class="literal filename">/etc/cups/cupsd.conf</code> file:
						</p><pre class="literallayout">&lt;Location /admin/log&gt;
AuthType Default
Require user @SYSTEM
Allow from &lt;your_ip_address&gt;
Order allow,deny
&lt;/Location&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Replace <code class="literal">&lt;your_ip_address&gt;</code> with the real IP address of your system.
							</p></div></div></li><li class="listitem"><p class="simpara">
							To specify the use of encryption for authenticated requests in the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>, include <code class="literal">DefaultEncryption</code> in the <code class="literal filename">/etc/cups/cupsd.conf</code> file:
						</p><pre class="literallayout">DefaultEncryption IfRequested</pre><p class="simpara">
							With this setting, you will receive an authentication window to enter the username of a user allowed to add printers when you attempt to access the <code class="literal">Administration</code> menu. However, there are also other options how to set <code class="literal">DefaultEncryption</code>. For more details, see the <code class="literal">cupsd.conf</code> man page.
						</p></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal">cups</code> service:
						</p><pre class="literallayout"># systemctl restart cups</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								If you do not restart the <code class="literal">cups</code> service, the changes in <code class="literal filename">/etc/cups/cupsd.conf</code> will not be applied. Consequently, you will not be able to obtain administration access to the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>.
							</p></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For more information on how to configure a CUPS server using the <code class="literal filename">/etc/cups/cupsd.conf</code> file, see the <code class="literal">cupsd.conf</code> man page.
						</li></ul></div></section></section><section class="section" id="adding-a-printer-cups-web-ui_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.4. Adding a printer in the CUPS web UI</h2></div></div></div><p>
				This section describes how to add a new printer using the <span class="strong strong"><strong><span class="application application">CUPS web user interface</span></strong></span>.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					You have acquired administration access to the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span> as described in <a class="xref" href="index.html#acquiring-administration-access-to-cups-web-ui_configuring-printing" title="8.3.1. Acquiring administration access to the CUPS web UI">Section 8.3.1, “Acquiring administration access to the CUPS web UI”</a>.
				</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Start the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span> as described in <a class="xref" href="index.html#starting-cups-web-ui_configuring-printing" title="8.3. Accessing and configuring the CUPS web UI">Section 8.3, “Accessing and configuring the CUPS web UI”</a>
					</li><li class="listitem"><p class="simpara">
						Go to <code class="literal">Adding Printers and Classes</code> - <code class="literal">Add printer</code>
					</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-1.png" alt="add printer in cups ui 1"/></div></div><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-2.png" alt="add printer in cups ui 2"/></div></div></li><li class="listitem"><p class="simpara">
						Authenticate by username and password:
					</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-auth-n.png" alt="add printer in cups ui auth n"/></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							To be able to add a new printer by using the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>, you must authenticate as one of the following users:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Superuser
								</li><li class="listitem">
									Any user with the administration access provided by the <code class="literal command">sudo</code> command (users listed within <code class="literal filename">/etc/sudoers</code>)
								</li><li class="listitem">
									Any user belonging to the <code class="literal">printadmin</code> group in <code class="literal filename">/etc/group</code>
								</li></ul></div></div></div></li><li class="listitem"><p class="simpara">
						If a local printer is connected, or CUPS finds a network printer available, select the printer. If neither local printer nor network printer is available, select one of the printer types from <code class="literal">Other Network Printers</code>, for example <span class="strong strong"><strong>APP Socket/HP Jet direct</strong></span>, enter the IP address of the printer, and then click <code class="literal">Continue</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-4-new.png" alt="add printer in cups ui 4 new"/></div></div></li><li class="listitem"><p class="simpara">
						If you have selected for example <span class="strong strong"><strong>APP Socket/HP Jet direct</strong></span> as shown above, enter the IP address of the printer, and then click <code class="literal">Continue</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-5-new.png" alt="add printer in cups ui 5 new"/></div></div></li><li class="listitem"><p class="simpara">
						You can add more details about the new printer, such as the name, description and location. To set a printer to be shared over the network, use <code class="literal">Share This Printer</code> as shown below.
					</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-6-new.png" alt="add printer in cups ui 6 new"/></div></div></li><li class="listitem"><p class="simpara">
						Select the printer manufacturer, and then click <code class="literal">Continue</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-7-new.png" alt="add printer in cups ui 7 new"/></div></div><p class="simpara">
						Alternatively, you can also provide a postscript printer description (PPD) file to be used as a driver for the printer, by click on <code class="literal">Browse…​</code> at the bottom.
					</p></li><li class="listitem"><p class="simpara">
						Select the model of the printer, and then click <code class="literal">Add Printer</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-8-new.png" alt="add printer in cups ui 8 new"/></div></div></li><li class="listitem"><p class="simpara">
						After the printer has been added, the next window allows you to set the default print options.
					</p><div class="informalfigure"><div class="mediaobject"><img src="cups-web-ui-set-defaults-n2.png" alt="cups web ui set defaults n2"/></div></div></li></ol></div><p>
				After clicking <code class="literal">Set Default Options</code>, you will receive a confirmation that the new printer has been added successfully.
			</p><div class="informalfigure"><div class="mediaobject"><img src="add-printer-in-cups-ui-final-confirm.png" alt="add printer in cups ui final confirm"/></div></div></section><section class="section" id="configuring-printer-cups-web-ui_acquiconfiguring-printing"><div class="titlepage"><div><div><h2 class="title">8.5. Configuring a printer in the CUPS web UI</h2></div></div></div><p>
				This section describes how to configure a new printer, and how to maintain a configuration of a printer using the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					You have acquired administration access to the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span> as described in <a class="xref" href="index.html#acquiring-administration-access-to-cups-web-ui_configuring-printing" title="8.3.1. Acquiring administration access to the CUPS web UI">Section 8.3.1, “Acquiring administration access to the CUPS web UI”</a>.
				</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Click the <code class="literal">Printers</code> menu to see available printers that you can configure.
					</p><div class="informalfigure"><div class="mediaobject"><img src="conf-printer-cups-1.png" alt="conf printer cups 1"/></div></div></li><li class="listitem"><p class="simpara">
						Choose one printer that you want to configure.
					</p><div class="informalfigure"><div class="mediaobject"><img src="conf-printer-cups-2.png" alt="conf printer cups 2"/></div></div></li><li class="listitem"><p class="simpara">
						Perform your selected task by using one of the available menus:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Go to <code class="literal">Maintenance</code> for maintenance tasks.
							</p><div class="informalfigure"><div class="mediaobject"><img src="conf-printer-cups-3.png" alt="conf printer cups 3"/></div></div></li><li class="listitem"><p class="simpara">
								Go to <code class="literal">Administration</code> for administration tasks.
							</p><div class="informalfigure"><div class="mediaobject"><img src="conf-printer-cups-4.png" alt="conf printer cups 4"/></div></div></li><li class="listitem">
								You can also check completed print jobs or all active print jobs by clicking the <code class="literal">Show Completed Jobs</code> or <code class="literal">Show All Jobs</code> buttons.
							</li></ul></div></li></ol></div></section><section class="section" id="printing-a-test-page_latest_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.6. Printing a test page using the CUPS web UI</h2></div></div></div><p>
				This section describes how to print a test page to make sure that the printer functions properly.
			</p><p>
				You might want to print a test page if one of the below conditions is met.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A printer has been set up.
					</li><li class="listitem">
						A printer configuration has been changed.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					You have acquired administration access to the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span> as described in <a class="xref" href="index.html#acquiring-administration-access-to-cups-web-ui_configuring-printing" title="8.3.1. Acquiring administration access to the CUPS web UI">Section 8.3.1, “Acquiring administration access to the CUPS web UI”</a>.
				</p></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Go to <code class="literal">Printers</code> menu, and click <code class="literal">Maintenance</code> → <code class="literal">Print Test Page</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="printing-test-page-cups-web-ui.png" alt="printing test page cups web ui"/></div></div></li></ul></div></section><section class="section" id="setting-print-options_cups-web-ui_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.7. Setting print options using the CUPS web UI</h2></div></div></div><p>
				This section describes how to set common print options, such as the media size and type, print quality or the color mode, in the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span>.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					You have acquired administration access to the <span class="strong strong"><strong><span class="application application">CUPS web UI</span></strong></span> as described in <a class="xref" href="index.html#acquiring-administration-access-to-cups-web-ui_configuring-printing" title="8.3.1. Acquiring administration access to the CUPS web UI">Section 8.3.1, “Acquiring administration access to the CUPS web UI”</a>.
				</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Go to <code class="literal">Administration</code> menu, and click <code class="literal">Maintenance</code> → <code class="literal">Set Default Options</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="cups-web-ui-set-defaults-n1.png" alt="cups web ui set defaults n1"/></div></div></li><li class="listitem"><p class="simpara">
						Set the print options.
					</p><div class="informalfigure"><div class="mediaobject"><img src="cups-web-ui-set-defaults-n2.png" alt="cups web ui set defaults n2"/></div></div></li></ol></div></section><section class="section" id="using-samba-to-print-to-a-windows-print-server-with-kerberos-authentication_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.8. Using Samba to print to a Windows print server with Kerberos authentication</h2></div></div></div><p>
				With the <code class="literal systemitem">samba-krb5-printing</code> wrapper, Active Directory (AD) users who are logged in to Red Hat Enterprise Linux can authenticate to Active Directory (AD) by using Kerberos and then print to a local CUPS print server that forwards the print job to a Windows print server.
			</p><p>
				The benefit of this configuration is that the administrator of CUPS on Red Hat Enterprise Linux does not need to store a fixed user name and password in the configuration. CUPS authenticates to AD with the Kerberos ticket of the user that sends the print job.
			</p><p>
				This section describes how to configure CUPS for this scenario.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Red Hat only supports submitting print jobs to CUPS from your local system, and not to re-share a printer on a Samba print server.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The printer that you want to add to the local CUPS instance is shared on an AD print server.
					</li><li class="listitem">
						You joined the Red Hat Enterprise Linux host as a member to the AD. For details, see <a class="xref" href="index.html#proc_joining-samba-to-a-domain_assembly_setting-up-samba-as-an-ad-domain-member-server" title="2.5.1. Joining Samba to a Domain">Section 2.5.1, “Joining Samba to a Domain”</a>.
					</li><li class="listitem">
						CUPS is installed on Red Hat Enterprise Linux and the <code class="literal systemitem">cups</code> service is running. For details, see <a class="xref" href="index.html#activating-cups-service_configuring-printing" title="8.1. Activating the cups service">Section 8.1, “Activating the cups service”</a>.
					</li><li class="listitem">
						The PostScript Printer Description (PPD) file for the printer is stored in the <code class="literal filename">/usr/share/cups/model/</code> directory.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">samba-krb5-printing</code>, <code class="literal package">samba-client</code>, and <code class="literal package">krb5-workstation</code> packages:
					</p><pre class="literallayout"># yum install samba-krb5-printing samba-client krb5-workstation</pre></li><li class="listitem"><p class="simpara">
						Optional: Authenticate as a domain administrator and display the list of printers that are shared on the Windows print server:
					</p><pre class="literallayout"># kinit <span class="emphasis"><em>administrator</em></span>@<span class="emphasis"><em>AD_KERBEROS_REALM</em></span>
# smbclient -L <span class="emphasis"><em>win_print_srv.ad.example.com</em></span> -k

	Sharename       Type      Comment
	---------       ----      -------
	...
	Example         Printer   Example
	...</pre></li><li class="listitem"><p class="simpara">
						Optional: Display the list of CUPS models to identify the PPD name of your printer:
					</p><pre class="literallayout">lpinfo -m
...
<span class="emphasis"><em>samsung.ppd Samsung M267x 287x Series PXL</em></span>
...</pre><p class="simpara">
						You require the name of the PPD file when you add the printer in the next step.
					</p></li><li class="listitem"><p class="simpara">
						Add the printer to CUPS:
					</p><pre class="literallayout"># lpadmin -p "<span class="emphasis"><em>example_printer</em></span>" -v smb://<span class="emphasis"><em>win_print_srv.ad.example.com</em></span>/<span class="emphasis"><em>Example</em></span> -m <span class="emphasis"><em>samsung.ppd</em></span> -o auth-info-required=negotiate -E</pre><p class="simpara">
						The command uses the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal option">-p <span class="emphasis"><em>printer_name</em></span></code> sets the name of the printer in CUPS.
							</li><li class="listitem">
								<code class="literal option">-v <span class="emphasis"><em>URI_to_Windows_printer</em></span></code> sets the URI to the Windows printer. Use the following format: <code class="literal command">smb://<span class="emphasis"><em>host_name</em></span>/<span class="emphasis"><em>printer_share_name</em></span></code>.
							</li><li class="listitem">
								<code class="literal option">-m <span class="emphasis"><em>PPD_file</em></span></code> sets the PPD file the printer uses.
							</li><li class="listitem">
								<code class="literal option">-o auth-info-required=negotiate</code> configures CUPS to use Kerberos authentication when it forwards print jobs to the remote server.
							</li><li class="listitem">
								<code class="literal option">-E</code> enables the printer and CUPS accepts jobs for the printer.
							</li></ul></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log into the Red Hat Enterprise Linux host as an AD domain user.
					</li><li class="listitem"><p class="simpara">
						Authenticate as an AD domain user:
					</p><pre class="literallayout"># kinit <span class="emphasis"><em>domain_user_name</em></span>@<span class="emphasis"><em>AD_KERBEROS_REALM</em></span></pre></li><li class="listitem"><p class="simpara">
						Print a file to the printer you added to the local CUPS print server:
					</p><pre class="literallayout"># lp -d <span class="emphasis"><em>example_printer</em></span> <span class="emphasis"><em>file</em></span></pre></li></ol></div></section><section class="section" id="working-with-cups-logs_configuring-printing"><div class="titlepage"><div><div><h2 class="title">8.9. Working with CUPS logs</h2></div></div></div><section class="section" id="types-of-cups-logs_working-with-cups-logs"><div class="titlepage"><div><div><h3 class="title">8.9.1. Types of CUPS logs</h3></div></div></div><p>
					CUPS provides three different kinds of logs:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Error log - Stores error messages, warnings and debugging messages.
						</li><li class="listitem">
							Access log - Stores messages about how many times CUPS clients and web UI have been accessed.
						</li><li class="listitem">
							Page log - Stores messages about the total number of pages printed for each print job.
						</li></ul></div><p>
					In Red Hat Enterprise Linux 8, all three types are logged centrally in systemd-journald together with logs from other programs.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						In Red Hat Enterprise Linux 8, the logs are no longer stored in specific files within the <code class="literal filename">/var/log/cups</code> directory, which was used in Red Hat Enterprise Linux 7.
					</p></div></div></section><section class="section" id="accessing-cups-logs_working-with-cups-logs"><div class="titlepage"><div><div><h3 class="title">8.9.2. Accessing CUPS logs</h3></div></div></div><p>
					This section describes how to access:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							All CUPS logs
						</li><li class="listitem">
							CUPS logs for a specific print job
						</li><li class="listitem">
							CUPS logs within a specific time frame
						</li></ul></div><section class="section" id="accessing-all-cups-logs_accessing-cups-logs"><div class="titlepage"><div><div><h4 class="title">8.9.2.1. Accessing all CUPS logs</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Filter CUPS logs from systemd-journald:
							</li></ul></div><pre class="literallayout">$ journalctl -u cups</pre></section><section class="section" id="accessing-cups-log-for-a-specific-print-job_accessing-cups-logs"><div class="titlepage"><div><div><h4 class="title">8.9.2.2. Accessing CUPS logs for a specific print job</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Filter logs for a specific print job:
							</li></ul></div><pre class="literallayout">$ journalctl -u cups JID=N</pre><p>
						Where <code class="literal">N</code> is a number of a print job.
					</p></section><section class="section" id="accessing-cups-log-by-specific-time-frame_accessing-cups-logs"><div class="titlepage"><div><div><h4 class="title">8.9.2.3. Accessing CUPS logs by specific time frame</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Filter logs within the specified time frame:
							</li></ul></div><pre class="literallayout">$ journalctl -u cups --since=YYYY-MM-DD --until=YYYY-MM-DD</pre><p>
						Where <code class="literal">YYYY</code> is year, <code class="literal">MM</code> is month and <code class="literal">DD</code> is day.
					</p></section><section class="section" id="related-information-accessing-cups-logs"><div class="titlepage"><div><div><h4 class="title">8.9.2.4. Related information</h4></div></div></div><p>
						For more detailed information on accessing CUPS logs, see the <code class="literal">journalctl</code> man page.
					</p></section></section><section class="section" id="configuring-the-cups-log-location_working-with-cups-logs"><div class="titlepage"><div><div><h3 class="title">8.9.3. Configuring the CUPS log location</h3></div></div></div><p>
					This section describes how to configure the location of CUPS logs.
				</p><p>
					In Red Hat Enterprise Linux 8, CUPS logs are by default logged into systemd-journald, which is ensured by the following default setting in the <code class="literal filename">/etc/cups/cups-files.conf</code> file:
				</p><pre class="literallayout">ErrorLog syslog</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Red Hat recommends to keep the default location of CUPS logs.
					</p></div></div><p>
					If you want to send the logs into a different location, you need to change the settings in the <code class="literal">/etc/cups/cups-files.conf</code> file as follows:
				</p><pre class="literallayout">ErrorLog &lt;your_required_location&gt;</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						If you change the default location of CUPS log, you may experience an unexpected behavior or SELinux issues.
					</p></div></div><p>
					context: configuring-printing
				</p><p>
					context: Deploying-different-types-of-servers
				</p></section></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140042815399824"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2020 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div>
  
  </div>
  </div>
</div>
<div id="comments-footer" class="book-comments">
  </div>
<meta itemscope="" itemref="md1">

    <!-- Display: Next/Previous Nav -->
          
      </div>
</article>


  

            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="index.html#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

            <div role="navigation">
                <h3>Quick Links</h3>
                <ul>
                    <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li><a class="manage-subscriptions" href="https://access.redhat.com/management/subscriptions/#active">Subscriptions</a></li>
                    <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                    <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                    <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Help</h3>
                <ul>
                    <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                    <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                    <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Site Info</h3>
                <ul>
                  <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                  <li><a class="browser-support-policy" href="https://access.redhat.com/help/browsers/">Browser Support Policy</a></li>
                  <li><a class="accessibility" href="https://access.redhat.com/help/accessibility/">Accessibility</a></li>
                  <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                  <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Related Sites</h3>
                <ul>
                    <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                    <li><a href="https://www.openshift.com" class="openshift-com">openshift.com</a></li>
                    <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                    <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>About</h3>
                <ul>
                    <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                    <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                    <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                </ul>
            </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                          <span class="status-description"></span>
                          <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2020 Red Hat, Inc.</div>

                        <div role="navigation" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://access.redhat.com/help/terms/" class="terms-of-use">Customer Portal Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                      <img src="l_summit.png" alt="Red Hat Summit" />
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHatSupport" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>
                        <a href="https://www.facebook.com/RedHatSupport" class="sm-icon facebook"><span class="nicon-facebook"></span><span class="offscreen">Facebook</span></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--googleon: all-->
</div>
  
  <div id="formatHelp" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="formatTitle" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="formatTitle">Formatting Tips</h3>
    </div>
    <div class="modal-body">
      <p>Here are the common uses of Markdown.</p><dl class="formatting-help">
        <dt class="codeblock">Code blocks</dt><dd class="codeblock"><pre><code>~~~
Code surrounded in tildes is easier to read
~~~</code></pre></dd>
        <dt class="urls">Links/URLs</dt><dd class="urls"><code>[Red Hat Customer Portal](https://access.redhat.com)</code></dd>
       </dl>
    </div>
    <div class="modal-footer">
      <a target="_blank" href="https://access.redhat.com/help/markdown" class="btn btn-primary">Learn more</a>
      <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
  </div></div></div></body>
</html>
