<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video#" >

<head profile="http://www.w3.org/1999/xhtml/vocab">
	  <!--[if IE]><![endif]-->
<meta charset="utf-8" />
<meta name="revision" title="d7d46cb7-cf27-4f0b-9f17-f4879f164e80" product="f321f43a-4a79-48fe-8aae-117b9d973ec0" revision="294370facdda799907970d628acddd693b6ccf13:en-us" page="58e91b57-3c5f-4c04-897e-e7dda93c99c6" />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/index" />
<meta property="og:title" content="Installing Identity Management Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta property="og:description" content="This documentation collection provides instructions on how to install Identity Management on Red Hat Enterprise Linux 8 (RHEL) and how to upgrade to it from RHEL 7." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/index" />
<meta name="twitter:title" content="Installing Identity Management Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta name="twitter:description" content="This documentation collection provides instructions on how to install Identity Management on Red Hat Enterprise Linux 8 (RHEL) and how to upgrade to it from RHEL 7." />
<meta name="twitter:image:src" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
  <title>Installing Identity Management Red Hat Enterprise Linux 8 | Red Hat Customer Portal</title>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="kcs06.web.prod.ext.phx2.redhat.com" />
<meta name="avalon-version" content="2070d6b" />
<meta name="cp-chrome-build-date" content="2020-03-09T20:28:54.189Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />

 

<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en",  
        version   : "2070d6b",
        builddate : "2020-03-09T20:28:54.189Z",
        fetchdate : "2020-03-11T07:53:05-0400",
        nrid      : "14615289",
        nrlk      : "2a497fa56f"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="favicon.ico" />

<link media="all" rel="stylesheet" type="text/css" href="bootstrap.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="main.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="components.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="pages.css%3Fv=2070d6b.css" />

<link href="chosen.css%3Fv=2070d6b.css" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]-->

<noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>

<!-- /cssInclude -->
<script type="text/javascript" src="require.js%3Fv=2070d6b" data-main="/webassets/avalon/j/"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
  <link type="text/css" rel="stylesheet" href="css__c2Nkkx_5vYh8rvZbfBAGB4EMzMtH5ouFJDBlDsnhSR8__-ax0_8bam15ZDJT9j7LilCfJrDyEhGGAgc0KC8HYvJg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__Jy3BSr8TrxptaufAzQDT1skBUlX2CnL_wm6BizzYuGw__-YZvqB8yuA4kK_iKklbk5HdZCoG2qAgz1l-8Qi2NFH4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="messages.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__m76iIFREtc70Nmw5xe1ZwHbNBlwOP2Zjc3DcacNWnFQ__STEh8aY3w8E_bKzhB4Xke2WOQ9XMDQquHIP5B8SeDIY__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__4sM4s6XOQ2Nm0pdkrWRLvrgtwpTmHAFzR_LcdesKYj8__vJ0jjVEhoPh3KBeLZfkqg51T3AFxhQCuXg1reipa__k__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="print" />
  <link rel="stylesheet" type="text/css" media="all" href="list.css" />
  <script src="js__1YIht1y1Jlm9D0PyxEuhS3DlWdYAlEsNpsFDOaUsfRw__ZnC7278ZsqBG-1FOUqflDl8B3Y1kLiAWXAIkoLrHbYg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__5ysXPc5KIyMmizxqRY68ILfrEGrj0P29WBIifnPTJvQ__Cap0DACEVMsefumg1gS1APLLd8stDkdGfp6c1uswMo4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>chrometwo_require(["analytics/attributes"], function(attributes) {
attributes.set('ResourceID',       'd7d46cb7-cf27-4f0b-9f17-f4879f164e80');
attributes.set('ResourceTitle',    'Installing Identity Management');
attributes.set('Language',         'en-us');
attributes.set('RevisionId',       '294370facdda799907970d628acddd693b6ccf13:en-us');
attributes.set('PublicationState', ['active','published']);
attributes.set('Product',          'Red Hat Enterprise Linux');
attributes.set('ProductVersion',   '8');
attributes.set('ProductId',        'Red Hat Enterprise Linux 8');
});</script>
<script>breadcrumbs = [ ["Products &amp; Services", "/products/"], ["Product Documentation", "/documentation/"], ["Red Hat Enterprise Linux", "/documentation/en-us/red_hat_enterprise_linux/"], ["8", "/documentation/en-us/red_hat_enterprise_linux/8/"], ["Installing Identity\u00a0Management", "/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/"] ];</script>
<script>window.siteMapState = "products";</script>
<script src="js__i6ieGBO-OPmIKm_f0srsb6gM7QELIWrBpKh6ub_yj8A__wjRg_duSK4rEZCRV2uwrCIPMl80Z_LJ9ew61H5hE-ZI__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__vGeEtorfXGI3aPAp71YA74N5p8wfpYVhnoIqwaJrOiQ__veGxEiPQW6fkzAPZnAFA23SFz1CyJy2dlu6x8XuHM4s__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"kcs","theme_token":"P6qxcLq3R961CnuQ7Zu4vpYvvzUVxdg7C7rFripGphY","js":{"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.jquery.min.js":1,"modules\/chosen\/chosen.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/prism.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/underscore.js":1,"sites\/all\/themes\/kcs\/js\/kcs_base.js":1,"sites\/all\/themes\/kcs\/js\/showdown.js":1,"sites\/all\/themes\/kcs\/js\/case_links.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/date\/date_api\/date.css":1,"modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/contrib\/user_prune\/css\/user_prune.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/panels\/css\/panels.css":1,"sites\/all\/modules\/custom\/rate\/rate.css":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/plugins\/layouts\/docs_page\/docs_page.css":1,"https:\/\/access.redhat.com\/webassets\/avalon\/s\/messages.css":1,"sites\/all\/themes\/zen\/system.base.css":1,"sites\/all\/themes\/zen\/system.menus.css":1,"sites\/all\/themes\/zen\/system.messages.css":1,"sites\/all\/themes\/zen\/system.theme.css":1,"sites\/all\/themes\/zen\/comment.css":1,"sites\/all\/themes\/zen\/node.css":1,"sites\/all\/themes\/kcs\/css\/html-reset.css":1,"sites\/all\/themes\/kcs\/css\/wireframes.css":1,"sites\/all\/themes\/kcs\/css\/layout-fixed.css":1,"sites\/all\/themes\/kcs\/css\/page-backgrounds.css":1,"sites\/all\/themes\/kcs\/css\/tabs.css":1,"sites\/all\/themes\/kcs\/css\/pages.css":1,"sites\/all\/themes\/kcs\/css\/blocks.css":1,"sites\/all\/themes\/kcs\/css\/navigation.css":1,"sites\/all\/themes\/kcs\/css\/views-styles.css":1,"sites\/all\/themes\/kcs\/css\/nodes.css":1,"sites\/all\/themes\/kcs\/css\/comments.css":1,"sites\/all\/themes\/kcs\/css\/forms.css":1,"sites\/all\/themes\/kcs\/css\/fields.css":1,"sites\/all\/themes\/kcs\/css\/kcs.css":1,"sites\/all\/themes\/kcs\/css\/print.css":1}},"chosen":{"selector":"#edit-field-kcs-component-select-und, #edit-field-kcs-sbr-select-und, #edit-field-kcs-product-select-und, #edit-field-kcs-type-select-und, #edit-language, #edit-field-kcs-a-category-select-und, #edit-field-kcs-state-select-und, #edit-field-kcs-tags-select-und, #edit-field-kcs-state-select-value, #edit-field-vid-reference-product-und, #edit-state, #edit-product, #edit-category, #edit-field-kcs-product-select-tid, #edit-field-kcs-type-select-tid, #edit-field-kcs-a-category-select-tid, #edit-sort-bef-combine, #edit-kcs-state, #edit-field-category-tid, #edit-field-product-tid, #edit-field-tags-tid, #edit-field-category-und, #edit-field-product-und, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-category, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-product, #views-exposed-form-questions-list-questions-filter-block #edit-field-tags, #edit-field-mega-menu-tab-und, #edit-field-internal-tags-tid, #edit-tags, #edit-field-kcs-tags-select-tid, #edit-subscriptions-and-choose-field-select, #edit-subscriptions-and-type, #edit-vid-13, #edit-vid-4, #edit-vid-5, #edit-vid-53, #edit-vid-1, #edit-vid-3, #edit-group-blog, #edit-group-group, #edit-subscriptions-and-choose-field-select-two, #edit-subscriptions-and-type-two, #edit-vid-13-two, #edit-vid-4-two, #edit-vid-5-two, #edit-vid-53-two, #edit-vid-1-two, #edit-vid-3-two, #edit-group-blog-two, #edit-group-group-two, #edit-subscriptions-and-edit-choose-field-select, #edit-subscriptions-and-type-edit, #edit-subscriptions-and-edit-type-two, #edit-vid-13-edit-two, #edit-vid-4-edit-two, #edit-vid-5-edit-two, #edit-vid-53-edit-two, #edit-vid-1-edit-two, #edit-vid-3-edit-two, #edit-group-group-edit-two, #edit-subscriptions-and-edit-choose-field-select-two, #edit-vid-13-edit, #edit-vid-4-edit, #edit-vid-5-edit, #edit-vid-53-edit, #edit-vid-1-edit, #edit-vid-3-edit, #edit-group-group-edit, #edit-group-blog-edit, #edit-field-supported-languages-tid, #edit-field-geography-und, #edit-field-supported-products-und, #edit-field-supported-languages-und, #edit-field-vendor-und, #edit-field-errata-type-text-und, #edit-field-errata-severity-text-und, #edit-field-software-partner-level-und, #edit-field-scert-product-category-und, #edit-field-certifications-und-0-field-product-und, #edit-kcs-article-type, #edit-field-eco-industry-tag-select-tid, #edit-field-eco-software-catego-select-tid, #edit-field-ecosystem-tag-select-und, #edit-field-eco-industry-tag-select-und, #edit-field-eco-software-catego-select-und, #edit-field-vendor-tsanet-member-ref-und, #edit-field-og-vendor-ref-und-0-default, #edit-field-eco-products-enabled-col-und-0-field-eco-subscription-model-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-support-level-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-archite-select-und, #edit-field-eco-certifications-select-und-0-field-eco-certificati-lvl-select-und, #edit-field-eco-certifications-select-und-0-field-eco-hypervisor-str-und, #edit-field-eco-supported-language-ref-und, #edit-field-eco-region-ref-und, #edit-field-cs-product-category-str-und, #edit-field-eco-certifications-select-und-0-field-eco-format-ref-und, #edit-field-eco-group-access-ref-und, #edit-field-hw-category-tag-ref-und, #edit-field-profile-industry-und, #edit-field-profile-tech-interests-und, #edit-field-product-page-features-ref-und, #edit-field-eco-product-select-und, #edit-field-base-product-ref-und, #edit-field-eco-product-archite-select-und, #edit-field-eco-format-ref-und, #edit-field-certification-status-ref-und, #edit-field-certification-result-ref-und, #edit-field-og-certified-product-ref-und-0-default, #edit-field-eco-subscription-model-ref-und, #edit-field-eco-support-level-ref-und, #edit-field-eco-certificati-lvl-select-und, #edit-field-eco-hypervisor-str-und, #edit-field-ccp-thirdparty-cert-select-und, .use_, #edit-field-eco-cert-product-tag-und, #edit-field-documentation-location-ref-und, #edit-field-documentation-title-und, #edit-field-accelerator-products-und","minimum":"0"},"rh_doc_fetcher":{"page_type":"single"},"section":"","kcs":{"nodeType":null,"nodeId":null}});</script>
    <!--[if lt IE 9]>
  <script src="https://access.redhat.com/sites/all/themes/kcs/js/html5shiv.js"></script>
  <![endif]-->
  
      


    <!--kcs07-->
<script type="text/javascript">
  Drupal.portal = {"version":{"redhat_portal":"package drupal7-redhat_portal is not installed"}};
  Drupal.portal.currentUser = {};
  </script>

</head>

<body class="portal-page admin-bar  kcs_external" >

  
  <div id="page-wrap" class="page-wrap">
    <div class="top-page-wrap">

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <!-- Accessibility Nav & Header -->
<div class="accessibility-nav sr-only">
    <a href="https://access.redhat.com/">
        <h1>Red Hat <span>Customer </span><span>Portal</span></h1>
    </a>
    <p><a href="index.html#cp-main">Skip to main content</a></p>
    <nav aria-labelledby="accessibility-nav-heading">
        <h2 id="accessibility-nav-heading">Main Navigation</h2>
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="accessibility-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="accessibility-accountUser">
                    <div class="account-name"><strong id="accessibility-userFullName"></strong></div>
                    <div class="account-org"><span id="accessibility-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="accessibility-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="accessibility-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="accessibility-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="accessibility-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="accessibility-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="accessibility-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- Mobile Header -->
<nav class="mobile-nav-bar hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <button id="menu-btn" class="menu menu-white" type="button" aria-label="Toggle Navigation">
        <span class="lines"></span>
    </button>
    <a class="logo" href="https://access.redhat.com/">
        <span class="logo-crop">
          <!-- logo -->
          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
            <defs>
              <style>
                .rh-logo-hat {
                  fill: #e00;
                }
                .rh-logo-type {
                  fill: #fff;
                }
              </style>
            </defs>
            <title>Red Hat</title>
            <path
              class="rh-logo-hat"
              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
              <path class="rh-logo-band"
              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
              <path
              class="rh-logo-type"
              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
          </svg>
        </span>
        <span class="site-title"><span>Customer </span><span>Portal</span></span>
    </a>
    <button class="btn btn-search btn-utility" data-target="#site-search">
        <span class="web-icon-search"></span>
        <span class="link-text">Search</span>
    </button>
</nav>

<!-- Mobile Menu Drawer -->
<div class="nav-drawer mobile-nav-drawer hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <nav class="nav-container">
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="mobile-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="mobile-accountUser">
                    <div class="account-name"><strong id="mobile-userFullName"></strong></div>
                    <div class="account-org"><span id="mobile-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="mobile-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="mobile-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="mobile-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="mobile-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="mobile-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="mobile-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- White Utility Menu for large screens -->
<div class="utility-wrap" aria-hidden="true">
    <div class="utility-container">
        <div class="utility-bar hidden-xs">
            <div role="navigation" class="top-nav">
                <ul>
                    <li id="nav-subscription" data-portal-tour-1="1"><a class="top-nav-subscriptions" href="https://access.redhat.com/management/">Subscriptions</a></li>
                    <li id="nav-downloads" data-portal-tour-1="2"><a class="top-nav-downloads" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li id="nav-containers"><a class="top-nav-containers" href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
                    <li id="nav-support" data-portal-tour-1="3"><a class="top-nav-support-cases" href="https://access.redhat.com/support/cases/">Support Cases</a></li>
                </ul>
            </div>

            <div role="navigation" class="utility-nav">
                <ul>
                    <li id="searchABTestHide">
                        <a class="btn-search" data-target="#site-search" title="Search" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-search" aria-label="search"></span>
                            <span class="link-text">Search</span>
                        </a>
                    </li>
                    <!-- AB Test -->
                    <li id="searchABTestShow">
                        <form id="topSearchFormABTest" name="topSearchFormABTest">
                            <label for="topSearchInputABTest" class="sr-only">Search</label>
                            <input id="topSearchInputABTest" name="keyword" placeholder="Search" value="" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="form-control">
                            <button type="submit" class="btn btn-app btn-sm btn-link"><span class="web-icon-search" aria-label="search"></span></button>
                        </form>
                    </li>
                    <!-- End of AB Test -->
                    <li>
                        <a class="btn-profile" data-target="#account-info" data-portal-tour-1="4a" title="Account" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-user" aria-label="log in"></span>
                            <span class="link-text">Log In</span>
                            <span class="account-user" id="accountUserName"></span>
                        </a>
                    </li>
                    <li>
                        <a class="btn-language" data-target="#language" data-portal-tour-1="6" title="Language" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-globe" aria-label="language"></span>
                            <span class="link-text">Language</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Utility Tray -->
        <div class="utility-tray-container">
            <div class="utility-tray">
                <div id="site-search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="https://access.redhat.com/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <div class="input-group push-bottom">

                                <input class="form-control searchField" id="topSearchInput" name="keyword" value="" placeholder="Enter your search term" type="text">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primary">Search</button>
                                </span>
                            </div>
                            <div>Troubleshooting an issue? Try <a href="https://access.redhat.com/solution-engine">Solution Engine</a>&mdash;our new support tool.</div>
                        </form>
                    </div>
                </div>
                <div id="account-info" class="utility-link account-info">
                    <div class="content">

                        <!-- Account Unauthenticated -->
                        <div id="accountLinksLoggedOut" class="unauthenticated">
                            <h2 class="utility-header">Log in to Your Red Hat Account</h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border">
                                    <p><a href="https://access.redhat.com/login" id="accountLogin" class="btn btn-primary">Log In</a></p>
                                    <p>Your Red Hat account gives you access to your profile, preferences, and services, depending on your status.</p>
                                </div>
                                <div class="col-sm-6 col-border col-border-left">
                                    <p><a href="https://www.redhat.com/wapps/ugc/register.html" class="btn btn-primary">Register</a></p>
                                    <p>If you are a new customer, register now for access to product evaluations and purchasing capabilities. </p>

                                    <strong>Need access to an account?</strong><p>If your company has an existing Red Hat account, your organization administrator can grant you access.</p>

                                    <p><a href="https://access.redhat.com/support/contact/customerService/">If you have any questions, please contact customer service.</a></p>
                                </div>
                            </div>
                        </div>

                        <!-- Account Authenticated -->
                        <div id="accountLinksLoggedIn" class="authenticated">
                            <h2 class="utility-header"><span id="userFirstName"></span></h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border col-border-right">
                                    <div class="account-info" id="accountUser">
                                        <div class="avatar"><!-- placeholder--></div>
                                        <div class="account-name"><strong id="userFullName"></strong></div>
                                        <div class="account-org"><span id="userOrg"></span></div>
                                        <div class="account-number accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                                    </div>

                                    <div class="row account-settings">
                                        <div class="col-md-6" data-portal-tour-1="4">
                                            <h3>Red Hat Account</h3>
                                            <ul class="reset">
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
                                                <!-- <li><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
                                                <li><a href="https://access.redhat.com/account-team">Account Team</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6" data-portal-tour-1="5">
                                            <h3>Customer Portal</h3>
                                            <ul class="reset">
                                                <li><a href="https://access.redhat.com/user">My Profile</a></li>
                                                <li><a href="https://access.redhat.com/user" id="userNotificationsLink">Notifications</a></li>
                                                <li><a href="https://access.redhat.com/help/">Help</a></li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-6 col-border">
                                    <p>For your security, if you’re on a public computer and have finished using your Red Hat services, please be sure to log out.</p>
                                    <p><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout" id="accountLogout" class="btn btn-primary">Log Out</a></p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="language" class="utility-link language">
                    <div class="content">
                        <h2 class="utility-header">Select Your Language</h2>
                        <div class="row" id="localesMenu">
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en">English</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko">한국어</a></li>
                                </ul>
                            </div>
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja">日本語</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN">中文 (中国)</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="scroll-anchor"></div>

<!-- Main Menu for large screens -->
<div class="header-nav visible-sm visible-md visible-lg" aria-hidden="true">
    <div id="header-nav">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">

                    <a href="https://access.redhat.com/" class="logo">
                        <span class="logo-crop">
                          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                            <defs>
                              <style>
                                .rh-logo-hat {
                                  fill: #e00;
                                }
                                .rh-logo-type {
                                  fill: #fff;
                                }
                              </style>
                            </defs>
                            <title>Red Hat</title>
                            <path
                              class="rh-logo-hat"
                              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                              <path class="rh-logo-band"
                              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                              <path
                              class="rh-logo-type"
                              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                          </svg>
                        </span>
                        <span class="site-title"><span>Customer </span><span>Portal</span></span>
                    </a>

                    <nav class="primary-nav hidden-sm">
                        <ul>
                            <li id="nav-products"><a class="products" data-link="mega" data-target="products-menu" href="https://access.redhat.com/products/" id="products-menu">Products &amp; Services</a></li>
                            <li id="nav-tools"><a class="tools" data-link="mega" data-target="tools-menu" href="https://access.redhat.com/labs/" id="tools-menu">Tools</a></li>
                            <li id="nav-security"><a class="security" data-link="mega" data-target="security-menu" href="https://access.redhat.com/security/" id="security-menu">Security</a></li>
                            <li id="nav-community"><a class="community" data-link="mega" data-target="community-menu" href="https://access.redhat.com/community/" id="community-menu">Community</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Mega Menu for large screens -->
<div class="mega-wrap visible-sm visible-md visible-lg" aria-hidden="true">
    <nav class="mega">
        <div class="container">
            <div class="mega-menu-wrap">

                <!-- Products Menu -->
                <div aria-labelledby="products-menu" class="products-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-md-6 col-sm-8">
                            <div class="root clearfix" data-portal-tour-1="7">
                                <ul class="subnav subnav-root">
                                    <li data-target="infrastructure-menu" class="active">
                                        <h3>Infrastructure and Management</h3>
                                    </li>
                                    <li data-target="cloud-menu">
                                        <h3>Cloud Computing</h3>
                                    </li>
                                    <li data-target="storage-menu">
                                        <h3>Storage</h3>
                                    </li>
                                    <li data-target="jboss-dev-menu">
                                        <h3>Runtimes</h3>
                                    </li>
                                    <li data-target="jboss-int-menu">
                                        <h3>Integration and Automation</h3>
                                    </li>
                                </ul>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="infrastructure-menu" style="display: block;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="cloud-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="storage-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a>
                                        </li>
                                        <li>
                                          <a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-dev-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                        </li>
                                    </ul>
                                </div> -->
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul class="border-bottom" id="portal-menu-border-bottom">
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                      </li>
                                    </ul>
                                    <ul>
                                      <li>
                                        <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                      </li>
                                    </ul>
                                </div>
                            </div>
                            <a href="https://access.redhat.com/products" class="btn btn-primary">View All Products</a>
                        </div>

                        <div class="col-md-6 col-sm-4 pull-right" data-portal-tour-1="8">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/support" class="cta-link cta-link-darkbg">Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
                                        <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>
                                    </ul>
                                    <h4 class="nav-title">Services</h4>
                                    <ul>
                                        <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
                                        <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/documentation" class="cta-link cta-link-darkbg">Documentation</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>
                                    </ul>
                                    <ul>
                                        <li><a href="https://access.redhat.com/ecosystem/" class="cta-link cta-link-darkbg">Ecosystem</a></li>
                                        <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
                                        <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tools Menu -->
                <div aria-labelledby="tools-menu" class="tools-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row" data-portal-tour-1="9">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h3 class="nav-title">Tools</h3>
                                    <ul>
                                        <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
                                        <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
                                        <li><a href="https://access.redhat.com/errata/">Errata</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <ul class="list-flat">
                                        <li><a href="https://access.redhat.com/labs/" class="cta-link cta-link-darkbg">Customer Portal Labs</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <div class="card card-dark-grey">
                                        <h4 class="card-heading">Red Hat Insights</h4>
                                        <p class="text-white">Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                        <ul class="list-flat rh-l-grid rh-m-gutters rh-m-all-6-col-on-md">
                                          <li><a href="https://www.redhat.com/en/technologies/management/insights" class="cta-link cta-link-md cta-link-darkbg">Learn more</a></li>
                                          <li><a href="https://cloud.redhat.com/insights" class="cta-link cta-link-md cta-link-darkbg">Go to Insights</a></li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <!-- Security Menu -->
                <div aria-labelledby="security-menu" class="security-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="10">

                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Red Hat Product Security Center</h2>
                                    <p class="text-white">Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.</p>
                                    <p><a href="https://access.redhat.com/security/" class="btn btn-primary">Product Security Center</a></p>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Security Updates</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
                                    </ul>
                                    <p class="text-white">Keep your systems secure with Red Hat&#039;s specialized responses for high-priority security vulnerabilities.</p>
                                    <ul>
                                        <li class="more-link"><a href="https://access.redhat.com/security/vulnerability">View Responses</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Resources</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
                                        <li><a href="https://www.redhat.com/en/blog/channel/security">Security Blog</a></li>
                                        <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
                                        <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community Menu -->
                <div aria-labelledby="community-menu" class="community-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="11">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Portal Community</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
                                        <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
                                        <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
                                        <p class="push-top"><a href="https://access.redhat.com/community/" class="btn btn-primary">Community Activity</a></p>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Events</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
                                        <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Stories</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
                                        <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
                                        <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--<a href="https://access.redhat.com/community/" class="btn btn-primary">Explore Community</a>-->
                    </div>
                </div>
            </div>
        </div>
    </nav>
</div>

            <!--[if IE 8]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
            </div>
            <![endif]-->
            <!--[if IE 9]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
            </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">
  <script type="text/javascript">
    chrometwo_require(['jquery-ui']);
  </script>


      <article class="rh_docs">
  <div class="container">
        <!-- Display: Book Page Content -->
    
  

<div class="row">
  <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
  <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
  


<a class="toc-toggle toc-show" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
  <span class="sr-only">Show Table of Contents</span>
  <span class="web-icon-mobile-menu" aria-hidden="true"></span>
</a>
<nav id="toc-main" class="toc-main collapse in">
  <div class="toc-menu affix-top">
    <a class="toc-toggle toc-hide" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
      <span class="sr-only">Hide Table of Contents</span>
      <span class="icon-remove" aria-hidden="true"></span>
    </a>
    <div class="doc-options">
      <div class="doc-language btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          English <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="index.html">English</a></li>
                      <li><a href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/8/html/installing_identity_management/">日本語</a></li>
                  </ul>
      </div>
      <div class="doc-format btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          Single-page HTML <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/">Multi-page HTML</a></li>
                                <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/pdf/installing_identity_management/Red_Hat_Enterprise_Linux-8-Installing_Identity_Management-en-US.pdf">PDF</a></li>
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/epub/installing_identity_management/Red_Hat_Enterprise_Linux-8-Installing_Identity_Management-en-US.epub">ePub</a></li>
                  </ul>
      </div>
    </div>
    <ol class="menu"><li class=" leaf"><a href="index.html">Installing Identity Management</a></li><li class=" leaf"><a href="index.html#proc_providing-feedback-on-red-hat-documentation_installing-identity-management">Providing feedback on Red Hat documentation</a></li><li class=" leaf"><a href="index.html#installing-idm">I. Installing Identity Management</a><ol class="menu"><li class=" leaf"><a href="index.html#preparing-the-system-for-ipa-server-installation_installing-identity-management">1. Preparing the system for IdM server installation</a><ol class="menu"><li class=" leaf"><a href="index.html#hardware-recomendations_preparing-the-system-for-ipa-server-installation">1.1. Hardware recommendations</a></li><li class=" leaf"><a href="index.html#system-requirements-in-ipa_preparing-the-system-for-ipa-server-installation">1.2. Custom configuration requirements for IdM</a><ol class="menu"><li class=" leaf"><a href="index.html#ipv6_requirements_in_idm">1.2.1. IPv6 requirements in IdM</a></li></ol></li><li class=" leaf"><a href="index.html#host-name-and-dns-requirements-for-ipa_preparing-the-system-for-ipa-server-installation">1.3. Host name and DNS requirements for IdM</a></li><li class=" leaf"><a href="index.html#port-requirements-for-ipa_preparing-the-system-for-ipa-server-installation">1.4. Port requirements for IdM</a></li><li class=" leaf"><a href="index.html#packages-required-for-an-ipa-server_preparing-the-system-for-ipa-server-installation">1.5. Installing packages required for an IdM server</a></li></ol></li><li class=" leaf"><a href="index.html#installing-an-ipa-server-with-integrated-dns_installing-identity-management">2. Installing an IdM server: With integrated DNS, with an integrated CA as the root CA</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-ipa-server-with-dns-interactive-install_install-server-with-dns">2.1. Interactive installation</a></li><li class=" leaf"><a href="index.html#installing-an-ipa-server-with-integrated-dns-non-interactive-installation_install-server-with-dns">2.2. Non-interactive installation</a></li></ol></li><li class=" leaf"><a href="index.html#installing-an-ipa-server-with-external-ca_installing-identity-management">3. Installing an IdM server: With integrated DNS, with an external CA as the root CA</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-an-ipa-server-with-an-external-ca-as-the-root-ca_install-server-external-ca">3.1. Interactive installation</a></li><li class=" leaf"><a href="index.html#troubleshooting-external-ca-installation-fails">3.2. Troubleshooting: External CA installation fails</a></li></ol></li><li class=" leaf"><a href="index.html#installing-an-ipa-server-without-a-ca_installing-identity-management">4. Installing an IdM server: With integrated DNS, without a CA</a><ol class="menu"><li class=" leaf"><a href="index.html#certificates-required-to-install-ipa-server-no-ca_install-server-no-ca">4.1. Certificates required to install an IdM server without a CA</a></li><li class=" leaf"><a href="index.html#installing-ipa-server-with-dns-interactive-install_install-server-no-ca">4.2. Interactive installation</a></li></ol></li><li class=" leaf"><a href="index.html#installing-an-ipa-server-without-integrated-dns_installing-identity-management">5. Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-an-ipa-server-without-integrated-dns-interactive-installation_installing-identity-management">5.1. Interactive installation</a></li><li class=" leaf"><a href="index.html#installing-an-ipa-server-without-integrated-dns-non-interactive-installation_installing-identity-management">5.2. Non-interactive installation</a></li></ol></li><li class=" leaf"><a href="index.html#uninstalling-an-ipa-server_installing-identity-management">6. Uninstalling an IdM server</a></li><li class=" leaf"><a href="index.html#renaming-an-ipa-server_installing-identity-management">7. Renaming an IdM server</a></li><li class=" leaf"><a href="index.html#preparing-the-system-for-ipa-client-installation_installing-identity-management">8. Preparing the system for IdM client installation</a><ol class="menu"><li class=" leaf"><a href="index.html#dns-requirements-for-ipa-clients_preparing-the-system-for-ipa-client-installation">8.1. DNS requirements for IdM clients</a></li><li class=" leaf"><a href="index.html#port-requirements-for-ipa-clients_preparing-the-system-for-ipa-client-installation">8.2. Port requirements for IdM clients</a></li><li class=" leaf"><a href="index.html#packages-required-to-install-an-ipa-client_preparing-the-system-for-ipa-client-installation">8.3. Packages required to install an IdM client</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-ipa-client-packages-from-the-idm-client-stream">8.3.1. Installing ipa-client packages from the idm:client stream</a></li><li class=" leaf"><a href="index.html#installing-ipa-client-packages-from-the-idm-dl1-stream">8.3.2. Installing ipa-client packages from the idm:DL1 stream</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#installing-an-ipa-client-basic-scenario_installing-identity-management">9. Installing an IdM client: Basic scenario</a><ol class="menu"><li class=" leaf"><a href="index.html#prerequisites">9.1. Prerequisites</a></li><li class=" leaf"><a href="index.html#overview-of-the-ipa-client-installation-options">9.2. An overview of the IdM client installation options</a></li><li class=" leaf"><a href="index.html#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation">9.3. Installing a client by using user credentials: Interactive installation</a></li><li class=" leaf"><a href="index.html#installing-client-basic-installing-a-client-by-using-a-one-time-password-interactive-installation">9.4. Installing a client by using a one-time password: Interactive installation</a></li><li class=" leaf"><a href="index.html#installing-ipa-client-non-interactive-install_install-client-basic">9.5. Installing a client: Non-interactive installation</a></li><li class=" leaf"><a href="index.html#removing-pre-ipa-configuration-after-installing-client_install-client-basic">9.6. Removing pre-IdM configuration after installing a client</a></li><li class=" leaf"><a href="index.html#testing-an-ipa-client_install-client-basic">9.7. Testing an IdM client</a></li><li class=" leaf"><a href="index.html#connection-requests-during-an-ipa-client-installation_install-client-basic">9.8. Connections performed during an IdM client installation</a></li><li class=" leaf"><a href="index.html#ipa-client-communication-with-server_install-client-basic">9.9. IdM client’s communications with the server during post-installation deployment</a><ol class="menu"><li class=" leaf"><a href="index.html#sssd-deployment-operations_install-client-basic">9.9.1. SSSD communication patterns</a></li><li class=" leaf"><a href="index.html#certmonger-deployment-operations_install-client-basic">9.9.2. Certmonger communication patterns</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#installing-an-ipa-client-with-kickstart_installing-identity-management">10. Installing an IdM client with Kickstart</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-a-client-with-kickstart_client-kickstart">10.1. Installing a client with Kickstart</a></li><li class=" leaf"><a href="index.html#kickstart-file-for-client-installation_client-kickstart">10.2. Kickstart file for client installation</a></li><li class=" leaf"><a href="index.html#testing-an-ipa-client_client-kickstart">10.3. Testing an IdM client</a></li></ol></li><li class=" leaf"><a href="index.html#re-enrolling-an-ipa-client_installing-identity-management">11. Re-enrolling an IdM client</a><ol class="menu"><li class=" leaf"><a href="index.html#client-reenrollment-idm_re-enrolling-client">11.1. Client re-enrollment in IdM</a><ol class="menu"><li class=" leaf"><a href="index.html#what-happens-during-client-re-enrollment_re-enrolling-client">11.1.1. What happens during client re-enrollment</a></li></ol></li><li class=" leaf"><a href="index.html#re-enrolling-a-client-by-using-user-credentials-interactive-re-enrollment_re-enrolling-client">11.2. Re-enrolling a client by using user credentials: Interactive re-enrollment</a></li><li class=" leaf"><a href="index.html#re-enrolling-idm-client-using-keytab-non-interactive_re-enrolling-client">11.3. Re-enrolling a client by using the client keytab: Non-interactive re-enrollment</a></li><li class=" leaf"><a href="index.html#testing-an-ipa-client_re-enrolling-client">11.4. Testing an IdM client</a></li></ol></li><li class=" leaf"><a href="index.html#uninstalling-an-ipa-client_installing-identity-management">12. Uninstalling an IdM client</a><ol class="menu"><li class=" leaf"><a href="index.html#uninstalling-an-ipa-client-procedure_installing-identity-management">12.1. Uninstalling an IdM client</a></li></ol></li><li class=" leaf"><a href="index.html#renaming-ipa-client-systems_installing-identity-management">13. Renaming IdM client systems</a><ol class="menu"><li class=" leaf"><a href="index.html#prerequisites_renaming-clients">13.1. Prerequisites</a></li><li class=" leaf"><a href="index.html#uninstalling-an-ipa-client-procedure_renaming-clients">13.2. Uninstalling an IdM client</a></li><li class=" leaf"><a href="index.html#renaming-the-ipa-client-system_renaming-clients">13.3. Renaming the host system</a></li><li class=" leaf"><a href="index.html#reinstalling-client_renaming-clients">13.4. Re-installing an IdM client</a></li><li class=" leaf"><a href="index.html#re-adding-services-re-generating-certificates-and-re-adding-host-groups_renaming-clients">13.5. Re-adding services, re-generating certificates, and re-adding host groups</a></li></ol></li><li class=" leaf"><a href="index.html#preparing-the-system-for-ipa-replica-installation_installing-identity-management">14. Preparing the system for IdM replica installation</a><ol class="menu"><li class=" leaf"><a href="index.html#replica-version-requirements_preparing-the-system-for-ipa-replica-installation">14.1. Replica version requirements</a></li><li class=" leaf"><a href="index.html#display-software-version_preparing-the-system-for-ipa-replica-installation">14.2. Methods for Displaying Identity Management Software Version</a></li></ol></li><li class=" leaf"><a href="index.html#installing-an-ipa-replica_installing-identity-management">15. Installing an IdM replica</a><ol class="menu"><li class=" leaf"><a href="index.html#prerequisites-for-installing-a-replica-on-an-ipa-client_install-replica">15.1. Prerequisites for installing a replica on an IdM client</a></li><li class=" leaf"><a href="index.html#prerequisites-for-installing-a-replica-on-a-system-outside-the-ipa-domain_install-replica">15.2. Prerequisites for installing a replica on a system outside the IdM domain</a></li><li class=" leaf"><a href="index.html#installing-an-ipa-replica-with-integrated-dns_install-replica">15.3. Installing an IdM replica with integrated DNS</a></li><li class=" leaf"><a href="index.html#installing-an-ipa-replica-with-a-ca-replica-prereqs_install-replica">15.4. Installing an IdM replica with a CA</a></li><li class=" leaf"><a href="index.html#installing-an-ipa-replica-without-a-ca_install-replica">15.5. Installing an IdM replica without a CA</a></li><li class=" leaf"><a href="index.html#installing-an-idm-hidden-replica_install-replica">15.6. Installing an IdM hidden replica</a></li><li class=" leaf"><a href="index.html#testing-an-ipa-replica_install-replica">15.7. Testing an IdM replica</a></li><li class=" leaf"><a href="index.html#connection-requests-during-an-ipa-replica-installation_install-replica">15.8. Connections performed during an IdM replica installation</a></li></ol></li><li class=" leaf"><a href="index.html#uninstalling-an-ipa-server2_installing-identity-management">16. Uninstalling an IdM replica</a></li><li class=" leaf"><a href="index.html#installing-the-ipa-healthcheck-tool_installing-identity-management">17. Installing the IdM Healthcheck tool</a><ol class="menu"><li class=" leaf"><a href="index.html#healthcheck-in-idm_installing-the-ipa-healthcheck-tool">17.1. Healthcheck in IdM</a><ol class="menu"><li class=" leaf"><a href="index.html#modules_are_independent">17.1.1. Modules are Independent</a></li><li class=" leaf"><a href="index.html#two_output_formats">17.1.2. Two output formats</a></li><li class=" leaf"><a href="index.html#results">17.1.3. Results</a></li><li class=" leaf"><a href="index.html#running_idm_healthcheck">17.1.4. Running IdM Healthcheck</a></li></ol></li><li class=" leaf"><a href="index.html#installing-ipa-healthcheck_installing-the-ipa-healthcheck-tool">17.2. Installing IdM Healthcheck</a></li><li class=" leaf"><a href="index.html#additional_resources_2">17.3. Additional resources</a></li></ol></li><li class=" leaf"><a href="index.html#installing-an-Identity-Management-server-using-an-Ansible-playbook_installing-identity-management">18. Installing an Identity Management server using an Ansible playbook</a><ol class="menu"><li class=" leaf"><a href="index.html#ansible-and-its-advantages-for-installing-IdM_server-ansible">18.1. Ansible and its advantages for installing IdM</a></li><li class=" leaf"><a href="index.html#IdM-server-installation-using-an-Ansible-playbook_server-ansible">18.2. IdM server installation using an Ansible playbook</a></li><li class=" leaf"><a href="index.html#installing-the-ansible-freeipa-package_server-ansible">18.3. Installing the ansible-freeipa package</a></li><li class=" leaf"><a href="index.html#ansible-roles-location-in-the-file-system_server-ansible">18.4. Ansible roles location in the file system</a></li><li class=" leaf"><a href="index.html#deploying-an-idm-server-with-an-integrated-CA-using-an-ansible-playbook_server-ansible">18.5. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook</a><ol class="menu"><li class=" leaf"><a href="index.html#setting-the-parameters-for-a-deployment-with-an-integrated-CA_server-ansible">18.5.1. Setting the parameters for a deployment with an integrated CA as the root CA</a></li><li class=" leaf"><a href="index.html#deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible">18.5.2. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook</a></li></ol></li><li class=" leaf"><a href="index.html#deploying-an-idm-server-with-an-external-CA-using-an-ansible-playbook_server-ansible">18.6. Deploying an IdM server with an external CA as the root CA using an Ansible playbook</a><ol class="menu"><li class=" leaf"><a href="index.html#setting-the-parameters-for-a-deployment-with-an-external-CA_server-ansible">18.6.1. Setting the parameters for a deployment with an external CA as the root CA</a></li><li class=" leaf"><a href="index.html#deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible">18.6.2. Deploying an IdM server with an external CA as the root CA using an Ansible playbook</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#installing-an-Identity-Management-replica-using-an-ansible-playbook_installing-identity-management">19. Installing an Identity Management replica using an Ansible playbook</a><ol class="menu"><li class=" leaf"><a href="index.html#ansible-and-its-advantages-for-installing-IdM_replica-ansible">19.1. Ansible and its advantages for installing IdM</a></li><li class=" leaf"><a href="index.html#IdM-replica-installation-using-an-Ansible-playbook-intro_replica-ansible">19.2. IdM replica installation using an Ansible playbook</a></li><li class=" leaf"><a href="index.html#installing-the-ansible-freeipa-package_replica-ansible">19.3. Installing the ansible-freeipa package</a></li><li class=" leaf"><a href="index.html#ansible-roles-location-in-the-file-system_replica-ansible">19.4. Ansible roles location in the file system</a></li><li class=" leaf"><a href="index.html#setting-the-parameters-of-the-IdM-replica-deployment_replica-ansible">19.5. Setting the parameters of the IdM replica deployment</a><ol class="menu"><li class=" leaf"><a href="index.html#specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible">19.5.1. Specifying the base, server and client variables for installing the IdM replica</a></li><li class=" leaf"><a href="index.html#specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible">19.5.2. Specifying the credentials for installing the IdM replica using an Ansible playbook</a></li></ol></li><li class=" leaf"><a href="index.html#deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible">19.6. Deploying an IdM replica using an Ansible playbook</a></li></ol></li><li class=" leaf"><a href="index.html#installing-an-Identity-Management-client-using-an-ansible-playbook_installing-identity-management">20. Installing an Identity Management client using an Ansible playbook</a><ol class="menu"><li class=" leaf"><a href="index.html#ansible-and-its-advantages-for-installing-IdM_client-ansible">20.1. Ansible and its advantages for installing IdM</a></li><li class=" leaf"><a href="index.html#IdM-client-installation-using-an-Ansible-playbook_client-ansible">20.2. IdM client installation using an Ansible playbook</a></li><li class=" leaf"><a href="index.html#installing-the-ansible-freeipa-package_client-ansible">20.3. Installing the ansible-freeipa package</a></li><li class=" leaf"><a href="index.html#ansible-roles-location-in-the-file-system_client-ansible">20.4. Ansible roles location in the file system</a></li><li class=" leaf"><a href="index.html#installing-ipa-client-ansible_client-ansible">20.5. Setting the parameters of the IdM client deployment</a><ol class="menu"><li class=" leaf"><a href="index.html#setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible">20.5.1. Setting the parameters of the inventory file for the autodiscovery client installation mode</a></li><li class=" leaf"><a href="index.html#setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible">20.5.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation</a></li><li class=" leaf"><a href="index.html#checking-the-parameters-in-the-install-client-yml-file_client-ansible">20.5.3. Checking the parameters in the install-client.yml file</a></li><li class=" leaf"><a href="index.html#authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible">20.5.4. Authorization options for IdM client enrollment using an Ansible playbook</a></li></ol></li><li class=" leaf"><a href="index.html#deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible">20.6. Deploying an IdM client using an Ansible playbook</a></li><li class=" leaf"><a href="index.html#testing-an-Identity-Management-after-Ansible-installation_client-ansible">20.7. Testing an Identity Management client after Ansible installation</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#integrating-idm-and-ad">II. Integrating IdM and AD</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-trust-between-idm-and-ad_installing-identity-management">21. Installing trust between IdM and AD</a><ol class="menu"><li class=" leaf"><a href="index.html#supported-versions-of-windows-server_installing-trust-between-idm-and-ad">21.1. Supported versions of Windows Server</a></li><li class=" leaf"><a href="index.html#how-the-trust-works_installing-trust-between-idm-and-ad">21.2. How the trust works</a></li><li class=" leaf"><a href="index.html#ad-administration-rights_installing-trust-between-idm-and-ad">21.3. AD administration rights</a></li><li class=" leaf"><a href="index.html#ports-required-for-communication-between-idm-and-ad_installing-trust-between-idm-and-ad">21.4. Ports required for communication between IdM and AD</a></li><li class=" leaf"><a href="index.html#configuring-dns-and-realm-settings-for-a-trust_installing-trust-between-idm-and-ad">21.5. Configuring DNS and realm settings for a trust</a><ol class="menu"><li class=" leaf"><a href="index.html#unique-primary-dns-domains_configuring-dns-and-realm-settings-for-a-trust">21.5.1. Unique primary DNS domains</a></li><li class=" leaf"><a href="index.html#configuring-dns-zones-in-idm_configuring-dns-and-realm-settings-for-a-trust">21.5.2. Configuring DNS zones in the IdM Web UI</a></li><li class=" leaf"><a href="index.html#configuring-dns-forwarding-in-ad_configuring-dns-and-realm-settings-for-a-trust">21.5.3. Configuring DNS forwarding in AD</a></li><li class=" leaf"><a href="index.html#verifying-the-dns-configuration_configuring-dns-and-realm-settings-for-a-trust">21.5.4. Verifying the DNS configuration</a></li></ol></li><li class=" leaf"><a href="index.html#setting-up-a-trust_installing-trust-between-idm-and-ad">21.6. Setting up a trust</a><ol class="menu"><li class=" leaf"><a href="index.html#preparing-the-idm-server-for-the-trust_setting-up-a-trust">21.6.1. Preparing the IdM server for the trust</a></li><li class=" leaf"><a href="index.html#setting-up-a-trust-agreement-using-the-command-line_setting-up-a-trust">21.6.2. Setting up a trust agreement using the command line</a></li><li class=" leaf"><a href="index.html#setting-up-the-trust-in-the-idm-web-ui_setting-up-a-trust">21.6.3. Setting up a trust agreement in the IdM Web UI</a></li><li class=" leaf"><a href="index.html#verifying-the-kerberos-configuration_setting-up-a-trust">21.6.4. Verifying the Kerberos configuration</a></li><li class=" leaf"><a href="index.html#verifying-the-trust-configuration-on-idm_setting-up-a-trust">21.6.5. Verifying the trust configuration on IdM</a></li><li class=" leaf"><a href="index.html#verifying-the-trust-configuration-on-ad_setting-up-a-trust">21.6.6. Verifying the trust configuration on AD</a></li></ol></li><li class=" leaf"><a href="index.html#removing-the-trust-using-the-idm-web-ui_installing-trust-between-idm-and-ad">21.7. Removing the trust using the IdM Web UI</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#migrating">III. Migrating IdM from RHEL 7 to RHEL 8 and keeping it up-to-date</a><ol class="menu"><li class=" leaf"><a href="index.html#migrate-7-to-8_migrating">22. Migrating IdM from RHEL 7 to 8</a><ol class="menu"><li class=" leaf"><a href="index.html#migrating-7-8-prereqs_migrate-7-to-8">22.1. Prerequisites for Migrating IdM from RHEL 7 to 8</a></li><li class=" leaf"><a href="index.html#install-replica_migrate-7-to-8">22.2. Installing the RHEL 8 Replica</a></li><li class=" leaf"><a href="index.html#move-ca-renewal-master-to-8_migrate-7-to-8">22.3. Moving the CA renewal master to RHEL 8</a></li><li class=" leaf"><a href="index.html#stopping-crl-generation-on-rhel7-IdM-CA-master_migrate-7-to-8">22.4. Stopping CRL generation on RHEL 7 IdM CA master</a></li><li class=" leaf"><a href="index.html#starting-crl-generation-on-rhel8-IdM-CA-master_migrate-7-to-8">22.5. Starting CRL generation on the new RHEL 8 IdM CA master</a></li><li class=" leaf"><a href="index.html#stop-decommission-server_migrate-7-to-8">22.6. Stopping and decommissioning the RHEL 7 server</a></li></ol></li><li class=" leaf"><a href="index.html#update-downgrade-ipa_migrate-7-to-8">23. Updating and downgrading IdM</a></li></ol></li><li class=" leaf"><a href="index.html#idm140081250494016">Legal Notice</a></li></ol>  </div>
</nav>


  <div class="doc-wrapper">
    <div class="panel-pane pane-training-banner"  >
  
      
  
  <div class="card card-light card-md push-bottom">
  <h2 class="card-heading card-heading-red card-heading-sm card-heading-flush">Red Hat Training</h2>
  <p>A Red Hat training course is available for <a href="https://www.redhat.com/en/services/training/courses-by-curriculum?intcmp=701f2000001D4OtAAK&amp;#Red-Hat-Enterprise-Linux" class="cta-link">RHEL 8</a></p>
</div>

  
  </div>
<div class="panel-pane pane-page-title"  >
  
      
  
  <h1 class="title" itemprop="name">Installing Identity Management</h1>
  
  </div>
<div class="panel-pane pane-page-body"  >
  
      
  
  <div class="body"><div xml:lang="en-US" class="book" id="idm140081248216320"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">8</span></div><div><h2 class="subtitle">Getting started using Identity Management</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="index.html#idm140081250494016">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This documentation collection provides instructions on how to install Identity Management on Red Hat Enterprise Linux 8 (RHEL) and how to upgrade to it from RHEL 7.
			</div></div></div></div><hr/></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_installing-identity-management"><div class="titlepage"><div><div><h1 class="title">Providing feedback on Red Hat documentation</h1></div></div></div><p>
			We appreciate your input on our documentation. Please let us know how we could make it better. To do so:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					For simple comments on specific passages:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Make sure you are viewing the documentation in the <span class="emphasis"><em>Multi-page HTML</em></span> format. In addition, ensure you see the <span class="strong strong"><strong>Feedback</strong></span> button in the upper right corner of the document.
						</li><li class="listitem">
							Use your mouse cursor to highlight the part of text that you want to comment on.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Add Feedback</strong></span> pop-up that appears below the highlighted text.
						</li><li class="listitem">
							Follow the displayed instructions.
						</li></ol></div></li><li class="listitem"><p class="simpara">
					For submitting more complex feedback, create a Bugzilla ticket:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Go to the <a class="link" href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20Enterprise%20Linux%208">Bugzilla</a> website.
						</li><li class="listitem">
							As the Component, use <span class="strong strong"><strong>Documentation</strong></span>.
						</li><li class="listitem">
							Fill in the <span class="strong strong"><strong>Description</strong></span> field with your suggestion for improvement. Include a link to the relevant part(s) of documentation.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit Bug</strong></span>.
						</li></ol></div></li></ul></div></section><div class="part" id="installing-idm"><div class="titlepage"><div><div><h1 class="title">Part I. Installing Identity Management</h1></div></div></div><section class="chapter" id="preparing-the-system-for-ipa-server-installation_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Preparing the system for IdM server installation</h2></div></div></div><p>
				The following sections list the requirements to install an Identity Management (IdM) server. Before the installation, make sure your system meets these requirements.
			</p><section class="section" id="hardware-recomendations_preparing-the-system-for-ipa-server-installation"><div class="titlepage"><div><div><h2 class="title">1.1. Hardware recommendations</h2></div></div></div><p>
					RAM is the most important hardware feature to size properly. Make sure your system has enough RAM available. Typical RAM requirements are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For 10,000 users and 100 groups: at least 3 GB of RAM and 1 GB swap space
						</li><li class="listitem">
							For 100,000 users and 50,000 groups: at least 16 GB of RAM and 4 GB of swap space
						</li></ul></div><p>
					For larger deployments, it is more effective to increase the RAM than to increase disk space because much of the data is stored in cache.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						A basic user entry or a simple host entry with a certificate is approximately 5—​10 kB in size.
					</p></div></div></section><section class="section" id="system-requirements-in-ipa_preparing-the-system-for-ipa-server-installation"><div class="titlepage"><div><div><h2 class="title">1.2. Custom configuration requirements for IdM</h2></div></div></div><p>
					Install an Identity Management (IdM) server on a clean system without any custom configuration for services such as DNS, Kerberos, Apache, or Directory Server.
				</p><p>
					The IdM server installation overwrites system files to set up the IdM domain. IdM backs up the original system files to <code class="literal">/var/lib/ipa/sysrestore/</code>. When an IdM server is uninstalled at the end of the lifecycle, these files are restored.
				</p><section class="section" id="ipv6_requirements_in_idm"><div class="titlepage"><div><div><h3 class="title">1.2.1. IPv6 requirements in IdM</h3></div></div></div><p>
						The IdM system must have the IPv6 protocol enabled in the kernel. If IPv6 is disabled, then the CLDAP plug-in used by the IdM services fails to initialize.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							IPv6 does not have to be enabled on the network.
						</p></div></div></section></section><section class="section" id="host-name-and-dns-requirements-for-ipa_preparing-the-system-for-ipa-server-installation"><div class="titlepage"><div><div><h2 class="title">1.3. Host name and DNS requirements for IdM</h2></div></div></div><p>
					This section lists the host name and DNS requirements for server and replica systems. It also shows how to verify that the systems meet the requirements.
				</p><p>
					The requirements in this section apply to all Identity Management (IdM) servers, those with integrated DNS and those without integrated DNS.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						DNS records are vital for nearly all IdM domain functions, including running LDAP directory services, Kerberos, and Active Directory integration. Be extremely cautious and ensure that:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a tested and functional DNS service available
							</li><li class="listitem">
								The service is properly configured
							</li></ul></div><p>
						This requirement applies to IdM servers with <span class="strong strong"><strong>and</strong></span> without integrated DNS.
					</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Verify the server host name</span></dt><dd><p class="simpara">
								The host name must be a fully qualified domain name, such as <code class="literal"><span class="emphasis"><em>server.example.com</em></span></code>.
							</p><p class="simpara">
								The fully qualified domain name must meet the following conditions:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										It is a valid DNS name, which means only numbers, alphabetic characters, and hyphens (-) are allowed. Other characters, such as underscores (_), in the host name cause DNS failures.
									</li><li class="listitem">
										It is all lower-case. No capital letters are allowed.
									</li><li class="listitem">
										It does not resolve to the loopback address. It must resolve to the system’s public IP address, not to <code class="literal">127.0.0.1</code>.
									</li></ul></div><p class="simpara">
								To verify the host name, use the <code class="literal">hostname</code> utility on the system where you want to install:
							</p><pre class="literallayout"># <span class="strong strong"><strong>hostname</strong></span>
server.idm.example.com</pre><p class="simpara">
								The output of <code class="literal">hostname</code> must not be <code class="literal">localhost</code> or <code class="literal">localhost6</code>.
							</p></dd><dt><span class="term">Verify the forward and reverse DNS configuration</span></dt><dd><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Obtain the IP address of the server.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												The <code class="literal command">ip addr show</code> command displays both the IPv4 and IPv6 addresses. In the following example, the relevant IPv6 address is <code class="literal">2001:DB8::1111</code> because its scope is global:
											</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ip addr show</strong></span>
...
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
	link/ether 00:1a:4a:10:4e:33 brd ff:ff:ff:ff:ff:ff
	inet <span class="strong strong"><strong>192.0.2.1</strong></span>/24 brd 192.0.2.255 scope global dynamic eth0
		valid_lft 106694sec preferred_lft 106694sec
	inet6 <span class="strong strong"><strong>2001:DB8::1111</strong></span>/32 scope global dynamic
 		valid_lft 2591521sec preferred_lft 604321sec
	inet6 fe80::56ee:75ff:fe2b:def6/64 scope link
	       valid_lft forever preferred_lft forever
...</pre></li></ol></div></li><li class="listitem"><p class="simpara">
										Verify the forward DNS configuration using the <code class="literal">dig</code> utility.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Run the command <code class="literal command">dig +short <span class="emphasis"><em>server.example.com</em></span> A</code>. The returned IPv4 address must match the IP address returned by <code class="literal">ip addr show</code>:
											</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>dig +short <span class="emphasis"><em>server.example.com</em></span> A</strong></span>
192.0.2.1</pre></li><li class="listitem"><p class="simpara">
												Run the command <code class="literal command">dig +short <span class="emphasis"><em>server.example.com</em></span> AAAA</code>. If it returns an address, it must match the IPv6 address returned by <code class="literal">ip addr show</code>:
											</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>dig +short <span class="emphasis"><em>server.example.com</em></span> AAAA</strong></span>
2001:DB8::1111</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
													If <code class="literal">dig</code> does not return any output for the AAAA record, it does not indicate incorrect configuration. No output only means that no IPv6 address is configured in DNS for the system. If you do not intend to use the IPv6 protocol in your network, you can proceed with the installation in this situation.
												</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
										Verify the reverse DNS configuration (PTR records). Use the <code class="literal">dig</code> utility and add the IP address.
									</p><p class="simpara">
										If the commands below display a different host name or no host name, even though <code class="literal command">dig +short <span class="emphasis"><em>server_host_name</em></span></code> in the previous step returned an IP address, it indicates that the reverse DNS configuration is incorrect.
									</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
												Run the command <code class="literal command">dig +short -x <span class="emphasis"><em>IPv4_address</em></span></code>. The output must display the server host name. For example:
											</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>dig +short -x <span class="emphasis"><em>192.0.2.1</em></span></strong></span>
server.example.com</pre></li><li class="listitem"><p class="simpara">
												If the command <code class="literal command">dig +short -x <span class="emphasis"><em>server.example.com</em></span> AAAA</code> in the previous step returned an IPv6 address, use <code class="literal">dig</code> to query the IPv6 address too. The output must display the server host name. For example:
											</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>dig +short -x <span class="emphasis"><em>2001:DB8::1111</em></span></strong></span>
server.example.com</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
													If <code class="literal command">dig +short <span class="emphasis"><em>server.example.com</em></span> AAAA</code> in the previous step did not display any IPv6 address, querying the AAAA record does not output anything. In this case, this is normal behavior and does not indicate incorrect configuration.
												</p></div></div></li></ol></div></li></ol></div></dd><dt><span class="term">Verify the standards-compliance of DNS forwarders (required for integrated DNS only)</span></dt><dd><p class="simpara">
								Ensure that all DNS forwarders you want to use with the IdM DNS server comply with the Extension Mechanisms for DNS (EDNS0) and DNS Security Extensions (DNSSEC) standards. To do this, inspect the output of the following command for each forwarder separately:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>dig +dnssec @<span class="emphasis"><em>IP_address_of_the_DNS_forwarder</em></span> . SOA</strong></span></pre><p class="simpara">
								The expected output displayed by the command contains the following information:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										status: <code class="literal">NOERROR</code>
									</li><li class="listitem">
										flags: <code class="literal">ra</code>
									</li><li class="listitem">
										EDNS flags: <code class="literal">do</code>
									</li><li class="listitem">
										The <code class="literal">RRSIG</code> record must be present in the <code class="literal">ANSWER</code> section
									</li></ul></div><p class="simpara">
								If any of these items is missing from the output, inspect the documentation for your DNS forwarder and verify that EDNS0 and DNSSEC are supported and enabled. In the latest versions of the BIND server, the <code class="literal option">dnssec-enable yes;</code> option must be set in the <code class="literal">/etc/named.conf</code> file.
							</p><p class="simpara">
								Example of the expected output produced by <code class="literal">dig</code>:
							</p><pre class="literallayout">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, <span class="strong strong"><strong>status: NOERROR</strong></span>, id: 48655
;; <span class="strong strong"><strong>flags:</strong></span> qr rd <span class="strong strong"><strong>ra</strong></span> ad; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, <span class="strong strong"><strong>flags: do;</strong></span> udp: 4096

;; ANSWER SECTION:
. 31679 IN SOA a.root-servers.net. nstld.verisign-grs.com. 2015100701 1800 900 604800 86400
. 31679 IN <span class="strong strong"><strong>RRSIG SOA</strong></span> 8 0 86400 20151017170000 20151007160000 62530 . GNVz7SQs [...]</pre></dd><dt><span class="term">Verify the <code class="literal">/etc/hosts</code> file</span></dt><dd><p class="simpara">
								Verify that the <code class="literal">/etc/hosts</code> file fulfills one of the following conditions:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The file does not contain an entry for the host. It only lists the IPv4 and IPv6 localhost entries for the host.
									</li><li class="listitem"><p class="simpara">
										The file contains an entry for the host and the file fulfills all the following conditions:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												The first two entries are the IPv4 and IPv6 localhost entries.
											</li><li class="listitem">
												The next entry specifies the IdM server IPv4 address and host name.
											</li><li class="listitem">
												The <code class="literal">FQDN</code> of the IdM server comes before the short name of the IdM server.
											</li><li class="listitem">
												The IdM server host name is not part of the localhost entry.
											</li></ul></div><p class="simpara">
										The following is an example of a correctly configured <code class="literal">/etc/hosts</code> file:
									</p></li></ul></div><pre class="screen">127.0.0.1	localhost.localdomain	localhost
::1		localhost6.localdomain6	localhost6
192.0.2.1	server.example.com	server
2001:DB8::1111	server.example.com	server</pre></dd></dl></div></section><section class="section" id="port-requirements-for-ipa_preparing-the-system-for-ipa-server-installation"><div class="titlepage"><div><div><h2 class="title">1.4. Port requirements for IdM</h2></div></div></div><p>
					Identity Management (IdM) uses a number of <a class="link" href="index.html#tab.ipa-ports_preparing-the-system-for-ipa-server-installation" title="Table 1.1. IdM ports">ports</a> to communicate with its services. These ports must be open and available for incoming connections to the IdM server for IdM to work. They must not be currently used by another service or blocked by a <a class="link" href="index.html#tab.firewalld-services_preparing-the-system-for-ipa-server-installation" title="Table 1.2. firewalld services">firewall</a>.
				</p><div class="table" id="tab.ipa-ports_preparing-the-system-for-ipa-server-installation"><p class="title"><strong>Table 1.1. IdM ports</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081260542736" scope="col">Service</th><th align="left" valign="top" id="idm140081259028000" scope="col">Ports</th><th align="left" valign="top" id="idm140081259026912" scope="col">Protocol</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081260542736"> <p>
									HTTP/HTTPS
								</p>
								 </td><td align="left" valign="top" headers="idm140081259028000"> <p>
									80, 443
								</p>
								 </td><td align="left" valign="top" headers="idm140081259026912"> <p>
									TCP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081260542736"> <p>
									LDAP/LDAPS
								</p>
								 </td><td align="left" valign="top" headers="idm140081259028000"> <p>
									389, 636
								</p>
								 </td><td align="left" valign="top" headers="idm140081259026912"> <p>
									TCP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081260542736"> <p>
									Kerberos
								</p>
								 </td><td align="left" valign="top" headers="idm140081259028000"> <p>
									88, 464
								</p>
								 </td><td align="left" valign="top" headers="idm140081259026912"> <p>
									TCP and UDP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081260542736"> <p>
									DNS
								</p>
								 </td><td align="left" valign="top" headers="idm140081259028000"> <p>
									53
								</p>
								 </td><td align="left" valign="top" headers="idm140081259026912"> <p>
									TCP and UDP (optional)
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081260542736"> <p>
									NTP
								</p>
								 </td><td align="left" valign="top" headers="idm140081259028000"> <p>
									123
								</p>
								 </td><td align="left" valign="top" headers="idm140081259026912"> <p>
									UDP (optional)
								</p>
								 </td></tr></tbody></table></div></div><p>
					In addition, ports 8080, 8443, and 749 must be free as they are used internally. Do not open these ports and instead leave them blocked by a firewall.
				</p><div class="table" id="tab.firewalld-services_preparing-the-system-for-ipa-server-installation"><p class="title"><strong>Table 1.2. <code class="literal">firewalld</code> services</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081275883984" scope="col">Service name</th><th align="left" valign="top" id="idm140081275882896" scope="col">For details, see:</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081275883984"> <p>
									<code class="literal">freeipa-ldap</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140081275882896"> <p>
									<code class="literal">/usr/lib/firewalld/services/freeipa-ldap.xml</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081275883984"> <p>
									<code class="literal">freeipa-ldaps</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140081275882896"> <p>
									<code class="literal">/usr/lib/firewalld/services/freeipa-ldaps.xml</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081275883984"> <p>
									<code class="literal">dns</code>
								</p>
								 </td><td align="left" valign="top" headers="idm140081275882896"> <p>
									<code class="literal">/usr/lib/firewalld/services/dns.xml</code>
								</p>
								 </td></tr></tbody></table></div></div><h4 id="opening_the_required_ports">Opening the required ports</h4><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Make sure the <code class="literal">firewalld</code> service is running.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To find out if <code class="literal">firewalld</code> is currently running:
								</p><pre class="screen"># systemctl status firewalld.service</pre></li><li class="listitem"><p class="simpara">
									To start <code class="literal">firewalld</code> and configure it to start automatically when the system boots:
								</p><pre class="screen"># systemctl start firewalld.service
# systemctl enable firewalld.service</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							Open the required ports using the <code class="literal">firewall-cmd</code> utility. Choose one of the following options:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Add the individual ports to the firewall by using the <code class="literal command">firewall-cmd --add-port</code> command. For example, to open the ports in the default zone:
								</p><pre class="screen"># firewall-cmd --permanent --add-port={80/tcp,443/tcp,389/tcp,636/tcp,88/tcp,88/udp,464/tcp,464/udp,53/tcp,53/udp,123/udp}</pre></li><li class="listitem"><p class="simpara">
									Add the <code class="literal">firewalld</code> services to the firewall by using the <code class="literal command">firewall-cmd --add-service</code> command. For example, to open the ports in the default zone:
								</p><pre class="screen"># firewall-cmd --permanent --add-service={freeipa-ldap,freeipa-ldaps,dns}</pre><p class="simpara">
									For details on using <code class="literal">firewall-cmd</code> to open ports on a system, see the <span class="strong strong"><strong>firewall-cmd</strong></span>(1) man page.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Reload the <code class="literal">firewall-cmd</code> configuration to ensure that the change takes place immediately:
						</p><pre class="screen"># firewall-cmd --reload</pre><p class="simpara">
							Note that reloading <code class="literal">firewalld</code> on a system in production can cause DNS connection time outs. If required, to avoid the risk of time outs and to make the changes persistent on the running system, use the <code class="literal">--runtime-to-permanent</code> option of the <code class="literal">firewall-cmd</code> command, for example:
						</p><pre class="screen"># firewall-cmd --runtime-to-permanent</pre></li><li class="listitem">
							<span class="strong strong"><strong>Optional.</strong></span> To verify that the ports are available now, use the <code class="literal">nc</code>, <code class="literal">telnet</code>, or <code class="literal">nmap</code> utilities to connect to a port or run a port scan.
						</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Note that you also have to open network-based firewalls for both incoming and outgoing traffic.
					</p></div></div></section><section class="section" id="packages-required-for-an-ipa-server_preparing-the-system-for-ipa-server-installation"><div class="titlepage"><div><div><h2 class="title">1.5. Installing packages required for an IdM server</h2></div></div></div><p>
					In RHEL8, the packages necessary for installing an Identity Management (IdM) server are shipped as a module. The IdM server module stream is called the <code class="literal stream">DL1</code> stream, and you need to enable this stream before downloading packages from this stream. The following procedure shows how to download the packages necessary for setting up the IdM environment of your choice.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have a newly installed RHEL system.
						</li><li class="listitem">
							You have registered your system with the Red Hat Subscription Manager (RHSM). For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index#reg-cli">Registration, attaching, and removing subscriptions in the Subscription Manager command line</a>.
						</li><li class="listitem">
							You have not previously enabled an IdM module stream.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enable the <code class="literal">BaseOS</code> and <code class="literal">AppStream</code> repositories that IdM uses:
						</p><pre class="literallayout"># <span class="strong strong"><strong>subscription-manager repos --enable=rhel-8-for-x86_64-baseos-rpms</strong></span>
# <span class="strong strong"><strong>subscription-manager repos --enable=rhel-8-for-x86_64-appstream-rpms</strong></span></pre><p class="simpara">
							For details on how to enable and disable specific repositories using RHSM, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index#repos">Configuring options in Red Hat Subscription Manager</a>.
						</p></li><li class="listitem"><p class="simpara">
							Enable the <code class="literal stream">idm:DL1</code> stream:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum module enable idm:DL1</strong></span></pre></li><li class="listitem"><p class="simpara">
							Switch to the RPMs delivered through the <code class="literal stream">idm:DL1</code> stream:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum distro-sync</strong></span></pre></li><li class="listitem"><p class="simpara">
							Choose one of the following options, depending on your IdM requirements:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To download the packages necessary for installing an IdM server without an integrated DNS:
								</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm:DL1/server</strong></span></pre></li><li class="listitem"><p class="simpara">
									To download the packages necessary for installing an IdM server with an integrated DNS:
								</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm:DL1/dns</strong></span></pre></li><li class="listitem"><p class="simpara">
									To download the packages necessary for installing an IdM server that has a trust agreement with Active Directory:
								</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm:DL1/adtrust</strong></span></pre></li><li class="listitem"><p class="simpara">
									To download the packages from multiple profiles, for example the <code class="literal stream">adtrust</code> and <code class="literal stream">dns</code> profiles:
								</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm:DL1/{dns,adtrust}</strong></span></pre></li><li class="listitem"><p class="simpara">
									To download the packages necessary for installing an IdM client:
								</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm:DL1/client</strong></span></pre></li></ul></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						When switching to a new module stream once you have already enabled a different stream and downloaded packages from it, you need to first explicitly remove all the relevant installed content and disable the current module stream before enabling the new module stream. Trying to enable a new stream without disabling the current one results in an error. For details on how to proceed, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_managing_and_removing_user-space_components/index#switching-to-a-later-stream_managing-versions-of-appstream-content">Switching to a later stream</a>.
					</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						While it is possible to install packages from modules individually, be aware that if you install any package from a module that is not listed as "API" for that module, it is only going to be supported by Red Hat in the context of that module. For example, if you install <code class="literal package">bind-dyndb-ldap</code> directly from the repository to use with your custom 389 Directory Server setup, any problems that you have will be ignored unless they occur for IdM, too.
					</p></div></div></section></section><section class="chapter" id="installing-an-ipa-server-with-integrated-dns_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Installing an IdM server: With integrated DNS, with an integrated CA as the root CA</h2></div></div></div><p>
				Installing a new Identity Management (IdM) server with integrated DNS has the following advantages:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You can automate much of the maintenance and DNS record management using native IdM tools. For example, DNS SRV records are automatically created during the setup, and later on are automatically updated.
					</li><li class="listitem">
						You can have a stable connection with the rest of the Internet by setting up global forwarders during the installation of the IdM server. Global forwarders are also useful for trusts with Active Directory.
					</li><li class="listitem">
						You can set up a DNS reverse zone to prevent emails from your domain to be considered spam by email servers outside of the IdM domain.
					</li></ul></div><p>
				Installing IdM with integrated DNS has certain limitations:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM DNS is not meant to be used as a general-purpose DNS server. Some of the advanced DNS functions are not supported.
					</li></ul></div><p>
				This chapter describes how you can install a new IdM server with an integrated certificate authority (CA) as the root CA.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The default configuration for the <span class="strong strong"><strong>ipa-server-install</strong></span> command is an integrated CA as the root CA. If no CA option, for example <code class="literal option">--external-ca</code> or <code class="literal option">--ca-less</code> is specified, the IdM server is installed with an integrated CA.
				</p></div></div><section class="section" id="installing-ipa-server-with-dns-interactive-install_install-server-with-dns"><div class="titlepage"><div><div><h2 class="title">2.1. Interactive installation</h2></div></div></div><p>
					During the interactive installation using the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code> utility, you are asked to supply basic configuration of the system, for example the realm, the administrator’s password and the Directory Manager’s password.
				</p><p>
					The <code class="literal">ipa-server-install</code> installation script creates a log file at <code class="literal">/var/log/ipaserver-install.log</code>. If the installation fails, the log can help you identify the problem.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <span class="strong strong"><strong>ipa-server-install</strong></span> utility.
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-install</strong></span></pre></li><li class="listitem"><p class="simpara">
							The script prompts to configure an integrated DNS service. Enter <code class="literal">yes</code>.
						</p><pre class="screen">Do you want to configure integrated DNS (BIND)? [no]: <code class="literal">yes</code></pre></li><li class="listitem"><p class="simpara">
							The script prompts for several required settings and offers recommended default values in brackets.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To accept a default value, press <span class="keycap"><strong>Enter</strong></span>.
								</li><li class="listitem"><p class="simpara">
									To provide a custom value, enter the required value.
								</p><pre class="screen">Server host name [server.example.com]:
Please confirm the domain name [example.com]:
Please provide a realm name [EXAMPLE.COM]:</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
										Plan these names carefully. You will not be able to change them after the installation is complete.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Enter the passwords for the Directory Server superuser (<code class="literal">cn=Directory Manager</code>) and for the Identity Management (IdM) administration system user account (<code class="literal">admin</code>).
						</p><pre class="screen">Directory Manager password:
IPA admin password:</pre></li><li class="listitem"><p class="simpara">
							The script prompts for DNS forwarders.
						</p><pre class="screen">Do you want to configure DNS forwarders? [yes]:</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To configure DNS forwarders, enter <code class="literal">yes</code>, and then follow the instructions on the command line. The installation process will add the forwarder IP addresses to the <code class="literal">/etc/named.conf</code> file on the installed IdM server.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											For the forwarding policy default settings, see the <code class="literal option">--forward-policy</code> description in the <span class="strong strong"><strong>ipa-dns-install</strong></span>(1) man page.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									If you do not want to use DNS forwarding, enter <code class="literal">no</code>.
								</p><p class="simpara">
									With no DNS forwarders, your environment will be isolated, and names from other DNS domains in your infrastructure will not be resolved.
								</p></li></ul></div></li><li class="listitem"><p class="simpara">
							The script prompts to check if any DNS reverse (PTR) records for the IP addresses associated with the server need to be configured.
						</p><pre class="screen">Do you want to search for missing reverse zones? [yes]:</pre><p class="simpara">
							If you run the search and missing reverse zones are discovered, the script asks you whether to create the reverse zones along with the PTR records.
						</p><pre class="screen">Do you want to create reverse zone for IP 192.0.2.1 [yes]:
Please specify the reverse zone name [2.0.192.in-addr.arpa.]:
Using reverse zone(s) 2.0.192.in-addr.arpa.</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Using IdM to manage reverse zones is optional. You can use an external DNS service for this purpose instead.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Enter <code class="literal">yes</code> to confirm the server configuration.
						</p><pre class="screen">Continue to configure the system with these values? [no]: <code class="literal">yes</code></pre></li><li class="listitem">
							The installation script now configures the server. Wait for the operation to complete.
						</li><li class="listitem"><p class="simpara">
							After the installation script completes, add DNS delegation from the parent domain to the IdM DNS domain. For example, if the IdM DNS domain is <code class="literal">ipa.example.com</code>, add a name server (NS) record to the <code class="literal">example.com</code> parent domain.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Repeat this step each time after an IdM DNS server is installed.
							</p></div></div></li></ol></div></section><section class="section" id="installing-an-ipa-server-with-integrated-dns-non-interactive-installation_install-server-with-dns"><div class="titlepage"><div><div><h2 class="title">2.2. Non-interactive installation</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">ipa-server-install</code> installation script creates a log file at <code class="literal">/var/log/ipaserver-install.log</code>. If the installation fails, the log can help you identify the problem.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <span class="strong strong"><strong>ipa-server-install</strong></span> utility with the options to supply all the required information. The minimum required options for non-interactive installation are:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">--realm</code> to provide the Kerberos realm name
								</li><li class="listitem">
									<code class="literal">--ds-password</code> to provide the password for the Directory Manager (DM), the Directory Server super user
								</li><li class="listitem">
									<code class="literal">--admin-password</code> to provide the password for <code class="literal">admin</code>, the Identity Management (IdM) administrator
								</li><li class="listitem">
									<code class="literal">--unattended</code> to let the installation process select default options for the host name and domain name
								</li></ul></div><p class="simpara">
							To install a server with integrated DNS, add also these options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">--setup-dns</code> to configure integrated DNS
								</li><li class="listitem">
									<code class="literal">--forwarder</code> or <code class="literal">--no-forwarders</code>, depending on whether you want to configure DNS forwarders or not
								</li><li class="listitem">
									<code class="literal">--auto-reverse</code> or <code class="literal">--no-reverse</code>, depending on whether you want to configure automatic detection of the reverse DNS zones that must be created in the IdM DNS or no reverse zone auto-detection
								</li></ul></div><p class="simpara">
							For example:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-install --realm <span class="emphasis"><em>EXAMPLE.COM</em></span> --ds-password <span class="emphasis"><em>DM_password</em></span> --admin-password <span class="emphasis"><em>admin_password</em></span> --unattended --setup-dns --forwarder <span class="emphasis"><em>192.0.2.1</em></span> --no-reverse</strong></span></pre></li><li class="listitem"><p class="simpara">
							After the installation script completes, add DNS delegation from the parent domain to the IdM DNS domain. For example, if the IdM DNS domain is <code class="literal"><span class="emphasis"><em>ipa.example.com</em></span></code>, add a name server (NS) record to the <code class="literal">example.com</code> parent domain.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Repeat this step each time after an IdM DNS server is installed.
							</p></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For a complete list of options accepted by <span class="strong strong"><strong>ipa-server-install</strong></span>, run the <code class="literal">ipa-server-install --help</code> command.
						</li></ul></div></section></section><section class="chapter" id="installing-an-ipa-server-with-external-ca_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Installing an IdM server: With integrated DNS, with an external CA as the root CA</h2></div></div></div><p>
				Installing a new Identity Management (IdM) server with integrated DNS has the following advantages:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You can automate much of the maintenance and DNS record management using native IdM tools. For example, DNS SRV records are automatically created during the setup, and later on are automatically updated.
					</li><li class="listitem">
						You can have a stable connection with the rest of the Internet by setting up global forwarders during the installation of the IdM server. Global forwarders are also useful for trusts with Active Directory.
					</li><li class="listitem">
						You can set up a DNS reverse zone to prevent emails from your domain to be considered spam by email servers outside of the IdM domain.
					</li></ul></div><p>
				Installing IdM with integrated DNS has certain limitations:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM DNS is not meant to be used as a general-purpose DNS server. Some of the advanced DNS functions are not supported.
					</li></ul></div><p>
				This chapter describes how you can install a new IdM server with an external certificate authority (CA) as the root CA.
			</p><section class="section" id="installing-an-ipa-server-with-an-external-ca-as-the-root-ca_install-server-external-ca"><div class="titlepage"><div><div><h2 class="title">3.1. Interactive installation</h2></div></div></div><p>
					During the interactive installation using the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code> utility, you are asked to supply basic configuration of the system, for example the realm, the administrator’s password and the Directory Manager’s password.
				</p><p>
					The <code class="literal">ipa-server-install</code> installation script creates a log file at <code class="literal">/var/log/ipaserver-install.log</code>. If the installation fails, the log can help you identify the problem.
				</p><p>
					This procedure describes how to install a server:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							with integrated DNS
						</li><li class="listitem">
							with an external certificate authority (CA) as the root CA
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Decide on the type of the external CA you use (the <code class="literal option">--external-ca-type</code> option). See the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code>(1) man page for details.
						</li><li class="listitem"><p class="simpara">
							Alternatively, decide on the <code class="literal option">--external-ca-profile</code> option allowing an alternative Active Directory Certificate Services (AD CS) template to be specified. For example, to specify an AD CS installation-specific object identifier:
						</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa-server-install --external-ca --external-ca-type=ms-cs --external-ca-profile=1.3.6.1.4.1.311.21.8.8950086.10656446.2706058.12775672.480128.147.7130143.4405632:1</strong></span></pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <span class="strong strong"><strong>ipa-server-install</strong></span> utility with the <code class="literal">--external-ca</code> option.
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-install --external-ca</strong></span></pre><p class="simpara">
							If you are using the Microsoft Certificate Services CA, use also the <code class="literal">--external-ca-type</code> option. For details, see the <span class="strong strong"><strong>ipa-server-install</strong></span>(1) man page.
						</p></li><li class="listitem"><p class="simpara">
							The script prompts to configure an integrated DNS service. Enter <code class="literal">yes</code> or <code class="literal">no</code>. In this procedure, we are installing a server with integrated DNS.
						</p><pre class="screen">Do you want to configure integrated DNS (BIND)? [no]: <code class="literal">yes</code></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If you want to install a server without integrated DNS, the installation script will not prompt you for DNS configuration as described in the steps below. See <a class="xref" href="index.html#installing-an-ipa-server-without-integrated-dns_installing-identity-management" title="Chapter 5. Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA">Chapter 5, <em>Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA</em></a> for details on the steps for installing a server without DNS.
							</p></div></div></li><li class="listitem"><p class="simpara">
							The script prompts for several required settings and offers recommended default values in brackets.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To accept a default value, press <span class="keycap"><strong>Enter</strong></span>.
								</li><li class="listitem"><p class="simpara">
									To provide a custom value, enter the required value.
								</p><pre class="screen">Server host name [<code class="literal"><span class="emphasis"><em>server.example.com</em></span></code>]:
Please confirm the domain name [<code class="literal"><span class="emphasis"><em>example.com</em></span></code>]:
Please provide a realm name [<code class="literal"><span class="emphasis"><em>EXAMPLE.COM</em></span></code>]:</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
										Plan these names carefully. You will not be able to change them after the installation is complete.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Enter the passwords for the Directory Server superuser (<code class="literal">cn=Directory Manager</code>) and for the Identity Management (IdM) administration system user account (<code class="literal">admin</code>).
						</p><pre class="screen">Directory Manager password:
IPA admin password:</pre></li><li class="listitem"><p class="simpara">
							The script prompts for DNS forwarders.
						</p><pre class="screen">Do you want to configure DNS forwarders? [yes]:</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To configure DNS forwarders, enter <code class="literal">yes</code>, and then follow the instructions on the command line. The installation process will add the forwarder IP addresses to the <code class="literal">/etc/named.conf</code> file on the installed IdM server.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											For the forwarding policy default settings, see the <code class="literal option">--forward-policy</code> description in the <span class="strong strong"><strong>ipa-dns-install</strong></span>(1) man page.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									If you do not want to use DNS forwarding, enter <code class="literal">no</code>.
								</p><p class="simpara">
									With no DNS forwarders, your environment will be isolated, and names from other DNS domains in your infrastructure will not be resolved.
								</p></li></ul></div></li><li class="listitem"><p class="simpara">
							The script prompts to check if any DNS reverse (PTR) records for the IP addresses associated with the server need to be configured.
						</p><pre class="screen">Do you want to search for missing reverse zones? [yes]:</pre><p class="simpara">
							If you run the search and missing reverse zones are discovered, the script asks you whether to create the reverse zones along with the PTR records.
						</p><pre class="screen">Do you want to create reverse zone for IP 192.0.2.1 [yes]:
Please specify the reverse zone name [2.0.192.in-addr.arpa.]:
Using reverse zone(s) 2.0.192.in-addr.arpa.</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Using IdM to manage reverse zones is optional. You can use an external DNS service for this purpose instead.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Enter <code class="literal">yes</code> to confirm the server configuration.
						</p><pre class="screen">Continue to configure the system with these values? [no]: <code class="literal">yes</code></pre></li><li class="listitem"><p class="simpara">
							During the configuration of the Certificate System instance, the utility prints the location of the certificate signing request (CSR): <code class="literal">/root/ipa.csr</code>:
						</p><pre class="screen">...

Configuring certificate server (pki-tomcatd): Estimated time 3 minutes 30 seconds
  [1/8]: creating certificate server user
  [2/8]: configuring certificate server instance
The next step is to get /root/ipa.csr signed by your CA and re-run /sbin/ipa-server-install as:
/sbin/ipa-server-install --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate</pre><p class="simpara">
							When this happens:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Submit the CSR located in <code class="literal">/root/ipa.csr</code> to the external CA. The process differs depending on the service to be used as the external CA.
								</li><li class="listitem"><p class="simpara">
									Retrieve the issued certificate and the CA certificate chain for the issuing CA in a base 64-encoded blob (either a PEM file or a Base_64 certificate from a Windows CA). Again, the process differs for every certificate service. Usually, a download link on a web page or in the notification email allows the administrator to download all the required certificates.
								</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										Be sure to get the full certificate chain for the CA, not just the CA certificate.
									</p></div></div></li><li class="listitem"><p class="simpara">
									Run <code class="literal">ipa-server-install</code> again, this time specifying the locations and names of the newly-issued CA certificate and the CA chain files. For example:
								</p><pre class="screen"># ipa-server-install --external-cert-file=<span class="emphasis"><em>/tmp/servercert20170601.pem</em></span> --external-cert-file=<span class="emphasis"><em>/tmp/cacert.pem</em></span></pre></li></ol></div></li><li class="listitem">
							The installation script now configures the server. Wait for the operation to complete.
						</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal command">ipa-server-install --external-ca</code> command can sometimes fail with the following error:
					</p><pre class="screen">ipa         : CRITICAL failed to configure ca instance Command '/usr/sbin/pkispawn -s CA -f /tmp/<span class="emphasis"><em>configuration_file</em></span>' returned non-zero exit status 1
Configuration of CA failed</pre><p>
						This failure occurs when the <code class="literal">*_proxy</code> environmental variables are set. For a solution of the problem, see <a class="xref" href="index.html#troubleshooting-external-ca-installation-fails" title="3.2. Troubleshooting: External CA installation fails">Section 3.2, “Troubleshooting: External CA installation fails”</a>.
					</p></div></div></section><section class="section" id="troubleshooting-external-ca-installation-fails"><div class="titlepage"><div><div><h2 class="title">3.2. Troubleshooting: External CA installation fails</h2></div></div></div><p>
					The <code class="literal command">ipa-server-install --external-ca</code> command fails with the following error:
				</p><pre class="literallayout">ipa         : CRITICAL failed to configure ca instance Command '/usr/sbin/pkispawn -s CA -f /tmp/<span class="emphasis"><em>configuration_file</em></span>' returned non-zero exit status 1
Configuration of CA failed</pre><p>
					The <code class="literal command">env|grep proxy</code> command displays variables such as the following:
				</p><pre class="literallayout"># <span class="strong strong"><strong>env|grep proxy</strong></span>
http_proxy=http://example.com:8080
ftp_proxy=http://example.com:8080
https_proxy=http://example.com:8080</pre><h4 id="what_this_means">What this means:</h4><p>
					The <code class="literal">*_proxy</code> environmental variables are preventing the server from being installed.
				</p><h4 id="to_fix_the_problem">To fix the problem:</h4><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the following shell script to unset the <code class="literal">*_proxy</code> environmental variables:
						</p><pre class="literallayout"># <span class="strong strong"><strong>for i in ftp http https; do unset ${i}_proxy; done</strong></span></pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">pkidestroy</code> utility to remove the unsuccessful certificate authority (CA) subsystem installation:
						</p><pre class="literallayout"># <span class="strong strong"><strong>pkidestroy -s CA -i pki-tomcat; rm -rf /var/log/pki/pki-tomcat /etc/sysconfig/pki-tomcat /etc/sysconfig/pki/tomcat/pki-tomcat /var/lib/pki/pki-tomcat /etc/pki/pki-tomcat /root/ipa.csr</strong></span></pre></li><li class="listitem"><p class="simpara">
							Remove the failed Identity Management (IdM) server installation:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-install --uninstall</strong></span></pre></li><li class="listitem">
							Retry running <code class="literal command">ipa-server-install --external-ca</code>.
						</li></ol></div></section></section><section class="chapter" id="installing-an-ipa-server-without-a-ca_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Installing an IdM server: With integrated DNS, without a CA</h2></div></div></div><p>
				Installing a new Identity Management (IdM) server with integrated DNS has the following advantages:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You can automate much of the maintenance and DNS record management using native IdM tools. For example, DNS SRV records are automatically created during the setup, and later on are automatically updated.
					</li><li class="listitem">
						You can have a stable connection with the rest of the Internet by setting up global forwarders during the installation of the IdM server. Global forwarders are also useful for trusts with Active Directory.
					</li><li class="listitem">
						You can set up a DNS reverse zone to prevent emails from your domain to be considered spam by email servers outside of the IdM domain.
					</li></ul></div><p>
				Installing IdM with integrated DNS has certain limitations:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM DNS is not meant to be used as a general-purpose DNS server. Some of the advanced DNS functions are not supported.
					</li></ul></div><p>
				This chapter describes how you can install a new IdM server without a certificate authority (CA).
			</p><section class="section" id="certificates-required-to-install-ipa-server-no-ca_install-server-no-ca"><div class="titlepage"><div><div><h2 class="title">4.1. Certificates required to install an IdM server without a CA</h2></div></div></div><p>
					This section lists:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							the certificates required to install an Identity Management (IdM) server without a certificate authority (CA)
						</li><li class="listitem">
							the command-line options used to provide these certificates to the <code class="literal">ipa-server-install</code> utility
						</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You cannot install a server or replica using self-signed third-party server certificates because the imported certificate files must contain the full CA certificate chain of the CA that issued the LDAP and Apache server certificates.
					</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">The LDAP server certificate and private key</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal option">--dirsrv-cert-file</code> for the certificate and private key files for the LDAP server certificate
									</li><li class="listitem">
										<code class="literal option">--dirsrv-pin</code> for the password to access the private key in the files specified in <code class="literal option">--dirsrv-cert-file</code>
									</li></ul></div></dd><dt><span class="term">The Apache server certificate and private key</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal option">--http-cert-file</code> for the certificate and private key files for the Apache server certificate
									</li><li class="listitem">
										<code class="literal option">--http-pin</code> for the password to access the private key in the files specified in <code class="literal option">--http-cert-file</code>
									</li></ul></div></dd><dt><span class="term">The full CA certificate chain of the CA that issued the LDAP and Apache server certificates</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal option">--dirsrv-cert-file</code> and <code class="literal option">--http-cert-file</code> for the certificate files with the full CA certificate chain or a part of it
									</li></ul></div></dd></dl></div><p>
					You can provide the files specified in the <code class="literal option">--dirsrv-cert-file</code> and <code class="literal option">--http-cert-file</code> options in the following formats:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Privacy-Enhanced Mail (PEM) encoded certificate (RFC 7468). Note that the Identity Management installer accepts concatenated PEM-encoded objects.
						</li><li class="listitem">
							Distinguished Encoding Rules (DER)
						</li><li class="listitem">
							PKCS #7 certificate chain objects
						</li><li class="listitem">
							PKCS #8 private key objects
						</li><li class="listitem">
							PKCS #12 archives
						</li></ul></div><p>
					You can specify the <code class="literal option">--dirsrv-cert-file</code> and <code class="literal option">--http-cert-file</code> options multiple times to specify multiple files.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">The certificate files to complete the full CA certificate chain (not needed in some environments)</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal option">--ca-cert-file</code> for the file or files containing the CA certificate of the CA that issued the LDAP, Apache Server, and Kerberos KDC certificates. Use this option if the CA certificate is not present in the certificate files provided by the other options.
									</li></ul></div></dd></dl></div><p>
					The files provided using <code class="literal option">--dirsrv-cert-file</code> and <code class="literal option">--http-cert-file</code> combined with the file provided using <code class="literal option">--ca-cert-file</code> must contain the full CA certificate chain of the CA that issued the LDAP and Apache server certificates.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">The Kerberos key distribution center (KDC) PKINIT certificate and private key (optional)</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal option">--pkinit-cert-file</code> for the Kerberos KDC SSL certificate and private key
									</li><li class="listitem">
										<code class="literal option">--pkinit-pin</code> for the password to access the Kerberos KDC private key in the files specified in <code class="literal option">--pkinit-cert-file</code>
									</li><li class="listitem">
										<code class="literal option">--no-pkinit</code> for disabling pkinit setup steps
									</li></ul></div></dd></dl></div><p>
					If you do not provide the PKINIT certificate, <code class="literal">ipa-server-install</code> configures the IdM server with a local KDC with a self-signed certificate.
				</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For details on what the certificate file formats these options accept, see the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code>(1) man page.
						</li></ul></div></section><section class="section" id="installing-ipa-server-with-dns-interactive-install_install-server-no-ca"><div class="titlepage"><div><div><h2 class="title">4.2. Interactive installation</h2></div></div></div><p>
					During the interactive installation using the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code> utility, you are asked to supply basic configuration of the system, for example the realm, the administrator’s password and the Directory Manager’s password.
				</p><p>
					The <code class="literal">ipa-server-install</code> installation script creates a log file at <code class="literal">/var/log/ipaserver-install.log</code>. If the installation fails, the log can help you identify the problem.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code> utility and provide all the required certificates. For example:
						</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa-server-install \</strong></span>
    <span class="strong strong"><strong>--http-cert-file <span class="emphasis"><em>/tmp/server.crt</em></span> \</strong></span>
    <span class="strong strong"><strong>--http-cert-file <span class="emphasis"><em>/tmp/server.key</em></span> \</strong></span>
    <span class="strong strong"><strong>--http-pin <span class="emphasis"><em>secret</em></span> \</strong></span>
    <span class="strong strong"><strong>--dirsrv-cert-file <span class="emphasis"><em>/tmp/server.crt</em></span> \</strong></span>
    <span class="strong strong"><strong>--dirsrv-cert-file <span class="emphasis"><em>/tmp/server.key</em></span> \</strong></span>
    <span class="strong strong"><strong>--dirsrv-pin <span class="emphasis"><em>secret</em></span> \</strong></span>
    <span class="strong strong"><strong>--ca-cert-file <span class="emphasis"><em>ca.crt</em></span></strong></span></pre><p class="simpara">
							See <a class="xref" href="index.html#certificates-required-to-install-ipa-server-no-ca_install-server-no-ca" title="4.1. Certificates required to install an IdM server without a CA">Section 4.1, “Certificates required to install an IdM server without a CA”</a> for details on the provided certificates.
						</p></li><li class="listitem"><p class="simpara">
							The script prompts to configure an integrated DNS service. Enter <code class="literal">yes</code> or <code class="literal">no</code>. In this procedure, we are installing a server with integrated DNS.
						</p><pre class="screen">Do you want to configure integrated DNS (BIND)? [no]: <code class="literal">yes</code></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If you want to install a server without integrated DNS, the installation script will not prompt you for DNS configuration as described in the steps below. See <a class="xref" href="index.html#installing-an-ipa-server-without-integrated-dns_installing-identity-management" title="Chapter 5. Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA">Chapter 5, <em>Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA</em></a> for details on the steps for installing a server without DNS.
							</p></div></div></li><li class="listitem"><p class="simpara">
							The script prompts for several required settings and offers recommended default values in brackets.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To accept a default value, press <span class="keycap"><strong>Enter</strong></span>.
								</li><li class="listitem"><p class="simpara">
									To provide a custom value, enter the required value.
								</p><pre class="screen">Server host name [server.example.com]:
Please confirm the domain name [example.com]:
Please provide a realm name [EXAMPLE.COM]:</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
										Plan these names carefully. You will not be able to change them after the installation is complete.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Enter the passwords for the Directory Server superuser (<code class="literal">cn=Directory Manager</code>) and for the Identity Management (IdM) administration system user account (<code class="literal">admin</code>).
						</p><pre class="screen">Directory Manager password:
IPA admin password:</pre></li><li class="listitem"><p class="simpara">
							The script prompts for DNS forwarders.
						</p><pre class="screen">Do you want to configure DNS forwarders? [yes]:</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To configure DNS forwarders, enter <code class="literal">yes</code>, and then follow the instructions on the command line. The installation process will add the forwarder IP addresses to the <code class="literal">/etc/named.conf</code> file on the installed IdM server.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											For the forwarding policy default settings, see the <code class="literal option">--forward-policy</code> description in the <span class="strong strong"><strong>ipa-dns-install</strong></span>(1) man page.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									If you do not want to use DNS forwarding, enter <code class="literal">no</code>.
								</p><p class="simpara">
									With no DNS forwarders, your environment will be isolated, and names from other DNS domains in your infrastructure will not be resolved.
								</p></li></ul></div></li><li class="listitem"><p class="simpara">
							The script prompts to check if any DNS reverse (PTR) records for the IP addresses associated with the server need to be configured.
						</p><pre class="screen">Do you want to search for missing reverse zones? [yes]:</pre><p class="simpara">
							If you run the search and missing reverse zones are discovered, the script asks you whether to create the reverse zones along with the PTR records.
						</p><pre class="screen">Do you want to create reverse zone for IP 192.0.2.1 [yes]:
Please specify the reverse zone name [2.0.192.in-addr.arpa.]:
Using reverse zone(s) 2.0.192.in-addr.arpa.</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Using IdM to manage reverse zones is optional. You can use an external DNS service for this purpose instead.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Enter <code class="literal">yes</code> to confirm the server configuration.
						</p><pre class="screen">Continue to configure the system with these values? [no]: <code class="literal">yes</code></pre></li><li class="listitem">
							The installation script now configures the server. Wait for the operation to complete.
						</li><li class="listitem"><p class="simpara">
							After the installation script completes, add DNS delegation from the parent domain to the IdM DNS domain. For example, if the IdM DNS domain is <code class="literal">ipa.example.com</code>, add a name server (NS) record to the <code class="literal">example.com</code> parent domain.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								Repeat this step each time after an IdM DNS server is installed.
							</p></div></div></li></ol></div></section></section><section class="chapter" id="installing-an-ipa-server-without-integrated-dns_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA</h2></div></div></div><p>
				This chapter describes how you can install a new Identity Management (IdM) server without integrated DNS.
			</p><section class="section" id="installing-an-ipa-server-without-integrated-dns-interactive-installation_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">5.1. Interactive installation</h2></div></div></div><p>
					During the interactive installation using the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code> utility, you are asked to supply basic configuration of the system, for example the realm, the administrator’s password and the Directory Manager’s password.
				</p><p>
					The <code class="literal">ipa-server-install</code> installation script creates a log file at <code class="literal">/var/log/ipaserver-install.log</code>. If the installation fails, the log can help you identify the problem.
				</p><p>
					This procedure installs a server:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Without integrated DNS
						</li><li class="listitem">
							With integrated Identity Management (IdM) certificate authority (CA) as the root CA, which is the default CA configuration
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa-server-install</code> utility.
						</p><pre class="screen"># ipa-server-install</pre></li><li class="listitem"><p class="simpara">
							The script prompts to configure an integrated DNS service. Press <span class="keycap"><strong>Enter</strong></span> to select the default <code class="literal">no</code> option.
						</p><pre class="screen">Do you want to configure integrated DNS (BIND)? [no]:</pre></li><li class="listitem"><p class="simpara">
							The script prompts for several required settings and offers recommended default values in brackets.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To accept a default value, press <span class="keycap"><strong>Enter</strong></span>.
								</li><li class="listitem"><p class="simpara">
									To provide a custom value, enter the required value.
								</p><pre class="screen">Server host name [server.example.com]:
Please confirm the domain name [example.com]:
Please provide a realm name [EXAMPLE.COM]:</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
										Plan these names carefully. You will not be able to change them after the installation is complete.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Enter the passwords for the Directory Server superuser (<code class="literal">cn=Directory Manager</code>) and for the IdM administration system user account (<code class="literal">admin</code>).
						</p><pre class="screen">Directory Manager password:
IPA admin password:</pre></li><li class="listitem"><p class="simpara">
							Enter <code class="literal">yes</code> to confirm the server configuration.
						</p><pre class="screen">Continue to configure the system with these values? [no]: <code class="literal">yes</code></pre></li><li class="listitem">
							The installation script now configures the server. Wait for the operation to complete.
						</li></ol></div></section><section class="section" id="installing-an-ipa-server-without-integrated-dns-non-interactive-installation_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">5.2. Non-interactive installation</h2></div></div></div><p>
					This procedure installs a server:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Without integrated DNS
						</li><li class="listitem">
							With integrated Identity Management (IdM) certificate authority (CA) as the root CA, which is the default CA configuration
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">ipa-server-install</code> installation script creates a log file at <code class="literal">/var/log/ipaserver-install.log</code>. If the installation fails, the log can help you identify the problem.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal"><span class="strong strong"><strong>ipa-server-install</strong></span></code> utility with the options to supply all the required information. The minimum required options for non-interactive installation are:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">--realm</code> to provide the Kerberos realm name
								</li><li class="listitem">
									<code class="literal">--ds-password</code> to provide the password for the Directory Manager (DM), the Directory Server super user
								</li><li class="listitem">
									<code class="literal">--admin-password</code> to provide the password for <code class="literal">admin</code>, the IdM administrator
								</li><li class="listitem">
									<code class="literal">--unattended</code> to let the installation process select default options for the host name and domain name
								</li></ul></div><p class="simpara">
							For example:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-install --realm <span class="emphasis"><em>EXAMPLE.COM</em></span> --ds-password <span class="emphasis"><em>DM_password</em></span> --admin-password <span class="emphasis"><em>admin_password</em></span> --unattended</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For a complete list of options accepted by <span class="strong strong"><strong>ipa-server-install</strong></span>, run the <code class="literal">ipa-server-install --help</code> command.
						</li></ul></div></section></section><section class="chapter" id="uninstalling-an-ipa-server_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Uninstalling an IdM server</h2></div></div></div><p>
				As an administrator, you can remove an Identity Management (IdM) server from the topology.
			</p><p>
				This procedure describes how you can uninstall an example server named <code class="literal">server.idm.example.com</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Before uninstalling a server that serves as a certificate authority (CA), key recovery authority (KRA), or DNS server, make sure these services are running on another server in the domain.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Removing the last server that serves as a CA, KRA, or DNS server seriously disrupts the Identity Management (IdM) functionality.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On all the servers in the topology that have a replication agreement with <code class="literal">server.idm.example.com</code>, use the <code class="literal command">ipa server-del</code> command to delete the replica from the topology:
					</p><pre class="literallayout">[root@another_server ~]# <span class="strong strong"><strong>ipa server-del server.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						On <code class="literal">server.idm.example.com</code>, use the <code class="literal command">ipa-server-install --uninstall</code> command:
					</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa-server-install --uninstall</strong></span>
...
Are you sure you want to continue with the uninstall procedure? [no]: yes</pre></li><li class="listitem">
						Make sure all name server (NS) DNS records pointing to <code class="literal">server.idm.example.com</code> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.
					</li></ol></div></section><section class="chapter" id="renaming-an-ipa-server_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Renaming an IdM server</h2></div></div></div><p>
				You cannot change the host name of an existing Identity Management (IdM) server. However, you can replace the server with a replica of a different name.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install a new replica that will replace the existing server, ensuring the replica has the required host name and IP address. For details, see <a class="xref" href="index.html#installing-an-ipa-replica_installing-identity-management" title="Chapter 15. Installing an IdM replica">Chapter 15, <em>Installing an IdM replica</em></a>.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If the server you are uninstalling is a certificate revocation list (CRL) master server, make another server the CRL master server before proceeding. For details how this is done in the context of a migration procedure, see <a class="link" href="index.html#stopping-crl-generation-on-rhel7-IdM-CA-master_migrate-7-to-8" title="22.4. Stopping CRL generation on RHEL 7 IdM CA master">Stopping CRL generation on RHEL 7 and redirecting CRL requests to RHEL 8</a> and <a class="link" href="index.html#starting-crl-generation-on-rhel8-IdM-CA-master_migrate-7-to-8" title="22.5. Starting CRL generation on the new RHEL 8 IdM CA master">Starting CRL generation on RHEL 8</a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Stop the existing IdM server instance.
					</p><pre class="literallayout">[root@old_server ~]# <span class="strong strong"><strong>ipactl stop</strong></span></pre></li><li class="listitem">
						Uninstall the existing server as described in <a class="xref" href="index.html#uninstalling-an-ipa-server_installing-identity-management" title="Chapter 6. Uninstalling an IdM server">Chapter 6, <em>Uninstalling an IdM server</em></a>.
					</li></ol></div></section><section class="chapter" id="preparing-the-system-for-ipa-client-installation_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Preparing the system for IdM client installation</h2></div></div></div><p>
				This chapter describes the conditions your system must meet to install an Identity Management (IdM) client.
			</p><section class="section" id="dns-requirements-for-ipa-clients_preparing-the-system-for-ipa-client-installation"><div class="titlepage"><div><div><h2 class="title">8.1. DNS requirements for IdM clients</h2></div></div></div><p>
					Client installer by default tries to search for <code class="literal">_ldap._tcp.DOMAIN</code> DNS SRV records for all domains that are parent to its hostname. For example, if a client machine has a hostname <code class="literal">client1.idm.example.com</code>, the installer will try to retrieve an IdM server hostname from <code class="literal">_ldap._tcp.idm.example.com</code>, <code class="literal">_ldap._tcp.example.com</code> and <code class="literal">_ldap._tcp.com</code> DNS SRV records, respectively. The discovered domain is then used to configure client components (for example, SSSD and Kerberos 5 configuration) on the machine.
				</p><p>
					However, the hostnames of IdM clients are not required to be part of the primary DNS domain. If the client machine hostname is not in a subdomain of an IdM server, pass the IdM domain as the <code class="literal">--domain</code> option of the <code class="literal">ipa-client-install</code> command. In that case, after the installation of the client, both SSSD and Kerberos components will have the domain set in their configuration files and will use it to autodiscover IdM servers.
				</p><h4 id="additional_resources">Additional resources</h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For details on DNS requirements in IdM, see <a class="xref" href="index.html#host-name-and-dns-requirements-for-ipa_preparing-the-system-for-ipa-server-installation" title="1.3. Host name and DNS requirements for IdM">Section 1.3, “Host name and DNS requirements for IdM”</a>.
						</li></ul></div></section><section class="section" id="port-requirements-for-ipa-clients_preparing-the-system-for-ipa-client-installation"><div class="titlepage"><div><div><h2 class="title">8.2. Port requirements for IdM clients</h2></div></div></div><p>
					Identity Management (IdM) clients connect to a number of ports on IdM servers to communicate with their services.
				</p><p>
					On IdM client, these ports must be open <span class="emphasis"><em>in the outgoing direction</em></span>. If you are using a firewall that does not filter outgoing packets, such as <code class="literal">firewalld</code>, the ports are already available in the outgoing direction.
				</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For information about which specific ports are used, see <a class="xref" href="index.html#port-requirements-for-ipa_preparing-the-system-for-ipa-server-installation" title="1.4. Port requirements for IdM">Section 1.4, “Port requirements for IdM”</a>.
						</li></ul></div></section><section class="section" id="packages-required-to-install-an-ipa-client_preparing-the-system-for-ipa-client-installation"><div class="titlepage"><div><div><h2 class="title">8.3. Packages required to install an IdM client</h2></div></div></div><p>
					In RHEL8, the packages necessary for installing an Identity Management (IdM) client are shipped as a module. Two IdM streams provide IdM client packages:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							the <code class="literal systemitem">idm:client</code> stream. For details, see <a class="xref" href="index.html#installing-ipa-client-packages-from-the-idm-client-stream" title="8.3.1. Installing ipa-client packages from the idm:client stream">Section 8.3.1, “Installing ipa-client packages from the idm:client stream”</a>.
						</li><li class="listitem">
							the <code class="literal systemitem">idm:DL1</code> stream. For details, see <a class="xref" href="index.html#installing-ipa-client-packages-from-the-idm-dl1-stream" title="8.3.2. Installing ipa-client packages from the idm:DL1 stream">Section 8.3.2, “Installing ipa-client packages from the idm:DL1 stream”</a>.
						</li></ul></div><section class="section" id="installing-ipa-client-packages-from-the-idm-client-stream"><div class="titlepage"><div><div><h3 class="title">8.3.1. Installing ipa-client packages from the idm:client stream</h3></div></div></div><p>
						The <code class="literal systemitem">idm:client</code> stream is the default stream of the <code class="literal package">idm</code> module. Use this stream to download the IdM client packages if you do not need to install server components on your machine. Using the <code class="literal systemitem">idm:client</code> stream is especially recommended if you need to consistently use IdM client software that is supported long-term, provided you do not need server components, too.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							When switching to the <code class="literal systemitem">idm:client</code> stream after you previously enabled the <code class="literal systemitem">idm:DL1</code> stream and downloaded packages from it, you need to first explicitly remove all the relevant installed content and disable the <code class="literal systemitem">idm:DL1</code> stream before enabling the <code class="literal systemitem">idm:client</code> stream. Trying to enable a new stream without disabling the current one results in an error. For details on how to proceed, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_managing_and_removing_user-space_components/index#switching-to-a-later-stream_managing-versions-of-appstream-content">Switching to a later stream</a>.
						</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To download the packages necessary for installing an IdM client:
							</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm</strong></span></pre></li></ul></div></section><section class="section" id="installing-ipa-client-packages-from-the-idm-dl1-stream"><div class="titlepage"><div><div><h3 class="title">8.3.2. Installing ipa-client packages from the idm:DL1 stream</h3></div></div></div><p>
						The <code class="literal systemitem">idm:DL1</code> stream needs to be enabled before you can download packages from it. Use this stream to download the IdM client packages if you need to install IdM server components on your machine.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							When switching to the <code class="literal systemitem">idm:DL1</code> stream after you previously enabled the <code class="literal systemitem">idm:client</code> stream and downloaded packages from it, you need to first explicitly remove all the relevant installed content and disable the <code class="literal systemitem">idm:client</code> stream before enabling the <code class="literal systemitem">idm:DL1</code> stream. Trying to enable a new stream without disabling the current one results in an error. For details on how to proceed, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_managing_and_removing_user-space_components/index#switching-to-a-later-stream_managing-versions-of-appstream-content">Switching to a later stream</a>.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To switch to the RPMs delivered through the <code class="literal systemitem">idm:DL1</code> stream:
							</p><pre class="literallayout"># <span class="strong strong"><strong>yum module enable idm:DL1</strong></span>
# <span class="strong strong"><strong>yum distro-sync</strong></span></pre></li><li class="listitem"><p class="simpara">
								To download the packages necessary for installing an IdM client:
							</p><pre class="literallayout"># <span class="strong strong"><strong>yum module install idm:DL1/client</strong></span></pre></li></ol></div></section></section></section><section class="chapter" id="installing-an-ipa-client-basic-scenario_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Installing an IdM client: Basic scenario</h2></div></div></div><p>
				The following sections describe how to configure a system as an Identity Management (IdM) client by using the <code class="literal">ipa-client-install</code> utility. Configuring a system as an IdM client enrolls it into an IdM domain and enables the system to use IdM services on IdM servers in the domain.
			</p><p>
				Several options are available for a basic installation:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For installing a client interactively using privileged user’s credentials, see <a class="xref" href="index.html#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation" title="9.3. Installing a client by using user credentials: Interactive installation">Section 9.3, “Installing a client by using user credentials: Interactive installation”</a>.
					</li><li class="listitem">
						For installing a client interactively using a one-time password, see <a class="xref" href="index.html#installing-client-basic-installing-a-client-by-using-a-one-time-password-interactive-installation" title="9.4. Installing a client by using a one-time password: Interactive installation">Section 9.4, “Installing a client by using a one-time password: Interactive installation”</a>.
					</li><li class="listitem">
						For installing a client noninteractively using either a privileged user’s credentials, a one-time password or a keytab from previous enrollment, see <a class="xref" href="index.html#installing-ipa-client-non-interactive-install_install-client-basic" title="9.5. Installing a client: Non-interactive installation">Section 9.5, “Installing a client: Non-interactive installation”</a>.
					</li></ul></div><section class="section" id="prerequisites"><div class="titlepage"><div><div><h2 class="title">9.1. Prerequisites</h2></div></div></div><p>
					Before you start installing the IdM client, make sure that you have met all the prerequisites. See <a class="xref" href="index.html#preparing-the-system-for-ipa-client-installation_installing-identity-management" title="Chapter 8. Preparing the system for IdM client installation">Chapter 8, <em>Preparing the system for IdM client installation</em></a>.
				</p></section><section class="section" id="overview-of-the-ipa-client-installation-options"><div class="titlepage"><div><div><h2 class="title">9.2. An overview of the IdM client installation options</h2></div></div></div><p>
					To install an Identity Management (IdM) client successfully, you must provide credentials that can be used to enroll the client. The following authentication methods are available:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The credentials of a user authorized to enroll clients. This is the default option expected by <code class="literal">ipa-client-install</code>.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									To provide the credentials of an authorized user directly to <code class="literal">ipa-client-install</code>, use the <code class="literal option">--principal</code> and <code class="literal option">--password</code> options. See <a class="xref" href="index.html#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation" title="9.3. Installing a client by using user credentials: Interactive installation">Section 9.3, “Installing a client by using user credentials: Interactive installation”</a> for a detailed procedure.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A random, one-time password pre-generated on the server:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									To use this authentication method, add the <code class="literal option">--random</code> option to <code class="literal">ipa-client-install</code> option. See <a class="xref" href="index.html#installing-client-basic-installing-a-client-by-using-a-one-time-password-interactive-installation" title="9.4. Installing a client by using a one-time password: Interactive installation">Section 9.4, “Installing a client by using a one-time password: Interactive installation”</a> for a detailed procedure.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							The client principal from the previous enrollment:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This option is available if the system was previously enrolled as an IdM client. To use this authentication method, add the <code class="literal option">--keytab</code> option to <code class="literal">ipa-client-install</code>. See <a class="xref" href="index.html#re-enrolling-an-ipa-client_installing-identity-management" title="Chapter 11. Re-enrolling an IdM client">Chapter 11, <em>Re-enrolling an IdM client</em></a> for details.
								</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For details on the options accepted by <code class="literal">ipa-client-install</code>, see the <code class="literal"><span class="strong strong"><strong>ipa-client-install</strong></span></code>(1) man page.
						</li></ul></div></section><section class="section" id="installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation"><div class="titlepage"><div><div><h2 class="title">9.3. Installing a client by using user credentials: Interactive installation</h2></div></div></div><p>
					This procedure describes installing an Identity Management (IdM) client interactively by using the credentials of an authorized user to enroll the system into the domain.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure you have the credentials of a user authorized to enroll clients into the IdM domain. This could be, for example, a <code class="literal">hostadmin</code> user with the Enrollment Administrator role.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa-client-install</code> utility on the system that you want to configure as an IdM client.
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install</strong></span></pre><p class="simpara">
							Add the <code class="literal option">--enable-dns-updates</code> option to update the DNS records with the IP address of the client system if either of the following conditions applies:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The IdM server the client will be enrolled with was installed with integrated DNS
								</li><li class="listitem">
									The DNS server on the network accepts DNS entry updates with the GSS-TSIG protocol
								</li></ul></div><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --enable-dns-updates</strong></span></pre><p class="simpara">
							Enabling DNS updates is useful if your client:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									has a dynamic IP address issued using the Dynamic Host Configuration Protocol
								</li><li class="listitem">
									has a static IP address but it has just been allocated and the IdM server does not know about it
								</li></ul></div></li><li class="listitem"><p class="simpara">
							The installation script attempts to obtain all the required settings, such as DNS records, automatically.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values and displays them. Enter <code class="literal">yes</code> to confirm.
								</p><pre class="literallayout">Client hostname: client.example.com
Realm: EXAMPLE.COM
DNS Domain: example.com
IPA Server: server.example.com
BaseDN: dc=example,dc=com

Continue to configure the system with these values? [no]: <span class="strong strong"><strong>yes</strong></span></pre></li><li class="listitem"><p class="simpara">
									To install the system with different values, enter <code class="literal">no</code>. Then run <code class="literal">ipa-client-install</code> again, and specify the required values by adding command-line options to <code class="literal">ipa-client-install</code>, for example:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">--hostname</code>
										</li><li class="listitem">
											<code class="literal">--realm</code>
										</li><li class="listitem">
											<code class="literal">--domain</code>
										</li><li class="listitem">
											<code class="literal">--server</code>
										</li></ul></div></li><li class="listitem">
									If the script fails to obtain some settings automatically, it prompts you for the values.
								</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								The fully qualified domain name must be a valid DNS name:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Only numbers, alphabetic characters, and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
									</li><li class="listitem">
										The host name must be all lower-case. No capital letters are allowed.
									</li></ul></div></div></div></li><li class="listitem"><p class="simpara">
							The script prompts for a user whose identity will be used to enroll the client. This could be, for example, a <code class="literal">hostadmin</code> user with the Enrollment Administrator role:
						</p><pre class="literallayout">User authorized to enroll computers: <code class="literal">hostadmin</code>
Password for <code class="literal">hostadmin</code>@<code class="literal">EXAMPLE.COM</code>:</pre></li><li class="listitem"><p class="simpara">
							The installation script now configures the client. Wait for the operation to complete.
						</p><pre class="literallayout">Client configuration complete.</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For details on how the client installation script searches for the DNS records, see the <code class="literal">DNS Autodiscovery</code> section in the <code class="literal">ipa-client-install</code>(1) man page.
						</li></ul></div></section><section class="section" id="installing-client-basic-installing-a-client-by-using-a-one-time-password-interactive-installation"><div class="titlepage"><div><div><h2 class="title">9.4. Installing a client by using a one-time password: Interactive installation</h2></div></div></div><p>
					This procedure describes installing an Identity Management (IdM) client interactively by using a one-time password to enroll the system into the domain.
				</p><div class="orderedlist"><p class="title"><strong>Prerequisites</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On a server in the domain, add the future client system as an IdM host. Use the <code class="literal option">--random</code> option with the <code class="literal command">ipa host-add</code> command to generate a one-time random password for the enrollment.
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-add <span class="emphasis"><em>client.example.com</em></span> --random</strong></span>
 --------------------------------------------------
 Added host "client.example.com"
 --------------------------------------------------
  Host name: client.example.com
  Random password: <span class="strong strong"><strong>W5YpARl=7M.n</strong></span>
  Password: True
  Keytab: False
  Managed by: server.example.com</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The generated password will become invalid after you use it to enroll the machine into the IdM domain. It will be replaced with a proper host keytab after the enrollment is finished.
							</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa-client-install</code> utility on the system that you want to configure as an IdM client. Use the <code class="literal option">--password</code> option to provide the one-time random password. Because the password often contains special characters, enclose it in single quotes (').
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install</strong></span></pre><p class="simpara">
							Add the <code class="literal option">--enable-dns-updates</code> option to update the DNS records with the IP address of the client system if either of the following conditions applies:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The IdM server the client will be enrolled with was installed with integrated DNS
								</li><li class="listitem">
									The DNS server on the network accepts DNS entry updates with the GSS-TSIG protocol
								</li></ul></div><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --password 'W5YpARl=7M.n' --enable-dns-updates</strong></span></pre><p class="simpara">
							Enabling DNS updates is useful if your client:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									has a dynamic IP address issued using the Dynamic Host Configuration Protocol
								</li><li class="listitem">
									has a static IP address but it has just been allocated and the IdM server does not know about it
								</li></ul></div></li><li class="listitem"><p class="simpara">
							The installation script attempts to obtain all the required settings, such as DNS records, automatically.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values and displays them. Enter <code class="literal">yes</code> to confirm.
								</p><pre class="literallayout">Client hostname: client.example.com
Realm: EXAMPLE.COM
DNS Domain: example.com
IPA Server: server.example.com
BaseDN: dc=example,dc=com

Continue to configure the system with these values? [no]: <span class="strong strong"><strong>yes</strong></span></pre></li><li class="listitem"><p class="simpara">
									To install the system with different values, enter <code class="literal">no</code>. Then run <code class="literal">ipa-client-install</code> again, and specify the required values by adding command-line options to <code class="literal">ipa-client-install</code>, for example:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">--hostname</code>
										</li><li class="listitem">
											<code class="literal">--realm</code>
										</li><li class="listitem">
											<code class="literal">--domain</code>
										</li><li class="listitem">
											<code class="literal">--server</code>
										</li></ul></div></li><li class="listitem">
									If the script fails to obtain some settings automatically, it prompts you for the values.
								</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								The fully qualified domain name must be a valid DNS name:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Only numbers, alphabetic characters, and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
									</li><li class="listitem">
										The host name must be all lower-case. No capital letters are allowed.
									</li></ul></div></div></div></li><li class="listitem"><p class="simpara">
							The installation script now configures the client. Wait for the operation to complete.
						</p><pre class="literallayout">Client configuration complete.</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For details on how the client installation script searches for the DNS records, see the <code class="literal">DNS Autodiscovery</code> section in the <code class="literal">ipa-client-install</code>(1) man page.
						</li></ul></div></section><section class="section" id="installing-ipa-client-non-interactive-install_install-client-basic"><div class="titlepage"><div><div><h2 class="title">9.5. Installing a client: Non-interactive installation</h2></div></div></div><p>
					For a non-interactive installation, you must provide all required information to the <code class="literal">ipa-client-install</code> utility using command-line options. The following sections describe the minimum required options for a non-interactive installation.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Options for the intended authentication method for client enrollment</span></dt><dd><p class="simpara">
								The available options are:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal option">--principal</code> and <code class="literal option">--password</code> to specify the credentials of a user authorized to enroll clients
									</li><li class="listitem">
										<code class="literal option">--random</code> to specify a one-time random password generated for the client
									</li><li class="listitem">
										<code class="literal option">--keytab</code> to specify the keytab from a previous enrollment
									</li></ul></div><p class="simpara">
								For details, see <a class="xref" href="index.html#overview-of-the-ipa-client-installation-options" title="9.2. An overview of the IdM client installation options">Section 9.2, “An overview of the IdM client installation options”</a>.
							</p></dd><dt><span class="term">The option for unattended installation</span></dt><dd><p class="simpara">
								The <code class="literal option">--unattended</code> lets the installation run without requiring user confirmation.
							</p><p class="simpara">
								If the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values. If the script cannot discover the values automatically, provide them using command-line options, such as:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										<code class="literal option">--hostname</code> to specify a static host name for the client machine
									</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
											The fully qualified domain name must be a valid DNS name:
										</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
													Only numbers, alphabetic characters, and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
												</li><li class="listitem">
													The host name must be all lower-case. No capital letters are allowed.
												</li></ul></div></div></div></li><li class="listitem">
										<code class="literal option">--server</code> to specify the host name of the IdM server the client will be enrolled with
									</li><li class="listitem">
										<code class="literal option">--domain</code> to specify the DNS domain name of the IdM server the client will be enrolled with
									</li><li class="listitem">
										<code class="literal option">--realm</code> to specify the Kerberos realm name
									</li></ul></div></dd></dl></div><p>
					An example of a basic <span class="strong strong"><strong>ipa-client-install</strong></span> command for non-interactive installation:
				</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --password '<span class="emphasis"><em>W5YpARl=7M.n</em></span>' --unattended</strong></span></pre><p>
					 <br/>
				</p><p>
					An example of an <span class="strong strong"><strong>ipa-client-install</strong></span> command for non-interactive installation with more options specified:
				</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --password '<span class="emphasis"><em>W5YpARl=7M.n</em></span>' --domain <span class="emphasis"><em>example.com</em></span> --server <span class="emphasis"><em>server.idm.example.com</em></span> --unattended</strong></span></pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For a complete list of options accepted by <code class="literal command">ipa-client-install</code>, see the <span class="strong strong"><strong>ipa-client-install</strong></span>(1) man page.
						</li></ul></div></section><section class="section" id="removing-pre-ipa-configuration-after-installing-client_install-client-basic"><div class="titlepage"><div><div><h2 class="title">9.6. Removing pre-IdM configuration after installing a client</h2></div></div></div><p>
					The <code class="literal">ipa-client-install</code> script does not remove any previous LDAP and System Security Services Daemon (SSSD) configuration from the <code class="literal">/etc/openldap/ldap.conf</code> and <code class="literal">/etc/sssd/sssd.conf</code> files. If you modified the configuration in these files before installing the client, the script adds the new client values, but comments them out. For example:
				</p><pre class="literallayout">BASE   dc=example,dc=com
URI    ldap://ldap.example.com

#URI ldaps://server.example.com # modified by IPA
#BASE dc=ipa,dc=example,dc=com # modified by IPA</pre><p>
					To apply the new Identity Management (IdM)} configuration values:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Open <code class="literal">/etc/openldap/ldap.conf</code> and <code class="literal">/etc/sssd/sssd.conf</code>.
						</li><li class="listitem">
							Delete the previous configuration.
						</li><li class="listitem">
							Uncomment the new IdM configuration.
						</li><li class="listitem">
							Server processes that rely on system-wide LDAP configuration might require a restart to apply the changes. Applications that use <code class="literal">openldap</code> libraries typically import the configuration when started.
						</li></ol></div></section><section class="section" id="testing-an-ipa-client_install-client-basic"><div class="titlepage"><div><div><h2 class="title">9.7. Testing an IdM client</h2></div></div></div><p>
					The Command-Line Interface informs you that the <code class="literal command">ipa-client-install</code> was successful, but you can also do your own test.
				</p><p>
					To test that the Identity Management (IdM) client can obtain information about users defined on the server, check that you are able to resolve a user defined on the server. For example, to check the default <code class="literal">admin</code> user:
				</p><pre class="literallayout">[user@client ~]$ <span class="strong strong"><strong>id admin</strong></span>
uid=1254400000(admin) gid=1254400000(admins) groups=1254400000(admins)</pre><p>
					To test that authentication works correctly, <code class="literal command">su</code> to a root user from a non-root user:
				</p><pre class="literallayout">[user@client ~]$ <span class="strong strong"><strong>su -</strong></span>
Last login: Thu Oct 18 18:39:11 CEST 2018 from 192.168.122.1 on pts/0
[root@client ~]#</pre></section><section class="section" id="connection-requests-during-an-ipa-client-installation_install-client-basic"><div class="titlepage"><div><div><h2 class="title">9.8. Connections performed during an IdM client installation</h2></div></div></div><p>
					<a class="xref" href="index.html#tab-requests-client-installation_install-client-basic" title="Table 9.1. Requests performed during an IdM client installation">Table 9.1, “Requests performed during an IdM client installation”</a> lists the operations performed by <code class="literal">ipa-client-install</code>, the Identity Management (IdM) client installation tool.
				</p><div class="table" id="tab-requests-client-installation_install-client-basic"><p class="title"><strong>Table 9.1. Requests performed during an IdM client installation</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 38%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081248738832" scope="col">Operation</th><th align="left" valign="top" id="idm140081248737744" scope="col">Protocol used</th><th align="left" valign="top" id="idm140081248736656" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081248738832"> <p>
									DNS resolution against the DNS resolvers configured on the client system
								</p>
								 </td><td align="left" valign="top" headers="idm140081248737744"> <p>
									DNS
								</p>
								 </td><td align="left" valign="top" headers="idm140081248736656"> <p>
									To discover the IP addresses of IdM masters; (optionally) to add A/AAAA and SSHFP records
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081248738832"> <p>
									Requests to ports 88 (TCP/TCP6 and UDP/UDP6) on an IdM replica
								</p>
								 </td><td align="left" valign="top" headers="idm140081248737744"> <p>
									Kerberos
								</p>
								 </td><td align="left" valign="top" headers="idm140081248736656"> <p>
									To obtain a Kerberos ticket
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081248738832"> <p>
									JSON-RPC calls to the IdM Apache-based web-service on discovered or configured IdM masters
								</p>
								 </td><td align="left" valign="top" headers="idm140081248737744"> <p>
									HTTPS
								</p>
								 </td><td align="left" valign="top" headers="idm140081248736656"> <p>
									IdM client enrollment; retrieval of CA certificate chain if LDAP method fails; request for a certificate issuance if required
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081248738832"> <p>
									Requests over TCP/TCP6 to ports 389 on IdM servers, using SASL GSSAPI authentication, plain LDAP, or both
								</p>
								 </td><td align="left" valign="top" headers="idm140081248737744"> <p>
									LDAP
								</p>
								 </td><td align="left" valign="top" headers="idm140081248736656"> <p>
									IdM client enrollment; identity retrieval by SSSD processes; Kerberos key retrieval for the host principal
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081248738832"> <p>
									Network time protocol (NTP) discovery and resolution (optionally)
								</p>
								 </td><td align="left" valign="top" headers="idm140081248737744"> <p>
									NTP
								</p>
								 </td><td align="left" valign="top" headers="idm140081248736656"> <p>
									To synchronize time between the client system and an NTP server
								</p>
								 </td></tr></tbody></table></div></div></section><section class="section" id="ipa-client-communication-with-server_install-client-basic"><div class="titlepage"><div><div><h2 class="title">9.9. IdM client’s communications with the server during post-installation deployment</h2></div></div></div><p>
					The client side of Identity Management (IdM) framework is implemented with two different applications:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							the <code class="literal">ipa</code> command-line interface (CLI)
						</li><li class="listitem">
							the browser-based web UI
						</li></ul></div><p>
					The browser-based web UI is optional.
				</p><p>
					<a class="xref" href="index.html#tab-ipa-operations_install-client-basic" title="Table 9.2. CLI post-installation operations">Table 9.2, “CLI post-installation operations”</a> shows the operations performed by the CLI during an IdM client post-installation deployment. <a class="xref" href="index.html#tab-browser-operations_install-client-basic" title="Table 9.3. webUI post-installation operations">Table 9.3, “webUI post-installation operations”</a> shows the operations performed by the web UI during an IdM client post-installation deployment.
				</p><p>
					Two daemons run on the IdM client, the <code class="literal">System Security Services Daemon</code> (SSSD) and <code class="literal">certmonger</code>. <a class="xref" href="index.html#sssd-deployment-operations_install-client-basic" title="9.9.1. SSSD communication patterns">Section 9.9.1, “SSSD communication patterns”</a> and <a class="xref" href="index.html#certmonger-deployment-operations_install-client-basic" title="9.9.2. Certmonger communication patterns">Section 9.9.2, “Certmonger communication patterns”</a> describe how these daemons communicate with the services available on the IdM and Active Directory servers.
				</p><div class="table" id="tab-ipa-operations_install-client-basic"><p class="title"><strong>Table 9.2. CLI post-installation operations</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 38%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081252882144" scope="col">Operation</th><th align="left" valign="top" id="idm140081252881056" scope="col">Protocol used</th><th align="left" valign="top" id="idm140081252879968" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081252882144"> <p>
									DNS resolution against the DNS resolvers configured on the client system
								</p>
								 </td><td align="left" valign="top" headers="idm140081252881056"> <p>
									DNS
								</p>
								 </td><td align="left" valign="top" headers="idm140081252879968"> <p>
									To discover the IP addresses of IdM masters
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252882144"> <p>
									Requests to ports 88 (TCP/TCP6 and UDP/UDP6) and 464 (TCP/TCP6 and UDP/UDP6) on an IdM replica
								</p>
								 </td><td align="left" valign="top" headers="idm140081252881056"> <p>
									Kerberos
								</p>
								 </td><td align="left" valign="top" headers="idm140081252879968"> <p>
									To obtain a Kerberos ticket; change a Kerberos password; authenticate to the IdM Web UI
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252882144"> <p>
									JSON-RPC calls to the IdM Apache-based web-service on discovered or configured IdM masters
								</p>
								 </td><td align="left" valign="top" headers="idm140081252881056"> <p>
									HTTPS
								</p>
								 </td><td align="left" valign="top" headers="idm140081252879968"> <p>
									any <code class="literal command">ipa</code> utility usage
								</p>
								 </td></tr></tbody></table></div></div><div class="table" id="tab-browser-operations_install-client-basic"><p class="title"><strong>Table 9.3. webUI post-installation operations</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 38%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081249770864" scope="col">Operation</th><th align="left" valign="top" id="idm140081249769776" scope="col">Protocol used</th><th align="left" valign="top" id="idm140081249768688" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081249770864"> <p>
									JSON-RPC calls to the IdM Apache-based web-service on discovered or configured IdM masters
								</p>
								 </td><td align="left" valign="top" headers="idm140081249769776"> <p>
									HTTPS
								</p>
								 </td><td align="left" valign="top" headers="idm140081249768688"> <p>
									To retrieve the IdM web UI pages
								</p>
								 </td></tr></tbody></table></div></div><section class="section" id="sssd-deployment-operations_install-client-basic"><div class="titlepage"><div><div><h3 class="title">9.9.1. SSSD communication patterns</h3></div></div></div><p>
						The System Security Services Daemon (SSSD) is a system service to access remote directories and authentication mechanisms. If configured on an Identity Management IdM client, it connects to the IdM server, which provides authentication, authorization and other identity and policy information. If the IdM server is in a trust relationships with Active Directory (AD), SSSD also connects to AD to perform authentication for AD users using the Kerberos protocol. By default, SSSD uses Kerberos to authenticate any non-local user. In special situations, SSSD might be configured to use the LDAP protocol instead.
					</p><p>
						The SSSD can be configured to communicate with multiple servers. <a class="xref" href="index.html#tab-sssd-deployment-operations-clients_install-client-basic" title="Table 9.4. Communication patterns of SSSD on IdM clients when talking to IdM servers">Table 9.4, “Communication patterns of SSSD on IdM clients when talking to IdM servers”</a> and <a class="xref" href="index.html#tab-sssd-deployment-operations-trust-controllers_install-client-basic" title="Table 9.5. Communication patterns of SSSD on IdM servers acting as trust agents when talking to Active Directory Domain Controllers">Table 9.5, “Communication patterns of SSSD on IdM servers acting as trust agents when talking to Active Directory Domain Controllers”</a> show common communication patterns for SSSD in IdM.
					</p><div class="table" id="tab-sssd-deployment-operations-clients_install-client-basic"><p class="title"><strong>Table 9.4. Communication patterns of SSSD on IdM clients when talking to IdM servers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 38%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081248776176" scope="col">Operation</th><th align="left" valign="top" id="idm140081248775088" scope="col">Protocol used</th><th align="left" valign="top" id="idm140081248774000" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081248776176"> <p>
										DNS resolution against the DNS resolvers configured on the client system
									</p>
									 </td><td align="left" valign="top" headers="idm140081248775088"> <p>
										DNS
									</p>
									 </td><td align="left" valign="top" headers="idm140081248774000"> <p>
										To discover the IP addresses of IdM masters
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081248776176"> <p>
										Requests to ports 88 (TCP/TCP6 and UDP/UDP6), 464 (TCP/TCP6 and UDP/UDP6), and 749 (TCP/TCP6) on an Identity Management replica and Active Directory domain controllers
									</p>
									 </td><td align="left" valign="top" headers="idm140081248775088"> <p>
										Kerberos
									</p>
									 </td><td align="left" valign="top" headers="idm140081248774000"> <p>
										To obtain a Kerberos ticket; to change a Kerberos password
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081248776176"> <p>
										Requests over TCP/TCP6 to ports 389 on IdM servers, using SASL GSSAPI authentication, plain LDAP, or both
									</p>
									 </td><td align="left" valign="top" headers="idm140081248775088"> <p>
										LDAP
									</p>
									 </td><td align="left" valign="top" headers="idm140081248774000"> <p>
										To obtain information about IdM users and hosts, download HBAC and sudo rules, automount maps, the SELinux user context, public SSH keys, and other information stored in IdM LDAP
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081248776176"> <p>
										(optionally) In case of smart-card authentication, requests to the Online Certificate Status Protocol (OCSP) responder, if it is configured. This often is done via port 80, but it depends on the actual value of the OCSP responder URL in a client certificate.
									</p>
									 </td><td align="left" valign="top" headers="idm140081248775088"> <p>
										HTTP
									</p>
									 </td><td align="left" valign="top" headers="idm140081248774000"> <p>
										To obtain information about the status of the certificate installed in the smart card
									</p>
									 </td></tr></tbody></table></div></div><div class="table" id="tab-sssd-deployment-operations-trust-controllers_install-client-basic"><p class="title"><strong>Table 9.5. Communication patterns of SSSD on IdM servers acting as trust agents when talking to Active Directory Domain Controllers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 38%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081256789776" scope="col">Operation</th><th align="left" valign="top" id="idm140081256788688" scope="col">Protocol used</th><th align="left" valign="top" id="idm140081249509760" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081256789776"> <p>
										DNS resolution against the DNS resolvers configured on the client system
									</p>
									 </td><td align="left" valign="top" headers="idm140081256788688"> <p>
										DNS
									</p>
									 </td><td align="left" valign="top" headers="idm140081249509760"> <p>
										To discover the IP addresses of IdM masters
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081256789776"> <p>
										Requests to ports 88 (TCP/TCP6 and UDP/UDP6), 464 (TCP/TCP6 and UDP/UDP6), and 749 (TCP/TCP6) on an Identity Management replica and Active Directory domain controllers
									</p>
									 </td><td align="left" valign="top" headers="idm140081256788688"> <p>
										Kerberos
									</p>
									 </td><td align="left" valign="top" headers="idm140081249509760"> <p>
										To obtain a Kerberos ticket; change a Kerberos password; administer Kerberos remotely
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081256789776"> <p>
										Requests to ports 389 (TCP/TCP6 and UDP/UDP6) and 3268 (TCP/TCP6)
									</p>
									 </td><td align="left" valign="top" headers="idm140081256788688"> <p>
										LDAP
									</p>
									 </td><td align="left" valign="top" headers="idm140081249509760"> <p>
										To query Active Directory user and group information; to discover Active Directory domain controllers
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081256789776"> <p>
										(optionally) In case of smart-card authentication, requests to the Online Certificate Status Protocol (OCSP) responder, if it is configured. This often is done via port 80, but it depends on the actual value of the OCSP responder URL in a client certificate.
									</p>
									 </td><td align="left" valign="top" headers="idm140081256788688"> <p>
										HTTP
									</p>
									 </td><td align="left" valign="top" headers="idm140081249509760"> <p>
										To obtain information about the status of the certificate installed in the smart card
									</p>
									 </td></tr></tbody></table></div></div></section><section class="section" id="certmonger-deployment-operations_install-client-basic"><div class="titlepage"><div><div><h3 class="title">9.9.2. Certmonger communication patterns</h3></div></div></div><p>
						<code class="literal">Certmonger</code> is a daemon running on Identity Management (IdM) masters and IdM clients to allow a timely renewal of SSL certificates associated with the services on the host. The <a class="xref" href="index.html#tab-certmonger-deployment-operations_install-client-basic" title="Table 9.6. Certmonger communication patterns">Table 9.6, “Certmonger communication patterns”</a> shows the operations performed by IdM client’s <code class="literal">certmonger</code> utility on IdM masters.
					</p><div class="table" id="tab-certmonger-deployment-operations_install-client-basic"><p class="title"><strong>Table 9.6. Certmonger communication patterns</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 38%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081262129440" scope="col">Operation</th><th align="left" valign="top" id="idm140081262128352" scope="col">Protocol used</th><th align="left" valign="top" id="idm140081262127264" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081262129440"> <p>
										DNS resolution against the DNS resolvers configured on the client system
									</p>
									 </td><td align="left" valign="top" headers="idm140081262128352"> <p>
										DNS
									</p>
									 </td><td align="left" valign="top" headers="idm140081262127264"> <p>
										To discover the IP addresses of IdM masters
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081262129440"> <p>
										Requests to ports 88 (TCP/TCP6 and UDP/UDP6) and 464 (TCP/TCP6 and UDP/UDP6) on an IdM replica
									</p>
									 </td><td align="left" valign="top" headers="idm140081262128352"> <p>
										Kerberos
									</p>
									 </td><td align="left" valign="top" headers="idm140081262127264"> <p>
										To obtain a Kerberos ticket
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081262129440"> <p>
										JSON-RPC calls to the IdM Apache-based web-service on discovered or configured IdM masters
									</p>
									 </td><td align="left" valign="top" headers="idm140081262128352"> <p>
										HTTPS
									</p>
									 </td><td align="left" valign="top" headers="idm140081262127264"> <p>
										To request new certificates
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081262129440"> <p>
										Access over port 8080 (TCP/TCP6) on the IdM master
									</p>
									 </td><td align="left" valign="top" headers="idm140081262128352"> <p>
										HTTP
									</p>
									 </td><td align="left" valign="top" headers="idm140081262127264"> <p>
										To obtain an Online Certificate Status Protocol (OCSP) responder and certificate status
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081262129440"> <p>
										(on the first installed server or on the server where certificate tracking has been transferred) Access over port 8443 (TCP/TCP6) on the IdM master
									</p>
									 </td><td align="left" valign="top" headers="idm140081262128352"> <p>
										HTTPS
									</p>
									 </td><td align="left" valign="top" headers="idm140081262127264"> <p>
										To administer the Certificate Authority on the IdM master (only during IdM master and replica installation)
									</p>
									 </td></tr></tbody></table></div></div></section></section></section><section class="chapter" id="installing-an-ipa-client-with-kickstart_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Installing an IdM client with Kickstart</h2></div></div></div><p>
				A Kickstart enrollment automatically adds a new system to the Identity Management (IdM) domain at the time Red Hat Enterprise Linux is installed.
			</p><section class="section" id="installing-a-client-with-kickstart_client-kickstart"><div class="titlepage"><div><div><h2 class="title">10.1. Installing a client with Kickstart</h2></div></div></div><p>
					This procedure describes how to use a Kickstart file to install an Identity Management (IdM) client.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Do not start the <code class="literal">sshd</code> service prior to the kickstart enrollment. Starting <code class="literal">sshd</code> before enrolling the client generates the SSH keys automatically, but the Kickstart file in <a class="xref" href="index.html#kickstart-file-for-client-installation_client-kickstart" title="10.2. Kickstart file for client installation">Section 10.2, “Kickstart file for client installation”</a> uses a script for the same purpose, which is the preferred solution.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Pre-create the host entry on the IdM server, and set a temporary password for the entry:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-add <span class="emphasis"><em>client.example.com</em></span> --password=<span class="emphasis"><em>secret</em></span></strong></span></pre><p class="simpara">
							The password is used by Kickstart to authenticate during the client installation and expires after the first authentication attempt. After the client is successfully installed, it authenticates using its keytab.
						</p></li><li class="listitem">
							Create a Kickstart file with the contents described in <a class="xref" href="index.html#kickstart-file-for-client-installation_client-kickstart" title="10.2. Kickstart file for client installation">Section 10.2, “Kickstart file for client installation”</a>. Make sure that network is configured properly in the Kickstart file using the <code class="literal">network</code> command.
						</li><li class="listitem">
							Use the Kickstart file to install the IdM client.
						</li></ol></div></section><section class="section" id="kickstart-file-for-client-installation_client-kickstart"><div class="titlepage"><div><div><h2 class="title">10.2. Kickstart file for client installation</h2></div></div></div><p>
					This section describes the contents of a kickstart file that you can use to install an Identity Management (IdM) client.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">The <code class="literal package">ipa-client</code> package in the list of packages to install</span></dt><dd><p class="simpara">
								Add the <code class="literal">ipa-client</code> package to the %packages section of the kickstart file. For example:
							</p><pre class="literallayout">%packages
...
<code class="literal">ipa-client</code>
...</pre></dd><dt><span class="term">Post-installation instructions for the IdM client</span></dt><dd><p class="simpara">
								The post-installation instructions must include:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										An instruction for ensuring SSH keys are generated before enrollment
									</li><li class="listitem"><p class="simpara">
										An instruction to run the <code class="literal">ipa-client-install</code> utility, while specifying:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												All the required information to access and configure the IdM domain services
											</li><li class="listitem">
												The password which you set when pre-creating the client host on the IdM server. in <a class="xref" href="index.html#installing-a-client-with-kickstart_client-kickstart" title="10.1. Installing a client with Kickstart">Section 10.1, “Installing a client with Kickstart”</a>.
											</li></ul></div></li></ul></div><p class="simpara">
								For example, the post-installation instructions for a kickstart installation that uses a one-time password and retrieves the required options from the command line rather than via DNS can look like this:
							</p><pre class="literallayout">%post --log=/root/ks-post.log

# Generate SSH keys; ipa-client-install uploads them to the IdM server by default
/usr/libexec/openssh/sshd-keygen rsa

# Run the client install script
/usr/sbin/ipa-client-install --hostname=<span class="emphasis"><em>client.example.com</em></span> --domain=<span class="emphasis"><em>EXAMPLE.COM</em></span> --enable-dns-updates --mkhomedir -w <span class="emphasis"><em>secret</em></span> --realm=<span class="emphasis"><em>EXAMPLE.COM</em></span> --server=<span class="emphasis"><em>server.example.com</em></span></pre></dd></dl></div><p>
					Optionally, you can also include other options in the Kickstart file, such as:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For a non-interactive installation, add the <code class="literal option">--unattended</code> option to <code class="literal">ipa-client-install</code>.
						</li><li class="listitem"><p class="simpara">
							To let the client installation script request a certificate for the machine:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Add the <code class="literal option">--request-cert</code> option to <code class="literal">ipa-client-install</code>.
								</li><li class="listitem"><p class="simpara">
									Set the system bus address to <code class="literal">/dev/null</code> for both the <code class="literal">getcert</code> and <code class="literal">ipa-client-install</code> utility in the Kickstart <code class="literal">chroot</code> environment. To do this, add these lines to the post-installation instructions in the Kickstart file before the <code class="literal">ipa-client-install</code> instruction:
								</p><pre class="literallayout"># env DBUS_SYSTEM_BUS_ADDRESS=unix:path=/dev/null getcert list
# env DBUS_SYSTEM_BUS_ADDRESS=unix:path=/dev/null ipa-client-install</pre></li></ul></div></li></ul></div></section><section class="section" id="testing-an-ipa-client_client-kickstart"><div class="titlepage"><div><div><h2 class="title">10.3. Testing an IdM client</h2></div></div></div><p>
					The Command-Line Interface informs you that the <code class="literal command">ipa-client-install</code> was successful, but you can also do your own test.
				</p><p>
					To test that the Identity Management (IdM) client can obtain information about users defined on the server, check that you are able to resolve a user defined on the server. For example, to check the default <code class="literal">admin</code> user:
				</p><pre class="literallayout">[user@client ~]$ <span class="strong strong"><strong>id admin</strong></span>
uid=1254400000(admin) gid=1254400000(admins) groups=1254400000(admins)</pre><p>
					To test that authentication works correctly, <code class="literal command">su</code> to a root user from a non-root user:
				</p><pre class="literallayout">[user@client ~]$ <span class="strong strong"><strong>su -</strong></span>
Last login: Thu Oct 18 18:39:11 CEST 2018 from 192.168.122.1 on pts/0
[root@client ~]#</pre></section></section><section class="chapter" id="re-enrolling-an-ipa-client_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Re-enrolling an IdM client</h2></div></div></div><section class="section" id="client-reenrollment-idm_re-enrolling-client"><div class="titlepage"><div><div><h2 class="title">11.1. Client re-enrollment in IdM</h2></div></div></div><p>
					This section describes how to re-enroll an Identity Management (IdM) client.
				</p><p>
					If a client machine has been destroyed and lost connection with the IdM servers, for example due to the client’s hardware failure, and you still have its keytab, you can re-enroll the client. In this scenario, you want to get the client back in the IdM environment with the same hostname.
				</p><p>
					During the re-enrollment, the client generates a new Kerberos key and SSH keys, but the identity of the client in the LDAP database remains unchanged. After the re-enrollment, the host has its keys and other information in the same LDAP object with the same <code class="literal">FQDN</code> as previously, before the machine’s loss of connection with the IdM servers.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You can only re-enroll clients whose domain entry is still active. If you uninstalled a client (using <code class="literal command">ipa-client-install --uninstall</code>) or disabled its host entry (using <code class="literal command">ipa host-disable</code>), you cannot re-enroll it.
					</p></div></div><p>
					You cannot re-enroll a client after you have renamed it. This is because in IdM, the key attribute of the client’s entry in LDAP is the client’s hostname, its <code class="literal">FQDN</code>. As opposed to re-enrolling a client, during which the client’s LDAP object remains unchanged, the outcome of renaming a client is that the client has its keys and other information in a different LDAP object with a new <code class="literal">FQDN</code>. Thus the only way to rename a client is to uninstall the host from IdM, change the host’s hostname, and install it as an IdM client with a new name. For details on how to rename a client, see <a class="xref" href="index.html#renaming-ipa-client-systems_installing-identity-management" title="Chapter 13. Renaming IdM client systems">Chapter 13, <em>Renaming IdM client systems</em></a>.
				</p><section class="section" id="what-happens-during-client-re-enrollment_re-enrolling-client"><div class="titlepage"><div><div><h3 class="title">11.1.1. What happens during client re-enrollment</h3></div></div></div><p>
						During re-enrollment, IdM:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Revokes the original host certificate
							</li><li class="listitem">
								Creates new SSH keys
							</li><li class="listitem">
								Generates a new keytab
							</li></ul></div></section></section><section class="section" id="re-enrolling-a-client-by-using-user-credentials-interactive-re-enrollment_re-enrolling-client"><div class="titlepage"><div><div><h2 class="title">11.2. Re-enrolling a client by using user credentials: Interactive re-enrollment</h2></div></div></div><p>
					This procedure describes re-enrolling an Identity Management (IdM) client interactively by using the credentials of an authorized user.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Re-create the client machine with the same host name.
						</li><li class="listitem"><p class="simpara">
							Run the <code class="literal command">ipa-client-install --force-join</code> command on the client machine:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --force-join</strong></span></pre></li><li class="listitem"><p class="simpara">
							The script prompts for a user whose identity will be used to re-enroll the client. This could be, for example, a <code class="literal">hostadmin</code> user with the Enrollment Administrator role:
						</p><pre class="literallayout">User authorized to enroll computers: <code class="literal">hostadmin</code>
Password for <code class="literal">hostadmin</code>@<code class="literal">EXAMPLE.COM</code>:</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For a more detailed procedure on enrolling clients by using an authorized user’s credentials, see <a class="xref" href="index.html#installing-client-basic-installing-a-client-by-using-user-credentials-interactive-installation" title="9.3. Installing a client by using user credentials: Interactive installation">Section 9.3, “Installing a client by using user credentials: Interactive installation”</a>.
						</li></ul></div></section><section class="section" id="re-enrolling-idm-client-using-keytab-non-interactive_re-enrolling-client"><div class="titlepage"><div><div><h2 class="title">11.3. Re-enrolling a client by using the client keytab: Non-interactive re-enrollment</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Back up the original client keytab file, for example in the <code class="literal">/tmp</code> or <code class="literal">/root</code> directory.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						This procedure describes re-enrolling an Identity Management (IdM) client non-interactively by using the keytab of the client system. For example, re-enrollment using the client keytab is appropriate for an automated installation.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Re-create the client machine with the same host name.
						</li><li class="listitem">
							Copy the keytab file from the backup location to the <code class="literal">/etc/</code> directory on the re-created client machine.
						</li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa-client-install</code> utility to re-enroll the client, and specify the keytab location with the <code class="literal option">--keytab</code> option:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --keytab /etc/krb5.keytab</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The keytab specified in the <code class="literal option">--keytab</code> option is only used when authenticating to initiate the enrollment. During the re-enrollment, IdM generates a new keytab for the client.
							</p></div></div></li></ol></div></section><section class="section" id="testing-an-ipa-client_re-enrolling-client"><div class="titlepage"><div><div><h2 class="title">11.4. Testing an IdM client</h2></div></div></div><p>
					The Command-Line Interface informs you that the <code class="literal command">ipa-client-install</code> was successful, but you can also do your own test.
				</p><p>
					To test that the Identity Management (IdM) client can obtain information about users defined on the server, check that you are able to resolve a user defined on the server. For example, to check the default <code class="literal">admin</code> user:
				</p><pre class="literallayout">[user@client ~]$ <span class="strong strong"><strong>id admin</strong></span>
uid=1254400000(admin) gid=1254400000(admins) groups=1254400000(admins)</pre><p>
					To test that authentication works correctly, <code class="literal command">su</code> to a root user from a non-root user:
				</p><pre class="literallayout">[user@client ~]$ <span class="strong strong"><strong>su -</strong></span>
Last login: Thu Oct 18 18:39:11 CEST 2018 from 192.168.122.1 on pts/0
[root@client ~]#</pre></section></section><section class="chapter" id="uninstalling-an-ipa-client_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Uninstalling an IdM client</h2></div></div></div><p>
				As an administrator, you can remove an Identity Management (IdM) client from the environment.
			</p><section class="section" id="uninstalling-an-ipa-client-procedure_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">12.1. Uninstalling an IdM client</h2></div></div></div><p>
					Uninstalling a client removes the client from the Identity Management (IdM) domain, along with all of the specific IdM configuration of system services, such as System Security Services Daemon (SSSD). This restores the previous configuration of the client system.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal command">ipa-client-install --uninstall</code> command:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --uninstall</strong></span></pre></li><li class="listitem"><p class="simpara">
							Remove the DNS entries for the client host manually from the server:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa dnsrecord-del</strong></span>
Record name: old-client-name
Zone name: idm.example.com
No option to delete specific record provided.
Delete all? Yes/No (default No): yes
------------------------
Deleted record "old-client-name"</pre></li></ol></div></section></section><section class="chapter" id="renaming-ipa-client-systems_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Renaming IdM client systems</h2></div></div></div><p>
				The following sections describe how to change the host name of an Identity Management (IdM) client system.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Renaming a client is a manual procedure. Do not perform it unless changing the host name is absolutely required.
				</p></div></div><p>
				Renaming an IdM client involves:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Preparing the host. For details, see <a class="xref" href="index.html#prerequisites_renaming-clients" title="13.1. Prerequisites">Section 13.1, “Prerequisites”</a>
					</li><li class="listitem">
						Uninstalling the IdM client from the host. For details, see <a class="xref" href="index.html#uninstalling-an-ipa-client-procedure_renaming-clients" title="13.2. Uninstalling an IdM client">Section 13.2, “Uninstalling an IdM client”</a>
					</li><li class="listitem">
						Renaming the host. For details, see <a class="xref" href="index.html#renaming-the-ipa-client-system_renaming-clients" title="13.3. Renaming the host system">Section 13.3, “Renaming the host system”</a>
					</li><li class="listitem">
						Installing the IdM client on the host with the new name. For details, see <a class="xref" href="index.html#reinstalling-client_renaming-clients" title="13.4. Re-installing an IdM client">Section 13.4, “Re-installing an IdM client”</a>
					</li><li class="listitem">
						Configuring the host after the IdM client installation. For details, see <a class="xref" href="index.html#re-adding-services-re-generating-certificates-and-re-adding-host-groups_renaming-clients" title="13.5. Re-adding services, re-generating certificates, and re-adding host groups">Section 13.5, “Re-adding services, re-generating certificates, and re-adding host groups”</a>
					</li></ol></div><section class="section" id="prerequisites_renaming-clients"><div class="titlepage"><div><div><h2 class="title">13.1. Prerequisites</h2></div></div></div><p>
					Before uninstalling the current client, make note of certain settings for the client. You will apply this configuration after re-enrolling the machine with a new host name.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Identify which services are running on the machine:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									Use the <code class="literal command">ipa service-find</code> command, and identify services with certificates in the output:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa service-find <span class="emphasis"><em>old-client-name.example.com</em></span></strong></span></pre></li><li class="listitem">
									In addition, each host has a default <span class="emphasis"><em>host service</em></span> which does not appear in the <code class="literal command">ipa service-find</code> output. The service principal for the host service, also called a <span class="emphasis"><em>host principal</em></span>, is <code class="literal">host/<span class="emphasis"><em>old-client-name.example.com</em></span></code>.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							For all service principals displayed by <code class="literal command">ipa service-find <span class="emphasis"><em>old-client-name.example.com</em></span></code>, determine the location of the corresponding keytabs on the <code class="literal"><span class="emphasis"><em>old-client-name.example.com</em></span></code> system:
						</p><pre class="literallayout"># <span class="strong strong"><strong>find / -name "*.keytab"</strong></span></pre><p class="simpara">
							Each service on the client system has a Kerberos principal in the form <span class="emphasis"><em>service_name/host_name@REALM</em></span>, such as <code class="literal">ldap/<span class="emphasis"><em>old-client-name.example.com@EXAMPLE.COM</em></span></code>.
						</p></li><li class="listitem"><p class="simpara">
							Identify all host groups to which the machine belongs.
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa hostgroup-find <span class="emphasis"><em>old-client-name.example.com</em></span></strong></span></pre></li></ul></div></section><section class="section" id="uninstalling-an-ipa-client-procedure_renaming-clients"><div class="titlepage"><div><div><h2 class="title">13.2. Uninstalling an IdM client</h2></div></div></div><p>
					Uninstalling a client removes the client from the Identity Management (IdM) domain, along with all of the specific IdM configuration of system services, such as System Security Services Daemon (SSSD). This restores the previous configuration of the client system.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal command">ipa-client-install --uninstall</code> command:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-install --uninstall</strong></span></pre></li><li class="listitem"><p class="simpara">
							Remove the DNS entries for the client host manually from the server:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa dnsrecord-del</strong></span>
Record name: old-client-name
Zone name: idm.example.com
No option to delete specific record provided.
Delete all? Yes/No (default No): yes
------------------------
Deleted record "old-client-name"</pre></li></ol></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							For each identified keytab other than <code class="literal">/etc/krb5.keytab</code>, remove the old principals:
						</p><pre class="literallayout">[root@client ~]# ipa-rmkeytab -k <span class="emphasis"><em>/path/to/keytab</em></span> -r EXAMPLE.COM</pre><p class="simpara">
							See TBD &lt;removing-keytabs&gt;&gt;.
						</p></li><li class="listitem"><p class="simpara">
							On an IdM server, remove the host entry. This removes all services and revokes all certificates issued for that host:
						</p><pre class="literallayout">[root@server ~]# ipa host-del client.example.com</pre></li></ol></div></section><section class="section" id="renaming-the-ipa-client-system_renaming-clients"><div class="titlepage"><div><div><h2 class="title">13.3. Renaming the host system</h2></div></div></div><p>
					Rename the machine as required. For example:
				</p><pre class="literallayout"># <span class="strong strong"><strong>hostnamectl set-hostname <span class="emphasis"><em>new-client-name.example.com</em></span></strong></span></pre><p>
					You can now re-install the Identity Management (IdM) client to the IdM domain with the new host name.
				</p></section><section class="section" id="reinstalling-client_renaming-clients"><div class="titlepage"><div><div><h2 class="title">13.4. Re-installing an IdM client</h2></div></div></div><p>
					Install an client on your renamed host following the procedure described in <a class="xref" href="index.html#installing-an-ipa-client-basic-scenario_installing-identity-management" title="Chapter 9. Installing an IdM client: Basic scenario">Chapter 9, <em>Installing an IdM client: Basic scenario</em></a>.
				</p></section><section class="section" id="re-adding-services-re-generating-certificates-and-re-adding-host-groups_renaming-clients"><div class="titlepage"><div><div><h2 class="title">13.5. Re-adding services, re-generating certificates, and re-adding host groups</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On the Identity Management (IdM) server, add a new keytab for every service identified in <a class="xref" href="index.html#prerequisites_renaming-clients" title="13.1. Prerequisites">Section 13.1, “Prerequisites”</a>.
						</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa service-add <span class="emphasis"><em>service_name/new-client-name</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
							Generate certificates for services that had a certificate assigned in <a class="xref" href="index.html#prerequisites_renaming-clients" title="13.1. Prerequisites">Section 13.1, “Prerequisites”</a>. You can do this:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Using the IdM administration tools
								</li><li class="listitem">
									Using the <code class="literal">certmonger</code> utility
								</li></ul></div></li><li class="listitem">
							Re-add the client to the host groups identified in <a class="xref" href="index.html#prerequisites_renaming-clients" title="13.1. Prerequisites">Section 13.1, “Prerequisites”</a>.
						</li></ol></div></section></section><section class="chapter" id="preparing-the-system-for-ipa-replica-installation_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Preparing the system for IdM replica installation</h2></div></div></div><p>
				The following sections list the requirements to install an Identity Management (IdM) replica. Before the installation, make sure your system meets these requirements.
			</p><p>
				A system where you want to install a replica must meet the general requirements for servers: <a class="xref" href="index.html#preparing-the-system-for-ipa-server-installation_installing-identity-management" title="Chapter 1. Preparing the system for IdM server installation">Chapter 1, <em>Preparing the system for IdM server installation</em></a>
			</p><p>
				For additional requirements specific to replicas, see: <a class="xref" href="index.html#replica-version-requirements_preparing-the-system-for-ipa-replica-installation" title="14.1. Replica version requirements">Section 14.1, “Replica version requirements”</a>
			</p><section class="section" id="replica-version-requirements_preparing-the-system-for-ipa-replica-installation"><div class="titlepage"><div><div><h2 class="title">14.1. Replica version requirements</h2></div></div></div><p>
					Red Hat Enterprise Linux (RHEL) 8 replicas only work with Identity Management (IdM) masters running on RHEL 7.4 and later. Before introducing IdM replicas running on RHEL 8 into an existing deployment, upgrade all IdM servers to RHEL 7.4 or later, and change the domain level to 1.
				</p><p>
					In addition, the replica must be running the same or later version of IdM. For example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The master server is installed on Red Hat Enterprise Linux 8 and uses the IdM 4.x packages.
						</li><li class="listitem">
							You must install the replica also on Red Hat Enterprise Linux 8 or later and use IdM version 4.x or later.
						</li></ul></div><p>
					This ensures that configuration can be properly copied from the server to the replica.
				</p><p>
					For details on how to display the IdM software version, see <a class="xref" href="index.html#display-software-version_preparing-the-system-for-ipa-replica-installation" title="14.2. Methods for Displaying Identity Management Software Version">Section 14.2, “Methods for Displaying Identity Management Software Version”</a>.
				</p></section><section class="section" id="display-software-version_preparing-the-system-for-ipa-replica-installation"><div class="titlepage"><div><div><h2 class="title">14.2. Methods for Displaying Identity Management Software Version</h2></div></div></div><p>
					You can display the IdM version number with:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							the IdM WebUI
						</li><li class="listitem">
							<code class="literal">ipa</code> commands
						</li><li class="listitem"><p class="simpara">
							<code class="literal">rpm</code> commands
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Displaying Version through the WebUI</span></dt><dd><p class="simpara">
										In the IdM WebUI, the software version can be displayed by choosing <code class="literal">About</code> from the username menu at the top-right.
									</p><div class="informalfigure"><div class="mediaobject"><img src="idm-version-check.png" alt="Checking IdM Software Version"/></div></div></dd><dt><span class="term">Displaying Version with <code class="literal">ipa</code> commands</span></dt><dd><p class="simpara">
										From the command line, use the <code class="literal">ipa --version</code> command.
									</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa --version</strong></span>
<span class="strong strong"><strong>VERSION: 4.8.0</strong></span>, API_VERSION: 2.233</pre></dd><dt><span class="term">Displaying Version with rpm commands</span></dt><dd><p class="simpara">
										If IdM services are not operating properly, you can use the <code class="literal">rpm</code> utility to determine the version number of the <code class="literal">ipa-server</code> package that is currently installed.
									</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>rpm -q ipa-server</strong></span>
<span class="strong strong"><strong>ipa-server-4.8.0-11</strong></span>.module+el8.1.0+4247+9f3fd721.x86_64</pre></dd></dl></div></li></ul></div></section></section><section class="chapter" id="installing-an-ipa-replica_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Installing an IdM replica</h2></div></div></div><p>
				The following sections describe how to install an Identity Management (IdM) replica based on an existing server. The replica installation process copies the configuration of the existing server, and installs the replica based on that configuration.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Install one IdM replica at a time. The installation of multiple replicas at the same time is not supported.
				</p></div></div><p>
				Before installing a replica, the target system must be authorized for enrollment in the IdM domain. See:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index.html#prerequisites-for-installing-a-replica-on-an-ipa-client_install-replica" title="15.1. Prerequisites for installing a replica on an IdM client">Section 15.1, “Prerequisites for installing a replica on an IdM client”</a>
					</li><li class="listitem">
						<a class="xref" href="index.html#prerequisites-for-installing-a-replica-on-a-system-outside-the-ipa-domain_install-replica" title="15.2. Prerequisites for installing a replica on a system outside the IdM domain">Section 15.2, “Prerequisites for installing a replica on a system outside the IdM domain”</a>
					</li></ul></div><p>
				For the replica installation procedures, see:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index.html#installing-an-ipa-replica-with-integrated-dns_install-replica" title="15.3. Installing an IdM replica with integrated DNS">Section 15.3, “Installing an IdM replica with integrated DNS”</a>
					</li><li class="listitem">
						<a class="xref" href="index.html#installing-an-ipa-replica-without-a-ca_install-replica" title="15.5. Installing an IdM replica without a CA">Section 15.5, “Installing an IdM replica without a CA”</a>
					</li></ul></div><p>
				After the installation, see:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="index.html#testing-an-ipa-replica_install-replica" title="15.7. Testing an IdM replica">Section 15.7, “Testing an IdM replica”</a>
					</li></ul></div><section class="section" id="prerequisites-for-installing-a-replica-on-an-ipa-client_install-replica"><div class="titlepage"><div><div><h2 class="title">15.1. Prerequisites for installing a replica on an IdM client</h2></div></div></div><p>
					When installing a replica on an existing client, choose one of the following authorization methods.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">A privileged user’s credentials</span></dt><dd><p class="simpara">
								Choose this method to authorize the replica installation by providing a privileged user’s credentials:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Log in as the privileged user before running the <code class="literal">ipa-replica-install</code> utility. The default privileged user is <code class="literal">admin</code>:
									</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem">
										Let Identity Management (IdM) prompt you for the credentials interactively. This is the default behavior.
									</li></ul></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">The <code class="literal">ipaservers</code> host group</span></dt><dd><p class="simpara">
								Choose this method to authorize the replica installation by adding the client to the <code class="literal">ipaservers</code> host group. Membership in <code class="literal">ipaservers</code> grants the machine elevated privileges analogous to the administrator’s credentials.
							</p><p class="simpara">
								To add the client as a member of <code class="literal">ipaservers</code>:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span></pre><pre class="literallayout">$ <span class="strong strong"><strong>ipa hostgroup-add-member ipaservers --hosts <span class="emphasis"><em>replica.example.com</em></span></strong></span>
  Host-group: ipaservers
  Description: IPA server hosts
  Member hosts: server.idm.example.com, client.example.com
-------------------------
Number of members added 1
-------------------------</pre></dd></dl></div></section><section class="section" id="prerequisites-for-installing-a-replica-on-a-system-outside-the-ipa-domain_install-replica"><div class="titlepage"><div><div><h2 class="title">15.2. Prerequisites for installing a replica on a system outside the IdM domain</h2></div></div></div><p>
					When you run the <code class="literal">ipa-replica-install</code> utility on a system that has not yet been enrolled in the Identity Management (IdM) domain, <code class="literal">ipa-replica-install</code> first enrolls the system as a client and then installs the replica components.
				</p><p>
					When installing a replica on a system outside the IdM domain, choose one of the following authorization methods.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">A privileged user’s credentials</span></dt><dd><p class="simpara">
								Using this method, the replica installation is authorized by providing a privileged user’s credentials. The default privileged user is <code class="literal">admin</code>.
							</p><p class="simpara">
								To use this method, add the principal name and password options (<code class="literal">--principal <span class="emphasis"><em>admin</em></span> --admin-password <span class="emphasis"><em>password</em></span></code>) to <code class="literal">ipa-replica-install</code> directly during the installation.
							</p></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">A random password generated on an IdM server</span></dt><dd><p class="simpara">
								Using this method, the replica installation is authorized by providing a random password for one-time enrollment.
							</p><p class="simpara">
								To generate the random password for the future replica and add the future replica system to the <code class="literal">ipaservers</code> host group, use these commands on any server in the domain:
							</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
										Log in as the administrator.
									</p><pre class="literallayout">$ kinit admin</pre></li><li class="listitem"><p class="simpara">
										Add the new machine as an IdM host. Use the <code class="literal option">--random</code> option with the <code class="literal command">ipa host-add</code> command to generate a random one-time password to be used for the replica installation.
									</p><pre class="literallayout">$ ipa host-add <span class="emphasis"><em>replica.example2.com</em></span> --random
--------------------------------------------------
Added host "replica.example2.com"
--------------------------------------------------
  Host name: replica.example2.com
  Random password: W5YpARl=7M.n
  Password: True
  Keytab: False
  Managed by: server.example.com</pre><p class="simpara">
										The generated password will become invalid after you use it to enroll the machine into the IdM domain. It will be replaced with a proper host keytab after the enrollment is finished.
									</p></li><li class="listitem"><p class="simpara">
										Add the machine to the <code class="literal">ipaservers</code> host group.
									</p><pre class="literallayout">$ ipa hostgroup-add-member ipaservers --hosts <span class="emphasis"><em>replica.example2.com</em></span>
  Host-group: ipaservers
  Description: IPA server hosts
  Member hosts: server.example.com, replica.example2.com
-------------------------
Number of members added 1
-------------------------</pre><p class="simpara">
										Membership in <code class="literal">ipaservers</code> grants the machine elevated privileges required to set up the necessary server services.
									</p></li></ol></div></dd></dl></div></section><section class="section" id="installing-an-ipa-replica-with-integrated-dns_install-replica"><div class="titlepage"><div><div><h2 class="title">15.3. Installing an IdM replica with integrated DNS</h2></div></div></div><p>
					This procedure describes installing a replica:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							With integrated DNS
						</li><li class="listitem">
							Without a certificate authority (CA) in an Identity Management (IdM) environment in which a CA is already installed. The replica will forward all certificate operations to the IdM server with a CA installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run <code class="literal">ipa-replica-install</code> with these options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal option">--setup-dns</code> to configure the replica as the DNS server
								</li><li class="listitem">
									<code class="literal option">--forwarder</code> to specify a forwarder, or <code class="literal option">--no-forwarder</code> if you do not want to use any forwarders. To specify multiple forwarders for failover reasons, use <code class="literal option">--forwarder</code> multiple times.
								</li></ul></div><p class="simpara">
							For example, to set up a replica with an integrated DNS server that forwards all DNS requests not managed by the IdM servers to the DNS server running on IP 192.0.2.1:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-replica-install --setup-dns --forwarder <span class="emphasis"><em>192.0.2.1</em></span></strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">ipa-replica-install</code> utility accepts a number of other options related to DNS settings, such as <code class="literal option">--no-reverse</code> or <code class="literal option">--no-host-dns</code>. For more information about them, see the <span class="strong strong"><strong>ipa-replica-install</strong></span>(1) man page.
							</p></div></div></li></ol></div></section><section class="section" id="installing-an-ipa-replica-with-a-ca-replica-prereqs_install-replica"><div class="titlepage"><div><div><h2 class="title">15.4. Installing an IdM replica with a CA</h2></div></div></div><p>
					This procedure describes installing a replica:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Without integrated DNS
						</li><li class="listitem">
							With a certificate authority (CA)
						</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						When configuring a replica with a CA, the CA configuration of the replica must mirror the CA configuration of the master server.
					</p><p>
						For example, if the server includes an integrated Identity Management (IdM) CA as the root CA, the replica must also be installed with an integrated CA as the root CA. No other CA configuration is available in this case.
					</p><p>
						The inclusion of the <code class="literal option">--setup-ca</code> option in the <code class="literal">ipa-replica-install</code> command takes care of copying the CA configuration of the initial server.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run <code class="literal">ipa-replica-install</code> with the <code class="literal option">--setup-ca</code> option.
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-replica-install --setup-ca</strong></span></pre></li></ol></div></section><section class="section" id="installing-an-ipa-replica-without-a-ca_install-replica"><div class="titlepage"><div><div><h2 class="title">15.5. Installing an IdM replica without a CA</h2></div></div></div><p>
					This procedure describes installing a replica:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Without integrated DNS
						</li><li class="listitem">
							Without a certificate authority (CA) by providing the required certificates manually. The assumption here is that the master server was also installed without a CA.
						</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You cannot install a server or replica using self-signed third-party server certificates because the imported certificate files must contain the full CA certificate chain of the CA that issued the LDAP and Apache server certificates.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Run <code class="literal">ipa-replica-install</code>, and provide the required certificate files by adding these options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal option">--dirsrv-cert-file</code>
								</li><li class="listitem">
									<code class="literal option">--dirsrv-pin</code>
								</li><li class="listitem">
									<code class="literal option">--http-cert-file</code>
								</li><li class="listitem">
									<code class="literal option">--http-pin</code>
								</li></ul></div><p class="simpara">
							For details about the files that are provided using these options, see <a class="xref" href="index.html#certificates-required-to-install-ipa-server-no-ca_install-server-no-ca" title="4.1. Certificates required to install an IdM server without a CA">Section 4.1, “Certificates required to install an IdM server without a CA”</a>.
						</p><p class="simpara">
							For example:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-replica-install \</strong></span>
    <span class="strong strong"><strong>--dirsrv-cert-file <span class="emphasis"><em>/tmp/server.crt</em></span> \</strong></span>
    <span class="strong strong"><strong>--dirsrv-cert-file <span class="emphasis"><em>/tmp/server.key</em></span> \</strong></span>
    <span class="strong strong"><strong>--dirsrv-pin <span class="emphasis"><em>secret</em></span> \</strong></span>
    <span class="strong strong"><strong>--http-cert-file <span class="emphasis"><em>/tmp/server.crt</em></span> \</strong></span>
    <span class="strong strong"><strong>--http-cert-file <span class="emphasis"><em>/tmp/server.key</em></span> \</strong></span>
    <span class="strong strong"><strong>--http-pin <span class="emphasis"><em>secret</em></span></strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Do not add the <code class="literal option">--ca-cert-file</code> option. The <code class="literal">ipa-replica-install</code> utility takes this part of the certificate information automatically from the master server.
							</p></div></div></li></ul></div></section><section class="section" id="installing-an-idm-hidden-replica_install-replica"><div class="titlepage"><div><div><h2 class="title">15.6. Installing an IdM hidden replica</h2></div></div></div><p>
					A hidden (unadvertised) replica is an IdM server that has all services running and available. However, it has no SRV records in DNS, and LDAP server roles are not enabled. Therefore, clients cannot use service discovery to detect these hidden replicas.
				</p><p>
					For further details about hidden replicas, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/planning_identity_management/planning-the-replica-topology_planning-dns-and-host-names#the-hidden-replica-mode_planning-the-replica-topology">The hidden replica mode</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To install a hidden replica, use the following command:
						</p><pre class="literallayout">ipa-replica-install --hidden-replica</pre></li></ul></div><p>
					Note that the command installs a replica without DNS SRV records and with disabled LDAP server roles.
				</p><p>
					You can also change the mode of existing replica to hidden. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/demoting-or-promoting-hidden-replicas_configuring-and-managing-idm">Demotion and promotion of hidden replicas</a>.
				</p></section><section class="section" id="testing-an-ipa-replica_install-replica"><div class="titlepage"><div><div><h2 class="title">15.7. Testing an IdM replica</h2></div></div></div><p>
					After creating a replica, check if the replica replicates data as expected. You can use the following procedure.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a user on the new replica:
						</p><pre class="literallayout">[admin@new_replica ~]$ <span class="strong strong"><strong>ipa user-add <span class="emphasis"><em>test_user</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
							Make sure the user is visible on another replica:
						</p><pre class="literallayout">[admin@another_replica ~]$ <span class="strong strong"><strong>ipa user-show <span class="emphasis"><em>test_user</em></span></strong></span></pre></li></ol></div></section><section class="section" id="connection-requests-during-an-ipa-replica-installation_install-replica"><div class="titlepage"><div><div><h2 class="title">15.8. Connections performed during an IdM replica installation</h2></div></div></div><p>
					<a class="xref" href="index.html#tab-requests-replica-installation_install-replica" title="Table 15.1. Requests performed during an IdM replica installation">Table 15.1, “Requests performed during an IdM replica installation”</a> lists the operations performed by <code class="literal">ipa-replica-install</code>, the Identity Management (IdM) replica installation tool.
				</p><div class="table" id="tab-requests-replica-installation_install-replica"><p class="title"><strong>Table 15.1. Requests performed during an IdM replica installation</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 38%; " class="col_1"><!--Empty--></col><col style="width: 25%; " class="col_2"><!--Empty--></col><col style="width: 38%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081252899072" scope="col">Operation</th><th align="left" valign="top" id="idm140081252897984" scope="col">Protocol used</th><th align="left" valign="top" id="idm140081252896896" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081252899072"> <p>
									DNS resolution against the DNS resolvers configured on the client system
								</p>
								 </td><td align="left" valign="top" headers="idm140081252897984"> <p>
									DNS
								</p>
								 </td><td align="left" valign="top" headers="idm140081252896896"> <p>
									To discover the IP addresses of IdM masters
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252899072"> <p>
									Requests to ports 88 (TCP/TCP6 and UDP/UDP6) on the discovered IdM masters
								</p>
								 </td><td align="left" valign="top" headers="idm140081252897984"> <p>
									Kerberos
								</p>
								 </td><td align="left" valign="top" headers="idm140081252896896"> <p>
									To obtain a Kerberos ticket
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252899072"> <p>
									JSON-RPC calls to the IdM Apache-based web-service on the discovered or configured IdM masters
								</p>
								 </td><td align="left" valign="top" headers="idm140081252897984"> <p>
									HTTPS
								</p>
								 </td><td align="left" valign="top" headers="idm140081252896896"> <p>
									IdM client enrollment; replica keys retrieval and certificate issuance if required
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252899072"> <p>
									Requests over TCP/TCP6 to port 389 on the IdM server, using SASL GSSAPI authentication, plain LDAP, or both
								</p>
								 </td><td align="left" valign="top" headers="idm140081252897984"> <p>
									LDAP
								</p>
								 </td><td align="left" valign="top" headers="idm140081252896896"> <p>
									IdM client enrollment; CA certificate chain retrieval; LDAP data replication
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252899072"> <p>
									Requests over TCP/TCP6 to port 22 on IdM server
								</p>
								 </td><td align="left" valign="top" headers="idm140081252897984"> <p>
									SSH
								</p>
								 </td><td align="left" valign="top" headers="idm140081252896896"> <p>
									To check if the connection is working
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252899072"> <p>
									(optionally) Access over port 8443 (TCP/TCP6) on the IdM master
								</p>
								 </td><td align="left" valign="top" headers="idm140081252897984"> <p>
									HTTPS
								</p>
								 </td><td align="left" valign="top" headers="idm140081252896896"> <p>
									To administer the Certificate Authority on the IdM master (only during IdM master and replica installation)
								</p>
								 </td></tr></tbody></table></div></div></section></section><section class="chapter" id="uninstalling-an-ipa-server2_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Uninstalling an IdM replica</h2></div></div></div><p>
				As an administrator, you can remove an Identity Management (IdM) server from the topology.
			</p><p>
				This procedure describes how you can uninstall an example server named <code class="literal">server.idm.example.com</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Before uninstalling a server that serves as a certificate authority (CA), key recovery authority (KRA), or DNS server, make sure these services are running on another server in the domain.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Removing the last server that serves as a CA, KRA, or DNS server seriously disrupts the Identity Management (IdM) functionality.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On all the servers in the topology that have a replication agreement with <code class="literal">server.idm.example.com</code>, use the <code class="literal command">ipa server-del</code> command to delete the replica from the topology:
					</p><pre class="literallayout">[root@another_server ~]# <span class="strong strong"><strong>ipa server-del server.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						On <code class="literal">server.idm.example.com</code>, use the <code class="literal command">ipa-server-install --uninstall</code> command:
					</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa-server-install --uninstall</strong></span>
...
Are you sure you want to continue with the uninstall procedure? [no]: yes</pre></li><li class="listitem">
						Make sure all name server (NS) DNS records pointing to <code class="literal">server.idm.example.com</code> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.
					</li></ol></div></section><section class="chapter" id="installing-the-ipa-healthcheck-tool_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 17. Installing the IdM Healthcheck tool</h2></div></div></div><p>
				This section describes the IdM Healthcheck tool and how to install it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Healthcheck tool is only available on RHEL 8.1 or later.
					</li></ul></div><section class="section" id="healthcheck-in-idm_installing-the-ipa-healthcheck-tool"><div class="titlepage"><div><div><h2 class="title">17.1. Healthcheck in IdM</h2></div></div></div><p>
					The Healthcheck tool in Identity Management (IdM) helps find issues that may impact the health of your IdM environment.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The Healthcheck tool is a command line tool that can be used without Kerberos authentication.
					</p></div></div><section class="section" id="modules_are_independent"><div class="titlepage"><div><div><h3 class="title">17.1.1. Modules are Independent</h3></div></div></div><p>
						Healthcheck consists of independent modules which test for:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replication issues
							</li><li class="listitem">
								Certificate validity
							</li><li class="listitem">
								Certificate Authority infrastructure issues
							</li><li class="listitem">
								IdM and Active Directory trust issues
							</li><li class="listitem">
								Correct file permissions and ownership settings
							</li></ul></div></section><section class="section" id="two_output_formats"><div class="titlepage"><div><div><h3 class="title">17.1.2. Two output formats</h3></div></div></div><p>
						Healthcheck generates the following outputs:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Human-readable output
							</li><li class="listitem">
								Machine-readable output in JSON format
							</li></ul></div><p>
						The output destination for both human and JSON is standard output by default. You can specify a different destination with the <code class="literal">--output-file</code> option.
					</p></section><section class="section" id="results"><div class="titlepage"><div><div><h3 class="title">17.1.3. Results</h3></div></div></div><p>
						Each Healthcheck module returns one of the following results:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">SUCCESS</span></dt><dd>
									configured as expected
								</dd><dt><span class="term">WARNING</span></dt><dd>
									not an error, but worth keeping an eye on or evaluating
								</dd><dt><span class="term">ERROR</span></dt><dd>
									not configured as expected
								</dd><dt><span class="term">CRITICAL</span></dt><dd>
									not configured as expected, with a high possibility for impact
								</dd></dl></div></section><section class="section" id="running_idm_healthcheck"><div class="titlepage"><div><div><h3 class="title">17.1.4. Running IdM Healthcheck</h3></div></div></div><p>
						Healthcheck can be run:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Manually
							</p><pre class="literallayout">[root@master ~]# <span class="strong strong"><strong>ipa-healthcheck</strong></span></pre><p class="simpara">
								For all options, see the man page: <code class="literal">man ipa-healthcheck</code>.
							</p></li><li class="listitem">
								Automatically using <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/collecting-idm-healthcheck-information_configuring-and-managing-idm#log-rotation_collecting-idm-healthcheck-information">log rotation</a>.
							</li></ul></div></section></section><section class="section" id="installing-ipa-healthcheck_installing-the-ipa-healthcheck-tool"><div class="titlepage"><div><div><h2 class="title">17.2. Installing IdM Healthcheck</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Install the <code class="literal">ipa-healthcheck</code> package:
						</p><pre class="literallayout">[root@master ~]# <span class="strong strong"><strong>dnf install ipa-healthcheck</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the <code class="literal option">--failures-only</code> option to have <code class="literal">ipa-healthcheck</code> only report errors. A fully-functioning IdM installation returns an empty result of <code class="literal">[]</code>.
						</p><pre class="literallayout">[root@master ~]# <span class="strong strong"><strong>ipa-healthcheck --failures-only</strong></span>
<span class="strong strong"><strong>[]</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Use <code class="literal">ipa-healthcheck --help</code> to see all supported arguments.
						</li></ul></div></section><section class="section" id="additional_resources_2"><div class="titlepage"><div><div><h2 class="title">17.3. Additional resources</h2></div></div></div><p>
					See the following sections of <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/index">Configuring and managing Identity Management</a> for examples of using IdM Healthcheck.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/checking-services-using-idm-healthcheck_configuring-and-managing-idm">Checking services</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/verifying-your-idm-and-ad-trust-configuration-using-idm-healthcheck_configuring-and-managing-idm">Verifying your IdM and AD trust configuration</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/verifying-certificates-using-idm-healthcheck_configuring-and-managing-idm">Verifying certificates</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/verifying-system-certificates-using-idm-healthcheck_configuring-and-managing-idm">Verifying system certificates</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/checking-disk-space-using-idm-healthcheck_configuring-and-managing-idm">Checking disk space</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/verifying-permissions-of-idm-configuration-files-using-healthcheck_configuring-and-managing-idm">Verifying permissions of IdM configuration files</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/checking-idm-replication-using-healthcheck_configuring-and-managing-idm">Checking replication</a>
						</li></ul></div></section></section><section class="chapter" id="installing-an-Identity-Management-server-using-an-Ansible-playbook_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 18. Installing an Identity Management server using an Ansible playbook</h2></div></div></div><section class="section" id="ansible-and-its-advantages-for-installing-IdM_server-ansible"><div class="titlepage"><div><div><h2 class="title">18.1. Ansible and its advantages for installing IdM</h2></div></div></div><p>
					Ansible is an automation tool used to configure systems, deploy software, and perform rolling updates. Ansible includes support for Identity Management (IdM), and you can use Ansible modules to automate installation tasks such as the setup of an IdM server, replica, client, or an entire IdM topology.
				</p><h4 id="advantages_of_using_ansible_to_install_idm">Advantages of using Ansible to install IdM</h4><p>
					The following list presents advantages of installing Identity Management using Ansible in contrast to manual installation.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You do not need to log into the managed node.
						</li><li class="listitem">
							You do not need to configure settings on each host to be deployed individually. Instead, you can have one inventory file to deploy a complete cluster.
						</li><li class="listitem">
							You can reuse an inventory file later for management tasks, for example to add users and hosts. You can reuse an inventory file even for such tasks as are not related to IdM.
						</li></ul></div></section><section class="section" id="IdM-server-installation-using-an-Ansible-playbook_server-ansible"><div class="titlepage"><div><div><h2 class="title">18.2. IdM server installation using an Ansible playbook</h2></div></div></div><p>
					The following sections describe how to configure a system as an IdM server by using <a class="link" href="https://www.ansible.com/">Ansible</a>. Configuring a system as an IdM server establishes an IdM domain and enables the system to offer IdM services to IdM clients. The deployment is managed by the <code class="literal">ipaserver</code> Ansible role.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Before installing an IdM server using Ansible, ensure that you understand <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> and IdM concepts. Ensure that you understand the following terms that are used in this chapter:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Ansible roles
							</li><li class="listitem">
								Ansible nodes
							</li><li class="listitem">
								Ansible inventory
							</li><li class="listitem">
								Ansible tasks
							</li><li class="listitem">
								Ansible modules
							</li><li class="listitem">
								Ansible plays and playbooks
							</li></ul></div></div></div><h3 id="overview">Overview</h3><p>
					The installation consists of the following parts:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							<a class="link" href="index.html#installing-the-ansible-freeipa-package_server-ansible" title="18.3. Installing the ansible-freeipa package">Installing the ansible-freeipa package</a>;
						</li><li class="listitem">
							<a class="link" href="index.html#deploying-an-idm-server-with-an-integrated-CA-using-an-ansible-playbook_server-ansible" title="18.5. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook">Deploying an IdM server with an integrated CA using an Ansible playbook</a>;
						</li><li class="listitem">
							<a class="link" href="index.html#deploying-an-idm-server-with-an-external-CA-using-an-ansible-playbook_server-ansible" title="18.6. Deploying an IdM server with an external CA as the root CA using an Ansible playbook">Deploying an IdM server with an external CA using an Ansible-playbook</a>.
						</li></ol></div></section><section class="section" id="installing-the-ansible-freeipa-package_server-ansible"><div class="titlepage"><div><div><h2 class="title">18.3. Installing the ansible-freeipa package</h2></div></div></div><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
						On the <span class="strong strong"><strong>managed node</strong></span>:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that the managed node is a Red Hat Enterprise Linux 8 system with a static IP address and a working package manager.
						</li></ul></div><p>
					On the <span class="strong strong"><strong>controller</strong></span>:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that the controller is a Red Hat Enterprise Linux system with a valid subscription. If this is not the case, see the official Ansible documentation <a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">Installation guide</a> for alternative installation instructions.
						</li><li class="listitem">
							Ensure that you can reach the managed node over the <code class="literal">SSH</code> protocol from the controller. Check that the managed node is listed in the <code class="literal">/root/.ssh/known_hosts</code> file of the controller.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Run the following procedure on the Ansible controller.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enable the required repository:
						</p><pre class="literallayout"># <span class="strong strong"><strong>subscription-manager repos --enable ansible-2.8-for-rhel-8-x86_64-rpms</strong></span></pre></li><li class="listitem"><p class="simpara">
							Install Ansible:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum install ansible</strong></span></pre></li><li class="listitem"><p class="simpara">
							Install the IdM Ansible roles:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum install ansible-freeipa</strong></span></pre><p class="simpara">
							The roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory.
						</p></li></ol></div></section><section class="section" id="ansible-roles-location-in-the-file-system_server-ansible"><div class="titlepage"><div><div><h2 class="title">18.4. Ansible roles location in the file system</h2></div></div></div><p>
					By default the <code class="literal">ansible-freeipa</code> roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory. The structure of the <code class="literal">ansible-freeipa</code> package is as follows:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/ansible/roles/</code> directory stores the <code class="literal">ipaserver</code>, <code class="literal">ipareplica</code>, and <code class="literal">ipaclient</code> roles on the Ansible controller. Each role directory stores examples, a basic overview, the licence and documentation about the role in a README.md Markdown file.
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/ansible/roles/</strong></span>
ipaclient
ipareplica
ipaserver</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory stores the documentation about individual roles and the topology in README.md Markdown files. It also stores the <code class="literal">playbooks/</code> subdirectory (see below).
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/</strong></span>
playbooks
README-client.md
README.md
README-replica.md
README-server.md
README-topology.md</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/</code> directory stores the example playbooks:
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/playbooks/</strong></span>
install-client.yml
install-cluster.yml
install-replica.yml
install-server.yml
uninstall-client.yml
uninstall-cluster.yml
uninstall-replica.yml
uninstall-server.yml</pre></li></ul></div></section><section class="section" id="deploying-an-idm-server-with-an-integrated-CA-using-an-ansible-playbook_server-ansible"><div class="titlepage"><div><div><h2 class="title">18.5. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook</h2></div></div></div><section class="section" id="setting-the-parameters-for-a-deployment-with-an-integrated-CA_server-ansible"><div class="titlepage"><div><div><h3 class="title">18.5.1. Setting the parameters for a deployment with an integrated CA as the root CA</h3></div></div></div><p>
						Complete this procedure to configure the inventory file for installing an IdM server with an integrated CA as the root CA.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Open the inventory file for editing. Specify the fully-qualified domain names (<code class="literal">FQDN</code>) of the host you want to use as an IdM server. Ensure that the <code class="literal">FQDN</code> meets the following criteria:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Only alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
									</li><li class="listitem">
										The host name must be all lower-case.
									</li></ul></div></li><li class="listitem">
								Specify the IdM domain and realm information.
							</li><li class="listitem">
								Specify if you want the IdM server to have an integrated DNS and if you want it to use forwarders from the <code class="literal">/etc/resolv.conf</code> file.
							</li><li class="listitem"><p class="simpara">
								Specify the passwords for <code class="literal">admin</code> and for the <code class="literal">Directory Manager</code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.
							</p><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (excluding the passwords)</strong></p><p>
									
<pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=yes
ipaserver_auto_forwarders=yes
[...]</pre>

								</p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (including the passwords)</strong></p><p>
									
<pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=yes
ipaserver_auto_forwarders=yes
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234

[...]</pre>

								</p></div><div class="formalpara"><p class="title"><strong>Example playbook to set up an IdM server using admin and Directory Manager passwords stored in an Ansible Vault file</strong></p><p>
									
<pre class="literallayout">---
- name: Playbook to configure IPA server
  hosts: ipaserver
  become: true
  vars_files:
  - playbook_sensitive_data.yml

  roles:
  - role: ipaserver
    state: present</pre>

								</p></div><div class="formalpara"><p class="title"><strong>Example playbook to set up an IdM server using admin and Directory Manager passwords from an inventory file</strong></p><p>
									
<pre class="literallayout">---
- name: Playbook to configure IPA server
  hosts: ipaserver
  become: true

  roles:
  - role: ipaserver
    state: present</pre>

								</p></div></li></ol></div><p>
						For details on installing the IdM server and the available options, see <a class="xref" href="index.html#installing-idm" title="Part I. Installing Identity Management">Part I, “Installing Identity Management”</a>.
					</p></section><section class="section" id="deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible"><div class="titlepage"><div><div><h3 class="title">18.5.2. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook</h3></div></div></div><p>
						Complete this procedure to deploy an IdM server with an integrated certificate authority (CA) as the root CA using an Ansible playbook.
					</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Run the <code class="literal">ansible-playbook</code> command with the name of the playbook file, for example <code class="literal">install-server.yml</code>. Specify the inventory file with the <code class="literal">-i</code> option:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/install-server.yml</strong></span></pre><p class="simpara">
								Specify the level of verbosity by using the <code class="literal">-v</code>, <code class="literal">-vv</code>, or <code class="literal">-vvv</code> option.
							</p><p class="simpara">
								You can view the output of the Ansible playbook script on the command-line interface (CLI). The following output shows that the script has run successfully as 0 tasks have failed:
							</p><pre class="literallayout">PLAY RECAP
server.idm.example.com : ok=18   changed=10   unreachable=0    <span class="strong strong"><strong>failed=0</strong></span>    skipped=21   rescued=0    ignored=0</pre></li></ul></div><p>
						You have installed an IdM server on your host using an Ansible playbook.
					</p></section></section><section class="section" id="deploying-an-idm-server-with-an-external-CA-using-an-ansible-playbook_server-ansible"><div class="titlepage"><div><div><h2 class="title">18.6. Deploying an IdM server with an external CA as the root CA using an Ansible playbook</h2></div></div></div><section class="section" id="setting-the-parameters-for-a-deployment-with-an-external-CA_server-ansible"><div class="titlepage"><div><div><h3 class="title">18.6.1. Setting the parameters for a deployment with an external CA as the root CA</h3></div></div></div><p>
						Complete this procedure to configure the inventory file for installing an IdM server with an external CA as the root CA.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Open the inventory file for editing. Specify the fully-qualified domain names (<code class="literal">FQDN</code>) of the host you want to use as an IdM server. Ensure that the <code class="literal">FQDN</code> meets the following criteria:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Only alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
									</li><li class="listitem">
										The host name must be all lower-case.
									</li></ul></div></li><li class="listitem">
								Specify the IdM domain and realm information.
							</li><li class="listitem">
								Specify if you want the IdM server to have an integrated DNS and if you want it to use forwarders from the <code class="literal">/etc/resolv.conf</code> file.
							</li><li class="listitem"><p class="simpara">
								Specify the passwords for <code class="literal">admin</code> and for the <code class="literal">Directory Manager</code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.
							</p><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (excluding the passwords)</strong></p><p>
									
<pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=yes
ipaserver_auto_forwarders=yes
[...]</pre>

								</p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (including the passwords)</strong></p><p>
									
<pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=yes
ipaserver_auto_forwarders=yes
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234

[...]</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Create a playbook for the first step of the installation. Enter instructions for generating the certificate signing request (CSR) and copying it from the controller to the managed node.
							</p><div class="figure" id="idm140081249268512"><p class="title"><strong>Figure 18.1. Example playbook to set up an IdM server with an externally signed CA using admin and Directory Manager passwords stored in an Ansible Vault file: First step</strong></p><div class="figure-contents"><div class="mediaobject"><img src="external-CA-server-ansible-install-step-1.png" alt="external CA server ansible install step 1"/></div></div></div></li><li class="listitem"><p class="simpara">
								Create another playbook for the final step of the installation.
							</p><div class="figure" id="idm140081248911728"><p class="title"><strong>Figure 18.2. Example playbook to set up an IdM server with an externally signed CA using admin and Directory Manager passwords stored in an Ansible Vault file: Final step</strong></p><div class="figure-contents"><div class="mediaobject"><img src="external-CA-server-ansible-install-step-2.png" alt="external CA server ansible install step 2"/></div></div></div></li></ol></div><p>
						For details on the options available to you when installing an IdM server with an externally signed CA, see <a class="xref" href="index.html#installing-an-ipa-server-with-external-ca_installing-identity-management" title="Chapter 3. Installing an IdM server: With integrated DNS, with an external CA as the root CA">Chapter 3, <em>Installing an IdM server: With integrated DNS, with an external CA as the root CA</em></a>.
					</p></section><section class="section" id="deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible"><div class="titlepage"><div><div><h3 class="title">18.6.2. Deploying an IdM server with an external CA as the root CA using an Ansible playbook</h3></div></div></div><p>
						Complete this procedure to deploy an IdM server with an external certificate authority (CA) as the root CA using an Ansible playbook.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run the <code class="literal">ansible-playbook</code> command with the name of the playbook file that contains instructions for the first step of the installation, for example <code class="literal">install-server-step1.yml</code>. Specify the inventory file with the <code class="literal">-i</code> option:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i &lt;path_to_inventory_directory&gt;/host.server &lt;path_to_playbooks_directory&gt;/install-server-step1.yml</strong></span></pre><p class="simpara">
								Specify the level of verbosity by using the <code class="literal">-v</code>, <code class="literal">-vv</code> or <code class="literal">-vvv</code> option.
							</p><p class="simpara">
								You can view the output of the Ansible playbook script on the command-line interface (CLI). The following output shows that the script has run successfully as 0 tasks have failed:
							</p><pre class="literallayout">PLAY RECAP
server.idm.example.com : ok=18   changed=10   unreachable=0    <span class="strong strong"><strong>failed=0</strong></span>    skipped=21   rescued=0    ignored=0</pre></li><li class="listitem">
								Locate the <code class="literal">ipa.csr</code> certificate signing request file on the controller and submit it to the external CA.
							</li><li class="listitem">
								Place the IdM CA certificate signed by the external CA in the controller file system so that the playbook in the next step can find it.
							</li><li class="listitem"><p class="simpara">
								Run the <code class="literal">ansible-playbook</code> command with the name of the playbook file that contains instructions for the final step of the installation, for example <code class="literal">install-server-step2.yml</code>. Specify the inventory file with the <code class="literal">-i</code> option:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i &lt;path_to_inventory_directory&gt;/host.server &lt;path_to_playbooks_directory&gt;/install-server-step2.yml</strong></span></pre></li></ol></div><p>
						You have installed an IdM server with an externally signed CA on your host using an Ansible playbook.
					</p></section></section></section><section class="chapter" id="installing-an-Identity-Management-replica-using-an-ansible-playbook_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 19. Installing an Identity Management replica using an Ansible playbook</h2></div></div></div><section class="section" id="ansible-and-its-advantages-for-installing-IdM_replica-ansible"><div class="titlepage"><div><div><h2 class="title">19.1. Ansible and its advantages for installing IdM</h2></div></div></div><p>
					Ansible is an automation tool used to configure systems, deploy software, and perform rolling updates. Ansible includes support for Identity Management (IdM), and you can use Ansible modules to automate installation tasks such as the setup of an IdM server, replica, client, or an entire IdM topology.
				</p><h4 id="advantages_of_using_ansible_to_install_idm_2">Advantages of using Ansible to install IdM</h4><p>
					The following list presents advantages of installing Identity Management using Ansible in contrast to manual installation.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You do not need to log into the managed node.
						</li><li class="listitem">
							You do not need to configure settings on each host to be deployed individually. Instead, you can have one inventory file to deploy a complete cluster.
						</li><li class="listitem">
							You can reuse an inventory file later for management tasks, for example to add users and hosts. You can reuse an inventory file even for such tasks as are not related to IdM.
						</li></ul></div></section><section class="section" id="IdM-replica-installation-using-an-Ansible-playbook-intro_replica-ansible"><div class="titlepage"><div><div><h2 class="title">19.2. IdM replica installation using an Ansible playbook</h2></div></div></div><p>
					The following sections describe how to configure a system as an IdM replica by using <a class="link" href="https://www.ansible.com/">Ansible</a>. Configuring a system as an IdM replica enrolls it into an IdM domain and enables the system to use IdM services on IdM servers in the domain.
				</p><p>
					The deployment is managed by the <code class="literal">ipareplica</code> Ansible role. The role can use the autodiscovery mode for identifying the IdM servers, domain and other settings. However, if you deploy multiple replicas in a tier-like model, with different groups of replicas being deployed at different times, you must defined specific servers or replicas for each group.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Before installing an IdM replica using Ansible, ensure that you understand <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> and IdM concepts. Ensure that you understand the following terms that are used in this chapter:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Ansible roles
							</li><li class="listitem">
								Ansible nodes
							</li><li class="listitem">
								Ansible inventory
							</li><li class="listitem">
								Ansible tasks
							</li><li class="listitem">
								Ansible modules
							</li><li class="listitem">
								Ansible plays and playbooks
							</li></ul></div></div></div><h3 id="overview_2">Overview</h3><p>
					The installation consists of the following parts:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							<a class="link" href="index.html#installing-the-ansible-freeipa-package_replica-ansible" title="19.3. Installing the ansible-freeipa package">Installing the ansible-freeipa package</a>;
						</li><li class="listitem"><p class="simpara">
							<a class="link" href="index.html#setting-the-parameters-of-the-IdM-replica-deployment_replica-ansible" title="19.5. Setting the parameters of the IdM replica deployment">Setting the parameters of the IdM replica deployment</a>, namely:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<a class="link" href="index.html#specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible" title="19.5.1. Specifying the base, server and client variables for installing the IdM replica">Specifying the base, server and client variables for installing the IdM replica</a>;
								</li><li class="listitem">
									<a class="link" href="index.html#specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible" title="19.5.2. Specifying the credentials for installing the IdM replica using an Ansible playbook">Specifying the credentials for installing the IdM replica using an Ansible playbook</a>;
								</li></ul></div></li><li class="listitem">
							<a class="link" href="index.html#deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible" title="19.6. Deploying an IdM replica using an Ansible playbook">Deploying an IdM replica using an Ansible playbook</a>.
						</li></ol></div></section><section class="section" id="installing-the-ansible-freeipa-package_replica-ansible"><div class="titlepage"><div><div><h2 class="title">19.3. Installing the ansible-freeipa package</h2></div></div></div><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
						On the <span class="strong strong"><strong>managed node</strong></span>:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that the managed node is a Red Hat Enterprise Linux 8 system with a static IP address and a working package manager.
						</li></ul></div><p>
					On the <span class="strong strong"><strong>controller</strong></span>:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that the controller is a Red Hat Enterprise Linux system with a valid subscription. If this is not the case, see the official Ansible documentation <a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">Installation guide</a> for alternative installation instructions.
						</li><li class="listitem">
							Ensure that you can reach the managed node over the <code class="literal">SSH</code> protocol from the controller. Check that the managed node is listed in the <code class="literal">/root/.ssh/known_hosts</code> file of the controller.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Run the following procedure on the Ansible controller.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enable the required repository:
						</p><pre class="literallayout"># <span class="strong strong"><strong>subscription-manager repos --enable ansible-2.8-for-rhel-8-x86_64-rpms</strong></span></pre></li><li class="listitem"><p class="simpara">
							Install Ansible:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum install ansible</strong></span></pre></li><li class="listitem"><p class="simpara">
							Install the IdM Ansible roles:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum install ansible-freeipa</strong></span></pre><p class="simpara">
							The roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory.
						</p></li></ol></div></section><section class="section" id="ansible-roles-location-in-the-file-system_replica-ansible"><div class="titlepage"><div><div><h2 class="title">19.4. Ansible roles location in the file system</h2></div></div></div><p>
					By default the <code class="literal">ansible-freeipa</code> roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory. The structure of the <code class="literal">ansible-freeipa</code> package is as follows:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/ansible/roles/</code> directory stores the <code class="literal">ipaserver</code>, <code class="literal">ipareplica</code>, and <code class="literal">ipaclient</code> roles on the Ansible controller. Each role directory stores examples, a basic overview, the licence and documentation about the role in a README.md Markdown file.
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/ansible/roles/</strong></span>
ipaclient
ipareplica
ipaserver</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory stores the documentation about individual roles and the topology in README.md Markdown files. It also stores the <code class="literal">playbooks/</code> subdirectory (see below).
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/</strong></span>
playbooks
README-client.md
README.md
README-replica.md
README-server.md
README-topology.md</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/</code> directory stores the example playbooks:
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/playbooks/</strong></span>
install-client.yml
install-cluster.yml
install-replica.yml
install-server.yml
uninstall-client.yml
uninstall-cluster.yml
uninstall-replica.yml
uninstall-server.yml</pre></li></ul></div></section><section class="section" id="setting-the-parameters-of-the-IdM-replica-deployment_replica-ansible"><div class="titlepage"><div><div><h2 class="title">19.5. Setting the parameters of the IdM replica deployment</h2></div></div></div><p>
					Before you deploy a target host as an IdM replica, configure the following settings:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="index.html#specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible" title="19.5.1. Specifying the base, server and client variables for installing the IdM replica">Specify the base, server and client variables for installing the IdM replica.</a>
						</li><li class="listitem">
							<a class="link" href="index.html#specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible" title="19.5.2. Specifying the credentials for installing the IdM replica using an Ansible playbook">Specify the credentials for installing the IdM replica using an Ansible playbook.</a>
						</li></ul></div><section class="section" id="specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible"><div class="titlepage"><div><div><h3 class="title">19.5.1. Specifying the base, server and client variables for installing the IdM replica</h3></div></div></div><p>
						Complete this procedure to configure the inventory file for installing an IdM replica.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Open the inventory file for editing. Specify the fully-qualified domain names (<code class="literal">FQDN</code>) of the hosts to become IdM replicas. The <code class="literal">FQDNs</code> must be valid DNS names:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Only numbers, alphabetic characters, and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
									</li><li class="listitem"><p class="simpara">
										The host name must be all lower-case.
									</p><div class="formalpara"><p class="title"><strong>Example of a simple inventory hosts file with only the replicas' FQDN defined</strong></p><p>
											
<pre class="literallayout">[ipareplicas]
replica1.idm.example.com
replica2.idm.example.com
replica3.idm.example.com
[...]</pre>

										</p></div><p class="simpara">
										If the IdM master server is already deployed and the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values.
									</p></li></ul></div></li><li class="listitem"><p class="simpara">
								Optionally, provide additional information in the inventory file based on which of the following scenarios is closest to yours:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Scenario 1</strong></span>
									</p><p class="simpara">
										If you want to avoid autodiscovery and have all replicas listed in the <code class="literal">[ipareplicas]</code> section use a specific IdM server, set the server in the <code class="literal">[ipaservers]</code> section of the inventory file.
									</p><div class="formalpara"><p class="title"><strong>Example inventory hosts file with the FQDN of the IdM server and replicas defined</strong></p><p>
											
<pre class="literallayout">[ipaservers]
server.idm.example.com

[ipareplicas]
replica1.idm.example.com
replica2.idm.example.com
replica3.idm.example.com
[...]</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Scenario 2</strong></span>
									</p><p class="simpara">
										Alternatively, if you want to avoid autodiscovery but want to deploy specific replicas with specific servers, set the servers for specific replicas individually in the <code class="literal">[ipareplicas]</code> section in the inventory file.
									</p><div class="formalpara"><p class="title"><strong>Example inventory file with a specific IdM server defined for a specific replica</strong></p><p>
											
<pre class="literallayout">[ipaservers]
server.idm.example.com
replica1.idm.example.com

[ipareplicas]
replica2.idm.example.com
<span class="strong strong"><strong>replica3.idm.example.com ipareplica_servers=replica1.idm.example.com</strong></span></pre>

										</p></div><p class="simpara">
										In the example above, <code class="literal">replica3.idm.example.com</code> uses the already deployed <code class="literal">replica1.idm.example.com</code> as its master server.
									</p></li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Scenario 3</strong></span>
									</p><p class="simpara">
										If you are deploying several replicas in one batch and time is a concern to you, multitier replica deployment can be useful for you. Define specific groups of replicas in the inventory file, for example <code class="literal">[ipareplicas_tier1]</code> and <code class="literal">[ipareplicas_tier2]</code>, and design separate plays for each group in the <code class="literal">install-replica.yml</code> playbook.
									</p><div class="formalpara"><p class="title"><strong>Example inventory file with replica tiers defined</strong></p><p>
											
<pre class="literallayout">[ipaservers]
server.idm.example.com

<span class="strong strong"><strong>[ipareplicas_tier1]</strong></span>
replica1.idm.example.com

<span class="strong strong"><strong>[ipareplicas_tier2]</strong></span>
replica2.idm.example.com \ ipareplica_servers=replica1.idm.example.com,server.idm.example.com</pre>

										</p></div><p class="simpara">
										The first entry in <code class="literal">ipareplica_servers</code> will be used as the master. The second entry will be used as a fallback option. When using multiple tiers for deploying IdM replicas, you must have separate tasks in the playbook to first deploy replicas from tier1 and then replicas from tier2:
									</p><div class="formalpara"><p class="title"><strong>Example of a playbook file with different plays for different replica groups</strong></p><p>
											
<pre class="literallayout">---
- name: Playbook to configure IPA replicas (tier1)
  hosts: ipareplicas_tier1
  become: true

  roles:
  - role: ipareplica
    state: present

- name: Playbook to configure IPA replicas (tier2)
  hosts: ipareplicas_tier2
  become: true

  roles:
  - role: ipareplica
    state: present</pre>

										</p></div></li></ul></div></li></ol></div></section><section class="section" id="specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible"><div class="titlepage"><div><div><h3 class="title">19.5.2. Specifying the credentials for installing the IdM replica using an Ansible playbook</h3></div></div></div><p>
						Complete this procedure to configure the authorization for installing the IdM replica.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Specify the <span class="strong strong"><strong>password of a user authorized to deploy replicas</strong></span>, for example the IdM <code class="literal">admin</code>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Red Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example <code class="literal">install-replica.yml</code>:
									</p><div class="formalpara"><p class="title"><strong>Example playbook file using principal from inventory file and password from an Ansible Vault file</strong></p><p>
											
<pre class="literallayout">- name: Playbook to configure IPA replicas
  hosts: ipareplicas
  become: true
  vars_files:
  - <code class="literal">playbook_sensitive_data.yml</code>

  roles:
  - role: ipareplica
    state: present</pre>

										</p></div><p class="simpara">
										For details how to use Ansible Vault, see the official <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Ansible Vault</a> documentation.
									</p></li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Less securely, provide the credentials of <code class="literal">admin</code> directly in the inventory file. Use the <code class="literal">ipaadmin_password</code> option in the <code class="literal">[ipareplicas:vars]</code> section of the inventory file. The inventory file and the <code class="literal">install-replica.yml</code> playbook file can then look as follows:
									</p><div class="formalpara"><p class="title"><strong>Example inventory hosts.replica file</strong></p><p>
											
<pre class="literallayout">[...]
[ipareplicas:vars]
<span class="strong strong"><strong>ipaadmin_password=Secret123</strong></span></pre>

										</p></div><div class="formalpara"><p class="title"><strong>Example playbook using principal and password from inventory file</strong></p><p>
											
<pre class="literallayout">- name: Playbook to configure IPA replicas
  hosts: ipareplicas
  become: true

  roles:
  - role: ipareplica
    state: present</pre>

										</p></div></li><li class="listitem"><p class="simpara">
										Alternatively but also less securely, provide the credentials of another user authorized to deploy a replica directly in the inventory file. To specify a different authorized user, use the <code class="literal">ipaadmin_principal</code> option for the user name, and the <code class="literal">ipaadmin_password</code> option for the password. The inventory file and the <code class="literal">install-replica.yml</code> playbook file can then look as follows:
									</p><div class="formalpara"><p class="title"><strong>Example inventory hosts.replica file</strong></p><p>
											
<pre class="literallayout">[...]
[ipareplicas:vars]
<span class="strong strong"><strong>ipaadmin_principal=my_admin</strong></span>
<span class="strong strong"><strong>ipaadmin_password=my_admin_secret123</strong></span></pre>

										</p></div><div class="formalpara"><p class="title"><strong>Example playbook using principal and password from inventory file</strong></p><p>
											
<pre class="literallayout">- name: Playbook to configure IPA replicas
  hosts: ipareplicas
  become: true

  roles:
  - role: ipareplica
    state: present</pre>

										</p></div></li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								For details on the options accepted by the <code class="literal">ipareplica</code> Ansible role, see the <code class="literal">/usr/share/ansible/roles/ipareplica/README.md</code> Markdown file.
							</li></ul></div></section></section><section class="section" id="deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible"><div class="titlepage"><div><div><h2 class="title">19.6. Deploying an IdM replica using an Ansible playbook</h2></div></div></div><p>
					Complete this procedure to use an Ansible playbook to deploy an IdM replica.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To install an IdM replica using an Ansible playbook, use the <code class="literal">ansible-playbook</code> command with the name of the playbook file, for example <code class="literal">install-replica.yml</code>. Specify the inventory file with the <code class="literal">-i</code> option:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i &lt;path_to_inventory_directory&gt;/hosts.replica &lt;path_to_playbooks_directory&gt;/install-replica.yml</strong></span></pre><p class="simpara">
							Specify the level of verbosity by using the <code class="literal">-v</code>, <code class="literal">-vv</code> or <code class="literal">-vvv</code> option.
						</p><p class="simpara">
							Ansible informs you about the execution of the Ansible playbook script. The following output shows that the script has run successfully as 0 tasks have failed:
						</p><pre class="literallayout">PLAY RECAP
replica.idm.example.com : ok=18   changed=10   unreachable=0    <span class="strong strong"><strong>failed=0</strong></span>    skipped=21   rescued=0    ignored=0</pre></li></ul></div><p>
					You have now installed an IdM replica.
				</p></section></section><section class="chapter" id="installing-an-Identity-Management-client-using-an-ansible-playbook_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 20. Installing an Identity Management client using an Ansible playbook</h2></div></div></div><section class="section" id="ansible-and-its-advantages-for-installing-IdM_client-ansible"><div class="titlepage"><div><div><h2 class="title">20.1. Ansible and its advantages for installing IdM</h2></div></div></div><p>
					Ansible is an automation tool used to configure systems, deploy software, and perform rolling updates. Ansible includes support for Identity Management (IdM), and you can use Ansible modules to automate installation tasks such as the setup of an IdM server, replica, client, or an entire IdM topology.
				</p><h4 id="advantages_of_using_ansible_to_install_idm_3">Advantages of using Ansible to install IdM</h4><p>
					The following list presents advantages of installing Identity Management using Ansible in contrast to manual installation.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							You do not need to log into the managed node.
						</li><li class="listitem">
							You do not need to configure settings on each host to be deployed individually. Instead, you can have one inventory file to deploy a complete cluster.
						</li><li class="listitem">
							You can reuse an inventory file later for management tasks, for example to add users and hosts. You can reuse an inventory file even for such tasks as are not related to IdM.
						</li></ul></div></section><section class="section" id="IdM-client-installation-using-an-Ansible-playbook_client-ansible"><div class="titlepage"><div><div><h2 class="title">20.2. IdM client installation using an Ansible playbook</h2></div></div></div><p>
					The following sections describe how to configure a system as an Identity Management (IdM) client by using <a class="link" href="https://www.ansible.com/">Ansible</a>. Configuring a system as an IdM client enrolls it into an IdM domain and enables the system to use IdM services on IdM servers in the domain.
				</p><p>
					The deployment is managed by the <code class="literal">ipaclient</code> Ansible role. By default, the role uses the autodiscovery mode for identifying the IdM servers, domain and other settings. The role can be modified to have the Ansible playbook use the settings specified, for example in the inventory file.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Before installing an IdM client using Ansible, ensure that you understand <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> and IdM concepts. Ensure that you understand the following terms that are used in this chapter:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Ansible roles
							</li><li class="listitem">
								Ansible nodes
							</li><li class="listitem">
								Ansible inventory
							</li><li class="listitem">
								Ansible tasks
							</li><li class="listitem">
								Ansible modules
							</li><li class="listitem">
								Ansible plays and playbooks
							</li></ul></div></div></div><h3 id="overview_3">Overview</h3><p>
					The installation consists of the following parts:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							<a class="link" href="index.html#installing-the-ansible-freeipa-package_client-ansible" title="20.3. Installing the ansible-freeipa package">Installing the ansible-freeipa package</a>;
						</li><li class="listitem"><p class="simpara">
							<a class="link" href="index.html#installing-ipa-client-ansible_client-ansible" title="20.5. Setting the parameters of the IdM client deployment">Setting the parameters of the IdM client deployment</a> to correspond to your deployment scenario:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Setting the parameters of the inventory file <a class="link" href="index.html#setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible" title="20.5.1. Setting the parameters of the inventory file for the autodiscovery client installation mode">for the autodiscovery client installation mode</a>;
								</li><li class="listitem">
									Setting the parameters of the inventory file <a class="link" href="index.html#setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible" title="20.5.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation">for when autodiscovery is not possible during client installation</a>;
								</li></ul></div></li><li class="listitem">
							<a class="link" href="index.html#checking-the-parameters-in-the-install-client-yml-file_client-ansible" title="20.5.3. Checking the parameters in the install-client.yml file">Checking the parameters in install-client.yml</a>;
						</li><li class="listitem">
							<a class="link" href="index.html#deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible" title="20.6. Deploying an IdM client using an Ansible playbook">Deploying an IdM client using an Ansible playbook</a>;
						</li><li class="listitem">
							<a class="link" href="index.html#testing-an-Identity-Management-after-Ansible-installation_client-ansible" title="20.7. Testing an Identity Management client after Ansible installation">Testing an Identity Management client after installation</a>.
						</li></ol></div></section><section class="section" id="installing-the-ansible-freeipa-package_client-ansible"><div class="titlepage"><div><div><h2 class="title">20.3. Installing the ansible-freeipa package</h2></div></div></div><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
						On the <span class="strong strong"><strong>managed node</strong></span>:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that the managed node is a Red Hat Enterprise Linux 8 system with a static IP address and a working package manager.
						</li></ul></div><p>
					On the <span class="strong strong"><strong>controller</strong></span>:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Ensure that the controller is a Red Hat Enterprise Linux system with a valid subscription. If this is not the case, see the official Ansible documentation <a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">Installation guide</a> for alternative installation instructions.
						</li><li class="listitem">
							Ensure that you can reach the managed node over the <code class="literal">SSH</code> protocol from the controller. Check that the managed node is listed in the <code class="literal">/root/.ssh/known_hosts</code> file of the controller.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Run the following procedure on the Ansible controller.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enable the required repository:
						</p><pre class="literallayout"># <span class="strong strong"><strong>subscription-manager repos --enable ansible-2.8-for-rhel-8-x86_64-rpms</strong></span></pre></li><li class="listitem"><p class="simpara">
							Install Ansible:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum install ansible</strong></span></pre></li><li class="listitem"><p class="simpara">
							Install the IdM Ansible roles:
						</p><pre class="literallayout"># <span class="strong strong"><strong>yum install ansible-freeipa</strong></span></pre><p class="simpara">
							The roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory.
						</p></li></ol></div></section><section class="section" id="ansible-roles-location-in-the-file-system_client-ansible"><div class="titlepage"><div><div><h2 class="title">20.4. Ansible roles location in the file system</h2></div></div></div><p>
					By default the <code class="literal">ansible-freeipa</code> roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory. The structure of the <code class="literal">ansible-freeipa</code> package is as follows:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/ansible/roles/</code> directory stores the <code class="literal">ipaserver</code>, <code class="literal">ipareplica</code>, and <code class="literal">ipaclient</code> roles on the Ansible controller. Each role directory stores examples, a basic overview, the licence and documentation about the role in a README.md Markdown file.
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/ansible/roles/</strong></span>
ipaclient
ipareplica
ipaserver</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory stores the documentation about individual roles and the topology in README.md Markdown files. It also stores the <code class="literal">playbooks/</code> subdirectory (see below).
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/</strong></span>
playbooks
README-client.md
README.md
README-replica.md
README-server.md
README-topology.md</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/</code> directory stores the example playbooks:
						</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/playbooks/</strong></span>
install-client.yml
install-cluster.yml
install-replica.yml
install-server.yml
uninstall-client.yml
uninstall-cluster.yml
uninstall-replica.yml
uninstall-server.yml</pre></li></ul></div></section><section class="section" id="installing-ipa-client-ansible_client-ansible"><div class="titlepage"><div><div><h2 class="title">20.5. Setting the parameters of the IdM client deployment</h2></div></div></div><p>
					Before you deploy a target host as an IdM client, configure the <a class="link" href="index.html#checking-the-parameters-in-the-install-client-yml-file_client-ansible" title="20.5.3. Checking the parameters in the install-client.yml file">deployment instructions</a> on the control node. Additionally, configure the target host parameters depending on which of the following options you are planning:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="index.html#setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible" title="20.5.1. Setting the parameters of the inventory file for the autodiscovery client installation mode">Using the autodiscovery client installation mode</a>
						</li><li class="listitem">
							<a class="link" href="index.html#setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible" title="20.5.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation">Specifying the <code class="literal">FQDN</code> of the IdM server and the domain or realm information</a>.
						</li></ul></div><section class="section" id="setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible"><div class="titlepage"><div><div><h3 class="title">20.5.1. Setting the parameters of the inventory file for the autodiscovery client installation mode</h3></div></div></div><p>
						To install an Identity Management client using an Ansible playbook, provide the following information in an inventory file, for example <code class="literal">inventory/hosts</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								the information about the host
							</li><li class="listitem">
								the authorization for the task
							</li></ul></div><p>
						The inventory file can be in one of many formats, depending on the inventory plugins you have. The <code class="literal">INI-like</code> format is one of Ansible’s defaults and is used in the examples below.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Specify the fully-qualified hostname (<code class="literal">FQDN</code>) of the host to become an IdM client. The fully qualified domain name must be a valid DNS name:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Only numbers, alphabetic characters, and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
									</li><li class="listitem"><p class="simpara">
										The host name must be all lower-case. No capital letters are allowed.
									</p><p class="simpara">
										If the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values.
									</p></li></ul></div><div class="formalpara"><p class="title"><strong>Example of a simple inventory hosts file with only the client FQDN defined</strong></p><p>
									
<pre class="literallayout">[ipaclients]
client.idm.example.com
[...]</pre>

								</p></div></li><li class="listitem"><p class="simpara">
								Specify the credentials for enrolling the client. The following authentication methods are available:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>. This is the default option.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
												Red Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example <code class="literal">install-client.yml</code>, directly:
											</p><div class="formalpara"><p class="title"><strong>Example playbook file using principal from inventory file and password from an Ansible Vault file</strong></p><p>
													
<pre class="literallayout">- name: Playbook to configure IPA clients with username/password
  hosts: ipaclients
  become: true
  vars_files:
  - <code class="literal">playbook_sensitive_data.yml</code>

  roles:
  - role: ipaclient
    state: present</pre>

												</p></div></li><li class="listitem"><p class="simpara">
												Less securely, provide the credentials of <code class="literal">admin</code> using the <code class="literal">ipaadmin_password</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Alternatively, to specify a different authorized user, use the <code class="literal">ipaadmin_principal</code> option for the user name, and the <code class="literal">ipaadmin_password</code> option for the password. The <code class="literal">inventory/hosts</code> inventory file and the <code class="literal">install-client.yml</code> playbook file can then look as follows:
											</p><div class="formalpara"><p class="title"><strong>Example inventory hosts file</strong></p><p>
													
<pre class="literallayout">[...]
[ipaclients:vars]
<span class="strong strong"><strong>ipaadmin_principal=my_admin</strong></span>
<span class="strong strong"><strong>ipaadmin_password=Secret123</strong></span></pre>

												</p></div><div class="formalpara"><p class="title"><strong>Example Playbook using principal and password from inventory file</strong></p><p>
													
<pre class="literallayout">- name: Playbook to unconfigure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>

												</p></div></li></ul></div></li><li class="listitem"><p class="simpara">
										The <span class="strong strong"><strong>client keytab</strong></span> from the previous enrollment if it is still available:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												This option is available if the system was previously enrolled as an Identity Management client. To use this authentication method, uncomment the <code class="literal">#ipaclient_keytab</code> option, specifying the path to the file storing the keytab, for example in the <code class="literal">[ipaclient:vars]</code> section of <code class="literal">inventory/hosts</code>.
											</li></ul></div></li><li class="listitem"><p class="simpara">
										A <span class="strong strong"><strong>random, one-time password</strong></span> (OTP) to be generated during the enrollment. To use this authentication method, use the <code class="literal">ipaclient_use_otp=yes</code> option in your inventory file. For example, you can uncomment the <code class="literal">ipaclient_use_otp=yes</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Note that with OTP you must also specify one of the following options:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>, for example by providing a value for <code class="literal">ipaadmin_password</code> in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file.
											</li><li class="listitem">
												The <span class="strong strong"><strong>admin keytab</strong></span>, for example by providing a value for <code class="literal">ipaadmin_keytab</code> in the <code class="literal">[ipaclients:vars]</code> section of <code class="literal">inventory/hosts</code>.
											</li></ul></div></li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								For details on the options accepted by the <code class="literal">ipaclient</code> Ansible role, see the <code class="literal">/usr/share/ansible/roles/ipaclient/README.md</code> README file.
							</li></ul></div></section><section class="section" id="setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible"><div class="titlepage"><div><div><h3 class="title">20.5.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation</h3></div></div></div><p>
						To install an Identity Management client using an Ansible playbook, provide the following information in an inventory file, for example <code class="literal">inventory/hosts</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								the information about the host, the IdM server and the IdM domain or the IdM realm
							</li><li class="listitem">
								the authorization for the task
							</li></ul></div><p>
						The inventory file can be in one of many formats, depending on the inventory plugins you have. The <code class="literal">INI-like</code> format is one of Ansible’s defaults and is used in the examples below.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Specify the fully-qualified hostname (<code class="literal">FQDN</code>) of the host to become an IdM client. The fully qualified domain name must be a valid DNS name:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Only numbers, alphabetic characters, and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
									</li><li class="listitem">
										The host name must be all lower-case. No capital letters are allowed.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Specify other options in the relevant sections of the <code class="literal">inventory/hosts</code> file:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										the <code class="literal">FQDN</code> of the servers in the <code class="literal">[ipaservers]</code> section to indicate which IdM server the client will be enrolled with
									</li><li class="listitem"><p class="simpara">
										one of the two following options:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												the <code class="literal">ipaclient_domain</code> option in the <code class="literal">[ipaclients:vars]</code> section to indicate the DNS domain name of the IdM server the client will be enrolled with
											</li><li class="listitem"><p class="simpara">
												the <code class="literal">ipaclient_realm</code> option in the <code class="literal">[ipaclients:vars]</code> section to indicate the name of the Kerberos realm controlled by the IdM server
											</p><div class="formalpara"><p class="title"><strong>Example of an inventory hosts file with the client FQDN, the server FQDN and the domain defined</strong></p><p>
													
<pre class="literallayout">[ipaclients]
<span class="strong strong"><strong>client.idm.example.com</strong></span>

[ipaservers]
<span class="strong strong"><strong>server.idm.example.com</strong></span>

[ipaclients:vars]
<span class="strong strong"><strong>ipaclient_domain=idm.example.com</strong></span>
[...]</pre>

												</p></div></li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
								Specify the credentials for enrolling the client. The following authentication methods are available:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>. This is the default option.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
												Red Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example <code class="literal">install-client.yml</code>, directly:
											</p><div class="formalpara"><p class="title"><strong>Example playbook file using principal from inventory file and password from an Ansible Vault file</strong></p><p>
													
<pre class="literallayout">- name: Playbook to configure IPA clients with username/password
  hosts: ipaclients
  become: true
  vars_files:
  - <code class="literal">playbook_sensitive_data.yml</code>

  roles:
  - role: ipaclient
    state: present</pre>

												</p></div></li><li class="listitem"><p class="simpara">
												Less securely, provide the credentials of <code class="literal">admin</code> using the <code class="literal">ipaadmin_password</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Alternatively, to specify a different authorized user, use the <code class="literal">ipaadmin_principal</code> option for the user name, and the <code class="literal">ipaadmin_password</code> option for the password. The <code class="literal">install-client.yml</code> playbook file can then look as follows:
											</p><div class="formalpara"><p class="title"><strong>Example inventory hosts file</strong></p><p>
													
<pre class="literallayout">[...]
[ipaclients:vars]
<span class="strong strong"><strong>ipaadmin_principal=my_admin</strong></span>
<span class="strong strong"><strong>ipaadmin_password=Secret123</strong></span></pre>

												</p></div><div class="formalpara"><p class="title"><strong>Example Playbook using principal and password from inventory file</strong></p><p>
													
<pre class="literallayout">- name: Playbook to unconfigure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>

												</p></div></li></ul></div></li><li class="listitem"><p class="simpara">
										The <span class="strong strong"><strong>client keytab</strong></span> from the previous enrollment if it is still available:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												This option is available if the system was previously enrolled as an Identity Management client. To use this authentication method, uncomment the <code class="literal">ipaclient_keytab</code> option, specifying the path to the file storing the keytab, for example in the <code class="literal">[ipaclient:vars]</code> section of <code class="literal">inventory/hosts</code>.
											</li></ul></div></li><li class="listitem"><p class="simpara">
										A <span class="strong strong"><strong>random, one-time password</strong></span> (OTP) to be generated during the enrollment. To use this authentication method, use the <code class="literal">ipaclient_use_otp=yes</code> option in your inventory file. For example, you can uncomment the <code class="literal">#ipaclient_use_otp=yes</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Note that with OTP you must also specify one of the following options:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>, for example by providing a value for <code class="literal">ipaadmin_password</code> in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file.
											</li><li class="listitem">
												The <span class="strong strong"><strong>admin keytab</strong></span>, for example by providing a value for <code class="literal">ipaadmin_keytab</code> in the <code class="literal">[ipaclients:vars]</code> section of <code class="literal">inventory/hosts</code>.
											</li></ul></div></li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								For details on the options accepted by the <code class="literal">ipaclient</code> Ansible role, see the <code class="literal">/usr/share/ansible/roles/ipaclient/README.md</code> README file.
							</li></ul></div></section><section class="section" id="checking-the-parameters-in-the-install-client-yml-file_client-ansible"><div class="titlepage"><div><div><h3 class="title">20.5.3. Checking the parameters in the install-client.yml file</h3></div></div></div><p>
						The <code class="literal">install-client.yml</code> playbook file contains instructions for the IdM client deployment.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Open the file and check if the instructions in the playbook correspond to what you are planning for your deployment. The contents typically look like this:
							</p><pre class="literallayout">---
- name: Playbook to configure IPA clients with username/password
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: present</pre><p class="simpara">
								This is what the individual entries mean:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The hosts entry specifies the section of the <code class="literal">inventory/hosts</code> file where the ansible script searches the <code class="literal">FQDNs</code> of the hosts on which the <code class="literal">ipa-client-install</code> script shall be run.
									</li><li class="listitem">
										The <code class="literal">become: true</code> entry specifies that root’s credentials will be invoked during the execution of the <code class="literal">ipa-client-install</code> script.
									</li><li class="listitem">
										The <code class="literal">role: ipaclient</code> entry specifies the role that will be installed on the host: in this case, it is the ipa client role.
									</li><li class="listitem">
										The <code class="literal">state: present</code> entry specifies that the client should be installed rather than uninstalled (<code class="literal">absent</code>).
									</li></ul></div></li></ul></div></section><section class="section" id="authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible"><div class="titlepage"><div><div><h3 class="title">20.5.4. Authorization options for IdM client enrollment using an Ansible playbook</h3></div></div></div><p>
						This referential section presents individual authorization options for IdM client enrollment with examples of inventory and playbook files.
					</p><div class="table" id="authorization-client-enrollment-ansible_client-ansible"><p class="title"><strong>Table 20.1. Authorization options for IdM client enrollment using Ansible</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 13%; " class="col_1"><!--Empty--></col><col style="width: 13%; " class="col_2"><!--Empty--></col><col style="width: 37%; " class="col_3"><!--Empty--></col><col style="width: 37%; " class="col_4"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081252109232" scope="col">Authorization option</th><th align="left" valign="top" id="idm140081252108144" scope="col">Note</th><th align="left" valign="top" id="idm140081252107056" scope="col">Example inventory file</th><th align="left" valign="top" id="idm140081252105968" scope="col">Example <code class="literal">install-client.yml</code> playbook file</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081252109232"> <p>
										Password of a user authorized to enroll a client: Option 1
									</p>
									 </td><td align="left" valign="top" headers="idm140081252108144"> <p>
										Password stored in Ansible vault
									</p>
									 </td><td align="left" valign="top" headers="idm140081252107056">
<pre class="screen">[ipaclients:vars]
[...]</pre>
									 </td><td align="left" valign="top" headers="idm140081252105968">
<pre class="screen">- name: Playbook to configure IPA clients with username/password
  hosts: ipaclients
  become: true
  vars_files:
  - playbook_sensitive_data.yml

  roles:
  - role: ipaclient
    state: present</pre>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081252109232"> <p>
										Password of a user authorized to enroll a client: Option 2
									</p>
									 </td><td align="left" valign="top" headers="idm140081252108144"> <p>
										Password stored in inventory file
									</p>
									 </td><td align="left" valign="top" headers="idm140081252107056">
<pre class="screen">[ipaclients:vars]
ipaadmin_password=Secret123</pre>
									 </td><td align="left" valign="top" headers="idm140081252105968">
<pre class="screen">- name: Playbook to configure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081252109232"> <p>
										A random, one-time password (OTP): Option 1
									</p>
									 </td><td align="left" valign="top" headers="idm140081252108144"> <p>
										OTP + administrator password
									</p>
									 </td><td align="left" valign="top" headers="idm140081252107056">
<pre class="screen">[ipaclients:vars]
ipaadmin_password=Secret123
ipaclient_use_otp=yes</pre>
									 </td><td align="left" valign="top" headers="idm140081252105968">
<pre class="screen">- name: Playbook to configure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081252109232"> <p>
										A random, one-time password (OTP): Option 2
									</p>
									 </td><td align="left" valign="top" headers="idm140081252108144"> <p>
										OTP + an admin keytab
									</p>
									 </td><td align="left" valign="top" headers="idm140081252107056">
<pre class="screen">[ipaclients:vars]
ipaadmin_keytab=/tmp/admin.keytab
ipaclient_use_otp=yes</pre>
									 </td><td align="left" valign="top" headers="idm140081252105968">
<pre class="screen">- name: Playbook to configure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>
									 </td></tr><tr><td align="left" valign="top" headers="idm140081252109232"> <p>
										The client keytab from the previous enrollment
									</p>
									 </td><td align="left" valign="top" headers="idm140081252108144"> </td><td align="left" valign="top" headers="idm140081252107056">
<pre class="screen">[ipaclients:vars]
ipaclient_keytab=/tmp/krb5.keytab</pre>
									 </td><td align="left" valign="top" headers="idm140081252105968">
<pre class="screen">- name: Playbook to configure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>
									 </td></tr></tbody></table></div></div></section></section><section class="section" id="deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible"><div class="titlepage"><div><div><h2 class="title">20.6. Deploying an IdM client using an Ansible playbook</h2></div></div></div><p>
					Complete this procedure to use an Ansible playbook to deploy an IdM client in your IdM environment.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To install an IdM client using an Ansible playbook, use the <code class="literal">ansible-playbook</code> command with the name of the playbook file, for example <code class="literal">install-client.yml</code>. Specify the inventory file with the <code class="literal">-i</code> option:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i inventory/hosts install-client.yml</strong></span></pre><p class="simpara">
							Specify the level of verbosity by using the <code class="literal">-v</code>, <code class="literal">-vv</code> or <code class="literal">-vvv</code> option.
						</p><p class="simpara">
							Ansible informs you about the execution of the Ansible playbook script. The following output shows that the script has run successfully as no tasks have failed:
						</p><pre class="literallayout">PLAY RECAP
<span class="strong strong"><strong>client1.idm.example.com : ok=18 changed=10 unreachable=0 failed=0 skipped=21 rescued=0 ignored=0</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Ansible uses different colors to provide different types of information about the running process. You can modify the default colors in the <code class="literal">[colors]</code> section of the <code class="literal">/etc/ansible/ansible.cfg</code> file:
							</p><pre class="literallayout">[colors]
[...]
#error = red
#debug = dark gray
#deprecate = purple
#skip = cyan
#unreachable = red
#ok = green
#changed = yellow
[...]</pre></div></div></li></ul></div><p>
					You have now installed an IdM client on your host using an Ansible playbook.
				</p></section><section class="section" id="testing-an-Identity-Management-after-Ansible-installation_client-ansible"><div class="titlepage"><div><div><h2 class="title">20.7. Testing an Identity Management client after Ansible installation</h2></div></div></div><p>
					The command-line interface (CLI) informs you that the <code class="literal command">ansible-playbook</code> command was successful, but you can also do your own test.
				</p><p>
					To test that the Identity Management client can obtain information about users defined on the server, check that you are able to resolve a user defined on the server. For example, to check the default <code class="literal">admin</code> user:
				</p><pre class="literallayout">[user@client1 ~]$ <span class="strong strong"><strong>id admin</strong></span>
uid=1254400000(admin) gid=1254400000(admins) groups=1254400000(admins)</pre><p>
					To test that authentication works correctly, <code class="literal command">su -</code> as another already existing IdM user:
				</p><pre class="literallayout">[user@client1 ~]$ <span class="strong strong"><strong>su - idm_user</strong></span>
Last login: Thu Oct 18 18:39:11 CEST 2018 from 192.168.122.1 on pts/0
[idm_user@client1 ~]$</pre></section></section></div><div class="part" id="integrating-idm-and-ad"><div class="titlepage"><div><div><h1 class="title">Part II. Integrating IdM and AD</h1></div></div></div><section class="chapter" id="installing-trust-between-idm-and-ad_installing-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 21. Installing trust between IdM and AD</h2></div></div></div><p>
				This chapter aims to help you create a trust between the Identity Management IdM server and Active Directory (AD), where both servers are located in the same forest.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						First, read the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/planning_identity_management/planning-a-cross-forest-trust-between-idm-and-ad_planning-dns-and-host-names">Planning a cross-forest trust between Identity Management and Active Directory</a> document.
					</li><li class="listitem">
						AD is installed with a domain controller on it.
					</li><li class="listitem"><p class="simpara">
						The IdM server is installed and running.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_identity_management/index">Installing Identity Management</a>.
							</li></ul></div></li><li class="listitem">
						Both the AD server and the IdM server must have their clocks in sync because Kerberos requires max 5 mins delay in communication.
					</li><li class="listitem"><p class="simpara">
						Unique NetBIOS names for each of the servers placed in the trust because the NetBIOS names are critical for identifying the Active Directory domain.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The NetBIOS name of an Active Directory or IdM domain is usually the first part of the corresponding DNS domain. If the DNS domain is <code class="literal">ad.example.com</code>, the NetBIOS name is typically <code class="literal">AD</code>. However, it is not required. Important is that the NetBIOS name is just one word without periods. The maximum length of a NetBIOS name is 15 characters.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The IdM system must have the IPv6 protocol enabled in the kernel.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								If IPv6 is disabled, then the CLDAP plug-in used by the IdM services fails to initialize.
							</li></ul></div></li></ul></div><section class="section" id="supported-versions-of-windows-server_installing-trust-between-idm-and-ad"><div class="titlepage"><div><div><h2 class="title">21.1. Supported versions of Windows Server</h2></div></div></div><p>
					You can establish a trust relationship with Active Directory (AD) forests that use the following forest and domain functional levels:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Forest functional level range: Windows Server 2008 — Windows Server 2016
						</li><li class="listitem">
							Domain functional level range: Windows Server 2008 — Windows Server 2016
						</li></ul></div><p>
					Identity Management (IdM) supports the following operating systems:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Windows Server 2008
						</li><li class="listitem">
							Windows Server 2008 R2
						</li><li class="listitem">
							Windows Server 2012
						</li><li class="listitem">
							Windows Server 2012 R2
						</li><li class="listitem">
							Windows Server 2016
						</li><li class="listitem">
							Windows Server 2019
						</li></ul></div></section><section class="section" id="how-the-trust-works_installing-trust-between-idm-and-ad"><div class="titlepage"><div><div><h2 class="title">21.2. How the trust works</h2></div></div></div><p>
					The trust between Identity Management IdM and Active Directory (AD) is established on the Cross-realm Kerberos trust. This solution uses the Kerberos capability to establish trusts between different identity sources. Therefore, all AD users can:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Log in to access Linux systems and resources.
						</li><li class="listitem">
							Use single sign-on (SSO).
						</li></ul></div><p>
					All IdM objects are managed in IdM in the trust.
				</p><p>
					All AD objects are managed in AD in the trust.
				</p><p>
					In complex environments, a single IdM forest can be connected to multiple AD forests. This setup enables better separation of duties for different functions in the organization. AD administrators can focus on users and policies related to users while Linux administrators have full control over the Linux infrastructure. In such a case, the Linux realm controlled by IdM is analogous to an AD resource domain or realm but with Linux systems in it.
				</p><p>
					From the perspective of AD, Identity Management represents a separate AD forest with a single AD domain. When cross-forest trust between an AD forest root domain and an IdM domain is established, users from the AD forest domains can interact with Linux machines and services from the IdM domain.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						In trust environments, IdM enables you to use ID views to configure POSIX attributes for AD users on the IdM server.
					</p></div></div></section><section class="section" id="ad-administration-rights_installing-trust-between-idm-and-ad"><div class="titlepage"><div><div><h2 class="title">21.3. AD administration rights</h2></div></div></div><p>
					When you want to build a trust between AD (Active Directory) and IdM (Identity Management), you will need to use an AD administrator account with appropriate AD privileges.
				</p><p>
					Such an AD administrator must be a member of one of the following groups:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Enterprise Admin group in the AD forest
						</li><li class="listitem">
							Domain Admins group in the forest root domain for your AD forest
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Related information</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For details about Enterprise Admins, see <a class="link" href="https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups#bkmk-entadmins">Enterprise Admins</a>.
						</li><li class="listitem">
							For details about Domain Admins, see <a class="link" href="https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups#bkmk-domainadmins">Domain Admins</a>.
						</li><li class="listitem">
							For details about AD trust, see <a class="link" href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc773178(v=ws.10)">How Domain and Forest Trusts Work</a>.
						</li></ul></div></section><section class="section" id="ports-required-for-communication-between-idm-and-ad_installing-trust-between-idm-and-ad"><div class="titlepage"><div><div><h2 class="title">21.4. Ports required for communication between IdM and AD</h2></div></div></div><p>
					To enable communication between Active Directory (AD) domain controllers and Identity Management (IdM) servers, you must open ports on their firewalls.
				</p><div class="table" id="idm140081249055552"><p class="title"><strong>Table 21.1. Ports required for an AD trust</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081252760960" scope="col">Service</th><th align="left" valign="top" id="idm140081252759872" scope="col">Port</th><th align="left" valign="top" id="idm140081252758784" scope="col">Protocol</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081252760960"> <p>
									Endpoint resolution portmapper
								</p>
								 </td><td align="left" valign="top" headers="idm140081252759872"> <p>
									135
								</p>
								 </td><td align="left" valign="top" headers="idm140081252758784"> <p>
									TCP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252760960"> <p>
									NetBIOS-DGM
								</p>
								 </td><td align="left" valign="top" headers="idm140081252759872"> <p>
									138
								</p>
								 </td><td align="left" valign="top" headers="idm140081252758784"> <p>
									TCP and UDP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252760960"> <p>
									NetBIOS-SSN
								</p>
								 </td><td align="left" valign="top" headers="idm140081252759872"> <p>
									139
								</p>
								 </td><td align="left" valign="top" headers="idm140081252758784"> <p>
									TCP and UDP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252760960"> <p>
									Microsoft-DS
								</p>
								 </td><td align="left" valign="top" headers="idm140081252759872"> <p>
									445
								</p>
								 </td><td align="left" valign="top" headers="idm140081252758784"> <p>
									TCP and UDP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252760960"> <p>
									Endpoint mapper listener range
								</p>
								 </td><td align="left" valign="top" headers="idm140081252759872"> <p>
									1024-1300
								</p>
								 </td><td align="left" valign="top" headers="idm140081252758784"> <p>
									TCP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252760960"> <p>
									AD Global Catalog
								</p>
								 </td><td align="left" valign="top" headers="idm140081252759872"> <p>
									3268
								</p>
								 </td><td align="left" valign="top" headers="idm140081252758784"> <p>
									TCP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252760960"> <p>
									LDAP
								</p>
								 </td><td align="left" valign="top" headers="idm140081252759872"> <p>
									389
								</p>
								 </td><td align="left" valign="top" headers="idm140081252758784"> <p>
									TCP and UDP
								</p>
								 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The TCP port 389 is not required to be open on IdM servers for trust, but it is necessary for clients communicating with the IdM server.
					</p></div></div><p>
					To open ports, you can use the following methods:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Firewalld service — you can enable the particular ports or enable the following services which includes the ports:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									FreeIPA trust setup
								</li><li class="listitem">
									FreeIPA with LDAP
								</li><li class="listitem">
									Kerberos
								</li><li class="listitem">
									DNS
								</li></ul></div><p class="simpara">
							For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/using-and-configuring-firewalls_configuring-and-managing-networking#controlling-ports-using-cli_controlling-network-traffic-using-firewalld">Controlling ports using CLI</a>.
						</p></li><li class="listitem"><p class="simpara">
							The RHEL web console, which is a UI with firewall settings based od firewalld.
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="cockpit-trust-ports.png" alt="cockpit trust ports"/></span>

						</p></li></ul></div><p>
					For details about firewall configuration through the web console, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_web_console/using-the-web-console-for-managing-firewall_system-management-using-the-web-console#enabling-services-on-firewall-using-web-console_using-the-web-console-for-managing-firewall">Enabling services on firewall using the web console</a>.
				</p><div class="table" id="idm140081252200016"><p class="title"><strong>Table 21.2. Ports required by IdM servers in a trust</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081252194224" scope="col">Service</th><th align="left" valign="top" id="idm140081252193136" scope="col">Port</th><th align="left" valign="top" id="idm140081252192048" scope="col">Protocol</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081252194224"> <p>
									Kerberos
								</p>
								 </td><td align="left" valign="top" headers="idm140081252193136"> <p>
									88, 464
								</p>
								 </td><td align="left" valign="top" headers="idm140081252192048"> <p>
									TCP and UDP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252194224"> <p>
									LDAP
								</p>
								 </td><td align="left" valign="top" headers="idm140081252193136"> <p>
									389
								</p>
								 </td><td align="left" valign="top" headers="idm140081252192048"> <p>
									TCP
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140081252194224"> <p>
									DNS
								</p>
								 </td><td align="left" valign="top" headers="idm140081252193136"> <p>
									53
								</p>
								 </td><td align="left" valign="top" headers="idm140081252192048"> <p>
									TCP and UDP
								</p>
								 </td></tr></tbody></table></div></div><div class="table" id="idm140081252041936"><p class="title"><strong>Table 21.3. Ports required by IdM clients in an AD trust</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140081252036144" scope="col">Service</th><th align="left" valign="top" id="idm140081252035056" scope="col">Port</th><th align="left" valign="top" id="idm140081252033968" scope="col">Protocol</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081252036144"> <p>
									Kerberos
								</p>
								 </td><td align="left" valign="top" headers="idm140081252035056"> <p>
									88
								</p>
								 </td><td align="left" valign="top" headers="idm140081252033968"> <p>
									UDP and TCP
								</p>
								 </td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">libkrb5</code> library uses UDP and falls back to the TCP protocol if the data sent from the Key Distribution Centre (KDC) is too large. Active Directory attaches a Privilege Attribute Certificate (PAC) to the Kerberos ticket, which increases the size and requires to use the TCP protocol. To avoid the fall-back and resending the request, by default, SSSD in Red Hat Enterprise Linux 7.4 and later uses TCP for user authentication. If you want to configure the size before libkrb5 uses TCP, set the <code class="literal">udp_preference_limit</code> in the <code class="literal">/etc/krb.5.conf</code> file. For details, see the <code class="literal">krb5.conf(5)</code> man page.
					</p></div></div></section><section class="section" id="configuring-dns-and-realm-settings-for-a-trust_installing-trust-between-idm-and-ad"><div class="titlepage"><div><div><h2 class="title">21.5. Configuring DNS and realm settings for a trust</h2></div></div></div><p>
					Before you connect Identity Management (IdM) and Active Directory (AD) in a trust, you need to ensure that servers see each other and resolve domain names correctly. This scenario describes configuring DNS to allow using domain names between:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							One primary IdM server using integrated DNS server and Certification Authority.
						</li><li class="listitem">
							One AD Domain Controller.
						</li></ul></div><p>
					DNS settings require:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Configuring DNS zones in the IdM server
						</li><li class="listitem">
							Configuring conditional DNS forwarding in AD
						</li><li class="listitem">
							Verifying correctness of the DNS configuration
						</li></ul></div><section class="section" id="unique-primary-dns-domains_configuring-dns-and-realm-settings-for-a-trust"><div class="titlepage"><div><div><h3 class="title">21.5.1. Unique primary DNS domains</h3></div></div></div><p>
						In Windows, every domain is a Kerberos realm and a DNS domain at the same time. Every domain managed by the domain controller needs to have its own dedicated DNS zone. The same applies when Identity Management (IdM) is trusted by Active Directory (AD) as a forest. AD expects IdM to have its own DNS domain. For the trust setup to work, the DNS domain needs to be dedicated to the Linux environment.
					</p><p>
						Each system must have its own unique primary DNS domain configured. For example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal"><span class="emphasis"><em>ad.example.com</em></span></code> for AD and <code class="literal"><span class="emphasis"><em>idm.example.com</em></span></code> for IdM
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>example.com</em></span></code> for AD and <code class="literal"><span class="emphasis"><em>idm.example.com</em></span></code> for IdM
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>ad.example.com</em></span></code> for AD and <code class="literal"><span class="emphasis"><em>example.com</em></span></code> for IdM
							</li></ul></div><p>
						The most convenient management solution is an environment where each DNS domain is managed by integrated DNS servers, but it is possible to use any other standard-compliant DNS server as well.
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Kerberos realm names as upper-case versions of primary DNS domain names</span></dt><dd>
									Kerberos realm names must be the same as the primary DNS domain names, with all letters uppercase. For example, if the domain names are <code class="literal"><span class="emphasis"><em>ad.example.com</em></span></code> for AD and <code class="literal"><span class="emphasis"><em>idm.example.com</em></span></code> for IdM, the Kerberos realm names are required to be <code class="literal"><span class="emphasis"><em>AD.EXAMPLE.COM</em></span></code> and <code class="literal"><span class="emphasis"><em>IDM.EXAMPLE.COM</em></span></code>.
								</dd><dt><span class="term">DNS records resolvable from all DNS domains in the trust</span></dt><dd>
									All machines must be able to resolve DNS records from all DNS domains involved in the trust relationship.
								</dd><dt><span class="term">No overlap between IdM and AD DNS domains</span></dt><dd>
									Machines joined to IdM can be distributed over multiple DNS domains. DNS domains containing IdM clients must not overlap with DNS domains containing machines joined to AD. The primary IdM DNS domain must have proper SRV records to support AD trusts.
								</dd></dl></div><p>
						You can acquire a list of the required SRV records specific to your system setup by running the following command:
					</p><pre class="literallayout">$ ipa dns-update-system-records --dry-run</pre><p>
						The generated list can look for example like this:
					</p><pre class="literallayout">IPA DNS records:
  _kerberos-master._tcp.idm.example.com. 86400 IN SRV 0 100 88 server.idm.example.com.
  _kerberos-master._udp.idm.example.com. 86400 IN SRV 0 100 88 server.idm.example.com.
  _kerberos._tcp.idm.example.com. 86400 IN SRV 0 100 88 server.idm.example.com.
  _kerberos._tcp.idm.example.com. 86400 IN SRV 0 100 88 server.idm.example.com.
  _kerberos.idm.example.com. 86400 IN TXT "IDM.EXAMPLE.COM"
  _kpasswd._tcp.idm.example.com. 86400 IN SRV 0 100 464 server.idm.example.com.
  _kpasswd._udp.idm.example.com. 86400 IN SRV 0 100 464 server.idm.example.com.
  _ldap._tcp.idm.example.com. 86400 IN SRV 0 100 389 server.idm.example.com.
  _ipa-ca.idm.example.com. 86400 IN A 192.168.122.2</pre><p>
						For other DNS domains that are part of the same IdM realm, it is not required for the SRV records to be configured when the trust to AD is configured. The reason is that AD domain controllers do not use SRV records to discover KDCs but rather base the KDC discovery on name suffix routing information for the trust.
					</p></section><section class="section" id="configuring-dns-zones-in-idm_configuring-dns-and-realm-settings-for-a-trust"><div class="titlepage"><div><div><h3 class="title">21.5.2. Configuring DNS zones in the IdM Web UI</h3></div></div></div><p>
						This section describes how to add a new DNS forward zone to the Identity Management (IdM) server.
					</p><p>
						DNS forward zones enables you to forward DNS queries for a specific zone to a different DNS server.
					</p><p>
						For example, on your IdM server, you want to forward queries for the Active Directory (AD) domain.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Access to the IdM Web UI with a user account which have administrator rights.
							</li><li class="listitem">
								Correctly configured DNS server.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the IdM Web UI with administrator privileges. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_start-stop-ipa">Accessing the IdM Web UI in a web browser</a>.
							</li><li class="listitem">
								Click on the <span class="strong strong"><strong>Network Services</strong></span> tab.
							</li><li class="listitem">
								Click on the <span class="strong strong"><strong>DNS</strong></span> tab.
							</li><li class="listitem"><p class="simpara">
								In the drop down menu, click on the <span class="strong strong"><strong>DNS Forward Zones</strong></span> item.
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="web_ui-dns-tab.png" alt="web ui dns tab"/></span>

							</p></li><li class="listitem">
								Click on the <span class="strong strong"><strong>Add</strong></span> button.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Add DNS forward zone</strong></span> dialog box, add a zone name.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Zone forwarders</strong></span> item, click on the <span class="strong strong"><strong>Add</strong></span> button.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Zone forwarders</strong></span> field, add the IP address of the server for which you want to create the new forward zone.
							</li><li class="listitem"><p class="simpara">
								Click on the <span class="strong strong"><strong>Add</strong></span> button.
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="web_ui-forward-zone-add.png" alt="web ui forward zone add"/></span>

							</p></li></ol></div><p>
						The forwarded zone has been added to the DNS settings and you can verify it in the DNS Forward Zones settings. The Web UI informs you about success with the following pop-up message: <span class="strong strong"><strong>DNS Forward Zone successfully added.</strong></span>
					</p><p>
						You can perform the same procedure in the command line with the following command:
					</p><pre class="literallayout"># ipa dnsforwardzone-add $AD_DOMAIN --forwarder=$AD_IP_ADDR --forward-policy=only</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The Web UI can display a warning about DNSSEC validation failure after adding a new forward zone to the configuration.
						</p><p>
							<span class="inlinemediaobject"><img src="web_ui-forward-zone-dnssec-valid.png" alt="web ui forward zone dnssec valid"/></span>

						</p><p>
							DNSSEC (Domain Name System Security Extensions) secures DNS data with a digital signature to protect DNS from attacks. The DNSSEC service is enabled by default in the IdM server. The warning appeared because the remote DNS server didn’t also use the DNSSEC. Now, you can:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Enable DNSSEC on the remote DNS server.
								</li><li class="listitem">
									Disable the DNSSEC validation in the <code class="literal">/etc/named.conf</code> file saved in the IdM server:
								</li></ul></div><pre class="literallayout">dnssec-validation no;</pre><p>
							After saving the configuration change, do not forget to restart the ipactl service:
						</p><pre class="literallayout"># ipactl restart</pre><p>
							The warning will not appear again.
						</p></div></div><p>
						To verify that the dns zone has been created successfully, use the <code class="literal">nslookup</code> command with the name of the remote DNS server:
					</p><pre class="literallayout">$ nslookup ad.example.com
Server:        192.168.122.2
Address:       192.168.122.2#53

No-authoritative answer:
Name:          ad.example.com
Address:       192.168.122.3</pre><p>
						If the domain forwarding is configured correctly, <code class="literal">nslookup</code> will show you an IP address of the remote DNS server.
					</p></section><section class="section" id="configuring-dns-forwarding-in-ad_configuring-dns-and-realm-settings-for-a-trust"><div class="titlepage"><div><div><h3 class="title">21.5.3. Configuring DNS forwarding in AD</h3></div></div></div><p>
						This section describes how to set up a DNS forwarding in Active Directory (AD) for the Identity Management (IdM) server.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Windows Server with AD installed.
							</li><li class="listitem">
								DNS port open on both servers.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the Windows Server.
							</li><li class="listitem">
								Open <span class="strong strong"><strong>Server Manager</strong></span>.
							</li><li class="listitem">
								Open <span class="strong strong"><strong>DNS Manager</strong></span>.
							</li><li class="listitem"><p class="simpara">
								In <span class="strong strong"><strong>Conditional Forwarders</strong></span>, add a new conditional forwarder with:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The IdM server IP address
									</li><li class="listitem">
										A fully qualified domain name, for example, <code class="literal"><span class="emphasis"><em>server.idm.example.com</em></span></code>
									</li></ul></div></li><li class="listitem">
								Save the settings.
							</li></ol></div></section><section class="section" id="verifying-the-dns-configuration_configuring-dns-and-realm-settings-for-a-trust"><div class="titlepage"><div><div><h3 class="title">21.5.4. Verifying the DNS configuration</h3></div></div></div><p>
						Before configuring trust, verify that the Identity Management (IdM) and Active Directory (AD) servers can resolve themselves and each other.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You need to be logged in with sudo permissions.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run a DNS query for the Kerberos over UDP and LDAP over TCP service records.
							</p><pre class="literallayout">[admin@server ~]# dig +short -t SRV _kerberos._udp.idm.example.com.
0 100 88 server.ipa.example.com.

[admin@server ~]# dig +short -t SRV _ldap._tcp.idm.example.com.
0 100 389 server.idm.example.com.</pre><p class="simpara">
								The commands are expected to list all IdM servers.
							</p></li><li class="listitem"><p class="simpara">
								Run a DNS query for the TXT record with the IdM Kerberos realm name. The obtained value is expected to match the Kerberos realm you specified when installing IdM.
							</p><pre class="literallayout">[admin@server ~]# dig +short -t TXT _kerberos.idm.example.com.
"IDM.EXAMPLE.COM"</pre></li><li class="listitem"><p class="simpara">
								Verify that IdM is able to resolve service records for AD with a command that runs a DNS query for Kerberos over UDP and LDAP over TCP service records:
							</p><pre class="literallayout">[admin@server ~]# dig +short -t SRV _kerberos._udp.dc._msdcs.ad.example.com.
0 100 88 addc1.ad.example.com.

[admin@server ~]# dig +short -t SRV _ldap._tcp.dc._msdcs.ad.example.com.
0 100 389 addc1.ad.example.com.</pre></li></ol></div></section></section><section class="section" id="setting-up-a-trust_installing-trust-between-idm-and-ad"><div class="titlepage"><div><div><h2 class="title">21.6. Setting up a trust</h2></div></div></div><p>
					This section describes how to configure the Identity Management (IdM)/Active Directory (AD) trust on the IdM side using the command line.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							DNS correctly configured. Both IdM and AD servers must be able to resolve each other names. For details, see <a class="link" href="index.html#unique-primary-dns-domains_configuring-dns-and-realm-settings-for-a-trust" title="21.5.1. Unique primary DNS domains">Configuring DNS and realm settings for a trust</a>.
						</li><li class="listitem">
							Having supported versions of AD and IdM deployed. For details, see <a class="link" href="index.html#supported-versions-of-windows-server_installing-trust-between-idm-and-ad" title="21.1. Supported versions of Windows Server">Supported versions of Windows Server</a>.
						</li><li class="listitem">
							Obtained a Kerberos ticket. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/logging-in-to-ipa-from-the-command-line_configuring-and-managing-idm#using-kinit-to-log-in-to-ipa_login-cli">Using kinit to log in to IdM manually</a>.
						</li></ul></div><section class="section" id="preparing-the-idm-server-for-the-trust_setting-up-a-trust"><div class="titlepage"><div><div><h3 class="title">21.6.1. Preparing the IdM server for the trust</h3></div></div></div><p>
						Before you can establish a trust with AD and if you want to set up Samba on an IdM client, you must prepare the IdM domain using the <code class="literal">ipa-adtrust-install</code> utility on an IdM server. However, even if both situations apply, you must run <code class="literal">ipa-adtrust-install</code> only once on an IdM master.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								IdM is installed.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Install the required packages:
							</p><pre class="literallayout">[root@ipaserver ~]# yum install ipa-server ipa-server-trust-ad samba-client</pre></li><li class="listitem"><p class="simpara">
								Authenticate as the IdM administrative user:
							</p><pre class="literallayout">[root@ipaserver ~]# kinit admin</pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">ipa-adtrust-install</code> utility:
							</p><pre class="literallayout">[root@ipaserver ~]# ipa-adtrust-install</pre><p class="simpara">
								The DNS service records are created automatically if IdM was installed with an integrated DNS server.
							</p><p class="simpara">
								If IdM was installed without an integrated DNS server, <code class="literal">ipa-adtrust-install</code> prints a list of service records that must be manually added to DNS before you can continue.
							</p></li><li class="listitem"><p class="simpara">
								The script prompts you that the <code class="literal">/etc/samba/smb.conf</code> already exists and will be rewritten:
							</p><pre class="literallayout">WARNING: The smb.conf already exists. Running ipa-adtrust-install will break your existing Samba configuration.

Do you wish to continue? [no]: yes</pre></li><li class="listitem"><p class="simpara">
								The script prompts you to configure the <code class="literal">slapi-nis</code> plug-in, a compatibility plug-in that allows older Linux clients to work with trusted users:
							</p><pre class="literallayout">Do you want to enable support for trusted domains in Schema Compatibility plugin?
This will allow clients older than SSSD 1.9 and non-Linux clients to work with trusted users.

Enable trusted domains support in slapi-nis? [no]: yes</pre></li><li class="listitem"><p class="simpara">
								When prompted, enter the NetBIOS name for the IdM domain or press <span class="strong strong"><strong>Enter</strong></span> to accept the name suggested:
							</p><pre class="literallayout">Trust is configured but no NetBIOS domain name found, setting it now.
Enter the NetBIOS name for the IPA domain.
Only up to 15 uppercase ASCII letters, digits and dashes are allowed.
Example: EXAMPLE.

NetBIOS domain name [IDM]:</pre></li><li class="listitem"><p class="simpara">
								You are prompted to run the SID generation task to create a SID for any existing users:
							</p><pre class="literallayout">Do you want to run the ipa-sidgen task? [no]: yes</pre><p class="simpara">
								When the directory is first installed, at least one user (the IdM administrator) exists and as this is a resource-intensive task, if you have a high number of users, you can run this at another time.
							</p></li><li class="listitem"><p class="simpara">
								Make sure that DNS is properly configured, as described in <a class="link" href="index.html#verifying-the-dns-configuration_configuring-dns-and-realm-settings-for-a-trust" title="21.5.4. Verifying the DNS configuration">Verifying the DNS configuration for a trust</a>.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Every time you run <code class="literal">ipa-adtrust-install</code>, Red Hat strongly recommends you to verify the DNS configuration as described in <a class="link" href="index.html#verifying-the-dns-configuration_configuring-dns-and-realm-settings-for-a-trust" title="21.5.4. Verifying the DNS configuration">Verifying the DNS configuration for a trust</a> every time after running <code class="literal">ipa-adtrust-install</code>, especially if IdM or AD do not use integrated DNS servers.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Restart the <code class="literal systemitem">ipa</code> service:
							</p><pre class="literallayout">[root@ipaserver ~]# systemctl restart ipa</pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal systemitem">smbclient</code> utility to verify that Samba responds to Kerberos authentication from the IdM side:
							</p><pre class="literallayout">[root@ipaserver ~]# smbclient -L server.idm.example.com -k
lp_load_ex: changing to config backend registry
    Sharename       Type      Comment
    ---------       ----      -------
    IPC$            IPC       IPC Service (Samba 4.10.4)
...</pre></li></ol></div></section><section class="section" id="setting-up-a-trust-agreement-using-the-command-line_setting-up-a-trust"><div class="titlepage"><div><div><h3 class="title">21.6.2. Setting up a trust agreement using the command line</h3></div></div></div><p>
						This section describes on how to set up the trust agreement using the command line. The Identity Management (IdM) server allows you to configure three types of trust agreements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								One-way trust — default option. One-way trust enables Active Directory (AD) users and groups to access resources in IdM, but not the other way around. The IdM domain trusts the AD forest, but the AD forest does not trust the IdM domain.
							</li><li class="listitem"><p class="simpara">
								Two-way trust — Two-way trust enables AD users and groups to access resources in IdM. However, the two-way trust in IdM does not give the users any additional rights compared to the one-way trust solution in AD. Both solutions are considered equally secure because of default cross-forest trust SID filtering settings.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										To create the two-way trust, add the following option to the command: <code class="literal">--two-way=true</code>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								External trust for a trust relationship between domains that are in different forests.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										To create the external trust, add the following option to the command: <code class="literal">--external=true</code>
									</li></ul></div></li></ul></div><p>
						In this section, the steps below shows you how to create a one-way trust agreement.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								User name and password of a Windows administrator.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a trust agreement for the AD domain and the IdM domain by using the <code class="literal">ipa trust-add</code> command:
							</p><pre class="literallayout">[root@server ~]# ipa trust-add --type=type ad_domain_name --admin ad_admin_username --password</pre></li></ol></div><p>
						The <code class="literal">ipa trust-add</code> command configures the IdM server as a trust controller by default.
					</p></section><section class="section" id="setting-up-the-trust-in-the-idm-web-ui_setting-up-a-trust"><div class="titlepage"><div><div><h3 class="title">21.6.3. Setting up a trust agreement in the IdM Web UI</h3></div></div></div><p>
						This section describes how to configure the Identity Management (IdM)/Active Directory (AD) trust agreement on the IdM side using the IdM Web UI.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								DNS is correctly configured. Both IdM and AD servers must be able to resolve each other names.
							</li><li class="listitem">
								Supported versions of AD and IdM are deployed.
							</li><li class="listitem">
								You have obtained a Kerberos ticket
							</li><li class="listitem">
								Before creating a trust in the Web UI, prepare the IdM server for the trust as described in: <a class="xref" href="index.html#preparing-the-idm-server-for-the-trust_setting-up-a-trust" title="21.6.1. Preparing the IdM server for the trust">Section 21.6.1, “Preparing the IdM server for the trust”</a>
							</li><li class="listitem">
								You need to be logged in as an IdM administrator
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Log in to the IdM Web UI with administrator privileges. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_start-stop-ipa">Accessing the IdM Web UI in a web browser</a>.
							</li><li class="listitem">
								In the IdM Web UI, click the <span class="strong strong"><strong>IPA Server</strong></span> tab.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>IPA Server</strong></span> tab, click the <span class="strong strong"><strong>Trusts</strong></span> tab.
							</li><li class="listitem"><p class="simpara">
								In the drop down menu, select the <span class="strong strong"><strong>Trusts</strong></span> option.
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="ipa-trust-trusts.png" alt="ipa trust trusts"/></span>

							</p></li><li class="listitem">
								Click the <span class="strong strong"><strong>Add</strong></span> button.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Add Trust</strong></span> dialog box, enter the name of the Active Directory domain.
							</li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Account</strong></span> and <span class="strong strong"><strong>Password</strong></span> fields, add the administrator credentials of the Active Directory administrator.
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="ipa-trust-add.png" alt="ipa trust add"/></span>

							</p></li><li class="listitem">
								[Optional] Select <span class="strong strong"><strong>Two-way trust</strong></span>, if you want to enable AD users and groups to access resources in IdM. However, the two-way trust in IdM does not give the users any additional rights compared to the one-way trust solution in AD. Both solutions are considered equally secure because of default cross-forest trust SID filtering settings.
							</li><li class="listitem">
								[Optional] If your domains are in different forests, select <span class="strong strong"><strong>External trust</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span>.
							</li></ol></div><p>
						If the trust has been successfully added to the IdM server, you can see the green pop-up window in the IdM Web UI. It means that the:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Domain name exists
							</li><li class="listitem">
								User name and password of the Windows Server has been added correctly.
							</li></ul></div><p>
						<span class="inlinemediaobject"><img src="idm-trust-added.png" alt="idm trust added"/></span>

					</p><p>
						Now you can continue to test the trust connection and Kerberos authentication.
					</p></section><section class="section" id="verifying-the-kerberos-configuration_setting-up-a-trust"><div class="titlepage"><div><div><h3 class="title">21.6.4. Verifying the Kerberos configuration</h3></div></div></div><p>
						To verify the Kerberos configuration, test if it is possible to obtain a ticket for an Identity Management (IdM) user and if the IdM user can request service tickets.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Request a ticket for an Active Directory (AD) user:
							</p><pre class="literallayout">[root@ipaserver ~]# kinit user@AD.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
								Request service tickets for a service within the IdM domain:
							</p><pre class="literallayout">[root@server ~]# kvno -S host server.idm.example.com</pre><p class="simpara">
								If the AD service ticket is successfully granted, there is a cross-realm ticket-granting ticket (TGT) listed with all of the other requested tickets. The TGT is named krbtgt/IPA.DOMAIN@AD.DOMAIN.
							</p></li></ol></div><pre class="literallayout">[root@server ]# klist
Ticket cache: KEYRING:persistent:0:krb_ccache_hRtox00
Default principal: user@AD.EXAMPLE.COM

Valid starting       Expires              Service principal
03.05.2016 18:31:06  04.05.2016 04:31:01  host/server.idm.example.com@IDM.EXAMPLE.COM
	renew until 04.05.2016 18:31:00
03.05.2016 18:31:06 04.05.2016 04:31:01 krbtgt/IDM.EXAMPLE.COM@AD.EXAMPLE.COM
	renew until 04.05.2016 18:31:00
03.05.2016 18:31:01  04.05.2016 04:31:01  krbtgt/AD.EXAMPLE.COM@AD.EXAMPLE.COM
	renew until 04.05.2016 18:31:00</pre><p>
						The <code class="literal">localauth</code> plug-in maps Kerberos principals to local System Security Services Daemon (SSSD) user names. This allows AD users to use Kerberos authentication and access Linux services, which support GSSAPI authentication directly.
					</p></section><section class="section" id="verifying-the-trust-configuration-on-idm_setting-up-a-trust"><div class="titlepage"><div><div><h3 class="title">21.6.5. Verifying the trust configuration on IdM</h3></div></div></div><p>
						Before configuring trust, verify that the Identity Management (IdM) and Active Directory (AD) servers can resolve themselves and each other.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You need to be logged in with administrator privileges.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Run a DNS query for the MS DC Kerberos over UDP and LDAP over TCP service records.
							</p><pre class="literallayout">[root@server ~]# dig +short -t SRV _kerberos._udp.dc._msdcs.idm.example.com.
0 100 88 server.idm.example.com.

[root@server ~]# dig +short -t SRV _ldap._tcp.dc._msdcs.idm.example.com.
0 100 389 server.idm.example.com.</pre><p class="simpara">
								These commands list all IdM servers on which <code class="literal">ipa-adtrust-install</code> has been executed. The output is empty if <code class="literal">ipa-adtrust-install</code> has not been executed on any IdM server, which is typically before establishing the first trust relationship.
							</p></li><li class="listitem"><p class="simpara">
								Run a DNS query for the Kerberos over UDP and LDAP over TCP service records to verify that IdM is able to resolve service records for AD:
							</p><pre class="literallayout">[root@server ~]# dig +short -t SRV _kerberos._udp.dc._msdcs.ad.example.com.
0 100 88 addc1.ad.example.com.

[root@ipaserver ~]# dig +short -t SRV _ldap._tcp.dc._msdcs.ad.example.com.
0 100 389 addc1.ad.example.com.</pre></li></ol></div><p>
						.
					</p></section><section class="section" id="verifying-the-trust-configuration-on-ad_setting-up-a-trust"><div class="titlepage"><div><div><h3 class="title">21.6.6. Verifying the trust configuration on AD</h3></div></div></div><p>
						After configuring the trust, verify that:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Identity Management (IdM)-hosted services are resolvable from the Active Directory (AD) server.
							</li><li class="listitem">
								AD services are resolvable from the AD server.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You need to be logged in with administrator privileges.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								On the AD server, set the <code class="literal">nslookup.exe</code> utility to look up service records.
							</p><pre class="literallayout">C:\&gt;nslookup.exe
&gt; set type=SRV</pre></li><li class="listitem"><p class="simpara">
								Enter the domain name for the Kerberos over UDP and LDAP over TCP service records.
							</p><pre class="literallayout">&gt; _kerberos._udp.idm.example.com.
_kerberos._udp.idm.example.com.       SRV service location:
    priority                = 0
    weight                  = 100
    port                    = 88
    svr hostname   = server.idm.example.com
&gt; _ldap._tcp.ipa.example.com
_ldap._tcp.idm.example.com       SRV service location:
    priority                = 0
    weight                  = 100
    port                    = 389
    svr hostname   = server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
								Change the service type to TXT and run a DNS query for the TXT record with the IdM Kerberos realm name.
							</p><pre class="literallayout">C:\&gt;nslookup.exe
&gt; set type=TXT
&gt; _kerberos.idm.example.com.
_kerberos.idm.example.com.        text =

    "IDM.EXAMPLE.COM"</pre></li><li class="listitem"><p class="simpara">
								Run a DNS query for the MS DC Kerberos over UDP and LDAP over TCP service records.
							</p><pre class="literallayout">C:\&gt;nslookup.exe
&gt; set type=SRV
&gt; _kerberos._udp.dc._msdcs.idm.example.com.
_kerberos._udp.dc._msdcs.idm.example.com.        SRV service location:
    priority = 0
    weight = 100
    port = 88
    svr hostname = server.idm.example.com
&gt; _ldap._tcp.dc._msdcs.idm.example.com.
_ldap._tcp.dc._msdcs.idm.example.com.        SRV service location:
    priority = 0
    weight = 100
    port = 389
    svr hostname = server.idm.example.com</pre><p class="simpara">
								The command is expected to list all IdM servers on which the <code class="literal">ipa-adtrust-install</code> utility has been executed. For details about <code class="literal">ipa-adtrust-install</code>, see <a class="link" href="index.html#preparing-the-idm-server-for-the-trust_setting-up-a-trust" title="21.6.1. Preparing the IdM server for the trust">Preparing the IdM server for the trust</a>. Note that the output is empty if <code class="literal">ipa-adtrust-install</code> has not been executed on any IdM server, which is typically before establishing the first trust relationship.
							</p></li><li class="listitem"><p class="simpara">
								Verify that AD services are resolvable from the AD server.
							</p><pre class="literallayout">C:\&gt;nslookup.exe
&gt; set type=SRV</pre></li><li class="listitem"><p class="simpara">
								Enter the domain name for the Kerberos over UDP and LDAP over TCP service records.
							</p><pre class="literallayout">&gt; _kerberos._udp.dc._msdcs.ad.example.com.
_kerberos._udp.dc._msdcs.ad.example.com. 	SRV service location:
    priority = 0
    weight = 100
    port = 88
    svr hostname = addc1.ad.example.com
&gt; _ldap._tcp.dc._msdcs.ad.example.com.
_ldap._tcp.dc._msdcs.ad.example.com. 	SRV service location:
    priority = 0
    weight = 100
    port = 389
    svr hostname = addc1.ad.example.com</pre></li></ol></div></section></section><section class="section" id="removing-the-trust-using-the-idm-web-ui_installing-trust-between-idm-and-ad"><div class="titlepage"><div><div><h2 class="title">21.7. Removing the trust using the IdM Web UI</h2></div></div></div><p>
					This section describes how to remove the Identity Management (IdM)/Active Directory (AD) trust on the IdM side using the IdM Web UI.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have obtained a Kerberos ticket. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/logging-in-to-ipa-in-the-web-ui-using-a-kerberos-ticket_configuring-and-managing-idm">Logging in to IdM in the Web UI: Using a Kerberos ticket</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the IdM Web UI with administrator privileges. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/accessing-the-ipa-web-ui-in-a-web-browser_start-stop-ipa">Accessing the IdM Web UI in a web browser</a>.
						</li><li class="listitem">
							In the IdM Web UI, click the <span class="strong strong"><strong>IPA Server</strong></span> tab.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>IPA Server</strong></span> tab, click the <span class="strong strong"><strong>Trusts</strong></span> tab.
						</li><li class="listitem"><p class="simpara">
							Select the trust you want to remove.
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="idm-trust-remove.png" alt="idm trust remove"/></span>

						</p></li><li class="listitem">
							Click the <span class="strong strong"><strong>Delete</strong></span> button.
						</li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Remove trusts</strong></span> dialog box, click <span class="strong strong"><strong>Delete</strong></span>.
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="idm-trust-delete.png" alt="idm trust delete"/></span>

						</p></li></ol></div><p>
					If the trust is successfully deleted, the Web UI displays a green pop-up with the text:
				</p><p>
					<span class="inlinemediaobject"><img src="idm-trust-deleted.png" alt="idm trust deleted"/></span>

				</p></section></section></div><div class="part" id="migrating"><div class="titlepage"><div><div><h1 class="title">Part III. Migrating IdM from RHEL 7 to RHEL 8 and keeping it up-to-date</h1></div></div></div><section class="chapter" id="migrate-7-to-8_migrating"><div class="titlepage"><div><div><h2 class="title">Chapter 22. Migrating IdM from RHEL 7 to 8</h2></div></div></div><p>
				This procedure describes how to migrate all Identity Management (IPA) data and configuration from a Red Hat Enterprise Linux (RHEL) 7 server to a RHEL 8 server. The migration procedure includes:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Installing an IdM server on the RHEL 8 system. For details, see <a class="xref" href="index.html#install-replica_migrate-7-to-8" title="22.2. Installing the RHEL 8 Replica">Section 22.2, “Installing the RHEL 8 Replica”</a>.
					</li><li class="listitem">
						Making the RHEL 8 server the certificate authority (CA) renewal master. For details, see <a class="xref" href="index.html#move-ca-renewal-master-to-8_migrate-7-to-8" title="22.3. Moving the CA renewal master to RHEL 8">Section 22.3, “Moving the CA renewal master to RHEL 8”</a>.
					</li><li class="listitem">
						Stopping the generation of the certificate revocation list (CRL) on the RHEL 7 server and redirecting CRL requests to RHEL 8. For details, see <a class="xref" href="index.html#stopping-crl-generation-on-rhel7-IdM-CA-master_migrate-7-to-8" title="22.4. Stopping CRL generation on RHEL 7 IdM CA master">Section 22.4, “Stopping CRL generation on RHEL 7 IdM CA master”</a>.
					</li><li class="listitem">
						Starting the generation of the CRL on the RHEL 8 server. For details, see <a class="xref" href="index.html#starting-crl-generation-on-rhel8-IdM-CA-master_migrate-7-to-8" title="22.5. Starting CRL generation on the new RHEL 8 IdM CA master">Section 22.5, “Starting CRL generation on the new RHEL 8 IdM CA master”</a>.
					</li><li class="listitem">
						Stopping and decommissioning the original RHEL 7 CA master. For details, see <a class="xref" href="index.html#stop-decommission-server_migrate-7-to-8" title="22.6. Stopping and decommissioning the RHEL 7 server">Section 22.6, “Stopping and decommissioning the RHEL 7 server”</a>.
					</li></ol></div><p>
				In the following procedures:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">rhel8.example.com</code> is the RHEL 8 system that will become the new CA master.
					</li><li class="listitem"><p class="simpara">
						<code class="literal">rhel7.example.com</code> is the original RHEL 7 CA master. To identify which Red Hat Enterprise Linux 7 server is the master CA server, run the following command on any IdM server:
					</p><pre class="literallayout">[root@rhel7 ~]# ipa config-show | grep "CA renewal master"
IPA CA renewal master: rhel7.example.com</pre><p class="simpara">
						If your IdM deployment is CA-less, any IdM server running on RHEL 7 can be <code class="literal">rhel7.example.com</code>.
					</p></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Complete the steps in sections <a class="link" href="index.html#move-ca-renewal-master-to-8_migrate-7-to-8" title="22.3. Moving the CA renewal master to RHEL 8">21.3</a>, <a class="link" href="index.html#stopping-crl-generation-on-rhel7-IdM-CA-master_migrate-7-to-8" title="22.4. Stopping CRL generation on RHEL 7 IdM CA master">21.4</a>, and <a class="link" href="index.html#starting-crl-generation-on-rhel8-IdM-CA-master_migrate-7-to-8" title="22.5. Starting CRL generation on the new RHEL 8 IdM CA master">21.5</a> only if your IdM deployment uses an embedded certificate authority (CA).
				</p></div></div><section class="section" id="migrating-7-8-prereqs_migrate-7-to-8"><div class="titlepage"><div><div><h2 class="title">22.1. Prerequisites for Migrating IdM from RHEL 7 to 8</h2></div></div></div><p>
					On <code class="literal">rhel7.example.com</code>:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Upgrade the system to the latest RHEL 7 version.
						</li><li class="listitem"><p class="simpara">
							Update the <span class="strong strong"><strong><span class="package package">ipa-</span></strong></span>* packages to their latest version:
						</p><pre class="literallayout">[root@rhel7 ~]# yum update ipa-*</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								When upgrading multiple Identity Management (IdM) servers, wait at least 10 minutes between each upgrade.
							</p><p>
								When two or more servers are upgraded simultaneously or with only short intervals between the upgrades, there is not enough time to replicate the post-upgrade data changes throughout the topology, which can result in conflicting replication events.
							</p></div></div></li></ol></div><p>
					On <code class="literal">rhel8.example.com</code>:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Make sure the <code class="literal">rhel8.example.com</code> system meets the requirements listed in <a class="xref" href="index.html#preparing-the-system-for-ipa-server-installation_installing-identity-management" title="Chapter 1. Preparing the system for IdM server installation">Chapter 1, <em>Preparing the system for IdM server installation</em></a>.
						</li><li class="listitem">
							Make sure that the replica is part of the domain for which the IdM DNS server is authoritative.
						</li><li class="listitem"><p class="simpara">
							Update the <span class="strong strong"><strong><span class="package package">ipa-</span></strong></span>* packages to their latest version:
						</p><pre class="literallayout">[root@rhel8 ~]# yum update ipa-*</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Related information</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For details on using the <code class="literal">yum</code> utility, see the <code class="literal">yum(8)</code> manual pages.
						</li></ul></div></section><section class="section" id="install-replica_migrate-7-to-8"><div class="titlepage"><div><div><h2 class="title">22.2. Installing the RHEL 8 Replica</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							List which server roles are present in your RHEL 7 environment:
						</p><pre class="literallayout">[root@rhel7 ~]# <span class="strong strong"><strong>ipa server-role-find --status enabled</strong></span>
----------------------
4 server roles matched
----------------------
  Server name: rhel7.example.com
  Role name: CA server
  Role status: enabled

  Server name: replica7.example.com
  Role name: DNS server
  Role status: enabled

  Server name: rhel7.example.com
  Role name: DNS server
  Role status: enabled

  Server name: rhel7.example.com
  Role name: NTP server
  Role status: enabled
[... output truncated ...]</pre></li><li class="listitem"><p class="simpara">
							Install the Identity Management IdM server on <code class="literal">rhel8.example.com</code> as a replica of the IdM RHEL 7 server, including all the server roles present on your <code class="literal">rhel7.example.com</code>. To install all the roles from the example above, use these options with the <code class="literal">ipa-replica-install</code> command:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal option">--setup-ca</code> to set up the Certificate System component
								</li><li class="listitem"><p class="simpara">
									<code class="literal option">--setup-dns</code> and <code class="literal option">--forwarder</code> to configure an integrated DNS server and set a forwarder to take care of DNS queries that go outside the IdM domain
								</p><p class="simpara">
									To set up an IdM server with the ip address of 192.0.2.1 which uses a forwarder with the ip address of 192.0.2.20:
								</p><pre class="literallayout">[root@rhel8 ~]# <span class="strong strong"><strong>ipa-replica-install --setup-ca --ip-address 192.0.2.1 --setup-dns --forwarder 192.0.2.20</strong></span></pre></li></ul></div><p class="simpara">
							You do not need to specify the RHEL 7 IdM server because if DNS is working correctly, <code class="literal">rhel8.example.com</code> will find it using DNS autodiscovery.
						</p></li><li class="listitem"><p class="simpara">
							After the installation completes, verify that the IdM services are running on <code class="literal">rhel8.example.com</code>:
						</p><pre class="literallayout">[root@rhel8 ~]# <span class="strong strong"><strong>ipactl status</strong></span>
Directory Service: RUNNING
[... output truncated ...]
ipa: INFO: The ipactl command was successful</pre></li><li class="listitem"><p class="simpara">
							Verify that <code class="literal">rhel7.example.com</code> and <code class="literal">rhel8.example.com</code> certificate authorities (CAs) are both configured as master servers:
						</p><pre class="literallayout">[root@rhel8 ~]$ <code class="literal command">kinit admin</code>
[root@rhel8 ~]$ <code class="literal command">ipa-csreplica-manage list</code>
rhel7.example.com: master
rhel8.example.com: master</pre></li><li class="listitem"><p class="simpara">
							Optionally, to display details about the replication agreement between <code class="literal">rhel7.example.com</code> and <code class="literal">rhel8.example.com</code>:
						</p><pre class="literallayout">[root@rhel8 ~]# <span class="strong strong"><strong>ipa-csreplica-manage list --verbose rhel8.example.com</strong></span>
Directory Manager password:

rhel7.example.com
last init status: None
last init ended: 1970-01-01 00:00:00+00:00
last update status: Error (0) Replica acquired successfully: Incremental update succeeded
last update ended: 2019-02-13 13:55:13+00:00</pre></li></ol></div></section><section class="section" id="move-ca-renewal-master-to-8_migrate-7-to-8"><div class="titlepage"><div><div><h2 class="title">22.3. Moving the CA renewal master to RHEL 8</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Complete the steps in this section only if your IdM deployment uses an embedded certificate authority (CA).
					</p></div></div><p>
					On <code class="literal">rhel8.example.com</code>, configure <code class="literal">rhel8.example.com</code> as the new CA renewal master:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Configure <code class="literal">rhel8.example.com</code> to handle CA subsystem certificate renewal:
						</p><pre class="literallayout">[root@rhel8 ~]# <span class="strong strong"><strong>ipa config-mod --ca-renewal-master-server rhel8.example.com</strong></span>
  ...
  IPA masters: rhel7.example.com, rhel8.example.com
  IPA CA servers: rhel7.example.com, rhel8.example.com
  IPA NTP servers: rhel7.example.com, rhel8.example.com
  IPA CA renewal master: rhel8.example.com</pre><p class="simpara">
							The output confirms that the update was successful.
						</p></li></ul></div></section><section class="section" id="stopping-crl-generation-on-rhel7-IdM-CA-master_migrate-7-to-8"><div class="titlepage"><div><div><h2 class="title">22.4. Stopping CRL generation on RHEL 7 IdM CA master</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Complete the steps in this section only if your IdM deployment uses an embedded certificate authority (CA).
					</p></div></div><p>
					This section describes how to stop the generation of the Certificate Revocation List (CRL) on the <span class="strong strong"><strong>rhel7.example.com</strong></span> master CA using the <code class="literal">ipa-crlgen-manage</code> command.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must be logged in as root.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optionally, check if <span class="strong strong"><strong>rhel7.example.com</strong></span> is generating the CRL:
						</p><pre class="literallayout">[root@rhel7 ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span>
CRL generation: <span class="strong strong"><strong>enabled</strong></span>
Last CRL update: 2019-10-31 12:00:00
Last CRL Number: 6
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
							Stop generating CRL on the <span class="strong strong"><strong>rhel7.example.com</strong></span> server:
						</p><pre class="literallayout">[root@rhel7 ~]# <span class="strong strong"><strong>ipa-crlgen-manage disable</strong></span>
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
CRL generation disabled on the local host. Please make sure to configure CRL generation on another master with ipa-crlgen-manage enable.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
							Optionally, check if the <span class="strong strong"><strong>rhel7.example.com</strong></span> server stopped generating CRL:
						</p><pre class="literallayout">[root@rhel7 ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span></pre></li></ol></div><p>
					The <span class="strong strong"><strong>rhel7.example.com</strong></span> server stopped generating CRL. The next step is to enable CRL generation on <span class="strong strong"><strong>rhel8.example.com</strong></span>.
				</p></section><section class="section" id="starting-crl-generation-on-rhel8-IdM-CA-master_migrate-7-to-8"><div class="titlepage"><div><div><h2 class="title">22.5. Starting CRL generation on the new RHEL 8 IdM CA master</h2></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Complete the steps in this section only if your IdM deployment uses an embedded certificate authority (CA).
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You must be logged in as root on the <span class="strong strong"><strong>rhel8.example.com</strong></span> machine.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To start generating CRL on <span class="strong strong"><strong>rhel8.example.com</strong></span>, use the <code class="literal">ipa-crlgen-manage enable</code> command:
						</p><pre class="literallayout">[root@rhel8 ~]# <span class="strong strong"><strong>ipa-crlgen-manage enable</strong></span>
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
Forcing CRL update
CRL generation enabled on the local host. Please make sure to have only a single CRL generation master.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
							To check if CRL generation is enabled, use the <code class="literal">ipa-crlgen-manage status</code> command:
						</p><pre class="literallayout">[root@rhel8 ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span>
CRL generation: <span class="strong strong"><strong>enabled</strong></span>
Last CRL update: 2019-10-31 12:10:00
Last CRL Number: 7
The ipa-crlgen-manage command was successful</pre></li></ol></div></section><section class="section" id="stop-decommission-server_migrate-7-to-8"><div class="titlepage"><div><div><h2 class="title">22.6. Stopping and decommissioning the RHEL 7 server</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Make sure that all, even the latest data is correctly migrated from <code class="literal">rhel7.example.com</code> to <code class="literal">rhel8.example.com</code>. For example:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Add a new user on <code class="literal">rhel7.example.com</code>:
								</p><pre class="literallayout">[root@rhel7 ~]# <span class="strong strong"><strong>ipa user-add <span class="emphasis"><em>random_user</em></span></strong></span>
First name: random
Last name: user</pre></li><li class="listitem"><p class="simpara">
									Check that the user has been replicated to <code class="literal">rhel8.example.com</code>:
								</p><pre class="literallayout">[root@rhel8 ~]# <span class="strong strong"><strong>ipa user-find <span class="emphasis"><em>random_user</em></span></strong></span>
--------------
1 user matched
--------------
  User login: random_user
  First name: random
  Last name: user</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Stop all service on <code class="literal">rhel7.example.com</code> to force domain discovery to the new <code class="literal">rhel8.example.com</code> server.
						</p><pre class="literallayout">[root@rhel7 ~]# <span class="strong strong"><strong>ipactl stop</strong></span>
Stopping CA Service
Stopping pki-ca:                                           [  OK  ]
Stopping HTTP Service
Stopping httpd:                                            [  OK  ]
Stopping MEMCACHE Service
Stopping ipa_memcached:                                    [  OK  ]
Stopping DNS Service
Stopping named: .                                          [  OK  ]
Stopping KPASSWD Service
Stopping Kerberos 5 Admin Server:                          [  OK  ]
Stopping KDC Service
Stopping Kerberos 5 KDC:                                   [  OK  ]
Stopping Directory Service
Shutting down dirsrv:
    EXAMPLE-COM...                                         [  OK  ]
    PKI-IPA...                                             [  OK  ]</pre><p class="simpara">
							After this, the <code class="literal">ipa</code> utility will contact the new server through a remote procedure call (RPC).
						</p></li><li class="listitem">
							Remove the RHEL 7 server from the topology by executing the removal commands on the RHEL 8 server. For details, see <a class="xref" href="index.html#uninstalling-an-ipa-server_installing-identity-management" title="Chapter 6. Uninstalling an IdM server">Chapter 6, <em>Uninstalling an IdM server</em></a>.
						</li></ol></div></section></section><section class="chapter" id="update-downgrade-ipa_migrate-7-to-8"><div class="titlepage"><div><div><h2 class="title">Chapter 23. Updating and downgrading IdM</h2></div></div></div><p>
				You can use the <code class="literal">yum</code> utility to update the Identity Management (IdM) packages on the system.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To update all IdM packages that are relevant for your profile and that have updates available:
					</p><pre class="literallayout"># <span class="strong strong"><strong>yum upgrade ipa-</strong></span>*</pre></li><li class="listitem"><p class="simpara">
						Alternatively, to install or update packages to match the latest version available for your profile from any enabled repository:
					</p><pre class="literallayout"># <span class="strong strong"><strong>yum distro-sync ipa-</strong></span>*</pre></li></ul></div><p>
				After you update the IdM packages on at least one server, all other servers in the topology receive the updated schema, even if you do not update their packages. This ensures that any new entries which use the new schema can be replicated among the other servers.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					When updating multiple IdM servers, wait at least 10 minutes after updating one server before updating another server. However, the actual time required for a server’s successful update depends on the topology deployed, the latency of the connections, and the number of changes generated by the update.
				</p><p>
					When two or more servers are updated simultaneously or with only short intervals between the upgrades, there is not enough time to replicate the post-upgrade data changes throughout the topology, which can result in conflicting replication events.
				</p></div></div><p>
				Downgrading IdM packages manually is not supported. Use <span class="strong strong"><strong>yum distro-sync</strong></span> to update and downgrade packages in modules.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Do not run the <code class="literal command">yum downgrade</code> command on any of the <span class="strong strong"><strong><span class="package package">ipa-</span></strong></span>* packages.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Related information</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For details on using the <code class="literal">yum</code> utility, see the <code class="literal">yum(8)</code> manual pages.
					</li></ul></div></section></div><div><div xml:lang="en-US" class="legalnotice" id="idm140081250494016"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2020 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div>
  
  </div>
  </div>
</div>
<div id="comments-footer" class="book-comments">
  </div>
<meta itemscope="" itemref="md1">

    <!-- Display: Next/Previous Nav -->
          
      </div>
</article>


  

            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="index.html#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

            <div role="navigation">
                <h3>Quick Links</h3>
                <ul>
                    <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li><a class="manage-subscriptions" href="https://access.redhat.com/management/subscriptions/#active">Subscriptions</a></li>
                    <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                    <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                    <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Help</h3>
                <ul>
                    <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                    <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                    <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Site Info</h3>
                <ul>
                  <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                  <li><a class="browser-support-policy" href="https://access.redhat.com/help/browsers/">Browser Support Policy</a></li>
                  <li><a class="accessibility" href="https://access.redhat.com/help/accessibility/">Accessibility</a></li>
                  <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                  <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Related Sites</h3>
                <ul>
                    <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                    <li><a href="https://www.openshift.com" class="openshift-com">openshift.com</a></li>
                    <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                    <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>About</h3>
                <ul>
                    <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                    <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                    <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                </ul>
            </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                          <span class="status-description"></span>
                          <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2020 Red Hat, Inc.</div>

                        <div role="navigation" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://access.redhat.com/help/terms/" class="terms-of-use">Customer Portal Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                      <img src="l_summit.png" alt="Red Hat Summit" />
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHatSupport" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>
                        <a href="https://www.facebook.com/RedHatSupport" class="sm-icon facebook"><span class="nicon-facebook"></span><span class="offscreen">Facebook</span></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--googleon: all-->
</div>
  
  <div id="formatHelp" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="formatTitle" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="formatTitle">Formatting Tips</h3>
    </div>
    <div class="modal-body">
      <p>Here are the common uses of Markdown.</p><dl class="formatting-help">
        <dt class="codeblock">Code blocks</dt><dd class="codeblock"><pre><code>~~~
Code surrounded in tildes is easier to read
~~~</code></pre></dd>
        <dt class="urls">Links/URLs</dt><dd class="urls"><code>[Red Hat Customer Portal](https://access.redhat.com)</code></dd>
       </dl>
    </div>
    <div class="modal-footer">
      <a target="_blank" href="https://access.redhat.com/help/markdown" class="btn btn-primary">Learn more</a>
      <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
  </div></div></div></body>
</html>
