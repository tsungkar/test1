<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video#" >

<head profile="http://www.w3.org/1999/xhtml/vocab">
	  <!--[if IE]><![endif]-->
<meta charset="utf-8" />
<meta name="revision" title="fc417e9b-3f6f-46ec-b327-7526e003cd79" product="f321f43a-4a79-48fe-8aae-117b9d973ec0" revision="7f916032de34136efcc7c48ad2ab8850d57bb624:en-us" page="115666a0-1f58-414b-be8a-f924e0ac85ce" />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/index" />
<meta property="og:title" content="Security hardening Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta property="og:description" content="This title assists users and administrators in learning the processes and practices of securing workstations and servers against local and remote intrusion, exploitation, and malicious activity. Focused on Red Hat Enterprise Linux but detailing concepts and techniques valid for all Linux systems, this guide details the planning and the tools involved in creating a secured computing environment for the data center, workplace, and home. With proper administrative knowledge, vigilance, and tools, systems running Linux can be both fully functional and secured from most common intrusion and exploit methods." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/index" />
<meta name="twitter:title" content="Security hardening Red Hat Enterprise Linux 8 | Red Hat Customer Portal" />
<meta name="twitter:description" content="This title assists users and administrators in learning the processes and practices of securing workstations and servers against local and remote intrusion, exploitation, and malicious activity. Focused on Red Hat Enterprise Linux but detailing concepts and techniques valid for all Linux systems, this guide details the planning and the tools involved in creating a secured computing environment for the data center, workplace, and home. With proper administrative knowledge, vigilance, and tools, systems running Linux can be both fully functional and secured from most common intrusion and exploit methods." />
<meta name="twitter:image:src" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
  <title>Security hardening Red Hat Enterprise Linux 8 | Red Hat Customer Portal</title>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="kcs07.web.prod.ext.phx2.redhat.com" />
<meta name="avalon-version" content="2070d6b" />
<meta name="cp-chrome-build-date" content="2020-03-09T20:28:54.189Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />

 

<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en",  
        version   : "2070d6b",
        builddate : "2020-03-09T20:28:54.189Z",
        fetchdate : "2020-03-11T07:52:05-0400",
        nrid      : "14615289",
        nrlk      : "2a497fa56f"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="favicon.ico" />

<link media="all" rel="stylesheet" type="text/css" href="bootstrap.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="main.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="components.css%3Fv=2070d6b.css" />
<link media="all" rel="stylesheet" type="text/css" href="pages.css%3Fv=2070d6b.css" />

<link href="chosen.css%3Fv=2070d6b.css" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]-->

<noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>

<!-- /cssInclude -->
<script type="text/javascript" src="require.js%3Fv=2070d6b" data-main="/webassets/avalon/j/"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
  <link type="text/css" rel="stylesheet" href="css__c2Nkkx_5vYh8rvZbfBAGB4EMzMtH5ouFJDBlDsnhSR8__-ax0_8bam15ZDJT9j7LilCfJrDyEhGGAgc0KC8HYvJg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__Jy3BSr8TrxptaufAzQDT1skBUlX2CnL_wm6BizzYuGw__-YZvqB8yuA4kK_iKklbk5HdZCoG2qAgz1l-8Qi2NFH4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="messages.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__m76iIFREtc70Nmw5xe1ZwHbNBlwOP2Zjc3DcacNWnFQ__STEh8aY3w8E_bKzhB4Xke2WOQ9XMDQquHIP5B8SeDIY__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__4sM4s6XOQ2Nm0pdkrWRLvrgtwpTmHAFzR_LcdesKYj8__vJ0jjVEhoPh3KBeLZfkqg51T3AFxhQCuXg1reipa__k__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="print" />
  <link rel="stylesheet" type="text/css" media="all" href="list.css" />
  <script src="js__1YIht1y1Jlm9D0PyxEuhS3DlWdYAlEsNpsFDOaUsfRw__ZnC7278ZsqBG-1FOUqflDl8B3Y1kLiAWXAIkoLrHbYg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__5ysXPc5KIyMmizxqRY68ILfrEGrj0P29WBIifnPTJvQ__Cap0DACEVMsefumg1gS1APLLd8stDkdGfp6c1uswMo4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>chrometwo_require(["analytics/attributes"], function(attributes) {
attributes.set('ResourceID',       'fc417e9b-3f6f-46ec-b327-7526e003cd79');
attributes.set('ResourceTitle',    'Security hardening');
attributes.set('Language',         'en-us');
attributes.set('RevisionId',       '7f916032de34136efcc7c48ad2ab8850d57bb624:en-us');
attributes.set('PublicationState', ['active','published']);
attributes.set('Product',          'Red Hat Enterprise Linux');
attributes.set('ProductVersion',   '8');
attributes.set('ProductId',        'Red Hat Enterprise Linux 8');
});</script>
<script>breadcrumbs = [ ["Products &amp; Services", "/products/"], ["Product Documentation", "/documentation/"], ["Red Hat Enterprise Linux", "/documentation/en-us/red_hat_enterprise_linux/"], ["8", "/documentation/en-us/red_hat_enterprise_linux/8/"], ["Security hardening", "/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/"] ];</script>
<script>window.siteMapState = "products";</script>
<script src="js__i6ieGBO-OPmIKm_f0srsb6gM7QELIWrBpKh6ub_yj8A__wjRg_duSK4rEZCRV2uwrCIPMl80Z_LJ9ew61H5hE-ZI__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__vGeEtorfXGI3aPAp71YA74N5p8wfpYVhnoIqwaJrOiQ__veGxEiPQW6fkzAPZnAFA23SFz1CyJy2dlu6x8XuHM4s__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"kcs","theme_token":"fA85zFAgX9t7wzCd01OECL6QLDtpF9huLIkBGtY_bJ4","js":{"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.jquery.min.js":1,"modules\/chosen\/chosen.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/prism.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/underscore.js":1,"sites\/all\/themes\/kcs\/js\/kcs_base.js":1,"sites\/all\/themes\/kcs\/js\/showdown.js":1,"sites\/all\/themes\/kcs\/js\/case_links.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/date\/date_api\/date.css":1,"modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/contrib\/user_prune\/css\/user_prune.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/panels\/css\/panels.css":1,"sites\/all\/modules\/custom\/rate\/rate.css":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/plugins\/layouts\/docs_page\/docs_page.css":1,"https:\/\/access.redhat.com\/webassets\/avalon\/s\/messages.css":1,"sites\/all\/themes\/zen\/system.base.css":1,"sites\/all\/themes\/zen\/system.menus.css":1,"sites\/all\/themes\/zen\/system.messages.css":1,"sites\/all\/themes\/zen\/system.theme.css":1,"sites\/all\/themes\/zen\/comment.css":1,"sites\/all\/themes\/zen\/node.css":1,"sites\/all\/themes\/kcs\/css\/html-reset.css":1,"sites\/all\/themes\/kcs\/css\/wireframes.css":1,"sites\/all\/themes\/kcs\/css\/layout-fixed.css":1,"sites\/all\/themes\/kcs\/css\/page-backgrounds.css":1,"sites\/all\/themes\/kcs\/css\/tabs.css":1,"sites\/all\/themes\/kcs\/css\/pages.css":1,"sites\/all\/themes\/kcs\/css\/blocks.css":1,"sites\/all\/themes\/kcs\/css\/navigation.css":1,"sites\/all\/themes\/kcs\/css\/views-styles.css":1,"sites\/all\/themes\/kcs\/css\/nodes.css":1,"sites\/all\/themes\/kcs\/css\/comments.css":1,"sites\/all\/themes\/kcs\/css\/forms.css":1,"sites\/all\/themes\/kcs\/css\/fields.css":1,"sites\/all\/themes\/kcs\/css\/kcs.css":1,"sites\/all\/themes\/kcs\/css\/print.css":1}},"chosen":{"selector":"#edit-field-kcs-component-select-und, #edit-field-kcs-sbr-select-und, #edit-field-kcs-product-select-und, #edit-field-kcs-type-select-und, #edit-language, #edit-field-kcs-a-category-select-und, #edit-field-kcs-state-select-und, #edit-field-kcs-tags-select-und, #edit-field-kcs-state-select-value, #edit-field-vid-reference-product-und, #edit-state, #edit-product, #edit-category, #edit-field-kcs-product-select-tid, #edit-field-kcs-type-select-tid, #edit-field-kcs-a-category-select-tid, #edit-sort-bef-combine, #edit-kcs-state, #edit-field-category-tid, #edit-field-product-tid, #edit-field-tags-tid, #edit-field-category-und, #edit-field-product-und, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-category, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-product, #views-exposed-form-questions-list-questions-filter-block #edit-field-tags, #edit-field-mega-menu-tab-und, #edit-field-internal-tags-tid, #edit-tags, #edit-field-kcs-tags-select-tid, #edit-subscriptions-and-choose-field-select, #edit-subscriptions-and-type, #edit-vid-13, #edit-vid-4, #edit-vid-5, #edit-vid-53, #edit-vid-1, #edit-vid-3, #edit-group-blog, #edit-group-group, #edit-subscriptions-and-choose-field-select-two, #edit-subscriptions-and-type-two, #edit-vid-13-two, #edit-vid-4-two, #edit-vid-5-two, #edit-vid-53-two, #edit-vid-1-two, #edit-vid-3-two, #edit-group-blog-two, #edit-group-group-two, #edit-subscriptions-and-edit-choose-field-select, #edit-subscriptions-and-type-edit, #edit-subscriptions-and-edit-type-two, #edit-vid-13-edit-two, #edit-vid-4-edit-two, #edit-vid-5-edit-two, #edit-vid-53-edit-two, #edit-vid-1-edit-two, #edit-vid-3-edit-two, #edit-group-group-edit-two, #edit-subscriptions-and-edit-choose-field-select-two, #edit-vid-13-edit, #edit-vid-4-edit, #edit-vid-5-edit, #edit-vid-53-edit, #edit-vid-1-edit, #edit-vid-3-edit, #edit-group-group-edit, #edit-group-blog-edit, #edit-field-supported-languages-tid, #edit-field-geography-und, #edit-field-supported-products-und, #edit-field-supported-languages-und, #edit-field-vendor-und, #edit-field-errata-type-text-und, #edit-field-errata-severity-text-und, #edit-field-software-partner-level-und, #edit-field-scert-product-category-und, #edit-field-certifications-und-0-field-product-und, #edit-kcs-article-type, #edit-field-eco-industry-tag-select-tid, #edit-field-eco-software-catego-select-tid, #edit-field-ecosystem-tag-select-und, #edit-field-eco-industry-tag-select-und, #edit-field-eco-software-catego-select-und, #edit-field-vendor-tsanet-member-ref-und, #edit-field-og-vendor-ref-und-0-default, #edit-field-eco-products-enabled-col-und-0-field-eco-subscription-model-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-support-level-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-archite-select-und, #edit-field-eco-certifications-select-und-0-field-eco-certificati-lvl-select-und, #edit-field-eco-certifications-select-und-0-field-eco-hypervisor-str-und, #edit-field-eco-supported-language-ref-und, #edit-field-eco-region-ref-und, #edit-field-cs-product-category-str-und, #edit-field-eco-certifications-select-und-0-field-eco-format-ref-und, #edit-field-eco-group-access-ref-und, #edit-field-hw-category-tag-ref-und, #edit-field-profile-industry-und, #edit-field-profile-tech-interests-und, #edit-field-product-page-features-ref-und, #edit-field-eco-product-select-und, #edit-field-base-product-ref-und, #edit-field-eco-product-archite-select-und, #edit-field-eco-format-ref-und, #edit-field-certification-status-ref-und, #edit-field-certification-result-ref-und, #edit-field-og-certified-product-ref-und-0-default, #edit-field-eco-subscription-model-ref-und, #edit-field-eco-support-level-ref-und, #edit-field-eco-certificati-lvl-select-und, #edit-field-eco-hypervisor-str-und, #edit-field-ccp-thirdparty-cert-select-und, .use_, #edit-field-eco-cert-product-tag-und, #edit-field-documentation-location-ref-und, #edit-field-documentation-title-und, #edit-field-accelerator-products-und","minimum":"0"},"rh_doc_fetcher":{"page_type":"single"},"section":"","kcs":{"nodeType":null,"nodeId":null}});</script>
    <!--[if lt IE 9]>
  <script src="https://access.redhat.com/sites/all/themes/kcs/js/html5shiv.js"></script>
  <![endif]-->
  
      


    <!--kcs06-->
<script type="text/javascript">
  Drupal.portal = {"version":{"redhat_portal":"package drupal7-redhat_portal is not installed"}};
  Drupal.portal.currentUser = {};
  </script>

</head>

<body class="portal-page admin-bar  kcs_external" >

  
  <div id="page-wrap" class="page-wrap">
    <div class="top-page-wrap">

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <!-- Accessibility Nav & Header -->
<div class="accessibility-nav sr-only">
    <a href="https://access.redhat.com/">
        <h1>Red Hat <span>Customer </span><span>Portal</span></h1>
    </a>
    <p><a href="index.html#cp-main">Skip to main content</a></p>
    <nav aria-labelledby="accessibility-nav-heading">
        <h2 id="accessibility-nav-heading">Main Navigation</h2>
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="accessibility-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="accessibility-accountUser">
                    <div class="account-name"><strong id="accessibility-userFullName"></strong></div>
                    <div class="account-org"><span id="accessibility-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="accessibility-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="accessibility-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="accessibility-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="accessibility-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="accessibility-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="accessibility-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- Mobile Header -->
<nav class="mobile-nav-bar hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <button id="menu-btn" class="menu menu-white" type="button" aria-label="Toggle Navigation">
        <span class="lines"></span>
    </button>
    <a class="logo" href="https://access.redhat.com/">
        <span class="logo-crop">
          <!-- logo -->
          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
            <defs>
              <style>
                .rh-logo-hat {
                  fill: #e00;
                }
                .rh-logo-type {
                  fill: #fff;
                }
              </style>
            </defs>
            <title>Red Hat</title>
            <path
              class="rh-logo-hat"
              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
              <path class="rh-logo-band"
              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
              <path
              class="rh-logo-type"
              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
          </svg>
        </span>
        <span class="site-title"><span>Customer </span><span>Portal</span></span>
    </a>
    <button class="btn btn-search btn-utility" data-target="#site-search">
        <span class="web-icon-search"></span>
        <span class="link-text">Search</span>
    </button>
</nav>

<!-- Mobile Menu Drawer -->
<div class="nav-drawer mobile-nav-drawer hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <nav class="nav-container">
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="mobile-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="mobile-accountUser">
                    <div class="account-name"><strong id="mobile-userFullName"></strong></div>
                    <div class="account-org"><span id="mobile-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="mobile-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="mobile-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="mobile-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="mobile-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="mobile-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="mobile-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- White Utility Menu for large screens -->
<div class="utility-wrap" aria-hidden="true">
    <div class="utility-container">
        <div class="utility-bar hidden-xs">
            <div role="navigation" class="top-nav">
                <ul>
                    <li id="nav-subscription" data-portal-tour-1="1"><a class="top-nav-subscriptions" href="https://access.redhat.com/management/">Subscriptions</a></li>
                    <li id="nav-downloads" data-portal-tour-1="2"><a class="top-nav-downloads" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li id="nav-containers"><a class="top-nav-containers" href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
                    <li id="nav-support" data-portal-tour-1="3"><a class="top-nav-support-cases" href="https://access.redhat.com/support/cases/">Support Cases</a></li>
                </ul>
            </div>

            <div role="navigation" class="utility-nav">
                <ul>
                    <li id="searchABTestHide">
                        <a class="btn-search" data-target="#site-search" title="Search" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-search" aria-label="search"></span>
                            <span class="link-text">Search</span>
                        </a>
                    </li>
                    <!-- AB Test -->
                    <li id="searchABTestShow">
                        <form id="topSearchFormABTest" name="topSearchFormABTest">
                            <label for="topSearchInputABTest" class="sr-only">Search</label>
                            <input id="topSearchInputABTest" name="keyword" placeholder="Search" value="" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="form-control">
                            <button type="submit" class="btn btn-app btn-sm btn-link"><span class="web-icon-search" aria-label="search"></span></button>
                        </form>
                    </li>
                    <!-- End of AB Test -->
                    <li>
                        <a class="btn-profile" data-target="#account-info" data-portal-tour-1="4a" title="Account" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-user" aria-label="log in"></span>
                            <span class="link-text">Log In</span>
                            <span class="account-user" id="accountUserName"></span>
                        </a>
                    </li>
                    <li>
                        <a class="btn-language" data-target="#language" data-portal-tour-1="6" title="Language" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-globe" aria-label="language"></span>
                            <span class="link-text">Language</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Utility Tray -->
        <div class="utility-tray-container">
            <div class="utility-tray">
                <div id="site-search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="https://access.redhat.com/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <div class="input-group push-bottom">

                                <input class="form-control searchField" id="topSearchInput" name="keyword" value="" placeholder="Enter your search term" type="text">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primary">Search</button>
                                </span>
                            </div>
                            <div>Troubleshooting an issue? Try <a href="https://access.redhat.com/solution-engine">Solution Engine</a>&mdash;our new support tool.</div>
                        </form>
                    </div>
                </div>
                <div id="account-info" class="utility-link account-info">
                    <div class="content">

                        <!-- Account Unauthenticated -->
                        <div id="accountLinksLoggedOut" class="unauthenticated">
                            <h2 class="utility-header">Log in to Your Red Hat Account</h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border">
                                    <p><a href="https://access.redhat.com/login" id="accountLogin" class="btn btn-primary">Log In</a></p>
                                    <p>Your Red Hat account gives you access to your profile, preferences, and services, depending on your status.</p>
                                </div>
                                <div class="col-sm-6 col-border col-border-left">
                                    <p><a href="https://www.redhat.com/wapps/ugc/register.html" class="btn btn-primary">Register</a></p>
                                    <p>If you are a new customer, register now for access to product evaluations and purchasing capabilities. </p>

                                    <strong>Need access to an account?</strong><p>If your company has an existing Red Hat account, your organization administrator can grant you access.</p>

                                    <p><a href="https://access.redhat.com/support/contact/customerService/">If you have any questions, please contact customer service.</a></p>
                                </div>
                            </div>
                        </div>

                        <!-- Account Authenticated -->
                        <div id="accountLinksLoggedIn" class="authenticated">
                            <h2 class="utility-header"><span id="userFirstName"></span></h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border col-border-right">
                                    <div class="account-info" id="accountUser">
                                        <div class="avatar"><!-- placeholder--></div>
                                        <div class="account-name"><strong id="userFullName"></strong></div>
                                        <div class="account-org"><span id="userOrg"></span></div>
                                        <div class="account-number accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                                    </div>

                                    <div class="row account-settings">
                                        <div class="col-md-6" data-portal-tour-1="4">
                                            <h3>Red Hat Account</h3>
                                            <ul class="reset">
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
                                                <!-- <li><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
                                                <li><a href="https://access.redhat.com/account-team">Account Team</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6" data-portal-tour-1="5">
                                            <h3>Customer Portal</h3>
                                            <ul class="reset">
                                                <li><a href="https://access.redhat.com/user">My Profile</a></li>
                                                <li><a href="https://access.redhat.com/user" id="userNotificationsLink">Notifications</a></li>
                                                <li><a href="https://access.redhat.com/help/">Help</a></li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-6 col-border">
                                    <p>For your security, if you’re on a public computer and have finished using your Red Hat services, please be sure to log out.</p>
                                    <p><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout" id="accountLogout" class="btn btn-primary">Log Out</a></p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="language" class="utility-link language">
                    <div class="content">
                        <h2 class="utility-header">Select Your Language</h2>
                        <div class="row" id="localesMenu">
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en">English</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko">한국어</a></li>
                                </ul>
                            </div>
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja">日本語</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN">中文 (中国)</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="scroll-anchor"></div>

<!-- Main Menu for large screens -->
<div class="header-nav visible-sm visible-md visible-lg" aria-hidden="true">
    <div id="header-nav">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">

                    <a href="https://access.redhat.com/" class="logo">
                        <span class="logo-crop">
                          <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                            <defs>
                              <style>
                                .rh-logo-hat {
                                  fill: #e00;
                                }
                                .rh-logo-type {
                                  fill: #fff;
                                }
                              </style>
                            </defs>
                            <title>Red Hat</title>
                            <path
                              class="rh-logo-hat"
                              d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                              <path class="rh-logo-band"
                              d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                              <path
                              class="rh-logo-type"
                              d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                          </svg>
                        </span>
                        <span class="site-title"><span>Customer </span><span>Portal</span></span>
                    </a>

                    <nav class="primary-nav hidden-sm">
                        <ul>
                            <li id="nav-products"><a class="products" data-link="mega" data-target="products-menu" href="https://access.redhat.com/products/" id="products-menu">Products &amp; Services</a></li>
                            <li id="nav-tools"><a class="tools" data-link="mega" data-target="tools-menu" href="https://access.redhat.com/labs/" id="tools-menu">Tools</a></li>
                            <li id="nav-security"><a class="security" data-link="mega" data-target="security-menu" href="https://access.redhat.com/security/" id="security-menu">Security</a></li>
                            <li id="nav-community"><a class="community" data-link="mega" data-target="community-menu" href="https://access.redhat.com/community/" id="community-menu">Community</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Mega Menu for large screens -->
<div class="mega-wrap visible-sm visible-md visible-lg" aria-hidden="true">
    <nav class="mega">
        <div class="container">
            <div class="mega-menu-wrap">

                <!-- Products Menu -->
                <div aria-labelledby="products-menu" class="products-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-md-6 col-sm-8">
                            <div class="root clearfix" data-portal-tour-1="7">
                                <ul class="subnav subnav-root">
                                    <li data-target="infrastructure-menu" class="active">
                                        <h3>Infrastructure and Management</h3>
                                    </li>
                                    <li data-target="cloud-menu">
                                        <h3>Cloud Computing</h3>
                                    </li>
                                    <li data-target="storage-menu">
                                        <h3>Storage</h3>
                                    </li>
                                    <li data-target="jboss-dev-menu">
                                        <h3>Runtimes</h3>
                                    </li>
                                    <li data-target="jboss-int-menu">
                                        <h3>Integration and Automation</h3>
                                    </li>
                                </ul>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="infrastructure-menu" style="display: block;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="cloud-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="storage-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a>
                                        </li>
                                        <li>
                                          <a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-dev-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                        </li>
                                    </ul>
                                </div> -->
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul class="border-bottom" id="portal-menu-border-bottom">
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                      </li>
                                    </ul>
                                    <ul>
                                      <li>
                                        <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Automation</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                      </li>
                                    </ul>
                                </div>
                            </div>
                            <a href="https://access.redhat.com/products" class="btn btn-primary">View All Products</a>
                        </div>

                        <div class="col-md-6 col-sm-4 pull-right" data-portal-tour-1="8">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/support" class="cta-link cta-link-darkbg">Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
                                        <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>
                                    </ul>
                                    <h4 class="nav-title">Services</h4>
                                    <ul>
                                        <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
                                        <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/documentation" class="cta-link cta-link-darkbg">Documentation</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>
                                    </ul>
                                    <ul>
                                        <li><a href="https://access.redhat.com/ecosystem/" class="cta-link cta-link-darkbg">Ecosystem</a></li>
                                        <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
                                        <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tools Menu -->
                <div aria-labelledby="tools-menu" class="tools-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row" data-portal-tour-1="9">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h3 class="nav-title">Tools</h3>
                                    <ul>
                                        <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
                                        <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
                                        <li><a href="https://access.redhat.com/errata/">Errata</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <ul class="list-flat">
                                        <li><a href="https://access.redhat.com/labs/" class="cta-link cta-link-darkbg">Customer Portal Labs</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <div class="card card-dark-grey">
                                        <h4 class="card-heading">Red Hat Insights</h4>
                                        <p class="text-white">Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                        <ul class="list-flat rh-l-grid rh-m-gutters rh-m-all-6-col-on-md">
                                          <li><a href="https://www.redhat.com/en/technologies/management/insights" class="cta-link cta-link-md cta-link-darkbg">Learn more</a></li>
                                          <li><a href="https://cloud.redhat.com/insights" class="cta-link cta-link-md cta-link-darkbg">Go to Insights</a></li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <!-- Security Menu -->
                <div aria-labelledby="security-menu" class="security-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="10">

                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Red Hat Product Security Center</h2>
                                    <p class="text-white">Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.</p>
                                    <p><a href="https://access.redhat.com/security/" class="btn btn-primary">Product Security Center</a></p>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Security Updates</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
                                    </ul>
                                    <p class="text-white">Keep your systems secure with Red Hat&#039;s specialized responses for high-priority security vulnerabilities.</p>
                                    <ul>
                                        <li class="more-link"><a href="https://access.redhat.com/security/vulnerability">View Responses</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Resources</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
                                        <li><a href="https://www.redhat.com/en/blog/channel/security">Security Blog</a></li>
                                        <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
                                        <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community Menu -->
                <div aria-labelledby="community-menu" class="community-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="11">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Portal Community</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
                                        <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
                                        <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
                                        <p class="push-top"><a href="https://access.redhat.com/community/" class="btn btn-primary">Community Activity</a></p>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Events</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
                                        <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Stories</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
                                        <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
                                        <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--<a href="https://access.redhat.com/community/" class="btn btn-primary">Explore Community</a>-->
                    </div>
                </div>
            </div>
        </div>
    </nav>
</div>

            <!--[if IE 8]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
            </div>
            <![endif]-->
            <!--[if IE 9]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
            </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">
  <script type="text/javascript">
    chrometwo_require(['jquery-ui']);
  </script>


      <article class="rh_docs">
  <div class="container">
        <!-- Display: Book Page Content -->
    
  

<div class="row">
  <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
  <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
  


<a class="toc-toggle toc-show" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
  <span class="sr-only">Show Table of Contents</span>
  <span class="web-icon-mobile-menu" aria-hidden="true"></span>
</a>
<nav id="toc-main" class="toc-main collapse in">
  <div class="toc-menu affix-top">
    <a class="toc-toggle toc-hide" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
      <span class="sr-only">Hide Table of Contents</span>
      <span class="icon-remove" aria-hidden="true"></span>
    </a>
    <div class="doc-options">
      <div class="doc-language btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          English <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="index.html">English</a></li>
                      <li><a href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/8/html/security_hardening/">日本語</a></li>
                  </ul>
      </div>
      <div class="doc-format btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          Single-page HTML <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/">Multi-page HTML</a></li>
                                <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/pdf/security_hardening/Red_Hat_Enterprise_Linux-8-Security_hardening-en-US.pdf">PDF</a></li>
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/epub/security_hardening/Red_Hat_Enterprise_Linux-8-Security_hardening-en-US.epub">ePub</a></li>
                  </ul>
      </div>
    </div>
    <ol class="menu"><li class=" leaf"><a href="index.html">Security hardening</a></li><li class=" leaf"><a href="index.html#proc_providing-feedback-on-red-hat-documentation_security-hardening">Providing feedback on Red Hat documentation</a></li><li class=" leaf"><a href="index.html#overview-of-security-hardening-security-hardening">1. Overview of security hardening in RHEL</a><ol class="menu"><li class=" leaf"><a href="index.html#what-is-computer-security_overview-of-security-hardening">1.1. What is computer security?</a></li><li class=" leaf"><a href="index.html#standardizing-security_overview-of-security-hardening">1.2. Standardizing security</a></li><li class=" leaf"><a href="index.html#cryptographic-software-and-certifications_overview-of-security-hardening">1.3. Cryptographic software and certifications</a></li><li class=" leaf"><a href="index.html#Security_Controls_overview-of-security-hardening">1.4. Security controls</a><ol class="menu"><li class=" leaf"><a href="index.html#Physical_Controls_overview-of-security-hardening">1.4.1. Physical controls</a></li><li class=" leaf"><a href="index.html#Technical_Controls_overview-of-security-hardening">1.4.2. Technical controls</a></li><li class=" leaf"><a href="index.html#Administrative_Controls_overview-of-security-hardening">1.4.3. Administrative controls</a></li></ol></li><li class=" leaf"><a href="index.html#vulnerability-assessment_overview-of-security-hardening">1.5. Vulnerability assessment</a><ol class="menu"><li class=" leaf"><a href="index.html#defining-assessment-and-testing_overview-of-security-hardening">1.5.1. Defining assessment and testing</a></li><li class=" leaf"><a href="index.html#establishing-a-methodology-for-vulnerability-assessment_overview-of-security-hardening">1.5.2. Establishing a methodology for vulnerability assessment</a></li><li class=" leaf"><a href="index.html#vulnerability-assessment-tools_overview-of-security-hardening">1.5.3. Vulnerability assessment tools</a></li></ol></li><li class=" leaf"><a href="index.html#security-threats_overview-of-security-hardening">1.6. Security threats</a><ol class="menu"><li class=" leaf"><a href="index.html#threats-to-network-security_overview-of-security-hardening">1.6.1. Threats to network security</a></li><li class=" leaf"><a href="index.html#threats-to-server-security_overview-of-security-hardening">1.6.2. Threats to server security</a></li><li class=" leaf"><a href="index.html#threats-to-workstation-and-home-pc-security_overview-of-security-hardening">1.6.3. Threats to workstation and home PC security</a></li></ol></li><li class=" leaf"><a href="index.html#Common_Exploits_and_Attacks_overview-of-security-hardening">1.7. Common exploits and attacks</a></li></ol></li><li class=" leaf"><a href="index.html#assembly_securing-rhel-during-installation-security-hardening">2. Securing RHEL during installation</a><ol class="menu"><li class=" leaf"><a href="index.html#Securing_BIOS_securing-rhel-during-installation">2.1. BIOS and UEFI security</a><ol class="menu"><li class=" leaf"><a href="index.html#BIOS_and_Boot_Loader_Security-BIOS_Passwords_securing-rhel-during-installation">2.1.1. BIOS passwords</a></li></ol></li><li class=" leaf"><a href="index.html#Disk_partitioning_securing-rhel-during-installation">2.2. Disk partitioning</a></li><li class=" leaf"><a href="index.html#Restricting_network_during_installation_securing-rhel-during-installation">2.3. Restricting network connectivity during the installation process</a></li><li class=" leaf"><a href="index.html#Minimal_install_securing-rhel-during-installation">2.4. Installing the minimum amount of packages required</a></li><li class=" leaf"><a href="index.html#Post-installation_procedures_securing-rhel-during-installation">2.5. Post-installation procedures</a></li></ol></li><li class=" leaf"><a href="index.html#using-the-system-wide-cryptographic-policies_security-hardening">3. Using system-wide cryptographic policies</a><ol class="menu"><li class=" leaf"><a href="index.html#system-wide-crypto-policies_using-the-system-wide-cryptographic-policies">3.1. System-wide cryptographic policies</a></li><li class=" leaf"><a href="index.html#switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies">3.2. Switching the system-wide cryptographic policy to mode compatible with earlier releases</a></li><li class=" leaf"><a href="index.html#switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies">3.3. Switching the system to FIPS mode</a></li><li class=" leaf"><a href="index.html#enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies">3.4. Enabling FIPS mode in a container</a></li><li class=" leaf"><a href="index.html#excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies">3.5. Excluding an application from following system-wide crypto policies</a><ol class="menu"><li class=" leaf"><a href="index.html#examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies">3.5.1. Examples of opting out of system-wide crypto policies</a></li></ol></li><li class=" leaf"><a href="index.html#customizing-system-wide-cryptographic-policies-with-policy-modifiers_using-the-system-wide-cryptographic-policies">3.6. Customizing system-wide cryptographic policies with policy modifiers</a></li><li class=" leaf"><a href="index.html#creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies">3.7. Creating and setting a custom system-wide cryptographic policy</a></li><li class=" leaf"><a href="index.html#related-information-using-the-system-wide-cryptographic-policies">3.8. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening">4. Configuring applications to use cryptographic hardware through PKCS #11</a><ol class="menu"><li class=" leaf"><a href="index.html#cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11">4.1. Cryptographic hardware support through PKCS #11</a></li><li class=" leaf"><a href="index.html#using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11">4.2. Using SSH keys stored on a smart card</a></li><li class=" leaf"><a href="index.html#using-hsms-protecting-private-keys-in-apache-and-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11">4.3. Using HSMs protecting private keys in Apache and Nginx</a></li><li class=" leaf"><a href="index.html#configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11">4.4. Configuring applications to authenticate using certificates from smart cards</a></li><li class=" leaf"><a href="index.html#related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11">4.5. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#using-shared-system-certificates_security-hardening">5. Using shared system certificates</a><ol class="menu"><li class=" leaf"><a href="index.html#the-system-wide-trust-store_using-shared-system-certificates">5.1. The system-wide trust store</a></li><li class=" leaf"><a href="index.html#adding-new-certificates_using-shared-system-certificates">5.2. Adding new certificates</a></li><li class=" leaf"><a href="index.html#managing-trusted-system-certificates_using-shared-system-certificates">5.3. Managing trusted system certificates</a></li><li class=" leaf"><a href="index.html#related-information-using-shared-system-certificates">5.4. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#scanning-the-system-for-security-compliance-and-vulnerabilities_security-hardening">6. Scanning the system for security compliance and vulnerabilities</a><ol class="menu"><li class=" leaf"><a href="index.html#security-compliance-tools-in-rhel_scanning-the-system-for-security-compliance-and-vulnerabilities">6.1. Security compliance tools in RHEL</a></li><li class=" leaf"><a href="index.html#red-hat-security-advisories-oval-feed_scanning-the-system-for-security-compliance-and-vulnerabilities">6.2. Red Hat Security Advisories OVAL feed</a></li><li class=" leaf"><a href="index.html#scanning-the-system-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities">6.3. Scanning the system for vulnerabilities</a></li><li class=" leaf"><a href="index.html#scanning-remote-systems-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities">6.4. Scanning remote systems for vulnerabilities</a></li><li class=" leaf"><a href="index.html#viewing-profiles-for-security-compliance_scanning-the-system-for-security-compliance-and-vulnerabilities">6.5. Viewing profiles for security compliance</a></li><li class=" leaf"><a href="index.html#assessing-security-compliance-with-a-specific-baseline_scanning-the-system-for-security-compliance-and-vulnerabilities">6.6. Assessing security compliance with a specific baseline</a></li><li class=" leaf"><a href="index.html#remediating-the-system-to-align-with-ospp_scanning-the-system-for-security-compliance-and-vulnerabilities">6.7. Remediating the system to align with OSPP</a></li><li class=" leaf"><a href="index.html#remediating-the-system-to-align-with-ospp-using-the-ssg-ansible-playbook_scanning-the-system-for-security-compliance-and-vulnerabilities">6.8. Remediating the system to align with OSPP using the SSG Ansible playbook</a></li><li class=" leaf"><a href="index.html#creating-a-remediation-ansible-playbook-to-align-the-system-with-ospp_scanning-the-system-for-security-compliance-and-vulnerabilities">6.9. Creating a remediation Ansible playbook to align the system with OSPP</a></li><li class=" leaf"><a href="index.html#scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-security-compliance-and-vulnerabilities">6.10. Scanning the system with a customized profile using SCAP Workbench</a><ol class="menu"><li class=" leaf"><a href="index.html#using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench">6.10.1. Using SCAP Workbench to scan and remediate the system</a></li><li class=" leaf"><a href="index.html#customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench">6.10.2. Customizing a security profile with SCAP Workbench</a></li><li class=" leaf"><a href="index.html#related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench">6.10.3. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#deploying-systems-that-are-compliant-with-a-security-profile-right-after-an-installation_scanning-the-system-for-security-compliance-and-vulnerabilities">6.11. Deploying systems that are compliant with a security profile right after an installation</a><ol class="menu"><li class=" leaf"><a href="index.html#deploying-ospp-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-right-after-an-installation">6.11.1. Deploying OSPP-compliant RHEL systems using the graphical installation</a></li><li class=" leaf"><a href="index.html#deploying-ospp-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-right-after-an-installation">6.11.2. Deploying OSPP-compliant RHEL systems using Kickstart</a></li></ol></li><li class=" leaf"><a href="index.html#scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities">6.12. Scanning container and container images for vulnerabilities</a></li><li class=" leaf"><a href="index.html#assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-security-compliance-and-vulnerabilities">6.13. Assessing security compliance of a container or a container image with a specific baseline</a></li><li class=" leaf"><a href="index.html#related-information-scanning-the-system-for-security-compliance-and-vulnerabilities">6.14. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#checking-integrity-with-aide_security-hardening">7. Checking integrity with AIDE</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-aide_checking-integrity-with-aide">7.1. Installing AIDE</a></li><li class=" leaf"><a href="index.html#performing-integrity-checks-with-aide_checking-integrity-with-aide">7.2. Performing integrity checks with AIDE</a></li><li class=" leaf"><a href="index.html#updating-an-aide-database_checking-integrity-with-aide">7.3. Updating an AIDE database</a></li><li class=" leaf"><a href="index.html#related-information-checking-integrity-with-aide">7.4. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#encrypting-block-devices-using-luks_security-hardening">8. Encrypting block devices using LUKS</a><ol class="menu"><li class=" leaf"><a href="index.html#luks-disk-encryption_encrypting-block-devices-using-luks">8.1. LUKS disk encryption</a><ol class="menu"><li class=" leaf"><a href="index.html#luks_implementation_in_rhel">8.1.1. LUKS implementation in RHEL</a></li></ol></li><li class=" leaf"><a href="index.html#encrypting-data-on-a-not-yet-encrypted-device_encrypting-block-devices-using-luks">8.2. Encrypting data on a not yet encrypted device</a></li><li class=" leaf"><a href="index.html#encrypting-data-on-a-not-yet-encrypted-device-while-storing-a-luks-header-in-a-detached-file_encrypting-block-devices-using-luks">8.3. Encrypting data on a not yet encrypted device while storing a LUKS header in a detached file</a></li></ol></li><li class=" leaf"><a href="index.html#configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening">9. Configuring automated unlocking of encrypted volumes using policy-based decryption</a><ol class="menu"><li class=" leaf"><a href="index.html#network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.1. Network-bound disk encryption</a></li><li class=" leaf"><a href="index.html#installing-an-encryption-client-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.2. Installing an encryption client - Clevis</a></li><li class=" leaf"><a href="index.html#deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.3. Deploying a Tang server with SELinux in enforcing mode</a></li><li class=" leaf"><a href="index.html#rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.4. Rotating Tang server keys and updating bindings on clients</a></li><li class=" leaf"><a href="index.html#deploying-a-clevis-encryption-client_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.5. Deploying an encryption client for an NBDE system with Tang</a></li><li class=" leaf"><a href="index.html#removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.6. Removing a Clevis pin from a LUKS-encrypted volume manually</a></li><li class=" leaf"><a href="index.html#deploying-an-encryption-client-with-a-tpm-2-0-policy_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.7. Deploying an encryption client with a TPM 2.0 policy</a></li><li class=" leaf"><a href="index.html#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.8. Configuring manual enrollment of LUKS-encrypted volumes</a></li><li class=" leaf"><a href="index.html#configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.9. Configuring automated enrollment of LUKS-encrypted volumes using Kickstart</a></li><li class=" leaf"><a href="index.html#configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.10. Configuring automated unlocking of a LUKS-encrypted removable storage device</a></li><li class=" leaf"><a href="index.html#deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.11. Deploying high-availability NBDE systems</a><ol class="menu"><li class=" leaf"><a href="index.html#high_available_nbde_using_shamir_s_secret_sharing">9.11.1. High-available NBDE using Shamir’s Secret Sharing</a></li></ol></li><li class=" leaf"><a href="index.html#deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.12. Deployment of virtual machines in a NBDE network</a></li><li class=" leaf"><a href="index.html#building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption">9.13. Building automatically-enrollable VM images for cloud environments using NBDE</a></li><li class=" leaf"><a href="index.html#additional_resources">9.14. Additional resources</a></li></ol></li><li class=" leaf"><a href="index.html#auditing-the-system_security-hardening">10. Auditing the system</a><ol class="menu"><li class=" leaf"><a href="index.html#linux-audit_auditing-the-system">10.1. Linux Audit</a></li><li class=" leaf"><a href="index.html#audit-system-architecture_auditing-the-system">10.2. Audit system architecture</a></li><li class=" leaf"><a href="index.html#configuring-auditd-for-a-secure-environment_auditing-the-system">10.3. Configuring auditd for a secure environment</a></li><li class=" leaf"><a href="index.html#starting-the-audit-service_auditing-the-system">10.4. Starting and controlling auditd</a></li><li class=" leaf"><a href="index.html#understanding-audit-log-files_auditing-the-system">10.5. Understanding Audit log files</a></li><li class=" leaf"><a href="index.html#using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system">10.6. Using auditctl for defining and executing Audit rules</a></li><li class=" leaf"><a href="index.html#defining-persistent-audit-rules_auditing-the-system">10.7. Defining persistent Audit rules</a></li><li class=" leaf"><a href="index.html#using-pre-configured-rules-files_auditing-the-system">10.8. Using pre-configured rules files</a></li><li class=" leaf"><a href="index.html#using-augenrules-to-define-persistent-rules_auditing-the-system">10.9. Using augenrules to define persistent rules</a></li><li class=" leaf"><a href="index.html#related-information-auditing-the-system">10.10. Related information</a></li></ol></li><li class=" leaf"><a href="index.html#configuring-and-managing-application-whitelists_security-hardening">11. Configuring and managing application whitelists</a><ol class="menu"><li class=" leaf"><a href="index.html#application-whitelisting-in-rhel_configuring-and-managing-application-whitelists">11.1. Application whitelisting in RHEL</a></li><li class=" leaf"><a href="index.html#deploying-application-whitelisting_configuring-and-managing-application-whitelists">11.2. Deploying application whitelisting</a></li><li class=" leaf"><a href="index.html#adding-custom-rules-for-application-whitelisting_configuring-and-managing-application-whitelists">11.3. Adding custom rules for application whitelisting</a></li><li class=" leaf"><a href="index.html#troubleshooting-rhel-application-whitelisting_configuring-and-managing-application-whitelists">11.4. Troubleshooting RHEL application whitelisting</a></li><li class=" leaf"><a href="index.html#additional_resources_2">11.5. Additional resources</a></li></ol></li><li class=" leaf"><a href="index.html#protecting-systems-against-intrusive-usb-devices_security-hardening">12. Protecting systems against intrusive USB devices</a><ol class="menu"><li class=" leaf"><a href="index.html#usbguard_protecting-systems-against-intrusive-usb-devices">12.1. USBGuard</a></li><li class=" leaf"><a href="index.html#installing-usbguard_protecting-systems-against-intrusive-usb-devices">12.2. Installing USBGuard</a></li><li class=" leaf"><a href="index.html#blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices">12.3. Blocking and authorizing a USB device using CLI</a></li><li class=" leaf"><a href="index.html#creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices">12.4. Creating a custom policy for USB devices</a></li><li class=" leaf"><a href="index.html#authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices">12.5. Authorizing users and groups to use the USBGuard IPC interface</a></li><li class=" leaf"><a href="index.html#logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices">12.6. Logging USBguard authorization events to the Linux Audit log</a></li><li class=" leaf"><a href="index.html#additional_resources_3">12.7. Additional resources</a></li></ol></li><li class=" leaf"><a href="index.html#idm140715702067824">Legal Notice</a></li></ol>  </div>
</nav>


  <div class="doc-wrapper">
    <div class="panel-pane pane-training-banner"  >
  
      
  
  <div class="card card-light card-md push-bottom">
  <h2 class="card-heading card-heading-red card-heading-sm card-heading-flush">Red Hat Training</h2>
  <p>A Red Hat training course is available for <a href="https://www.redhat.com/en/services/training/courses-by-curriculum?intcmp=701f2000001D4OtAAK&amp;#Red-Hat-Enterprise-Linux" class="cta-link">RHEL 8</a></p>
</div>

  
  </div>
<div class="panel-pane pane-page-title"  >
  
      
  
  <h1 class="title" itemprop="name">Security hardening</h1>
  
  </div>
<div class="panel-pane pane-page-body"  >
  
      
  
  <div class="body"><div xml:lang="en-US" class="book" id="idm140715708875392"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">8</span></div><div><h2 class="subtitle">Securing Red Hat Enterprise Linux 8</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="index.html#idm140715702067824">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This title assists users and administrators in learning the processes and practices of securing workstations and servers against local and remote intrusion, exploitation, and malicious activity. Focused on Red Hat Enterprise Linux but detailing concepts and techniques valid for all Linux systems, this guide details the planning and the tools involved in creating a secured computing environment for the data center, workplace, and home. With proper administrative knowledge, vigilance, and tools, systems running Linux can be both fully functional and secured from most common intrusion and exploit methods.
			</div></div></div></div><hr/></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_security-hardening"><div class="titlepage"><div><div><h1 class="title">Providing feedback on Red Hat documentation</h1></div></div></div><p>
			We appreciate your input on our documentation. Please let us know how we could make it better. To do so:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					For simple comments on specific passages:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Make sure you are viewing the documentation in the <span class="emphasis"><em>Multi-page HTML</em></span> format. In addition, ensure you see the <span class="strong strong"><strong>Feedback</strong></span> button in the upper right corner of the document.
						</li><li class="listitem">
							Use your mouse cursor to highlight the part of text that you want to comment on.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Add Feedback</strong></span> pop-up that appears below the highlighted text.
						</li><li class="listitem">
							Follow the displayed instructions.
						</li></ol></div></li><li class="listitem"><p class="simpara">
					For submitting more complex feedback, create a Bugzilla ticket:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Go to the <a class="link" href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20Enterprise%20Linux%208">Bugzilla</a> website.
						</li><li class="listitem">
							As the Component, use <span class="strong strong"><strong>Documentation</strong></span>.
						</li><li class="listitem">
							Fill in the <span class="strong strong"><strong>Description</strong></span> field with your suggestion for improvement. Include a link to the relevant part(s) of documentation.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit Bug</strong></span>.
						</li></ol></div></li></ul></div></section><section class="chapter" id="overview-of-security-hardening-security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Overview of security hardening in RHEL</h1></div></div></div><p>
			Due to the increased reliance on powerful, networked computers to help run businesses and keep track of our personal information, entire industries have been formed around the practice of network and computer security. Enterprises have solicited the knowledge and skills of security experts to properly audit systems and tailor solutions to fit the operating requirements of their organization. Because most organizations are increasingly dynamic in nature, their workers are accessing critical company IT resources locally and remotely, hence the need for secure computing environments has become more pronounced.
		</p><p>
			Unfortunately, many organizations, as well as individual users, regard security as more of an afterthought, a process that is overlooked in favor of increased power, productivity, convenience, ease of use, and budgetary concerns. Proper security implementation is often enacted postmortem — after an unauthorized intrusion has already occurred. Taking the correct measures prior to connecting a site to an untrusted network, such as the Internet, is an effective means of thwarting many attempts at intrusion.
		</p><section class="section" id="what-is-computer-security_overview-of-security-hardening"><div class="titlepage"><div><div><h2 class="title">1.1. What is computer security?</h2></div></div></div><p>
				Computer security is a general term that covers a wide area of computing and information processing. Industries that depend on computer systems and networks to conduct daily business transactions and access critical information regard their data as an important part of their overall assets. Several terms and metrics have entered our daily business vocabulary, such as total cost of ownership (TCO), return on investment (ROI), and quality of service (QoS). Using these metrics, industries can calculate aspects such as data integrity and high-availability (HA) as part of their planning and process management costs. In some industries, such as electronic commerce, the availability and trustworthiness of data can mean the difference between success and failure.
			</p></section><section class="section" id="standardizing-security_overview-of-security-hardening"><div class="titlepage"><div><div><h2 class="title">1.2. Standardizing security</h2></div></div></div><p>
				Enterprises in every industry rely on regulations and rules that are set by standards-making bodies such as the American Medical Association (AMA) or the Institute of Electrical and Electronics Engineers (IEEE). The same concepts hold true for information security. Many security consultants and vendors agree upon the standard security model known as CIA, or <span class="emphasis"><em>Confidentiality, Integrity, and Availability</em></span>. This three-tiered model is a generally accepted component to assessing risks of sensitive information and establishing security policy. The following describes the CIA model in further detail:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Confidentiality — Sensitive information must be available only to a set of pre-defined individuals. Unauthorized transmission and usage of information should be restricted. For example, confidentiality of information ensures that a customer’s personal or financial information is not obtained by an unauthorized individual for malicious purposes such as identity theft or credit fraud.
					</li><li class="listitem">
						Integrity — Information should not be altered in ways that render it incomplete or incorrect. Unauthorized users should be restricted from the ability to modify or destroy sensitive information.
					</li><li class="listitem">
						Availability — Information should be accessible to authorized users any time that it is needed. Availability is a warranty that information can be obtained with an agreed-upon frequency and timeliness. This is often measured in terms of percentages and agreed to formally in Service Level Agreements (SLAs) used by network service providers and their enterprise clients.
					</li></ul></div></section><section class="section" id="cryptographic-software-and-certifications_overview-of-security-hardening"><div class="titlepage"><div><div><h2 class="title">1.3. Cryptographic software and certifications</h2></div></div></div><p>
				Red Hat Enterprise Linux undergoes several security certifications, such as <span class="strong strong"><strong>FIPS 140-2</strong></span> or <span class="strong strong"><strong>Common Criteria</strong></span> (CC), to ensure that industry best practices are followed.
			</p><p>
				The <span class="strong strong"><strong><a class="link" href="https://access.redhat.com/articles/3655361">RHEL 8 core crypto components</a></strong></span> Knowledgebase article provides an overview of the Red Hat Enterprise Linux 8 core crypto components, documenting which are they, how are they selected, how are they integrated into the operating system, how do they support hardware security modules and smart cards, and how do crypto certifications apply to them.
			</p></section><section class="section" id="Security_Controls_overview-of-security-hardening"><div class="titlepage"><div><div><h2 class="title">1.4. Security controls</h2></div></div></div><p>
				Computer security is often divided into three distinct master categories, commonly referred to as <code class="literal">controls</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Physical
					</li><li class="listitem">
						Technical
					</li><li class="listitem">
						Administrative
					</li></ul></div><p>
				These three broad categories define the main objectives of proper security implementation. Within these controls are sub-categories that further detail the controls and how to implement them.
			</p><section class="section" id="Physical_Controls_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.4.1. Physical controls</h3></div></div></div><p>
					Physical control is the implementation of security measures in a defined structure used to deter or prevent unauthorized access to sensitive material. Examples of physical controls are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Closed-circuit surveillance cameras
						</li><li class="listitem">
							Motion or thermal alarm systems
						</li><li class="listitem">
							Security guards
						</li><li class="listitem">
							Picture IDs
						</li><li class="listitem">
							Locked and dead-bolted steel doors
						</li><li class="listitem">
							Biometrics (includes fingerprint, voice, face, iris, handwriting, and other automated methods used to recognize individuals)
						</li></ul></div></section><section class="section" id="Technical_Controls_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.4.2. Technical controls</h3></div></div></div><p>
					Technical controls use technology as a basis for controlling the access and usage of sensitive data throughout a physical structure and over a network. Technical controls are far-reaching in scope and encompass such technologies as:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Encryption
						</li><li class="listitem">
							Smart cards
						</li><li class="listitem">
							Network authentication
						</li><li class="listitem">
							Access control lists (ACLs)
						</li><li class="listitem">
							File integrity auditing software
						</li></ul></div></section><section class="section" id="Administrative_Controls_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.4.3. Administrative controls</h3></div></div></div><p>
					Administrative controls define the human factors of security. They involve all levels of personnel within an organization and determine which users have access to what resources and information by such means as:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Training and awareness
						</li><li class="listitem">
							Disaster preparedness and recovery plans
						</li><li class="listitem">
							Personnel recruitment and separation strategies
						</li><li class="listitem">
							Personnel registration and accounting
						</li></ul></div></section></section><section class="section" id="vulnerability-assessment_overview-of-security-hardening"><div class="titlepage"><div><div><h2 class="title">1.5. Vulnerability assessment</h2></div></div></div><p>
				Given time, resources, and motivation, an attacker can break into nearly any system. All of the security procedures and technologies currently available cannot guarantee that any systems are completely safe from intrusion. Routers help secure gateways to the Internet. Firewalls help secure the edge of the network. Virtual Private Networks safely pass data in an encrypted stream. Intrusion detection systems warn you of malicious activity. However, the success of each of these technologies is dependent upon a number of variables, including:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The expertise of the staff responsible for configuring, monitoring, and maintaining the technologies.
					</li><li class="listitem">
						The ability to patch and update services and kernels quickly and efficiently.
					</li><li class="listitem">
						The ability of those responsible to keep constant vigilance over the network.
					</li></ul></div><p>
				Given the dynamic state of data systems and technologies, securing corporate resources can be quite complex. Due to this complexity, it is often difficult to find expert resources for all of your systems. While it is possible to have personnel knowledgeable in many areas of information security at a high level, it is difficult to retain staff who are experts in more than a few subject areas. This is mainly because each subject area of information security requires constant attention and focus. Information security does not stand still.
			</p><p>
				A vulnerability assessment is an internal audit of your network and system security; the results of which indicate the confidentiality, integrity, and availability of your network. Typically, vulnerability assessment starts with a reconnaissance phase, during which important data regarding the target systems and resources is gathered. This phase leads to the system readiness phase, whereby the target is essentially checked for all known vulnerabilities. The readiness phase culminates in the reporting phase, where the findings are classified into categories of high, medium, and low risk; and methods for improving the security (or mitigating the risk of vulnerability) of the target are discussed
			</p><p>
				If you were to perform a vulnerability assessment of your home, you would likely check each door to your home to see if they are closed and locked. You would also check every window, making sure that they closed completely and latch correctly. This same concept applies to systems, networks, and electronic data. Malicious users are the thieves and vandals of your data. Focus on their tools, mentality, and motivations, and you can then react swiftly to their actions.
			</p><section class="section" id="defining-assessment-and-testing_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.5.1. Defining assessment and testing</h3></div></div></div><p>
					Vulnerability assessments may be broken down into one of two types: <span class="emphasis"><em>outside looking in</em></span> and <span class="emphasis"><em>inside looking around</em></span>.
				</p><p>
					When performing an outside-looking-in vulnerability assessment, you are attempting to compromise your systems from the outside. Being external to your company provides you with the cracker’s point of view. You see what a cracker sees — publicly-routable IP addresses, systems on your <span class="emphasis"><em>DMZ</em></span>, external interfaces of your firewall, and more. DMZ stands for "demilitarized zone", which corresponds to a computer or small subnetwork that sits between a trusted internal network, such as a corporate private LAN, and an untrusted external network, such as the public Internet. Typically, the DMZ contains devices accessible to Internet traffic, such as web (HTTP) servers, FTP servers, SMTP (e-mail) servers and DNS servers.
				</p><p>
					When you perform an inside-looking-around vulnerability assessment, you are at an advantage since you are internal and your status is elevated to trusted. This is the point of view you and your co-workers have once logged on to your systems. You see print servers, file servers, databases, and other resources.
				</p><p>
					There are striking distinctions between the two types of vulnerability assessments. Being internal to your company gives you more privileges than an outsider. In most organizations, security is configured to keep intruders out. Very little is done to secure the internals of the organization (such as departmental firewalls, user-level access controls, and authentication procedures for internal resources). Typically, there are many more resources when looking around inside as most systems are internal to a company. Once you are outside the company, your status is untrusted. The systems and resources available to you externally are usually very limited.
				</p><p>
					Consider the difference between vulnerability assessments and <span class="emphasis"><em>penetration tests</em></span>. Think of a vulnerability assessment as the first step to a penetration test. The information gleaned from the assessment is used for testing. Whereas the assessment is undertaken to check for holes and potential vulnerabilities, the penetration testing actually attempts to exploit the findings.
				</p><p>
					Assessing network infrastructure is a dynamic process. Security, both information and physical, is dynamic. Performing an assessment shows an overview, which can turn up false positives and false negatives. A false positive is a result, where the tool finds vulnerabilities which in reality do not exist. A false negative is when it omits actual vulnerabilities.
				</p><p>
					Security administrators are only as good as the tools they use and the knowledge they retain. Take any of the assessment tools currently available, run them against your system, and it is almost a guarantee that there are some false positives. Whether by program fault or user error, the result is the same. The tool may find false positives, or, even worse, false negatives.
				</p><p>
					Now that the difference between a vulnerability assessment and a penetration test is defined, take the findings of the assessment and review them carefully before conducting a penetration test as part of your new best practices approach.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not attempt to exploit vulnerabilities on production systems. Doing so can have adverse effects on productivity and efficiency of your systems and network.
					</p></div></div><p>
					The following list examines some of the benefits of performing vulnerability assessments.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Creates proactive focus on information security.
						</li><li class="listitem">
							Finds potential exploits before crackers find them.
						</li><li class="listitem">
							Results in systems being kept up to date and patched.
						</li><li class="listitem">
							Promotes growth and aids in developing staff expertise.
						</li><li class="listitem">
							Abates financial loss and negative publicity.
						</li></ul></div></section><section class="section" id="establishing-a-methodology-for-vulnerability-assessment_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.5.2. Establishing a methodology for vulnerability assessment</h3></div></div></div><p>
					To aid in the selection of tools for a vulnerability assessment, it is helpful to establish a vulnerability assessment methodology. Unfortunately, there is no predefined or industry approved methodology at this time; however, common sense and best practices can act as a sufficient guide.
				</p><p>
					<span class="emphasis"><em>What is the target? Are we looking at one server, or are we looking at our entire network and everything within the network? Are we external or internal to the company?</em></span> The answers to these questions are important as they help determine not only which tools to select but also the manner in which they are used.
				</p><p>
					To learn more about establishing methodologies, see the following website:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://www.owasp.org/index.php/Main_Page">https://www.owasp.org/</a> — <span class="strong strong"><strong><span class="citetitle citetitle">The Open Web Application Security Project</span></strong></span>
						</li></ul></div></section><section class="section" id="vulnerability-assessment-tools_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.5.3. Vulnerability assessment tools</h3></div></div></div><p>
					An assessment can start by using some form of an information-gathering tool. When assessing the entire network, map the layout first to find the hosts that are running. Once located, examine each host individually. Focusing on these hosts requires another set of tools. Knowing which tools to use may be the most crucial step in finding vulnerabilities.
				</p><p>
					The following tools are just a small sampling of the available tools:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal application">Nmap</code> is a popular tool that can be used to find host systems and open ports on those systems. To install <code class="literal application">Nmap</code> from the <code class="literal">AppStream</code> repository, enter the <code class="literal command">yum install nmap</code> command as the <code class="literal">root</code> user. See the <code class="literal">nmap(1)</code> man page for more information.
						</li><li class="listitem">
							The tools from the <code class="literal">OpenSCAP</code> suite, such as the <code class="literal">oscap</code> command-line utility and the <code class="literal">scap-workbench</code> graphical utility, provides a fully automated compliance audit. See <a class="link" href="index.html#scanning-the-system-for-security-compliance-and-vulnerabilities_security-hardening" title="Chapter 6. Scanning the system for security compliance and vulnerabilities">Scanning the system for security compliance and vulnerabilities</a> for more information.
						</li><li class="listitem">
							Advanced Intrusion Detection Environment (<code class="literal">AIDE</code>) is a utility that creates a database of files on the system, and then uses that database to ensure file integrity and detect system intrusions. See <a class="link" href="index.html#checking-integrity-with-aide_security-hardening" title="Chapter 7. Checking integrity with AIDE">Checking integrity with AIDE</a> for more information.
						</li></ul></div></section></section><section class="section" id="security-threats_overview-of-security-hardening"><div class="titlepage"><div><div><h2 class="title">1.6. Security threats</h2></div></div></div><section class="section" id="threats-to-network-security_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.6.1. Threats to network security</h3></div></div></div><p>
					Bad practices when configuring the following aspects of a network can increase the risk of an attack.
				</p><div class="formalpara"><p class="title"><strong>Insecure architectures</strong></p><p>
						A misconfigured network is a primary entry point for unauthorized users. Leaving a trust-based, open local network vulnerable to the highly-insecure Internet is much like leaving a door ajar in a crime-ridden neighborhood — nothing may happen for an arbitrary amount of time, but someone exploits the opportunity <span class="emphasis"><em>eventually</em></span>.
					</p></div><div class="formalpara"><p class="title"><strong>Broadcast networks</strong></p><p>
						System administrators often fail to realize the importance of networking hardware in their security schemes. Simple hardware, such as hubs and routers, relies on the broadcast or non-switched principle; that is, whenever a node transmits data across the network to a recipient node, the hub or router sends a broadcast of the data packets until the recipient node receives and processes the data. This method is the most vulnerable to address resolution protocol (<span class="emphasis"><em>ARP</em></span>) or media access control (<span class="emphasis"><em>MAC</em></span>) address spoofing by both outside intruders and unauthorized users on local hosts.
					</p></div><div class="formalpara"><p class="title"><strong>Centralized servers</strong></p><p>
						Another potential networking pitfall is the use of centralized computing. A common cost-cutting measure for many businesses is to consolidate all services to a single powerful machine. This can be convenient as it is easier to manage and costs considerably less than multiple-server configurations. However, a centralized server introduces a single point of failure on the network. If the central server is compromised, it may render the network completely useless or worse, prone to data manipulation or theft. In these situations, a central server becomes an open door that allows access to the entire network.
					</p></div></section><section class="section" id="threats-to-server-security_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.6.2. Threats to server security</h3></div></div></div><p>
					Server security is as important as network security because servers often hold a great deal of an organization’s vital information. If a server is compromised, all of its contents may become available for the cracker to steal or manipulate at will. The following sections detail some of the main issues.
				</p><div class="formalpara"><p class="title"><strong>Unused services and open ports</strong></p><p>
						A full installation of Red Hat Enterprise Linux 8 contains more than 1000 applications and library packages. However, most server administrators do not opt to install every single package in the distribution, preferring instead to install a base installation of packages, including several server applications.
					</p></div><p>
					A common occurrence among system administrators is to install the operating system without paying attention to what programs are actually being installed. This can be problematic because unneeded services may be installed, configured with the default settings, and possibly turned on. This can cause unwanted services, such as Telnet, DHCP, or DNS, to run on a server or workstation without the administrator realizing it, which in turn can cause unwanted traffic to the server or even a potential pathway into the system for crackers.
				</p><div class="formalpara"><p class="title"><strong>Unpatched services</strong></p><p>
						Most server applications that are included in a default installation are solid, thoroughly tested pieces of software. Having been in use in production environments for many years, their code has been thoroughly refined and many of the bugs have been found and fixed.
					</p></div><p>
					However, there is no such thing as perfect software and there is always room for further refinement. Moreover, newer software is often not as rigorously tested as one might expect, because of its recent arrival to production environments or because it may not be as popular as other server software.
				</p><p>
					Developers and system administrators often find exploitable bugs in server applications and publish the information on bug tracking and security-related websites such as the Bugtraq mailing list (<a class="link" href="http://www.securityfocus.com">http://www.securityfocus.com</a>) or the Computer Emergency Response Team (CERT) website (<a class="link" href="http://www.cert.org">http://www.cert.org</a>). Although these mechanisms are an effective way of alerting the community to security vulnerabilities, it is up to system administrators to patch their systems promptly. This is particularly true because crackers have access to these same vulnerability tracking services and will use the information to crack unpatched systems whenever they can. Good system administration requires vigilance, constant bug tracking, and proper system maintenance to ensure a more secure computing environment.
				</p><div class="formalpara"><p class="title"><strong>Inattentive administration</strong></p><p>
						Administrators who fail to patch their systems are one of the greatest threats to server security. This applies as much to inexperienced administrators as it does to overconfident or amotivated administrators.
					</p></div><p>
					Some administrators fail to patch their servers and workstations, while others fail to watch log messages from the system kernel or network traffic. Another common error is when default passwords or keys to services are left unchanged. For example, some databases have default administration passwords because the database developers assume that the system administrator changes these passwords immediately after installation. If a database administrator fails to change this password, even an inexperienced cracker can use a widely-known default password to gain administrative privileges to the database. These are only a few examples of how inattentive administration can lead to compromised servers.
				</p><div class="formalpara"><p class="title"><strong>Inherently insecure services</strong></p><p>
						Even the most vigilant organization can fall victim to vulnerabilities if the network services they choose are inherently insecure. For instance, there are many services developed under the assumption that they are used over trusted networks; however, this assumption fails as soon as the service becomes available over the Internet — which is itself inherently untrusted.
					</p></div><p>
					One category of insecure network services are those that require unencrypted user names and passwords for authentication. Telnet and FTP are two such services. If packet sniffing software is monitoring traffic between the remote user and such a service user names and passwords can be easily intercepted.
				</p><p>
					Inherently, such services can also more easily fall prey to what the security industry terms the <span class="emphasis"><em>man-in-the-middle</em></span> attack. In this type of attack, a cracker redirects network traffic by tricking a cracked name server on the network to point to his machine instead of the intended server. Once someone opens a remote session to the server, the attacker’s machine acts as an invisible conduit, sitting quietly between the remote service and the unsuspecting user capturing information. In this way a cracker can gather administrative passwords and raw data without the server or the user realizing it.
				</p><p>
					Another category of insecure services include network file systems and information services such as NFS or NIS, which are developed explicitly for LAN usage but are, unfortunately, extended to include WANs (for remote users). NFS does not, by default, have any authentication or security mechanisms configured to prevent a cracker from mounting the NFS share and accessing anything contained therein. NIS, as well, has vital information that must be known by every computer on a network, including passwords and file permissions, within a plain text ASCII or DBM (ASCII-derived) database. A cracker who gains access to this database can then access every user account on a network, including the administrator’s account.
				</p><p>
					By default, Red Hat Enterprise Linux 8 is released with all such services turned off. However, since administrators often find themselves forced to use these services, careful configuration is critical.
				</p></section><section class="section" id="threats-to-workstation-and-home-pc-security_overview-of-security-hardening"><div class="titlepage"><div><div><h3 class="title">1.6.3. Threats to workstation and home PC security</h3></div></div></div><p>
					Workstations and home PCs may not be as prone to attack as networks or servers, but since they often contain sensitive data, such as credit card information, they are targeted by system crackers. Workstations can also be co-opted without the user’s knowledge and used by attackers as "slave" machines in coordinated attacks. For these reasons, knowing the vulnerabilities of a workstation can save users the headache of reinstalling the operating system, or worse, recovering from data theft.
				</p><div class="formalpara"><p class="title"><strong>Bad passwords</strong></p><p>
						Bad passwords are one of the easiest ways for an attacker to gain access to a system.
					</p></div><div class="formalpara"><p class="title"><strong>Vulnerable client applications</strong></p><p>
						Although an administrator may have a fully secure and patched server, that does not mean remote users are secure when accessing it. For instance, if the server offers Telnet or FTP services over a public network, an attacker can capture the plain text user names and passwords as they pass over the network, and then use the account information to access the remote user’s workstation.
					</p></div><p>
					Even when using secure protocols, such as SSH, a remote user may be vulnerable to certain attacks if they do not keep their client applications updated. For instance, SSH protocol version 1 clients are vulnerable to an X-forwarding attack from malicious SSH servers. Once connected to the server, the attacker can quietly capture any keystrokes and mouse clicks made by the client over the network. This problem was fixed in the SSH version 2 protocol, but it is up to the user to keep track of what applications have such vulnerabilities and update them as necessary.
				</p></section></section><section class="section" id="Common_Exploits_and_Attacks_overview-of-security-hardening"><div class="titlepage"><div><div><h2 class="title">1.7. Common exploits and attacks</h2></div></div></div><p>
				<a class="xref" href="index.html#tabl-Common_Exploits" title="Table 1.1. Common exploits">Table 1.1, “Common exploits”</a> details some of the most common exploits and entry points used by intruders to access organizational network resources. Key to these common exploits are the explanations of how they are performed and how administrators can properly safeguard their network against such attacks.
			</p><div class="table" id="tabl-Common_Exploits"><p class="title"><strong>Table 1.1. Common exploits</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140715705812784" scope="col">Exploit</th><th align="left" valign="top" id="idm140715705811696" scope="col">Description</th><th align="left" valign="top" id="idm140715705810608" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140715705812784"> <p>
								Null or default passwords
							</p>
							 </td><td align="left" valign="top" headers="idm140715705811696"> <p>
								Leaving administrative passwords blank or using a default password set by the product vendor. This is most common in hardware such as routers and firewalls, but some services that run on Linux can contain default administrator passwords as well (though Red Hat Enterprise Linux 8 does not ship with them).
							</p>
							 </td><td align="left" valign="top" headers="idm140715705810608"> <p>
								Commonly associated with networking hardware such as routers, firewalls, VPNs, and network attached storage (NAS) appliances.
							</p>
							 <p>
								Common in many legacy operating systems, especially those that bundle services (such as UNIX and Windows.)
							</p>
							 <p>
								Administrators sometimes create privileged user accounts in a rush and leave the password null, creating a perfect entry point for malicious users who discover the account.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715705812784"> <p>
								Default shared keys
							</p>
							 </td><td align="left" valign="top" headers="idm140715705811696"> <p>
								Secure services sometimes package default security keys for development or evaluation testing purposes. If these keys are left unchanged and are placed in a production environment on the Internet, <span class="strong strong"><strong>all</strong></span> users with the same default keys have access to that shared-key resource, and any sensitive information that it contains.
							</p>
							 </td><td align="left" valign="top" headers="idm140715705810608"> <p>
								Most common in wireless access points and preconfigured secure server appliances.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715705812784"> <p>
								IP spoofing
							</p>
							 </td><td align="left" valign="top" headers="idm140715705811696"> <p>
								A remote machine acts as a node on your local network, finds vulnerabilities with your servers, and installs a backdoor program or Trojan horse to gain control over your network resources.
							</p>
							 </td><td align="left" valign="top" headers="idm140715705810608"> <p>
								Spoofing is quite difficult as it involves the attacker predicting TCP/IP sequence numbers to coordinate a connection to target systems, but several tools are available to assist crackers in performing such a vulnerability.
							</p>
							 <p>
								Depends on target system running services (such as <code class="literal command">rsh</code>, <code class="literal command">telnet</code>, FTP and others) that use <span class="emphasis"><em>source-based</em></span> authentication techniques, which are not recommended when compared to PKI or other forms of encrypted authentication used in <code class="literal command">ssh</code> or SSL/TLS.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715705812784"> <p>
								Eavesdropping
							</p>
							 </td><td align="left" valign="top" headers="idm140715705811696"> <p>
								Collecting data that passes between two active nodes on a network by eavesdropping on the connection between the two nodes.
							</p>
							 </td><td align="left" valign="top" headers="idm140715705810608"> <p>
								This type of attack works mostly with plain text transmission protocols such as Telnet, FTP, and HTTP transfers.
							</p>
							 <p>
								Remote attacker must have access to a compromised system on a LAN in order to perform such an attack; usually the cracker has used an active attack (such as IP spoofing or man-in-the-middle) to compromise a system on the LAN.
							</p>
							 <p>
								Preventative measures include services with cryptographic key exchange, one-time passwords, or encrypted authentication to prevent password snooping; strong encryption during transmission is also advised.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715705812784"> <p>
								Service vulnerabilities
							</p>
							 </td><td align="left" valign="top" headers="idm140715705811696"> <p>
								An attacker finds a flaw or loophole in a service run over the Internet; through this vulnerability, the attacker compromises the entire system and any data that it may hold, and could possibly compromise other systems on the network.
							</p>
							 </td><td align="left" valign="top" headers="idm140715705810608"> <p>
								HTTP-based services such as CGI are vulnerable to remote command execution and even interactive shell access. Even if the HTTP service runs as a non-privileged user such as "nobody", information such as configuration files and network maps can be read, or the attacker can start a denial of service attack which drains system resources or renders it unavailable to other users.
							</p>
							 <p>
								Services sometimes can have vulnerabilities that go unnoticed during development and testing; these vulnerabilities (such as <span class="emphasis"><em>buffer overflows</em></span>, where attackers crash a service using arbitrary values that fill the memory buffer of an application, giving the attacker an interactive command prompt from which they may execute arbitrary commands) can give complete administrative control to an attacker.
							</p>
							 <p>
								Administrators should make sure that services do not run as the root user, and should stay vigilant of patches and errata updates for applications from vendors or security organizations such as CERT and CVE.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715705812784"> <p>
								Application vulnerabilities
							</p>
							 </td><td align="left" valign="top" headers="idm140715705811696"> <p>
								Attackers find faults in desktop and workstation applications (such as email clients) and execute arbitrary code, implant Trojan horses for future compromise, or crash systems. Further exploitation can occur if the compromised workstation has administrative privileges on the rest of the network.
							</p>
							 </td><td align="left" valign="top" headers="idm140715705810608"> <p>
								Workstations and desktops are more prone to exploitation as workers do not have the expertise or experience to prevent or detect a compromise; it is imperative to inform individuals of the risks they are taking when they install unauthorized software or open unsolicited email attachments.
							</p>
							 <p>
								Safeguards can be implemented such that email client software does not automatically open or execute attachments. Additionally, the automatic update of workstation software using Red Hat Network; or other system management services can alleviate the burdens of multi-seat security deployments.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715705812784"> <p>
								Denial of Service (DoS) attacks
							</p>
							 </td><td align="left" valign="top" headers="idm140715705811696"> <p>
								Attacker or group of attackers coordinate against an organization’s network or server resources by sending unauthorized packets to the target host (either server, router, or workstation). This forces the resource to become unavailable to legitimate users.
							</p>
							 </td><td align="left" valign="top" headers="idm140715705810608"> <p>
								The most reported DoS case in the US occurred in 2000. Several highly-trafficked commercial and government sites were rendered unavailable by a coordinated ping flood attack using several compromised systems with high bandwidth connections acting as <span class="emphasis"><em>zombies</em></span>, or redirected broadcast nodes.
							</p>
							 <p>
								Source packets are usually forged (as well as rebroadcast), making investigation as to the true source of the attack difficult.
							</p>
							 <p>
								Advances in ingress filtering (IETF rfc2267) using <code class="literal command">iptables</code> and Network Intrusion Detection Systems such as <code class="literal command">snort</code> assist administrators in tracking down and preventing distributed DoS attacks.
							</p>
							 </td></tr></tbody></table></div></div></section></section><section class="chapter" id="assembly_securing-rhel-during-installation-security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Securing RHEL during installation</h1></div></div></div><p>
			Security begins even before you start the installation of Red Hat Enterprise Linux. Configuring your system securely from the beginning makes it easier to implement additional security settings later.
		</p><section class="section" id="Securing_BIOS_securing-rhel-during-installation"><div class="titlepage"><div><div><h2 class="title">2.1. BIOS and UEFI security</h2></div></div></div><p>
				Password protection for the BIOS (or BIOS equivalent) and the boot loader can prevent unauthorized users who have physical access to systems from booting using removable media or obtaining root privileges through single user mode. The security measures you should take to protect against such attacks depends both on the sensitivity of the information on the workstation and the location of the machine.
			</p><p>
				For example, if a machine is used in a trade show and contains no sensitive information, then it may not be critical to prevent such attacks. However, if an employee’s laptop with private, unencrypted SSH keys for the corporate network is left unattended at that same trade show, it could lead to a major security breach with ramifications for the entire company.
			</p><p>
				If the workstation is located in a place where only authorized or trusted people have access, however, then securing the BIOS or the boot loader may not be necessary.
			</p><section class="section" id="BIOS_and_Boot_Loader_Security-BIOS_Passwords_securing-rhel-during-installation"><div class="titlepage"><div><div><h3 class="title">2.1.1. BIOS passwords</h3></div></div></div><p>
					The two primary reasons for password protecting the BIOS of a computer are<a href="index.html#ftn.idm140715723352784" class="footnote"><sup class="footnote" id="idm140715723352784">[1]</sup></a>:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							<span class="strong strong"><strong>Preventing changes to BIOS settings</strong></span> — If an intruder has access to the BIOS, they can set it to boot from a CD-ROM or a flash drive. This makes it possible for them to enter rescue mode or single user mode, which in turn allows them to start arbitrary processes on the system or copy sensitive data.
						</li><li class="listitem">
							<span class="strong strong"><strong>Preventing system booting</strong></span> — Some BIOSes allow password protection of the boot process. When activated, an attacker is forced to enter a password before the BIOS launches the boot loader.
						</li></ol></div><p>
					Because the methods for setting a BIOS password vary between computer manufacturers, consult the computer’s manual for specific instructions.
				</p><p>
					If you forget the BIOS password, it can either be reset with jumpers on the motherboard or by disconnecting the CMOS battery. For this reason, it is good practice to lock the computer case if possible. However, consult the manual for the computer or motherboard before attempting to disconnect the CMOS battery.
				</p><section class="section" id="BIOS_Passwords-Securing_Non_BIOS_Systems_securing-rhel-during-installation"><div class="titlepage"><div><div><h4 class="title">2.1.1.1. Non-BIOS-based systems security</h4></div></div></div><p>
						Other systems and architectures use different programs to perform low-level tasks roughly equivalent to those of the BIOS on x86 systems. For example, the <span class="emphasis"><em>Unified Extensible Firmware Interface</em></span> (<span class="emphasis"><em>UEFI</em></span>) shell.
					</p><p>
						For instructions on password protecting BIOS-like programs, see the manufacturer’s instructions.
					</p></section></section></section><section class="section" id="Disk_partitioning_securing-rhel-during-installation"><div class="titlepage"><div><div><h2 class="title">2.2. Disk partitioning</h2></div></div></div><p>
				Red Hat recommends creating separate partitions for the <code class="literal">/boot</code>, <code class="literal">/</code>, <code class="literal">/home</code>, <code class="literal">/tmp</code>, and <code class="literal">/var/tmp/</code> directories. The reasons for each are different, and we will address each partition.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">/boot</code></span></dt><dd>
							This partition is the first partition that is read by the system during boot up. The boot loader and kernel images that are used to boot your system into Red Hat Enterprise Linux 8 are stored in this partition. This partition should not be encrypted. If this partition is included in / and that partition is encrypted or otherwise becomes unavailable then your system will not be able to boot.
						</dd><dt><span class="term"><code class="literal">/home</code></span></dt><dd>
							When user data (<code class="literal">/home</code>) is stored in <code class="literal">/</code> instead of in a separate partition, the partition can fill up causing the operating system to become unstable. Also, when upgrading your system to the next version of Red Hat Enterprise Linux 8 it is a lot easier when you can keep your data in the <code class="literal">/home</code> partition as it will not be overwritten during installation. If the root partition (<code class="literal">/</code>) becomes corrupt your data could be lost forever. By using a separate partition there is slightly more protection against data loss. You can also target this partition for frequent backups.
						</dd><dt><span class="term"><code class="literal">/tmp</code> and <code class="literal">/var/tmp/</code></span></dt><dd>
							Both the <code class="literal">/tmp</code> and <code class="literal">/var/tmp/</code> directories are used to store data that does not need to be stored for a long period of time. However, if a lot of data floods one of these directories it can consume all of your storage space. If this happens and these directories are stored within <code class="literal">/</code> then your system could become unstable and crash. For this reason, moving these directories into their own partitions is a good idea.
						</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					During the installation process, you have an option to encrypt partitions. You must supply a passphrase. This passphrase serves as a key to unlock the bulk encryption key, which is used to secure the partition’s data.
				</p></div></div></section><section class="section" id="Restricting_network_during_installation_securing-rhel-during-installation"><div class="titlepage"><div><div><h2 class="title">2.3. Restricting network connectivity during the installation process</h2></div></div></div><p>
				When installing Red Hat Enterprise Linux 8, the installation medium represents a snapshot of the system at a particular time. Because of this, it may not be up-to-date with the latest security fixes and may be vulnerable to certain issues that were fixed only after the system provided by the installation medium was released.
			</p><p>
				When installing a potentially vulnerable operating system, always limit exposure only to the closest necessary network zone. The safest choice is the “no network” zone, which means to leave your machine disconnected during the installation process. In some cases, a LAN or intranet connection is sufficient while the Internet connection is the riskiest. To follow the best security practices, choose the closest zone with your repository while installing Red Hat Enterprise Linux 8 from a network.
			</p></section><section class="section" id="Minimal_install_securing-rhel-during-installation"><div class="titlepage"><div><div><h2 class="title">2.4. Installing the minimum amount of packages required</h2></div></div></div><p>
				It is best practice to install only the packages you will use because each piece of software on your computer could possibly contain a vulnerability. If you are installing from the DVD media, take the opportunity to select exactly what packages you want to install during the installation. If you find you need another package, you can always add it to the system later.
			</p></section><section class="section" id="Post-installation_procedures_securing-rhel-during-installation"><div class="titlepage"><div><div><h2 class="title">2.5. Post-installation procedures</h2></div></div></div><p>
				The following steps are the security-related procedures that should be performed immediately after installation of Red Hat Enterprise Linux.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Update your system. Enter the following command as root:
					</p><pre class="screen"># yum update</pre></li><li class="listitem"><p class="simpara">
						Even though the firewall service, <code class="literal">firewalld</code>, is automatically enabled with the installation of Red Hat Enterprise Linux, there are scenarios where it might be explicitly disabled, for example in the kickstart configuration. In such a case, it is recommended to consider re-enabling the firewall.
					</p><p class="simpara">
						To start <code class="literal">firewalld</code> enter the following commands as root:
					</p><pre class="screen"># systemctl start firewalld
# systemctl enable firewalld</pre></li><li class="listitem"><p class="simpara">
						To enhance security, disable services you do not need. For example, if there are no printers installed on your computer, disable the <code class="literal command">cups</code> service using the following command:
					</p><pre class="screen"># systemctl disable cups</pre><p class="simpara">
						To review active services, enter the following command:
					</p><pre class="screen">$ <code class="literal command">systemctl list-units | grep service</code></pre></li></ol></div></section><div class="footnotes"><br/><hr width="100" align="left"/><div id="ftn.idm140715723352784" class="footnote"><div class="para"><a href="index.html#idm140715723352784" class="simpara"><sup class="simpara">[1] </sup></a>
						Since system BIOSes differ between manufacturers, some may not support password protection of either type, while others may support one type but not the other.
					</div></div></div></section><section class="chapter" id="using-the-system-wide-cryptographic-policies_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Using system-wide cryptographic policies</h1></div></div></div><p>
			Crypto policies is a system component that configures the core cryptographic subsystems, covering the TLS, IPSec, SSH, DNSSec, and Kerberos protocols. It provides a small set of policies, which the administrator can select.
		</p><section class="section" id="system-wide-crypto-policies_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.1. System-wide cryptographic policies</h2></div></div></div><p>
				Once a system-wide policy is set up, applications in RHEL follow it and refuse to use algorithms and protocols that do not meet the policy, unless you explicitly request the application to do so. That is, the policy applies to the default behavior of applications when running with the system-provided configuration but you can override it if required so.
			</p><p>
				Red Hat Enterprise Linux 8 contains the following policy levels:
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 80%; " class="col_2"><!--Empty--></col></colgroup><tbody><tr><td align="left" valign="top"> <p>
								<code class="literal">DEFAULT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								The default system-wide cryptographic policy level offers secure settings for current threat models. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 2048 bits long.
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">LEGACY</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								This policy ensures maximum compatibility with Red Hat Enterprise Linux 5 and earlier; it is less secure due to an increased attack surface. In addition to the <code class="literal">DEFAULT</code> level algorithms and protocols, it includes support for the TLS 1.0 and 1.1 protocols. The algorithms DSA, 3DES, and RC4 are allowed, while RSA keys and Diffie-Hellman parameters are accepted if they are at least 1023 bits long.
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">FUTURE</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								A conservative security level that is believed to withstand any near-term future attacks. This level does not allow the use of SHA-1 in signature algorithms. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 3072 bits long.
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">FIPS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								A policy level that conforms with the FIPS140-2 requirements. This is used internally by the <code class="literal">fips-mode-setup</code> tool, which switches the RHEL system into FIPS mode.
							</p>
							 </td></tr></tbody></table></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The specific algorithms and ciphers described in the policy levels as allowed are available only if an application supports them.
				</p></div></div><h4 id="tool_for_managing_crypto_policies">Tool for managing crypto policies</h4><p>
				To view or change the current system-wide cryptographic policy, use the <code class="literal">update-crypto-policies</code> tool, for example:
			</p><pre class="screen">$ <span class="strong strong"><strong>update-crypto-policies --show</strong></span>
DEFAULT
# <span class="strong strong"><strong>update-crypto-policies --set FUTURE</strong></span>
Setting system policy to FUTURE</pre><p>
				To ensure that the change of the cryptographic policy is applied, restart the system.
			</p><h4 id="strong_crypto_defaults_by_removing_insecure_cipher_suites_and_protocols">Strong crypto defaults by removing insecure cipher suites and protocols</h4><p>
				The following list contains cipher suites and protocols removed from the core cryptographic libraries in RHEL 8. They are not present in the sources, or their support is disabled during the build, so applications cannot use them.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						DES (since RHEL 7)
					</li><li class="listitem">
						All export grade cipher suites (since RHEL 7)
					</li><li class="listitem">
						MD5 in signatures (since RHEL 7)
					</li><li class="listitem">
						SSLv2 (since RHEL 7)
					</li><li class="listitem">
						SSLv3 (since RHEL 8)
					</li><li class="listitem">
						All ECC curves &lt; 224 bits (since RHEL 6)
					</li><li class="listitem">
						All binary field ECC curves (since RHEL 6)
					</li></ul></div><h4 id="cipher_suites_and_protocols_disabled_in_all_policy_levels">Cipher suites and protocols disabled in all policy levels</h4><p>
				The following cipher suites and protocols are disabled in all crypto policy levels. They can be enabled only by an explicit configuration of individual applications.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						DH with parameters &lt; 1024 bits
					</li><li class="listitem">
						RSA with key size &lt; 1024 bits
					</li><li class="listitem">
						Camellia
					</li><li class="listitem">
						ARIA
					</li><li class="listitem">
						SEED
					</li><li class="listitem">
						IDEA
					</li><li class="listitem">
						Integrity-only cipher suites
					</li><li class="listitem">
						TLS CBC mode cipher suites using SHA-384 HMAC
					</li><li class="listitem">
						AES-CCM8
					</li><li class="listitem">
						All ECC curves incompatible with TLS 1.3, including secp256k1
					</li><li class="listitem">
						IKEv1 (since RHEL 8)
					</li></ul></div><h4 id="cipher_suites_and_protocols_enabled_in_the_crypto_policies_levels">Cipher suites and protocols enabled in the crypto-policies levels</h4><p>
				The following table shows the enabled cipher suites and protocols in all four crypto-policies levels.
			</p><div class="informaltable"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col><col style="width: 20%; " class="col_3"><!--Empty--></col><col style="width: 20%; " class="col_4"><!--Empty--></col><col style="width: 20%; " class="col_5"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140715699152896" scope="col"> </th><th align="left" valign="top" id="idm140715699151968" scope="col"><code class="literal">LEGACY</code></th><th align="left" valign="top" id="idm140715704666144" scope="col"><code class="literal">DEFAULT</code></th><th align="left" valign="top" id="idm140715704664896" scope="col"><code class="literal">FIPS</code></th><th align="left" valign="top" id="idm140715704663648" scope="col"><code class="literal">FUTURE</code></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>IKEv1</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>3DES</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>RC4</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>DH</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								min. 1024-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								min. 3072-bit
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>RSA</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								min. 1024-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								min. 3072-bit
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>DSA</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>TLS v1.0</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>TLS v1.1</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>SHA-1 in digital signatures</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>CBC mode ciphers</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>Symmetric ciphers with keys &lt; 256 bits</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140715699152896"> <p>
								<span class="strong strong"><strong>SHA-1 and SHA-224 signatures in certificates</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140715699151968"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704666144"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704664896"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140715704663648"> <p>
								no
							</p>
							 </td></tr></tbody></table></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more details, see the <code class="literal">update-crypto-policies(8)</code> man page.
					</li></ul></div></section><section class="section" id="switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.2. Switching the system-wide cryptographic policy to mode compatible with earlier releases</h2></div></div></div><p>
				The default system-wide cryptographic policy in Red Hat Enterprise Linux 8 does not allow communication using older, insecure protocols. For environments that require to be compatible with Red Hat Enterprise Linux 5 and in some cases also with earlier releases, the less secure <code class="literal">LEGACY</code> policy level is available.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Switching to the <code class="literal">LEGACY</code> policy level results in a less secure system and applications.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To switch the system-wide cryptographic policy to the <code class="literal">LEGACY</code> level, enter the following command as <code class="literal">root</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set LEGACY</strong></span>
Setting system policy to LEGACY</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For the list of available cryptographic policy levels, see the <code class="literal">update-crypto-policies(8)</code> man page.
					</li></ul></div></section><section class="section" id="switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.3. Switching the system to FIPS mode</h2></div></div></div><p>
				The system-wide cryptographic policies contain a policy level that enables cryptographic modules self-checks in accordance with the requirements by Federal Information Processing Standard (FIPS) Publication 140-2. The <code class="literal">fips-mode-setup</code> tool that enables or disables FIPS mode internally uses the <code class="literal">FIPS</code> system-wide cryptographic policy level.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To switch the system to FIPS mode in RHEL 8:
					</p><pre class="screen"># <span class="strong strong"><strong>fips-mode-setup --enable</strong></span>
Setting system policy to FIPS
FIPS mode will be enabled.
Please reboot the system for the setting to take effect.</pre></li><li class="listitem"><p class="simpara">
						Restart your system to allow the kernel to switch to FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						After the restart, you can check the current state of FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>fips-mode-setup --check</strong></span>
FIPS mode is enabled.</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">fips-mode-setup(8)</code> man page.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/4309511">List of RHEL 8 applications using cryptography that are not compliant with FIPS 140-2</a>
					</li><li class="listitem">
						For more details on FIPS 140-2, see the <a class="link" href="https://csrc.nist.gov/publications/detail/fips/140/2/final">Security Requirements for Cryptographic Modules</a> on the National Institute of Standards and Technology (NIST) web site.
					</li></ul></div></section><section class="section" id="enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.4. Enabling FIPS mode in a container</h2></div></div></div><p>
				To enable cryptographic modules self-checks in accordance with the requirements by Federal Information Processing Standard (FIPS) Publication 140-2 in a container:
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The host system must be switched in FIPS mode first, see <a class="link" href="index.html#switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies" title="3.3. Switching the system to FIPS mode">Switching the system to FIPS mode</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Mount the <code class="literal filename">/etc/system-fips</code> file on the container from the host.
					</li><li class="listitem"><p class="simpara">
						Set the FIPS cryptographic policy level in the container:
					</p><pre class="screen">$ <span class="strong strong"><strong>update-crypto-policies --set FIPS</strong></span></pre></li></ol></div><p>
				RHEL 8.2 introduced an alternative method for switching a container to FIPS mode. It requires only using the following command in the container:
			</p><pre class="screen"># <span class="strong strong"><strong>mount --bind /usr/share/crypto-policies/back-ends/FIPS /etc/crypto-policies/back-ends</strong></span></pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In RHEL 8, the <code class="literal">fips-mode-setup</code> command does not work properly in a container and it cannot be used to enable or check FIPS mode in this scenario.
				</p></div></div></section><section class="section" id="excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.5. Excluding an application from following system-wide crypto policies</h2></div></div></div><p>
				You can customize cryptographic settings used by your application preferably by configuring supported cipher suites and protocols directly in the application.
			</p><p>
				You can also remove a symlink related to your application from the <code class="literal">/etc/crypto-policies/back-ends</code> directory and replace it with your customized cryptographic settings. This configuration prevents the use of system-wide cryptographic policies for applications that use the excluded back end. Furthermore, this modification is not supported by Red Hat.
			</p><section class="section" id="examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.5.1. Examples of opting out of system-wide crypto policies</h3></div></div></div><div class="formalpara"><p class="title"><strong>wget</strong></p><p>
						To customize cryptographic settings used by the <code class="literal">wget</code> network downloader, use <code class="literal">--secure-protocol</code> and <code class="literal">--ciphers</code> options. For example:
					</p></div><pre class="screen"># <span class="strong strong"><strong>wget --secure-protocol=<span class="emphasis"><em>TLSv1_1</em></span> --ciphers="<span class="emphasis"><em>SECURE128</em></span>" <span class="emphasis"><em>https://example.com</em></span></strong></span></pre><p>
					See the HTTPS (SSL/TLS) Options section of the <code class="literal">wget(1)</code> man page for more information.
				</p><div class="formalpara"><p class="title"><strong>curl</strong></p><p>
						To specify ciphers used by the <code class="literal">curl</code> tool, use the <code class="literal">--ciphers</code> option and provide a colon-separated list of ciphers as a value. For example:
					</p></div><pre class="screen"># <span class="strong strong"><strong>curl <span class="emphasis"><em>https://example.com</em></span> --ciphers <span class="emphasis"><em>DES-CBC3-SHA:RSA-DES-CBC3-SHA</em></span></strong></span></pre><p>
					See the <code class="literal">curl(1)</code> man page for more information.
				</p><div class="formalpara"><p class="title"><strong>Firefox</strong></p><p>
						Even though you cannot opt out of system-wide cryptographic policies in the <code class="literal">Firefox</code> web browser, you can further restrict supported ciphers and TLS versions in Firefox’s Configuration Editor. Type <code class="literal">about:config</code> in the address bar and change the value of the <code class="literal">security.tls.version.min</code> option as required. Setting <code class="literal">security.tls.version.min</code> to <code class="literal">1</code> allows TLS 1.0 as the minimum required, <code class="literal">security.tls.version.min 2</code> enables TLS 1.1, and so on.
					</p></div><div class="formalpara"><p class="title"><strong>OpenSSH</strong></p><p>
						To opt out of the system-wide crypto policies for your <code class="literal">OpenSSH</code> server, uncomment the line with the <code class="literal">CRYPTO_POLICY=</code> variable in the <code class="literal">/etc/sysconfig/sshd</code> file. After this change, values that you specify in the <code class="literal">Ciphers</code>, <code class="literal">MACs</code>, <code class="literal">KexAlgoritms</code>, and <code class="literal">GSSAPIKexAlgorithms</code> sections in the <code class="literal">/etc/ssh/sshd_config</code> file are not overridden. See the <code class="literal">sshd_config(5)</code> man page for more information.
					</p></div><div class="formalpara"><p class="title"><strong>Libreswan</strong></p><p>
						To allow the <code class="literal">Libreswan</code> IPsec suite to use the IKEv1 protocol, comment out the following line in the <code class="literal">/etc/ipsec.conf</code> file:
					</p></div><pre class="screen">include /etc/crypto-policies/back-ends/libreswan.config</pre><p>
					Then add the <code class="literal">ikev2=never</code> option to your connection configuration. See the <code class="literal">ipsec.conf(5)</code> man page for more information.
				</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For more details, see the <code class="literal">update-crypto-policies(8)</code> man page.
						</li></ul></div></section></section><section class="section" id="customizing-system-wide-cryptographic-policies-with-policy-modifiers_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.6. Customizing system-wide cryptographic policies with policy modifiers</h2></div></div></div><p>
				Use this procedure to adjust certain algorithms or protocols of any system-wide cryptographic policy level or a full custom policy.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Customization of system-wide cryptographic policies is available from RHEL 8.2.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create policy modules that contain your adjustments, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /etc/crypto-policies/policies/modules/<span class="emphasis"><em>MYCRYPTO1</em></span>.pmod</strong></span>
sha1_in_certs = 0
min_rsa_size = 3072
# <span class="strong strong"><strong>cat /etc/crypto-policies/policies/modules/<span class="emphasis"><em>NO-CAMELLIA</em></span>.pmod</strong></span>
cipher = -CAMELLIA-256-GCM -CAMELLIA-256-CBC -CAMELLIA-128-GCM -CAMELLIA-128-CBC</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Use upper-case letters in file names of policy modules.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Apply your policy adjustments to the <code class="literal">DEFAULT</code> system-wide cryptographic policy level:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set DEFAULT:<span class="emphasis"><em>MYCRYPTO1</em></span>:<span class="emphasis"><em>NO-CAMELLIA</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To make your cryptographic settings effective for already running services and applications, restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more details, see the <code class="literal">Custom Policies</code> section in the <code class="literal">update-crypto-policies(8)</code> man page and the <code class="literal">Crypto Policy Definition Format</code> section in the <code class="literal">update-crypto-policies(8)</code> man page.
					</li></ul></div></section><section class="section" id="creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.7. Creating and setting a custom system-wide cryptographic policy</h2></div></div></div><p>
				The following steps demonstrate customizing the system-wide cryptographic policies by a complete policy file.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Customization of system-wide cryptographic policies is available from RHEL 8.2.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a policy file for your customizations:
					</p><pre class="screen"># <span class="strong strong"><strong>cd /etc/crypto-policies/policies/</strong></span>
# <span class="strong strong"><strong>touch <span class="emphasis"><em>MYPOLICY</em></span>.pol</strong></span></pre><p class="simpara">
						Alternatively, start by copying one of the four predefined policy levels:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /usr/share/crypto-policies/<span class="emphasis"><em>DEFAULT</em></span>.pol /etc/crypto-policies/policies/<span class="emphasis"><em>MYPOLICY</em></span>.pol</strong></span></pre></li><li class="listitem"><p class="simpara">
						Edit the file with your custom cryptographic policy in a text editor of your choice to fit your requirements, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/crypto-policies/policies/<span class="emphasis"><em>MYPOLICY</em></span>.pol</strong></span></pre></li><li class="listitem"><p class="simpara">
						Switch the system-wide cryptographic policy to your custom level:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set <span class="emphasis"><em>MYPOLICY</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To make your cryptographic settings effective for already running services and applications, restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more details, see the <code class="literal">Custom Policies</code> section in the <code class="literal">update-crypto-policies(8)</code> man page and the <code class="literal">Crypto Policy Definition Format</code> section in the <code class="literal">update-crypto-policies(8)</code> man page.
					</li></ul></div></section><section class="section" id="related-information-using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h2 class="title">3.8. Related information</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <a class="link" href="https://access.redhat.com/articles/3666211">System-wide crypto policies in RHEL 8</a> and <a class="link" href="https://access.redhat.com/articles/3642912">Strong crypto defaults in RHEL 8 and deprecation of weak crypto algorithms</a> Knowledgebase articles on the Red Hat Customer Portal for more information.
					</li></ul></div></section></section><section class="chapter" id="configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Configuring applications to use cryptographic hardware through PKCS #11</h1></div></div></div><p>
			Separating parts of your secret information on dedicated cryptographic devices, such as smart cards and cryptographic tokens for end-user authentication and hardware security modules (HSM) for server applications, provides an additional layer of security. In Red Hat Enterprise Linux 8, support for cryptographic hardware through the PKCS #11 API is consistent across different applications, and the isolation of secrets on cryptographic hardware is not a complicated task.
		</p><section class="section" id="cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h2 class="title">4.1. Cryptographic hardware support through PKCS #11</h2></div></div></div><p>
				PKCS #11 (Public-Key Cryptography Standard) defines an application programming interface (API) to cryptographic devices that hold cryptographic information and perform cryptographic functions. These devices are called tokens, and they can be implemented in a hardware or software form.
			</p><p>
				A PKCS #11 token can store various object types including a certificate; a data object; and a public, private, or secret key. These objects are uniquely identifiable through the PKCS #11 URI scheme.
			</p><p>
				A PKCS #11 URI is a standard way to identify a specific object in a PKCS #11 module according to the object attributes. This enables you to configure all libraries and applications with the same configuration string in the form of a URI.
			</p><p>
				Red Hat Enterprise Linux 8 provides the OpenSC PKCS #11 driver for smart cards by default. However, hardware tokens and HSMs can have their own PKCS #11 modules that do not have their counterpart in Red Hat Enterprise Linux. You can register such PKCS #11 modules with the <code class="literal">p11-kit</code> tool, which acts as a wrapper over the registered smart card drivers in the system.
			</p><p>
				To make your own PKCS #11 module work on the system, add a new text file to the <code class="literal filename">/etc/pkcs11/modules/</code> directory
			</p><p>
				You can add your own PKCS #11 module into the system by creating a new text file in the <code class="literal filename">/etc/pkcs11/modules/</code> directory. For example, the OpenSC configuration file in <code class="literal">p11-kit</code> looks as follows:
			</p><pre class="screen">$ <span class="strong strong"><strong>cat /usr/share/p11-kit/modules/opensc.module</strong></span>
module: opensc-pkcs11.so</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/consistent-pkcs-11-support-red-hat-enterprise-linux-8">Consistent PKCS #11 support in Red Hat Enterprise Linux 8</a>
					</li><li class="listitem">
						<a class="link" href="https://tools.ietf.org/html/rfc7512">The PKCS #11 URI Scheme</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/blogs/766093/posts/1976313">Controlling access to smart cards</a>
					</li></ul></div></section><section class="section" id="using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h2 class="title">4.2. Using SSH keys stored on a smart card</h2></div></div></div><p>
				Red Hat Enterprise Linux 8 enables you to use RSA and ECDSA keys stored on a smart card on OpenSSH clients. Use this procedure to enable authentication using a smart card instead of using a password.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						On the client side, the <code class="literal package">opensc</code> package is installed and the <code class="literal">pcscd</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all keys provided by the OpenSC PKCS #11 module including their PKCS #11 URIs and save the output to the <span class="emphasis"><em>keys.pub</em></span> file:
					</p><pre class="screen white-space-pre white-space-pre">$ <span class="strong strong"><strong>ssh-keygen -D pkcs11: &gt; <span class="emphasis"><em>keys.pub</em></span></strong></span>
$ <span class="strong strong"><strong>ssh-keygen -D pkcs11:</strong></span>
ssh-rsa AAAAB3NzaC1yc2E...KKZMzcQZzx pkcs11:id=%02;object=SIGN%20pubkey;token=SSH%20key;manufacturer=piv_II?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so
ecdsa-sha2-nistp256 AAA...J0hkYnnsM= pkcs11:id=%01;object=PIV%20AUTH%20pubkey;token=SSH%20key;manufacturer=piv_II?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so</pre></li><li class="listitem"><p class="simpara">
						To enable authentication using a smart card on a remote server (<span class="emphasis"><em>example.com</em></span>), transfer the public key to the remote server. Use the <code class="literal command">ssh-copy-id</code> command with <span class="emphasis"><em>keys.pub</em></span> created in the previous step:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh-copy-id -f -i <span class="emphasis"><em>keys.pub</em></span> <span class="emphasis"><em>username@example.com</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To connect to <span class="emphasis"><em>example.com</em></span> using the ECDSA key from the output of the <code class="literal command">ssh-keygen -D</code> command in step 1, you can use just a subset of the URI, which uniquely references your key, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i "pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so" <span class="emphasis"><em>example.com</em></span></strong></span>
Enter PIN for 'SSH key':
[example.com] $</pre></li><li class="listitem"><p class="simpara">
						You can use the same URI string in the <code class="literal filename">~/.ssh/config</code> file to make the configuration permanent:
					</p><pre class="screen">$ <span class="strong strong"><strong>cat ~/.ssh/config</strong></span>
IdentityFile "pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so"
$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>example.com</em></span></strong></span>
Enter PIN for 'SSH key':
[example.com] $</pre><p class="simpara">
						Because OpenSSH uses the <code class="literal">p11-kit-proxy</code> wrapper and the OpenSC PKCS #11 module is registered to PKCS#11 Kit, you can simplify the previous commands:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i "pkcs11:id=%01" <span class="emphasis"><em>example.com</em></span></strong></span>
Enter PIN for 'SSH key':
[example.com] $</pre></li></ol></div><p>
				If you skip the <code class="literal">id=</code> part of a PKCS #11 URI, OpenSSH loads all keys that are available in the proxy module. This can reduce the amount of typing required:
			</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i pkcs11: <span class="emphasis"><em>example.com</em></span></strong></span>
Enter PIN for 'SSH key':
[example.com] $</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://fedoramagazine.org/fedora-28-better-smart-card-support-openssh/">Fedora 28: Better smart card support in OpenSSH</a>
					</li><li class="listitem">
						<code class="literal">p11-kit(8)</code> man page
					</li><li class="listitem">
						<code class="literal">ssh(1)</code> man page
					</li><li class="listitem">
						<code class="literal">ssh-keygen(1)</code> man page
					</li><li class="listitem">
						<code class="literal">opensc.conf(5)</code> man page
					</li><li class="listitem">
						<code class="literal">pcscd(8)</code> man page
					</li></ul></div></section><section class="section" id="using-hsms-protecting-private-keys-in-apache-and-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h2 class="title">4.3. Using HSMs protecting private keys in Apache and Nginx</h2></div></div></div><p>
				The <code class="literal">Apache</code> and <code class="literal">Nginx</code> HTTP servers can work with private keys stored on hardware security modules (HSMs), which helps to prevent the keys' disclosure and man-in-the-middle attacks. Note that this usually requires high-performance HSMs for busy servers.
			</p><div class="formalpara"><p class="title"><strong><code class="literal">Apache</code> HTTP server</strong></p><p>
					For secure communication in the form of the HTTPS protocol, the <code class="literal">Apache</code> HTTP server (<code class="literal">httpd</code>) uses the OpenSSL library. OpenSSL does not support PKCS #11 natively. To utilize HSMs, you have to install the <code class="literal package">openssl-pkcs11</code> package, which provides access to PKCS #11 modules through the engine interface. You can use a PKCS #11 URI instead of a regular file name to specify a server key and a certificate in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> configuration file, for example:
				</p></div><pre class="screen">SSLCertificateFile    "pkcs11:id=%01;token=softhsm;type=cert"
SSLCertificateKeyFile "pkcs11:id=%01;token=softhsm;type=private?pin-value=111111"</pre><p>
				Install the <code class="literal package">httpd-manual</code> package to obtain complete documentation for the <code class="literal">Apache</code> HTTP Server, including TLS configuration. The directives available in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> configuration file are described in detail in <a class="link" href="file:///usr/share/httpd/manual/mod/mod_ssl.html">/usr/share/httpd/manual/mod/mod_ssl.html</a>.
			</p><div class="formalpara"><p class="title"><strong><code class="literal">Nginx</code> HTTP and proxy server</strong></p><p>
					Because <code class="literal">Nginx</code> also uses the OpenSSL for cryptographic operations, support for PKCS #11 must go through the <code class="literal">openssl-pkcs11</code> engine. <code class="literal">Nginx</code> currently supports only loading private keys from an HSM, and a certificate must be provided separately as a regular file. Modify the <code class="literal">ssl_certificate</code> and <code class="literal">ssl_certificate_key</code> options in the <code class="literal">server</code> section of the <code class="literal">/etc/nginx/nginx.conf</code> configuration file:
				</p></div><pre class="screen">ssl_certificate     /path/to/cert.pem
ssl_certificate_key "engine:pkcs11:pkcs11:token=softhsm;id=%01;type=private?pin-value=111111";</pre><p>
				Note that the <code class="literal">engine:pkcs11:</code> prefix is needed for the PKCS #11 URI in the <code class="literal">Nginx</code> configuration file. This is because the other <code class="literal">pkcs11</code> prefix refers to the engine name.
			</p></section><section class="section" id="configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h2 class="title">4.4. Configuring applications to authenticate using certificates from smart cards</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">wget</code> network downloader enables you to specify PKCS #11 URIs instead of paths to locally stored private keys, and thus simplifies creating scripts for tasks that require safely stored private keys and certificates. For example:
					</p><pre class="screen">$ wget --private-key 'pkcs11:token=softhsm;id=%01;type=private?pin-value=111111' --certificate 'pkcs11:token=softhsm;id=%01;type=cert' https://example.com/</pre><p class="simpara">
						See the <code class="literal">wget(1)</code> man page for more information.
					</p></li><li class="listitem"><p class="simpara">
						Specifying PKCS #11 URI for use by the <code class="literal">curl</code> tool is analogous:
					</p><pre class="screen">$ curl --key 'pkcs11:token=softhsm;id=%01;type=private?pin-value=111111' --cert 'pkcs11:token=softhsm;id=%01;type=cert' <a class="link" href="https://example.com/">https://example.com/</a></pre><p class="simpara">
						See the <code class="literal">curl(1)</code> man page for more information.
					</p></li><li class="listitem">
						The <code class="literal">Firefox</code> web browser automatically loads the <code class="literal">p11-kit-proxy</code> module. This means that every supported smart card in the system is automatically detected. For using TLS client authentication, no additional setup is required and keys from a smart card are automatically used when a server requests them.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Using PKCS #11 URIs in custom applications</strong></p><p>
					If your application uses the <code class="literal">GnuTLS</code> or <code class="literal">NSS</code> library, support for PKCS #11 URIs is ensured by their built-in support for PKCS #11. Also, applications relying on the <code class="literal">OpenSSL</code> library can access cryptographic hardware modules thanks to the <code class="literal">openssl-pkcs11</code> engine.
				</p></div><p>
				With applications that require working with private keys on smart cards and that do not use <code class="literal">NSS</code>, <code class="literal">GnuTLS</code>, or <code class="literal">OpenSSL</code>, use <code class="literal">p11-kit</code> to implement registering PKCS #11 modules.
			</p><p>
				See the <code class="literal">p11-kit(8)</code> man page for more information.
			</p></section><section class="section" id="related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h2 class="title">4.5. Related information</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">pkcs11.conf(5)</code> man page
					</li></ul></div></section></section><section class="chapter" id="using-shared-system-certificates_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Using shared system certificates</h1></div></div></div><p>
			The shared system certificates storage enables NSS, GnuTLS, OpenSSL, and Java to share a default source for retrieving system certificate anchors and black list information. By default, the trust store contains the Mozilla CA list, including positive and negative trust. The system allows updating the core Mozilla CA list or choosing another certificate list.
		</p><section class="section" id="the-system-wide-trust-store_using-shared-system-certificates"><div class="titlepage"><div><div><h2 class="title">5.1. The system-wide trust store</h2></div></div></div><p>
				In Red Hat Enterprise Linux, the consolidated system-wide trust store is located in the <code class="literal">/etc/pki/ca-trust/</code> and <code class="literal">/usr/share/pki/ca-trust-source/</code> directories. The trust settings in <code class="literal">/usr/share/pki/ca-trust-source/</code> are processed with lower priority than settings in <code class="literal">/etc/pki/ca-trust/</code>.
			</p><p>
				Certificate files are treated depending on the subdirectory they are installed to the following directories:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						for trust anchors
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">/usr/share/pki/ca-trust-source/anchors/</code> or
							</li><li class="listitem">
								<code class="literal">/etc/pki/ca-trust/source/anchors/</code>
							</li></ul></div></li><li class="listitem"><p class="simpara">
						for distrusted certificates
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">/usr/share/pki/ca-trust-source/blacklist/</code> or
							</li><li class="listitem">
								<code class="literal">/etc/pki/ca-trust/source/blacklist/</code>
							</li></ul></div></li><li class="listitem"><p class="simpara">
						for certificates in the extended BEGIN TRUSTED file format
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">/usr/share/pki/ca-trust-source/</code> or
							</li><li class="listitem">
								<code class="literal">/etc/pki/ca-trust/source/</code>
							</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In a hierarchical cryptographic system, a trust anchor is an authoritative entity which is assumed to be trustworthy. For example, in X.509 architecture, a root certificate is a trust anchor from which a chain of trust is derived. The trust anchor must be put in the possession of the trusting party beforehand to make path validation possible.
				</p></div></div></section><section class="section" id="adding-new-certificates_using-shared-system-certificates"><div class="titlepage"><div><div><h2 class="title">5.2. Adding new certificates</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To add a certificate in the simple PEM or DER file formats to the list of CAs trusted on the system, copy the certificate file to the <code class="literal">/usr/share/pki/ca-trust-source/anchors/</code> or <code class="literal">/etc/pki/ca-trust/source/anchors/</code> directory, for example:
					</p><pre class="screen"># cp <span class="emphasis"><em>~/certificate-trust-examples/Cert-trust-test-ca.pem</em></span> <span class="emphasis"><em>/usr/share/pki/ca-trust-source/anchors/</em></span></pre></li><li class="listitem"><p class="simpara">
						To update the system-wide trust store configuration, use the <code class="literal command">update-ca-trust</code> command:
					</p><pre class="screen"># update-ca-trust</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					While the Firefox browser is able to use an added certificate without executing <code class="literal command">update-ca-trust</code>, it is recommended to run <code class="literal command">update-ca-trust</code> after a CA change. Also note that browsers, such as Firefox, Epiphany, or Chromium, cache files, and you might need to clear the browser’s cache or restart your browser to load the current system certificates configuration.
				</p></div></div></section><section class="section" id="managing-trusted-system-certificates_using-shared-system-certificates"><div class="titlepage"><div><div><h2 class="title">5.3. Managing trusted system certificates</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To list, extract, add, remove, or change trust anchors, use the <code class="literal command">trust</code> command. To see the built-in help for this command, enter it without any arguments or with the <code class="literal option">--help</code> directive:
					</p><pre class="screen">$ <code class="literal command">trust</code>
usage: trust command &lt;args&gt;...

Common trust commands are:
  list             List trust or certificates
  extract          Extract certificates and trust
  extract-compat   Extract trust compatibility bundles
  anchor           Add, remove, change trust anchors
  dump             Dump trust objects in internal format

See 'trust &lt;command&gt; --help' for more information</pre></li><li class="listitem"><p class="simpara">
						To list all system trust anchors and certificates, use the <code class="literal command">trust list</code> command:
					</p><pre class="screen">$ <code class="literal command">trust list</code>
pkcs11:id=%d2%87%b4%e3%df%37%27%93%55%f6%56%ea%81%e5%36%cc%8c%1e%3f%bd;type=cert
    type: certificate
    label: ACCVRAIZ1
    trust: anchor
    category: authority

pkcs11:id=%a6%b3%e1%2b%2b%49%b6%d7%73%a1%aa%94%f5%01%e7%73%65%4c%ac%50;type=cert
    type: certificate
    label: ACEDICOM Root
    trust: anchor
    category: authority
...
[trimmed for clarity]</pre></li><li class="listitem"><p class="simpara">
						To store a trust anchor into the system-wide trust store, use the <code class="literal command">trust anchor</code> sub-command and specify a path to a certificate. Replace <span class="emphasis"><em>path.to/certificate.crt</em></span> by a path to your certificate and its file name:
					</p><pre class="screen"># trust anchor <span class="emphasis"><em>path.to/certificate.crt</em></span></pre></li><li class="listitem"><p class="simpara">
						To remove a certificate, use either a path to a certificate or an ID of a certificate:
					</p><pre class="screen"># trust anchor --remove <span class="emphasis"><em>path.to/certificate.crt</em></span>
# trust anchor --remove <span class="emphasis"><em>"pkcs11:id=%AA%BB%CC%DD%EE;type=cert"</em></span></pre></li></ul></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					All sub-commands of the <code class="literal command">trust</code> commands offer a detailed built-in help, for example:
				</p></div><pre class="screen">$ trust list --help
usage: trust list --filter=&lt;what&gt;

  --filter=&lt;what&gt;     filter of what to export
                        ca-anchors        certificate anchors
                        blacklist         blacklisted certificates
                        trust-policy      anchors and blacklist (default)
                        certificates      all certificates
                        pkcs11:object=xx  a PKCS#11 URI
  --purpose=&lt;usage&gt;   limit to certificates usable for the purpose
                        server-auth       for authenticating servers
                        client-auth       for authenticating clients
                        email             for email protection
                        code-signing      for authenticating signed code
                        1.2.3.4.5...      an arbitrary object id
  -v, --verbose       show verbose debug output
  -q, --quiet         suppress command output</pre></section><section class="section" id="related-information-using-shared-system-certificates"><div class="titlepage"><div><div><h2 class="title">5.4. Related information</h2></div></div></div><p>
				For more information, see the following man pages:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">update-ca-trust(8)</code>
					</li><li class="listitem">
						<code class="literal">trust(1)</code>
					</li></ul></div></section></section><section class="chapter" id="scanning-the-system-for-security-compliance-and-vulnerabilities_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Scanning the system for security compliance and vulnerabilities</h1></div></div></div><p>
			A compliance audit is a process of figuring out whether a given object follows all the rules written out in a compliance policy. The compliance policy is defined by security professionals who specify required settings, often in the form of a checklist, that are to be used in the computing environment.
		</p><p>
			The compliance policy can vary substantially across organizations and even across different systems within the same organization. Differences among these policies are based on the purpose of these systems and its importance for the organization. The custom software settings and deployment characteristics also raise a need for custom policy checklists.
		</p><section class="section" id="security-compliance-tools-in-rhel_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.1. Security compliance tools in RHEL</h2></div></div></div><p>
				Red Hat Enterprise Linux provides tools that allow for a fully automated compliance audit. These tools are based on the Security Content Automation Protocol (SCAP) standard and are designed for automated tailoring of compliance policies.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>SCAP Workbench</strong></span> - The <code class="literal">scap-workbench</code> graphical utility is designed to perform configuration and vulnerability scans on a single local or remote system. It can be also used to generate security reports based on these scans and evaluations.
					</li><li class="listitem">
						<span class="strong strong"><strong>OpenSCAP</strong></span> - The <code class="literal">oscap</code> command-line utility is designed to perform configuration and vulnerability scans on a local system, to validate security compliance content, and to generate reports and guides based on these scans and evaluations.
					</li><li class="listitem">
						<span class="strong strong"><strong>SCAP Security Guide (SSG)</strong></span> - The <code class="literal package">scap-security-guide</code> package provides the latest collection of security policies for Linux systems. The guidance consists of a catalog of practical hardening advice, linked to government requirements where applicable. The project bridges the gap between generalized policy requirements and specific implementation guidelines.
					</li><li class="listitem">
						<span class="strong strong"><strong>Script Check Engine (SCE)</strong></span> - SCE is an extension to the SCAP protocol that allows administrators to write their security content using a scripting language, such as Bash, Python, or Ruby. The SCE extension is provided in the <code class="literal package">openscap-engine-sce</code> package.
					</li></ul></div><p>
				If you require performing automated compliance audits on multiple systems remotely, you can utilize OpenSCAP solution for Red Hat Satellite.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">oscap(8)</code> - The manual page for the <code class="literal">oscap</code> command-line utility provides a complete list of available options and their usage explanation.
					</li><li class="listitem">
						<code class="literal">scap-workbench(8)</code> - The manual page for the <code class="literal">SCAP Workbench</code> application provides a basic information about the application as well as some links to potential sources of SCAP content.
					</li><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> - The manual page for the <code class="literal">scap-security-guide</code> project provides further documentation about the various available SCAP security profiles. Examples how to utilize the provided benchmarks using the OpenSCAP utility are provided as well.
					</li><li class="listitem">
						For more details about using OpenSCAP with Red Hat Satellite, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.3/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-security_compliance_management">Security Compliance Management in the Administering Red Hat Satellite Guide</a>.
					</li></ul></div></section><section class="section" id="red-hat-security-advisories-oval-feed_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.2. Red Hat Security Advisories OVAL feed</h2></div></div></div><p>
				Red Hat Enterprise Linux security auditing capabilities are based on the Security Content Automation Protocol (SCAP) standard. SCAP is a multi-purpose framework of specifications that supports automated configuration, vulnerability and patch checking, technical control compliance activities, and security measurement.
			</p><p>
				SCAP specifications create an ecosystem where the format of security content is well known and standardized while the implementation of the scanner or policy editor is not mandated. Such a status enables organizations to build their security policy (SCAP content) once, no matter how many security vendors do they employ.
			</p><p>
				The Open Vulnerability Assessment Language (OVAL) is the essential and oldest component of SCAP. Unlike other tools or custom scripts, the OVAL language describes a required state of resources in a declarative manner. The OVAL language code is never executed directly but by means of an OVAL interpreter tool called scanner. The declarative nature of OVAL ensures that the state of the assessed system is not accidentally modified.
			</p><p>
				Like all other SCAP components, OVAL is based on XML. The SCAP standard defines several document formats. Each of them includes a different kind of information and serves a different purpose.
			</p><p>
				<a class="link" href="https://access.redhat.com/security/team/">Red Hat Product Security</a> helps customers evaluate and manage risk by tracking and investigating all security issues affecting Red Hat customers. It provides timely and concise patches and security advisories on the Red Hat Customer Portal. Red Hat creates and supports OVAL patch definitions, providing machine-readable versions of our security advisories.
			</p><p>
				The <a class="link" href="https://www.redhat.com/security/data/oval/">RHSA OVAL definitions</a> are available individually and as a complete package, and are updated within an hour of a new security advisory being made available on the Red Hat Customer Portal.
			</p><p>
				Each OVAL patch definition maps one-to-one to a Red Hat Security Advisory (RHSA). Since an RHSA can contain fixes for multiple vulnerabilities, each vulnerability is listed separately by its Common Vulnerabilities and Exposures (CVE) name and has a link to its entry in our public bug database.
			</p><p>
				The RHSA OVAL definitions are designed to check for vulnerable versions of RPM packages installed on a system. It is possible to extend these definitions to include further checks - for instance, to find out if the packages are being used in a vulnerable configuration. These definitions are designed to cover software and updates shipped by Red Hat. Additional definitions are required to detect the patch status of third-party software.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/221883">Red Hat and OVAL compatibility</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/2123171">Red Hat and CVE compatibility</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/security/updates/advisory">Notifications and Advisories</a> in the <a class="link" href="https://access.redhat.com/security/overview">Product Security Overview</a>
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/security/data/metrics/">Security Data Metrics</a>
					</li></ul></div></section><section class="section" id="scanning-the-system-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.3. Scanning the system for vulnerabilities</h2></div></div></div><p>
				The <code class="literal">oscap</code> command-line utility enables users to scan local systems, validate security compliance content, and generate reports and guides based on these scans and evaluations. This utility serves as a front end to the OpenSCAP library and groups its functionalities to modules (sub-commands) based on the type of SCAP content it processes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">openscap-scanner</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install openscap-scanner</strong></span></pre></li><li class="listitem"><p class="simpara">
						Download the latest RHSA OVAL definitions for your system:
					</p><pre class="screen"># <span class="strong strong"><strong>wget https://www.redhat.com/security/data/oval/com.redhat.rhsa-RHEL8.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Scan the system for vulnerabilities and save results to the <span class="emphasis"><em>vulnerability.html</em></span> file:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap oval eval --report <span class="emphasis"><em>vulnerability.html</em></span> com.redhat.rhsa-RHEL8.xml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the results in a browser of your choice, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>firefox <span class="emphasis"><em>vulnerability.html</em></span> &amp;</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">oscap(8)</code> man page.
					</li><li class="listitem">
						The <a class="link" href="https://www.redhat.com/security/data/oval/">Red Hat OVAL definitions</a> list.
					</li></ul></div></section><section class="section" id="scanning-remote-systems-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.4. Scanning remote systems for vulnerabilities</h2></div></div></div><p>
				You can check also remote systems for vulnerabilities with the OpenSCAP scanner. This functionality is enabled by the <code class="literal">oscap-ssh</code> tool over the SSH protocol.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li><li class="listitem">
						The <code class="literal">openscap-scanner</code> package is installed on the remote systems.
					</li><li class="listitem">
						The SSH server is running on the remote systems.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">openscap-utils</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install openscap-utils</strong></span></pre></li><li class="listitem"><p class="simpara">
						Download the latest RHSA OVAL definitions for your system:
					</p><pre class="screen"># <span class="strong strong"><strong>wget https://www.redhat.com/security/data/oval/com.redhat.rhsa-RHEL8.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Scan a remote system with the <span class="emphasis"><em>machine1</em></span> host name, SSH running on port 22, and the <span class="emphasis"><em>joesec</em></span> user name for vulnerabilities and save results to the <span class="emphasis"><em>remote-vulnerability.html</em></span> file:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap-ssh <span class="emphasis"><em>joesec@machine1</em></span> 22 oval eval --report <span class="emphasis"><em>remote-vulnerability.html</em></span> com.redhat.rhsa-RHEL8.xml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">oscap-ssh(8)</code> man page.
					</li><li class="listitem">
						The <a class="link" href="https://www.redhat.com/security/data/oval/">Red Hat OVAL definitions</a> list.
					</li></ul></div></section><section class="section" id="viewing-profiles-for-security-compliance_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.5. Viewing profiles for security compliance</h2></div></div></div><p>
				RHEL 8 provides several profiles for compliance with security policies. Before you decide to use them for scanning or remediation, you can list them and check their detailed descriptions using the <code class="literal">oscap info</code> sub-command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">openscap-scanner</code> and <code class="literal">scap-security-guide</code> packages are installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all available files with security compliance profiles provided by the SCAP Security Guide project:
					</p><pre class="screen">$ <span class="strong strong"><strong>ls /usr/share/xml/scap/ssg/content/</strong></span>
ssg-firefox-cpe-dictionary.xml  ssg-rhel6-ocil.xml
ssg-firefox-cpe-oval.xml        ssg-rhel6-oval.xml
...
ssg-rhel6-ds-1.2.xml          ssg-rhel8-oval.xml
ssg-rhel8-ds.xml              ssg-rhel8-xccdf.xml
...</pre></li><li class="listitem"><p class="simpara">
						Display detailed information about a selected data stream using the <code class="literal command">oscap info</code> sub-command. XML files containing data streams are indicated by the <code class="literal">-ds</code> string in their names. In the <code class="literal">Profiles</code> section, you can find a list of available profiles and their IDs:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap info /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span>
...
Profiles:
  Title: PCI-DSS v3 Control Baseline for Red Hat Enterprise Linux 8
    Id: xccdf_org.ssgproject.content_profile_pci-dss
  Title: OSPP - Protection Profile for General Purpose Operating Systems
    Id: xccdf_org.ssgproject.content_profile_ospp
...</pre></li><li class="listitem"><p class="simpara">
						Select a profile from the data-stream file and display additional details about the selected profile. To do so, use <code class="literal command">oscap info</code> with the <code class="literal">--profile</code> option followed by the last section of the ID displayed in the output of the previous command. For example, the ID of the PCI-DSS profile is: <code class="literal">xccdf_org.ssgproject.content_profile_pci-dss</code>, and the value for the <code class="literal option">--profile</code> option is <code class="literal">pci-dss</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap info --profile pci-dss /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span>
...
Title: PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 8
Id: xccdf_org.ssgproject.content_profile_pci-dss

Description: Ensures PCI-DSS v3.2.1 security configuration settings are applied.
...</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide(8)</code> man page.
					</li></ul></div></section><section class="section" id="assessing-security-compliance-with-a-specific-baseline_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.6. Assessing security compliance with a specific baseline</h2></div></div></div><p>
				The <code class="literal">SCAP Security Guide</code> suite provides profiles for several platforms in a form of XCCDF, OVAL, and data stream documents. The <span class="emphasis"><em>profile</em></span> is a set of rules based on a security policy, such as Operating System Protection Profile (OSPP) or Payment Card Industry Data Security Standard (PCI-DSS). This enables you to audit the system in an automated way in respect of security standards.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal package">openscap-scanner</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">scap-security-guide</code> packages:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install scap-security-guide</strong></span></pre></li><li class="listitem"><p class="simpara">
						Display detailed information about a selected data stream using the <code class="literal command">oscap info</code> sub-command. In the <code class="literal">Profiles</code> section, you can find a list of available profiles and their IDs:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap info /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span>
...
Profiles:
  Title: PCI-DSS v3 Control Baseline for Red Hat Enterprise Linux 8
    Id: xccdf_org.ssgproject.content_profile_pci-dss
  Title: OSPP - Protection Profile for General Purpose Operating Systems
    Id: xccdf_org.ssgproject.content_profile_ospp
...
[trimmed for clarity]</pre><p class="simpara">
						Select a profile from the data-stream file and display more details about the selected profile by providing the last part of an ID identified in the output of the previous command to the <code class="literal option">--profile</code> option of <code class="literal">oscap info</code>. For example, the OSPP profile has Id: <code class="literal">xccdf_org.ssgproject.content_profile_ospp</code>, and the value for the <code class="literal option">--profile</code> option is <code class="literal">ospp</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap info --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre><p class="simpara">
						The PCI-DSS v3 Control Baseline profile is identified by <code class="literal">xccdf_org.ssgproject.content_profile_pci-dss</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap info --profile pci-dss /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span>
...
Description: Ensures PCI-DSS v3 related security configuration settings are applied.
[trimmed for clarity]</pre><p class="simpara">
						Alternatively, when using GUI, install the <code class="literal package">scap-security-guide-doc</code> package and open the <code class="literal filename"><a class="link" href="file:///usr/share/doc/scap-security-guide/guides/ssg-rhel8-guide-index.html">file:///usr/share/doc/scap-security-guide/guides/ssg-rhel8-guide-index.html</a></code> file in a web browser. After you select a required profile in the top right field of the <span class="emphasis"><em>Guide to the Secure Configuration of Red Hat Enterprise Linux 8</em></span> document, you can see a relevant command for the following evaluation.
					</p></li><li class="listitem"><p class="simpara">
						Evaluate the compliance of the system with the selected profile and save scan results in the <span class="emphasis"><em>report.html</em></span> HTML file, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap xccdf eval --report <span class="emphasis"><em>report.html</em></span> --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre><p class="simpara">
						With the <code class="literal package">openscap-utils</code> package installed on your system and the <code class="literal package">openscap-scanner</code> package installed on a remote system, you can also scan the remote system with the <span class="emphasis"><em>machine1</em></span> host name, SSH running on port 22, and the <span class="emphasis"><em>joesec</em></span> user name for vulnerabilities and save results to the <span class="emphasis"><em>remote-report.html</em></span> file:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap-ssh joesec@machine1 22 xccdf eval --report remote_report.html --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> man page
					</li><li class="listitem">
						The <code class="literal">SCAP Security Guide</code> documentation installed in the <code class="literal filename"><a class="link" href="file:///usr/share/doc/scap-security-guide/">file:///usr/share/doc/scap-security-guide/</a></code> directory.
					</li><li class="listitem">
						The <a class="link" href="file:///usr/share/doc/scap-security-guide/guides/ssg-rhel8-guide-index.html">Guide to the Secure Configuration of Red Hat Enterprise Linux 8</a> installed with the <code class="literal package">scap-security-guide-doc</code> package.
					</li></ul></div></section><section class="section" id="remediating-the-system-to-align-with-ospp_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.7. Remediating the system to align with OSPP</h2></div></div></div><p>
				Use this procedure to remediate the RHEL 8 system to align with the Protection Profile for General Purpose Operating Systems (OSPP).
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide</code> package is installed on your RHEL 8 system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the <code class="literal">oscap</code> command with the <code class="literal">--remediate</code> option:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile ospp --remediate /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre></li><li class="listitem">
						Restart your system.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Evaluate the system of how it complies with the OSPP profile, and save results to the <code class="literal">ospp_report.html</code> file:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap xccdf eval --report <span class="emphasis"><em>ospp_report.html</em></span> --profile ospp /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> and <code class="literal">oscap(8)</code> man pages
					</li></ul></div></section><section class="section" id="remediating-the-system-to-align-with-ospp-using-the-ssg-ansible-playbook_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.8. Remediating the system to align with OSPP using the SSG Ansible playbook</h2></div></div></div><p>
				Use this procedure for remediation of your system to align with the Protection Profile for General Purpose Operating Systems (OSPP) using the Ansible playbook file from the <code class="literal">SCAP Security Guide</code> project.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide</code> package is installed on your RHEL 8 system.
					</li><li class="listitem">
						Ansible is installed. See the <a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/">Ansible Installation Guide</a> for more information.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Remediate your system to align with OSPP using Ansible:
					</p><pre class="screen"># <span class="strong strong"><strong>ansible-playbook -i localhost, -c local /usr/share/scap-security-guide/ansible/rhel8-playbook-ospp.yml</strong></span></pre></li><li class="listitem">
						Restart the system.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Scan the remediated system for compliance with OSPP:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile ospp --report ospp_report.html /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> and <code class="literal">oscap(8)</code> man pages
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/">Ansible Documentation</a>
					</li></ul></div></section><section class="section" id="creating-a-remediation-ansible-playbook-to-align-the-system-with-ospp_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.9. Creating a remediation Ansible playbook to align the system with OSPP</h2></div></div></div><p>
				Use this procedure to create an Ansible playbook containing remediations that align your system with the Protection Profile for General Purpose Operating Systems (OSPP). Using the following steps, you do not do any modifications to your system, you only prepare a file for later application.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide</code> package is installed on your RHEL 8 system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Scan the system and save the results:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile ospp --results <span class="emphasis"><em>ospp-results.xml</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate an Ansible playbook based on the file generated in the previous step:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf generate fix --fix-type ansible --output <span class="emphasis"><em>ospp-remediations.yml</em></span> <span class="emphasis"><em>ospp-results.xml</em></span></strong></span></pre></li><li class="listitem">
						The <code class="literal">ospp-remediations.yml</code> file contains Ansible remediations for rules that failed during the scan performed in step 1. After reviewing this generated file, you can apply it with the <code class="literal">ansible-playbook ospp-remediations.yml</code> command.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In a text editor of your choice, review that the <code class="literal">ospp-remediations.yml</code> file contains rules that failed in the scan performed in step 1.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> and <code class="literal">oscap(8)</code> man pages
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/">Ansible Documentation</a>
					</li></ul></div></section><section class="section" id="scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.10. Scanning the system with a customized profile using SCAP Workbench</h2></div></div></div><p>
				<code class="literal application">SCAP Workbench</code> (<code class="literal package">scap-workbench</code>) is a graphical utility that enables users to perform configuration and vulnerability scans on a single local or a remote system, perform remediation of the system, and generate reports based on scan evaluations. Note that compared with the <code class="literal application">oscap</code> command-line utility, <code class="literal application">SCAP Workbench</code> has only limited functionality. <code class="literal application">SCAP Workbench</code> can also process only security content in the form of XCCDF and data-stream files.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">SCAP Workbench</code> is installed on your system by the <code class="literal">yum install scap-workbench</code> command.
					</li></ul></div><section class="section" id="using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench"><div class="titlepage"><div><div><h3 class="title">6.10.1. Using SCAP Workbench to scan and remediate the system</h3></div></div></div><p>
					To evaluate your system against the selected security policy, use the following procedure.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To run <code class="literal application">SCAP Workbench</code> from the <code class="literal application">GNOME Classic</code> desktop environment, press the <code class="literal">Super</code> key to enter the <code class="literal">Activities Overview</code>, type <code class="literal command">scap-workbench</code>, and then press <span class="keycap"><strong>Enter</strong></span>. Alternatively, use:
						</p><pre class="screen">$ <span class="strong strong"><strong>scap-workbench</strong></span> &amp;</pre></li><li class="listitem"><p class="simpara">
							Select a security policy by using either the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal option">Load Content</code> button on the starting window
								</li><li class="listitem">
									<code class="literal option">Open content from SCAP Security Guide</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal option">Open Other Content</code> in the <code class="literal">File</code> menu, and search the respective XCCDF, SCAP RPM, or data stream file.
								</p><div class="informalfigure"><div class="mediaobject"><img src="scap-workbench-start.png" alt="scap workbench start"/></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							You can allow automatic correction of the system configuration by selecting the <span class="guibutton">Remediate</span> check box. With this option enabled, <code class="literal application">SCAP Workbench</code> attempts to change the system configuration in accordance with the security rules applied by the policy. This process should fix the related checks that fail during the system scan.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								If not used carefully, running the system evaluation with the <code class="literal option">Remediate</code> option enabled could render the system non-functional.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Scan your system with the selected profile by clicking the <span class="guibutton">Scan</span> button.
						</p><div class="informalfigure"><div class="mediaobject"><img src="scap-workbench-results.png" alt="scap workbench results"/></div></div></li><li class="listitem">
							To store the scan results in form of an XCCDF, ARF, or HTML file, click the <span class="guibutton">Save Results</span> combo box. Choose the <code class="literal option">HTML Report</code> option to generate the scan report in human-readable format. The XCCDF and ARF (data stream) formats are suitable for further automatic processing. You can repeatedly choose all three options.
						</li><li class="listitem">
							To export results-based remediations to a file, use the <span class="guibutton">Generate remediation role</span> pop-up menu.
						</li></ol></div></section><section class="section" id="customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench"><div class="titlepage"><div><div><h3 class="title">6.10.2. Customizing a security profile with SCAP Workbench</h3></div></div></div><p>
					The following procedure demonstrates how to use <code class="literal application">SCAP Workbench</code> to customize a profile. You can also save the customized profile for use with the <code class="literal application">oscap</code> command-line utility.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Run <code class="literal application">SCAP Workbench</code>, and select the profile to customize by using either <code class="literal option">Open content from SCAP Security Guide</code> or <code class="literal option">Open Other Content</code> in the <code class="literal">File</code> menu.
						</li><li class="listitem"><p class="simpara">
							To further adjust the selected security profile to make it stricter or looser according to your organization needs, click the <span class="guibutton">Customize</span> button.
						</p><p class="simpara">
							This opens the new Customization window that enables you to modify the currently selected XCCDF profile without changing the respective XCCDF file. Choose the new profile ID.
						</p><div class="informalfigure"><div class="mediaobject"><img src="scap-new-profile-id.png" alt="Choosing the ID of your new profile"/></div></div></li><li class="listitem">
							Use either the tree structure with rules organized into logical groups or the Search field to find a rule to modify.
						</li><li class="listitem"><p class="simpara">
							Include or exclude rules using check boxes in the tree structure, or modify values in rules where applicable.
						</p><div class="informalfigure"><div class="mediaobject"><img src="scap-workbench-customizing-profile.png" alt="Customizing a rule in the OSPP profile"/></div></div></li><li class="listitem">
							Confirm the changes by clicking the <span class="guibutton">OK</span> button.
						</li><li class="listitem"><p class="simpara">
							To store your changes permanently, use one of the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Save a customization file separately by using <code class="literal option">Save Customization Only</code> in the <code class="literal">File</code> menu.
								</li><li class="listitem"><p class="simpara">
									Save all security content at once by <code class="literal option">Save All</code> in the <code class="literal">File</code> menu.
								</p><p class="simpara">
									By selecting the <code class="literal option">Into a directory</code> option, <code class="literal application">SCAP Workbench</code> saves both the XCCDF or data-stream file and the customization file to the specified location. This can be useful as a backup solution.
								</p><p class="simpara">
									By selecting the <code class="literal option">As RPM</code> option, you can instruct <code class="literal application">SCAP Workbench</code> to create an RPM package containing the XCCDF or data stream file and customization file. This is useful for distributing the security content to systems that cannot be scanned remotely, or just for delivering the content for further processing.
								</p></li></ul></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Because <code class="literal application">SCAP Workbench</code> does not support results-based remediations for tailored profiles, use the exported remediations with the <code class="literal application">oscap</code> command-line utility.
					</p></div></div></section><section class="section" id="related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench"><div class="titlepage"><div><div><h3 class="title">6.10.3. Related information</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">scap-workbench(8)</code> man page
						</li><li class="listitem">
							<a class="link" href="file:///usr/share/doc/scap-workbench/user_manual.html">SCAP Workbench User Manual</a>
						</li></ul></div></section></section><section class="section" id="deploying-systems-that-are-compliant-with-a-security-profile-right-after-an-installation_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.11. Deploying systems that are compliant with a security profile right after an installation</h2></div></div></div><p>
				Administrators can use the OpenSCAP suite to deploy RHEL systems that are compliant with a security profile, such as OSPP or PCI-DSS, right after the installation process. Administrators that use this deployment method can apply specific rules, for example, a rule for password strength, that cannot be applied later using remediation scripts.
			</p><section class="section" id="deploying-ospp-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-right-after-an-installation"><div class="titlepage"><div><div><h3 class="title">6.11.1. Deploying OSPP-compliant RHEL systems using the graphical installation</h3></div></div></div><p>
					Use this procedure to deploy a RHEL system that is aligned with Protection Profile for General Purpose Operating System (OSPP).
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have booted into the graphical installation program.
						</li><li class="listitem">
							You have accessed the <code class="literal">Installation Summary</code> window.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the <code class="literal">Installation Summary</code> window, click <code class="literal">Software Selection</code>. The <code class="literal">Software Selection</code> window opens.
						</li><li class="listitem"><p class="simpara">
							From the <code class="literal">Base Environment</code> pane, select the <code class="literal">Server</code> environment. You can select only one base environment.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								<code class="literal">Server with GUI</code> is the default base environment. GNOME packages installed by the <code class="literal">Server with GUI</code> option require the <code class="literal">nfs-utils</code> package and this package is not OSPP-compliant. If you do not change the default base environment to <code class="literal">Server</code>, the installation process stops after you select OSPP.
							</p></div></div></li><li class="listitem">
							Click <code class="literal">Done</code> to apply the setting and return to the <code class="literal">Installation Summary</code> window.
						</li><li class="listitem">
							Click <code class="literal">Security Policy</code>. The <code class="literal">Security Policy</code> window opens.
						</li><li class="listitem">
							To enable security policies on the system, toggle the <code class="literal">Apply security policy</code> switch to <code class="literal">ON</code>.
						</li><li class="listitem">
							Select <code class="literal">Protection Profile for General Purpose Operating Systems</code> from the profile pane.
						</li><li class="listitem">
							Click <code class="literal">Select Profile</code> to confirm the selection.
						</li><li class="listitem">
							Confirm the changes in the <code class="literal">Changes that were done or need to be done</code> pane that is displayed at the bottom of the window. Complete any remaining manual changes.
						</li><li class="listitem">
							Because OSPP has strict partitioning requirements that must be met, create separate partitions for <code class="literal">/boot</code>, <code class="literal">/home</code>, <code class="literal">/var</code>, <code class="literal">/var/log</code>, <code class="literal">/var/tmp</code>, and <code class="literal">/var/log/audit</code>.
						</li><li class="listitem"><p class="simpara">
							Complete the graphical installation process.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The graphical installation program automatically creates a corresponding Kickstart file after a successful installation. You can use the <code class="literal">/root/anaconda-ks.cfg</code> file to automatically install OSPP-compliant systems.
							</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							The report of the hardening process is in the <code class="literal">/root/openscap_data/eval_remediate_report.html</code> file. Because <code class="literal">oscap</code> creates the report in a <code class="literal">chroot</code> environment, it can contain also false positives, for example, all service-related rules are shown as errors.
						</li><li class="listitem"><p class="simpara">
							To check the current status of the system properly, scan it after it restarts once the installation is complete:
						</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For more details on partitioning, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/graphical-installation_graphical-installation#manual-partitioning_graphical-installation">Configuring manual partitioning</a>.
						</li></ul></div></section><section class="section" id="deploying-ospp-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-right-after-an-installation"><div class="titlepage"><div><div><h3 class="title">6.11.2. Deploying OSPP-compliant RHEL systems using Kickstart</h3></div></div></div><p>
					Use this procedure to deploy RHEL systems that are aligned with Protection Profile for General Purpose Operating System (OSPP).
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">scap-security-guide</code> package is installed on your RHEL 8 system.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open the <code class="literal">/usr/share/scap-security-guide/kickstarts/ssg-rhel8-ospp-ks.cfg</code> Kickstart file in an editor of your choice.
						</li><li class="listitem"><p class="simpara">
							Update the partitioning scheme to fit your configuration requirements. For OSPP compliance, the separate partitions for <code class="literal">/boot</code>, <code class="literal">/home</code>, <code class="literal">/var</code>, <code class="literal">/var/log</code>, <code class="literal">/var/tmp</code>, and <code class="literal">/var/log/audit</code> must be preserved, and you can only change the size of the partitions.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								Because the <code class="literal">OSCAP Anaconda Addon</code> plugin does not support text-only installation, do not use the <code class="literal">text</code> option in your Kickstart file. For more information, see <a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1674001">RHBZ#1674001</a>.
							</p></div></div></li><li class="listitem">
							Start a Kickstart installation as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_an_advanced_rhel_installation/starting-kickstart-installations_installing-rhel-as-an-experienced-user">Performing an automated installation using Kickstart</a>.
						</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Passwords in the hash form cannot be checked for OSPP requirements.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							The report of the hardening process is in the <code class="literal">/root/openscap_data/eval_remediate_report.html</code> file. Because <code class="literal">oscap</code> creates the report in a <code class="literal">chroot</code> environment, it can contain also false positives, for example, all service-related rules are shown as errors.
						</li><li class="listitem"><p class="simpara">
							To check the current status of the system properly, scan it after it restarts once the installation is complete:
						</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							For more details, see the <a class="link" href="https://www.open-scap.org/tools/oscap-anaconda-addon/">OSCAP Anaconda Addon</a> project page.
						</li></ul></div></section></section><section class="section" id="scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.12. Scanning container and container images for vulnerabilities</h2></div></div></div><p>
				Use this procedure to find security vulnerabilities in a container or a container image.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">oscap-podman</code> command is available from RHEL 8.2. For RHEL 8.1 and 8.0, use the workaround described in the <a class="link" href="https://access.redhat.com/articles/4392051">Using OpenSCAP for scanning containers in RHEL 8</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">openscap-utils</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Download the latest RHSA OVAL definitions for your system:
					</p><pre class="screen"># <span class="strong strong"><strong>wget https://www.redhat.com/security/data/oval/com.redhat.rhsa-RHEL8.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Get the ID of a container or a container image, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>podman images</strong></span>
REPOSITORY                            TAG      IMAGE ID       CREATED       SIZE
registry.access.redhat.com/ubi8/ubi   latest   096cae65a207   7 weeks ago   239 MB</pre></li><li class="listitem"><p class="simpara">
						Scan the container or the container image for vulnerabilities and save results to the <span class="emphasis"><em>vulnerability.html</em></span> file:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap-podman <span class="emphasis"><em>096cae65a207</em></span> oval eval --report <span class="emphasis"><em>vulnerability.html</em></span> com.redhat.rhsa-RHEL8.xml</strong></span></pre><p class="simpara">
						Note that the <code class="literal">oscap-podman</code> command requires root privileges, and the ID of a container is the first argument.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the results in a browser of your choice, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>firefox <span class="emphasis"><em>vulnerability.html</em></span> &amp;</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information, see the <code class="literal">oscap-podman(8)</code> and <code class="literal">oscap(8)</code> man pages.
					</li></ul></div></section><section class="section" id="assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.13. Assessing security compliance of a container or a container image with a specific baseline</h2></div></div></div><p>
				Follow these steps to assess compliance of your container or a container image with a specific security baseline, such as Operating System Protection Profile (OSPP) or Payment Card Industry Data Security Standard (PCI-DSS).
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">oscap-podman</code> command is available from RHEL 8.2. For RHEL 8.1 and 8.0, use the workaround described in the <a class="link" href="https://access.redhat.com/articles/4392051">Using OpenSCAP for scanning containers in RHEL 8</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">openscap-utils</code> and <code class="literal">scap-security-guide</code> packages are installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Get the ID of a container or a container image, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>podman images</strong></span>
REPOSITORY                            TAG      IMAGE ID       CREATED       SIZE
registry.access.redhat.com/ubi8/ubi   latest   096cae65a207   7 weeks ago   239 MB</pre></li><li class="listitem"><p class="simpara">
						Evaluate the compliance of the container image with the OSPP profile and save scan results into the <span class="emphasis"><em>report.html</em></span> HTML file
					</p><pre class="screen"># <span class="strong strong"><strong>oscap-podman <span class="emphasis"><em>096cae65a207</em></span> xccdf eval --report <span class="emphasis"><em>report.html</em></span> --profile <span class="emphasis"><em>ospp</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml</strong></span></pre><p class="simpara">
						Replace <span class="emphasis"><em>096cae65a207</em></span> with the ID of your container image and the <span class="emphasis"><em>ospp</em></span> value with <span class="emphasis"><em>pci-dss</em></span> if you assess security compliance with the PCI-DSS baseline. Note that the <code class="literal">oscap-podman</code> command requires root privileges.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the results in a browser of your choice, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>firefox <span class="emphasis"><em>report.html</em></span> &amp;</strong></span></pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The rules marked as <span class="emphasis"><em>notapplicable</em></span> are rules that do not apply to containerized systems. These rules apply only to bare-metal and virtualized systems.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information, see the <code class="literal">oscap-podman(8)</code> and <code class="literal">scap-security-guide(8)</code> man pages.
					</li><li class="listitem">
						The <code class="literal">SCAP Security Guide</code> documentation installed in the <code class="literal filename"><a class="link" href="file:///usr/share/doc/scap-security-guide/">file:///usr/share/doc/scap-security-guide/</a></code> directory.
					</li></ul></div></section><section class="section" id="related-information-scanning-the-system-for-security-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h2 class="title">6.14. Related information</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="http://www.open-scap.org">The OpenSCAP project page</a> - The home page of the OpenSCAP project provides detailed information about the oscap utility and other components and projects related to SCAP.
					</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/tools/scap-workbench/">The SCAP Workbench project page</a> - The home page of the SCAP Workbench project provides detailed information about the <code class="literal">scap-workbench</code> application.
					</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/security-policies/scap-security-guide/">The SCAP Security Guide (SSG) project page</a> - The home page of the SSG project that provides the latest security content for Red Hat Enterprise Linux.
					</li><li class="listitem">
						<a class="link" href="http://scap.nist.gov/">National Institute of Standards and Technology (NIST) SCAP page</a> - This page represents a vast collection of SCAP-related materials, including SCAP publications, specifications, and the SCAP Validation Program.
					</li><li class="listitem">
						<a class="link" href="http://nvd.nist.gov/">National Vulnerability Database (NVD)</a> - This page represents the largest repository of SCAP content and other SCAP standards-based vulnerability management data.
					</li><li class="listitem">
						<a class="link" href="http://www.redhat.com/security/data/oval/">Red Hat OVAL content repository</a> - This is a repository containing OVAL definitions for vulnerabilities of Red Hat Enterprise Linux systems. This is the recommended source of vulnerability content.
					</li><li class="listitem">
						<a class="link" href="http://cve.mitre.org/">MITRE CVE</a> - This is a database of publicly known security vulnerabilities provided by the MITRE corporation. For RHEL, using OVAL CVE content provided by Red Hat is recommended.
					</li><li class="listitem">
						<a class="link" href="http://oval.mitre.org/">MITRE OVAL</a> - This page represents an OVAL-related project provided by the MITRE corporation. Among other OVAL-related information, these pages contain the latest version of the OVAL language and a repository of OVAL content with thousands of OVAL definitions. Note that for scanning RHEL, using OVAL CVE content provided by Red Hat is recommended.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.6/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-security_compliance_management">Managing security compliance in Red Hat Satellite</a> - The Red Hat Satellite documentation set guides how to maintain system security on multiple systems by using OpenSCAP.
					</li></ul></div></section></section><section class="chapter" id="checking-integrity-with-aide_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Checking integrity with AIDE</h1></div></div></div><p>
			Advanced Intrusion Detection Environment (<code class="literal">AIDE</code>) is a utility that creates a database of files on the system, and then uses that database to ensure file integrity and detect system intrusions.
		</p><section class="section" id="installing-aide_checking-integrity-with-aide"><div class="titlepage"><div><div><h2 class="title">7.1. Installing AIDE</h2></div></div></div><p>
				The following steps are necessary to install <code class="literal">AIDE</code> and to initiate its database.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To install the <span class="emphasis"><em>aide</em></span> package:
					</p><pre class="screen"># yum install aide</pre></li><li class="listitem"><p class="simpara">
						To generate an initial database:
					</p><pre class="screen"># aide --init</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							In the default configuration, the <code class="literal">aide --init</code> command checks just a set of directories and files defined in the <code class="literal">/etc/aide.conf</code> file. To include additional directories or files in the <code class="literal">AIDE</code> database, and to change their watched parameters, edit <code class="literal">/etc/aide.conf</code> accordingly.
						</p></div></div></li><li class="listitem"><p class="simpara">
						To start using the database, remove the <code class="literal">.new</code> substring from the initial database file name:
					</p><pre class="screen"># mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</pre></li><li class="listitem">
						To change the location of the <code class="literal">AIDE</code> database, edit the <code class="literal">/etc/aide.conf</code> file and modify the <code class="literal">DBDIR</code> value. For additional security, store the database, configuration, and the <code class="literal">/usr/sbin/aide</code> binary file in a secure location such as a read-only media.
					</li></ol></div></section><section class="section" id="performing-integrity-checks-with-aide_checking-integrity-with-aide"><div class="titlepage"><div><div><h2 class="title">7.2. Performing integrity checks with <code class="literal">AIDE</code></h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">AIDE</code> is properly installed and its database is initialized. See <a class="xref" href="index.html#installing-aide_checking-integrity-with-aide" title="7.1. Installing AIDE">Section 7.1, “Installing AIDE”</a>
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To initiate a manual check:
					</p><pre class="screen"># aide --check
Start timestamp: 2018-07-11 12:41:20 +0200 (AIDE 0.16)
AIDE found differences between database and filesystem!!
...
[trimmed for clarity]</pre></li><li class="listitem"><p class="simpara">
						At a minimum, <code class="literal">AIDE</code> should be configured to run a weekly scan. At most, <code class="literal">AIDE</code> should be run daily. For example, to schedule a daily execution of <code class="literal">AIDE</code> at <span class="emphasis"><em>04:05</em></span> a.m. using the <code class="literal">cron</code> command, add the following line to the <code class="literal">/etc/crontab</code> file:
					</p><pre class="screen"> 05 4 * * * root /usr/sbin/aide --check</pre></li></ol></div></section><section class="section" id="updating-an-aide-database_checking-integrity-with-aide"><div class="titlepage"><div><div><h2 class="title">7.3. Updating an AIDE database</h2></div></div></div><p>
				After verifying the changes of your system such as, package updates or configuration files adjustments, updating your baseline <code class="literal">AIDE</code> database is recommended.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">AIDE</code> is properly installed and its database is initialized. See <a class="xref" href="index.html#installing-aide_checking-integrity-with-aide" title="7.1. Installing AIDE">Section 7.1, “Installing AIDE”</a>
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Update your baseline <span class="strong strong"><strong>AIDE</strong></span> database:
					</p><pre class="screen"># aide --update</pre><p class="simpara">
						The <span class="strong strong"><strong>aide --update</strong></span> command creates the <code class="literal">/var/lib/aide/aide.db.new.gz</code> database file.
					</p></li><li class="listitem">
						To start using the updated database for integrity checks, remove the <code class="literal">.new</code> substring from the file name.
					</li></ol></div></section><section class="section" id="related-information-checking-integrity-with-aide"><div class="titlepage"><div><div><h2 class="title">7.4. Related information</h2></div></div></div><p>
				For additional information on <code class="literal">AIDE</code>, see the <code class="literal">aide(1)</code> man page.
			</p></section></section><section class="chapter" id="encrypting-block-devices-using-luks_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Encrypting block devices using LUKS</h1></div></div></div><p>
			Disk encryption protects the data on a block device by encrypting it. To access the device’s decrypted contents, a user must provide a passphrase or key as authentication. This is particularly important when it comes to mobile computers and removable media; it helps to protect the device’s contents even if it has been physically removed from the system. The LUKS format is a default implementation of block device encryption in Red Hat Enterprise Linux.
		</p><p>
			Disk-encryption solutions like LUKS only protect the data when your system is off. Once the system is on and LUKS has decrypted the disk, the files on that disk are available to anyone who would normally have access to them. To protect your files when the computer is on, use disk encryption in combination with another solution, such as file-based encryption.
		</p><section class="section" id="luks-disk-encryption_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h2 class="title">8.1. LUKS disk encryption</h2></div></div></div><p>
				The Linux Unified Key Setup-on-disk-format (LUKS) enables you to encrypt block devices and it provides a set of tools that simplifies managing the encrypted devices. LUKS allows multiple user keys to decrypt a master key, which is used for the bulk encryption of the partition.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">What LUKS does</span></dt><dd><p class="simpara">

						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									LUKS encrypts entire block devices and is therefore well-suited for protecting contents of mobile devices such as removable storage media or laptop disk drives.
								</li><li class="listitem">
									The underlying contents of the encrypted block device are arbitrary, which makes it useful for encrypting swap devices. This can also be useful with certain databases that use specially formatted block devices for data storage.
								</li><li class="listitem">
									LUKS uses the existing device mapper kernel subsystem.
								</li><li class="listitem">
									LUKS provides passphrase strengthening which protects against dictionary attacks.
								</li><li class="listitem">
									LUKS devices contain multiple key slots, allowing users to add backup keys or passphrases.
								</li></ul></div></dd><dt><span class="term">What LUKS does <span class="strong strong"><strong>not</strong></span> do</span></dt><dd><p class="simpara">

						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									LUKS is not well-suited for scenarios that require many users to have distinct access keys to the same device. The LUKS1 format provides eight key slots, LUKS2 up to 32 key slots.
								</li><li class="listitem">
									LUKS is not well-suited for applications requiring file-level encryption.
								</li></ul></div></dd></dl></div><section class="section" id="luks_implementation_in_rhel"><div class="titlepage"><div><div><h3 class="title">8.1.1. LUKS implementation in RHEL</h3></div></div></div><p>
					Red Hat Enterprise Linux utilizes LUKS to perform file system encryption. By default, the option to encrypt the file system is unchecked during the installation. If you select the option to encrypt your hard drive, you are prompted for a passphrase every time you boot the computer. This passphrase “unlocks” the bulk encryption key that decrypts your partition. If you choose to modify the default partition table you can choose which partitions you want to encrypt. This is set in the partition table settings.
				</p><p>
					In Red Hat Enterprise Linux 8, the default format is LUKS2. The legacy LUKS (LUKS1) remains fully supported and it is provided as a backward compatible format. The LUKS2 format is inspired by LUKS1 and in certain situations can be converted from LUKS1. The conversion is not possible specifically in the following scenarios:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A LUKS1 device is marked as being used by a Policy-Based Decryption (PBD - Clevis) solution. The <code class="literal">cryptsetup</code> tool refuses to convert the device when some <code class="literal">luksmeta</code> metadata are detected.
						</li><li class="listitem">
							A device is active. The device must be in the inactive state before any conversion is possible.
						</li></ul></div><p>
					The LUKS2 format is designed to enable future updates of various parts without a need to modify binary structures. LUKS2 internally uses JSON text format for metadata, provides redundancy of metadata, detects metadata corruption and allows automatic repairs from a metadata copy.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Do not use LUKS2 in production systems that need to be compatible with older systems that support only LUKS1. Note that Red Hat Enterprise Linux 7 supports the LUKS2 format since version 7.6.
					</p></div></div><p>
					The default cipher used for LUKS is <code class="literal">aes-xts-plain64</code>. The default key size for LUKS is 512 bits. The default key size for LUKS with <span class="strong strong"><strong><span class="application application">Anaconda</span></strong></span> (XTS mode) is 512 bits. Ciphers that are available are:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							AES - Advanced Encryption Standard - <a class="link" href="https://doi.org/10.6028/NIST.FIPS.197">FIPS PUB 197</a>
						</li><li class="listitem">
							Twofish (a 128-bit block cipher)
						</li><li class="listitem">
							Serpent
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://gitlab.com/cryptsetup/cryptsetup/blob/master/README.md">LUKS Project Home Page</a>
						</li><li class="listitem">
							<a class="link" href="https://gitlab.com/cryptsetup/LUKS2-docs/blob/master/luks2_doc_wip.pdf">LUKS On-Disk Format Specification</a>
						</li></ul></div></section></section><section class="section" id="encrypting-data-on-a-not-yet-encrypted-device_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h2 class="title">8.2. Encrypting data on a not yet encrypted device</h2></div></div></div><p>
				The following procedure contains steps to encrypt data on a not yet encrypted device using the LUKS2 format.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					To encrypt the device using the legacy LUKS1 format, use the <code class="literal">cryptsetup-reencrypt</code> utility. For more information, see the <code class="literal">cryptsetup-reencrypt(8)</code> man page.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your data are backed up.
					</li><li class="listitem">
						File systems on the device to be encrypted are not mounted.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Procedure</div><div><p>
					You can lose your data during the encryption process; due to a hardware, kernel, or human failure. Ensure that you have a reliable backup before you start encrypting the data.
				</p></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Back up the data from the device that will be encrypted.
					</li><li class="listitem"><p class="simpara">
						Unmount all file systems on the device, for example:
					</p><pre class="screen"># umount /dev/sdb1</pre></li><li class="listitem"><p class="simpara">
						Make free space for storing a LUKS header. Choose one of the following options that suit your scenario:
					</p><div class="informalexample"><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem"><p class="simpara">
								In the case of encrypting a logical volume, you can extend the logical volume without resizing the file system, for example:
							</p><pre class="screen"># lvextend -L+32M vg00/lv00</pre></li><li class="listitem">
								Extend the partition using partition management tools, such as <code class="literal">parted</code>.
							</li><li class="listitem">
								Shrink the file system on the device. You can use the <code class="literal">resize2fs</code> utility for the ext2, ext3, or ext4 file systems. Note that the xfs file system cannot be shrunk.
							</li></ol></div></div></li><li class="listitem"><p class="simpara">
						Initialize the encryption while storing a new LUKS header in the head of the device. The following command asks you for a passphrase and starts the encryption process, for example:
					</p><pre class="screen"># cryptsetup reencrypt --encrypt --init-only --reduce-device-size 32M /dev/sdb1</pre></li><li class="listitem"><p class="simpara">
						Open the device:
					</p><pre class="screen"># cryptsetup open /dev/sdb1 sdb1_encrypted</pre></li><li class="listitem"><p class="simpara">
						Mount the device:
					</p><pre class="screen"># mount /dev/mapper/sdb1_encrypted /mnt/sdb1_encrypted</pre></li><li class="listitem"><p class="simpara">
						Start the online encryption:
					</p><pre class="screen"># cryptsetup reencrypt --resume-only /dev/sdb1</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more details, see the <code class="literal">cryptsetup(8)</code>, <code class="literal">lvextend(8)</code>, <code class="literal">resize2fs(8)</code>, and <code class="literal">parted(8)</code> man pages.
					</li></ul></div></section><section class="section" id="encrypting-data-on-a-not-yet-encrypted-device-while-storing-a-luks-header-in-a-detached-file_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h2 class="title">8.3. Encrypting data on a not yet encrypted device while storing a LUKS header in a detached file</h2></div></div></div><p>
				The following procedure describes how to encrypt a file system without creating free space for storing a LUKS header. The header is stored in a detached location, which can be also used as an additional layer of security.
			</p><p>
				The procedure uses the LUKS2 encryption format.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					To encrypt the device using the legacy LUKS1 format, use the <code class="literal">cryptsetup-reencrypt</code> utility. For more information, see the <code class="literal">cryptsetup-reencrypt(8)</code> man page.
				</p></div></div><div class="admonition warning"><div class="admonition_header">Procedure</div><div><p>
					You can lose your data during the encryption process; due to a hardware, kernel, or human failure. Ensure that you have a reliable backup before you start encrypting the data.
				</p></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Back up the data from the device that will be encrypted.
					</li><li class="listitem"><p class="simpara">
						Unmount all file systems on the device, for example:
					</p><pre class="screen"># umount /dev/sdb1</pre></li><li class="listitem"><p class="simpara">
						Initialize the encryption while providing a path to the file with a detached LUKS header in the <code class="literal">--header</code> parameter. The following command asks you for a passphrase and starts the encryption process:
					</p><pre class="screen"># cryptsetup reencrypt --encrypt --init-only --header /path/to/header /dev/sdb1</pre><p class="simpara">
						Note that the detached LUKS header has to be accessible so that the encrypted device - <code class="literal">/dev/sdb1</code> in this procedure - can be unlocked later.
					</p></li><li class="listitem"><p class="simpara">
						Open the device:
					</p><pre class="screen"># cryptsetup open /dev/sdb1 --header /path/to/header sdb1_encrypted</pre></li><li class="listitem"><p class="simpara">
						Mount the device:
					</p><pre class="screen"># mount /dev/mapper/sdb1_encrypted /mnt/sdb1_encrypted</pre></li><li class="listitem"><p class="simpara">
						Start the online encryption:
					</p><pre class="screen"># cryptsetup reencrypt --resume-only --header /path/to/header /dev/sdb1</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more details, see the <code class="literal">cryptsetup(8)</code> man page.
					</li></ul></div></section></section><section class="chapter" id="configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Configuring automated unlocking of encrypted volumes using policy-based decryption</h1></div></div></div><p>
			The Policy-Based Decryption (PBD) is a collection of technologies that enable unlocking encrypted root and secondary volumes of hard drives on physical and virtual machines. PBD uses a variety of unlocking methods, such as user passwords, a Trusted Platform Module (TPM) device, a PKCS #11 device connected to a system, for example, a smart card, or a special network server.
		</p><p>
			PBD allows combining different unlocking methods into a policy, which makes it possible to unlock the same volume in different ways. The current implementation of the PBD in Red Hat Enterprise Linux consists of the Clevis framework and plug-ins called <span class="emphasis"><em>pins</em></span>. Each pin provides a separate unlocking capability. Currently, the following pins are available:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">tang</code> - allows volumes to be unlocked using a network server
				</li><li class="listitem">
					<code class="literal">tpm2</code> - allows volumes to be unlocked using a TPM2 policy
				</li></ul></div><p>
			The Network Bound Disc Encryption (NBDE) is a subcategory of PBD that allows binding encrypted volumes to a special network server. The current implementation of the NBDE includes a Clevis pin for Tang server and the Tang server itself.
		</p><section class="section" id="network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.1. Network-bound disk encryption</h2></div></div></div><p>
				In Red Hat Enterprise Linux, NBDE is implemented through the following components and technologies:
			</p><div class="figure" id="fig-NBDE-Clevis-Tang"><p class="title"><strong>Figure 9.1. NBDE scheme when using a LUKS1-encrypted volume. The luksmeta package is not used for LUKS2 volumes.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="RHEL_Security-Guide_453350_0717_ECE_NBDE.png" alt="RHEL Security Guide 453350 0717 ECE NBDE"/></div></div></div><p>
				<span class="emphasis"><em>Tang</em></span> is a server for binding data to network presence. It makes a system containing your data available when the system is bound to a certain secure network. Tang is stateless and does not require TLS or authentication. Unlike escrow-based solutions, where the server stores all encryption keys and has knowledge of every key ever used, Tang never interacts with any client keys, so it never gains any identifying information from the client.
			</p><p>
				<span class="emphasis"><em>Clevis</em></span> is a pluggable framework for automated decryption. In NBDE, Clevis provides automated unlocking of LUKS volumes. The <span class="strong strong"><strong><span class="package package">clevis</span></strong></span> package provides the client side of the feature.
			</p><p>
				A <span class="emphasis"><em>Clevis pin</em></span> is a plug-in into the Clevis framework. One of such pins is a plug-in that implements interactions with the NBDE server — Tang.
			</p><p>
				Clevis and Tang are generic client and server components that provide network-bound encryption. In Red Hat Enterprise Linux, they are used in conjunction with LUKS to encrypt and decrypt root and non-root storage volumes to accomplish Network-Bound Disk Encryption.
			</p><p>
				Both client- and server-side components use the <span class="emphasis"><em>José</em></span> library to perform encryption and decryption operations.
			</p><p>
				When you begin provisioning NBDE, the Clevis pin for Tang server gets a list of the Tang server’s advertised asymmetric keys. Alternatively, since the keys are asymmetric, a list of Tang’s public keys can be distributed out of band so that clients can operate without access to the Tang server. This mode is called <span class="emphasis"><em>offline provisioning</em></span>.
			</p><p>
				The Clevis pin for Tang uses one of the public keys to generate a unique, cryptographically-strong encryption key. Once the data is encrypted using this key, the key is discarded. The Clevis client should store the state produced by this provisioning operation in a convenient location. This process of encrypting data is the <span class="emphasis"><em>provisioning step</em></span>.
			</p><p>
				The LUKS version 2 (LUKS2) is the default format in Red Hat Enterprise Linux 8, hence, the provisioning state for NBDE is stored as a token in a LUKS2 header. The leveraging of provisioning state for NBDE by the <span class="strong strong"><strong><span class="package package">luksmeta</span></strong></span> package is used only for volumes encrypted with LUKS1. The Clevis pin for Tang supports both LUKS1 and LUKS2 without specification need.
			</p><p>
				When the client is ready to access its data, it loads the metadata produced in the provisioning step and it responds to recover the encryption key. This process is the <span class="emphasis"><em>recovery step</em></span>.
			</p><p>
				In NBDE, Clevis binds a LUKS volume using a pin so that it can be automatically unlocked. After successful completion of the binding process, the disk can be unlocked using the provided Dracut unlocker.
			</p></section><section class="section" id="installing-an-encryption-client-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.2. Installing an encryption client - Clevis</h2></div></div></div><p>
				Use this procedure to deploy and start using the Clevis pluggable framework on your system.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To install Clevis and its pins on a system with an encrypted volume:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install clevis</strong></span></pre></li><li class="listitem"><p class="simpara">
						To decrypt data, use a <code class="literal command">clevis decrypt</code> command and provide a cipher text in the JSON Web Encryption (JWE) format, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis decrypt &lt; <span class="emphasis"><em>secret.jwe</em></span></strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						For a quick reference, see the built-in CLI help:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis</strong></span>
Usage: clevis COMMAND [OPTIONS]

clevis decrypt             Decrypts using the policy defined at encryption time
clevis encrypt sss         Encrypts using a Shamir's Secret Sharing policy
clevis encrypt tang        Encrypts using a Tang binding server policy
clevis encrypt tpm2        Encrypts using a TPM2.0 chip binding policy
clevis luks bind           Binds a LUKS device using the specified policy
clevis luks list           Lists pins bound to a LUKSv1 or LUKSv2 device
clevis luks pass           Returns the LUKS passphrase used for binding a particular slot.
clevis luks regen          Regenerate LUKS metadata
clevis luks report         Report any key rotation on the server side
clevis luks unbind         Unbinds a pin bound to a LUKS volume
clevis luks unlock         Unlocks a LUKS volume</pre></li><li class="listitem">
						For more information , see the <code class="literal">clevis(1)</code> man page.
					</li></ul></div></section><section class="section" id="deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.3. Deploying a Tang server with SELinux in enforcing mode</h2></div></div></div><p>
				Use this procedure to deploy a Tang server running on a custom port as a confined service in SELinux enforcing mode.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal package">policycoreutils-python-utils</code> package and its dependencies are installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To install the <code class="literal package">tang</code> package and its dependencies, enter the following command as <code class="literal">root</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install tang</strong></span></pre></li><li class="listitem"><p class="simpara">
						Pick an unoccupied port, for example, <span class="emphasis"><em>7500/tcp</em></span>, and allow the <code class="literal">tangd</code> service to bind to that port:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage port -a -t tangd_port_t -p tcp <span class="emphasis"><em>7500</em></span></strong></span></pre><p class="simpara">
						Note that a port can be used only by one service at a time, and thus an attempt to use an already occupied port implies the <code class="literal">ValueError: Port already defined</code> error message.
					</p></li><li class="listitem"><p class="simpara">
						Open the port in the firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port=<span class="emphasis"><em>7500</em></span>/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre></li><li class="listitem"><p class="simpara">
						Enable the <code class="literal">tangd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable tangd.socket</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an override file:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl edit tangd.socket</strong></span></pre></li><li class="listitem"><p class="simpara">
						In the following editor screen, which opens an empty <code class="literal">override.conf</code> file located in the <code class="literal">/etc/systemd/system/tangd.socket.d/</code> directory, change the default port for the Tang server from 80 to the previously picked number by adding the following lines:
					</p><pre class="screen">[Socket]
ListenStream=
ListenStream=<span class="emphasis"><em>7500</em></span></pre><p class="simpara">
						Save the file and exit the editor.
					</p></li><li class="listitem"><p class="simpara">
						Reload the changed configuration:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl daemon-reload</strong></span></pre></li><li class="listitem"><p class="simpara">
						Check that your configuration is working:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl show tangd.socket -p Listen</strong></span>
Listen=[::]:7500 (Stream)</pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">tangd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start tangd.socket</strong></span></pre><p class="simpara">
						Because <code class="literal">tangd</code> uses the <code class="literal">systemd</code> socket activation mechanism, the server starts as soon as the first connection comes in. A new set of cryptographic keys is automatically generated at the first start. To perform cryptographic operations such as manual key generation, use the <code class="literal command">jose</code> utility.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">tang(8)</code> man page
					</li><li class="listitem">
						<code class="literal">semanage(8)</code> man page
					</li><li class="listitem">
						<code class="literal">firewall-cmd(1)</code> man page
					</li><li class="listitem">
						<code class="literal">systemd.unit(5)</code> and <code class="literal">systemd.socket(5)</code> man pages
					</li><li class="listitem">
						<code class="literal">jose(1)</code> man page
					</li></ul></div></section><section class="section" id="rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.4. Rotating Tang server keys and updating bindings on clients</h2></div></div></div><p>
				Use the following steps to rotate your Tang server keys and update existing bindings on clients. The precise interval at which you should rotate them depends on your application, key sizes, and institutional policy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A Tang server is running.
					</li><li class="listitem">
						The <code class="literal">clevis</code> and <code class="literal">clevis-luks</code> packages are installed on your clients.
					</li><li class="listitem">
						Note that <code class="literal">clevis luks list</code>, <code class="literal">clevis luks report</code>, and <code class="literal">clevis luks regen</code> have been introduced in RHEL 8.2.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To rotate keys, generate new keys using the <code class="literal">/usr/libexec/tangd-keygen</code> command in the <code class="literal">/var/db/tang</code> key database directory on the Tang server:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>ls <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
UV6dqXSwe1bRKG3KbJmdiR020hY.jwk y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk
# <span class="strong strong"><strong>/usr/libexec/tangd-keygen <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
# <span class="strong strong"><strong>ls <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
UV6dqXSwe1bRKG3KbJmdiR020hY.jwk y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk
3ZWS6-cDrCG61UPJS2BMmPU4I54.jwk zyLuX6hijUy_PSeUEFDi7hi38.jwk</pre></li><li class="listitem"><p class="simpara">
						Check that your Tang server advertises the signing key from the new key pair, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>tang-show-keys <span class="emphasis"><em>7500</em></span></strong></span>
3ZWS6-cDrCG61UPJS2BMmPU4I54</pre></li><li class="listitem"><p class="simpara">
						Rename the old keys to have a leading <code class="literal">.</code> to hide them from advertisement. Note that the file names in the following example differs from unique file names in the key database directory of your Tang server:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>cd <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
# <span class="strong strong"><strong>ls -l</strong></span>
-rw-r--r--. 1 root tang 354 Sep 23 16:08 3ZWS6-cDrCG61UPJS2BMmPU4I54.jwk
-rw-r--r--. 1 root tang 349 Sep 23 16:08 I-zyLuX6hijUy_PSeUEFDi7hi38.jwk
-rw-r--r--. 1 root root 349 Feb  7 14:55 UV6dqXSwe1bRKG3KbJmdiR020hY.jwk
-rw-r--r--. 1 root root 354 Feb  7 14:55 y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk
# <span class="strong strong"><strong>mv UV6dqXSwe1bRKG3KbJmdiR020hY.jwk .UV6dqXSwe1bRKG3KbJmdiR020hY.jwk</strong></span>
# <span class="strong strong"><strong>mv y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk .y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk</strong></span></pre><p class="simpara">
						Tang immediately picks up all changes. No restart is required. At this point, new client bindings pick up the new keys and old clients can continue to utilize the old keys.
					</p></li><li class="listitem"><p class="simpara">
						On your NBDE clients, use the <code class="literal">clevis luks report</code> command to check if the keys advertised by the Tang server remains the same. You can identify slots with the relevant binding using the <code class="literal">clevis luks list</code> command, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks list -d <span class="emphasis"><em>/dev/sda2</em></span></strong></span>
1: tang '{"url":"<span class="emphasis"><em>http://tang.srv</em></span>"}'
# <span class="strong strong"><strong>clevis luks report -d <span class="emphasis"><em>/dev/sda2</em></span> -s <span class="emphasis"><em>1</em></span></strong></span>
...
Report detected that some keys were rotated.
Do you want to regenerate luks metadata with "clevis luks regen -d /dev/sda2 -s 1"? [ynYN]</pre></li><li class="listitem"><p class="simpara">
						To regenerate LUKS metadata for the new keys either press <code class="literal">y</code> to the prompt of the previous command, or use the <code class="literal">clevis luks regen</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks regen -d <span class="emphasis"><em>/dev/sda2</em></span> -s <span class="emphasis"><em>1</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						When you are sure that all old clients use the new keys, you can remove the old keys from the Tang server, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cd <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
# <span class="strong strong"><strong>rm .*.jwk</strong></span></pre></li></ol></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Removing the old keys while clients are still using them can result in data loss. If you accidentally remove such keys, use the <code class="literal">clevis luks regen</code> command on the clients, and provide your LUKS password manually.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">tang-show-keys(1)</code>, <code class="literal">clevis-luks-list(1)</code>, <code class="literal">clevis-luks-report(1)</code>, and <code class="literal">clevis-luks-regen(1)</code> man pages
					</li></ul></div></section><section class="section" id="deploying-a-clevis-encryption-client_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.5. Deploying an encryption client for an NBDE system with Tang</h2></div></div></div><p>
				The following procedure contains steps to configure automated unlocking of an encrypted volume with a Tang network server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Clevis framework is installed.
					</li><li class="listitem">
						A Tang server is available.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To bind a Clevis encryption client to a Tang server, use the <code class="literal command">clevis encrypt tang</code> sub-command:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tang '{"url":"<span class="emphasis"><em>http://tang.srv:port</em></span>"}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span>
The advertisement contains the following signing keys:

_OsIk0T-E2l6qjfdDiwVmidoZjA

Do you wish to trust these keys? [ynYN] y</pre><p class="simpara">
						Change the <span class="emphasis"><em>http://tang.srv:port</em></span> URL in the previous example to match the URL of the server where <code class="literal package">tang</code> is installed. The <span class="emphasis"><em>secret.jwe</em></span> output file contains your encrypted cipher text in the JSON Web Encryption format. This cipher text is read from the <span class="emphasis"><em>input-plain.txt</em></span> input file.
					</p><p class="simpara">
						Alternatively, if your configuration requires a non-interactive communication with a Tang server without SSH access, you can download an advertisement and save it to a file:
					</p><pre class="screen">$ <span class="strong strong"><strong>curl -sfg <span class="emphasis"><em>http://tang.srv:port</em></span>/adv -o <span class="emphasis"><em>adv.jws</em></span></strong></span></pre><p class="simpara">
						Use the advertisement in the <span class="emphasis"><em>adv.jws</em></span> file for any following tasks, such as encryption of files or messages:
					</p><pre class="screen">$ <span class="strong strong"><strong>echo 'hello' | clevis encrypt tang '{"url":"<span class="emphasis"><em>http://tang.srv:port</em></span>","adv":"<span class="emphasis"><em>adv.jws</em></span>"}'</strong></span></pre></li><li class="listitem"><p class="simpara">
						To decrypt data, use the <code class="literal command">clevis decrypt</code> command and provide the cipher text (JWE):
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis decrypt &lt; <span class="emphasis"><em>secret.jwe</em></span> &gt; <span class="emphasis"><em>output-plain.txt</em></span></strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						For a quick reference, see the <code class="literal">clevis-encrypt-tang(1)</code> man page or use the built-in CLI help:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis</strong></span>
$ <span class="strong strong"><strong>clevis decrypt</strong></span>
$ <span class="strong strong"><strong>clevis encrypt tang</strong></span>
Usage: clevis encrypt tang CONFIG &lt; PLAINTEXT &gt; JWE
...</pre></li><li class="listitem"><p class="simpara">
						For more information, see the following man pages:
					</p><div class="informalexample"><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">clevis(1)</code>
							</li><li class="listitem">
								<code class="literal">clevis-luks-unlockers(7)</code>
							</li></ul></div></div></li></ul></div></section><section class="section" id="removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.6. Removing a Clevis pin from a LUKS-encrypted volume manually</h2></div></div></div><p>
				Use the following procedure for manual removing the metadata created by the <code class="literal">clevis luks bind</code> command and also for wiping a key slot that contains passphrase added by Clevis.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The recommended way to remove a Clevis pin from a LUKS-encrypted volume is through the <code class="literal">clevis luks unbind</code> command. The removal procedure using <code class="literal">clevis luks unbind</code> consists of only one step and works for both LUKS1 and LUKS2 volumes. The following example command removes the metadata created by the binding step and wipe the key slot <span class="emphasis"><em>1</em></span> on the <span class="emphasis"><em>/dev/sda2</em></span> device:
				</p><pre class="screen"># <span class="strong strong"><strong>clevis luks unbind -d /dev/sda2 -s 1</strong></span></pre></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A LUKS-encrypted volume with a Clevis binding.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check which LUKS version the volume, for example <span class="emphasis"><em>/dev/sda2</em></span>, is encrypted by and identify a slot and a token that is bound to Clevis:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksDump <span class="emphasis"><em>/dev/sda2</em></span></strong></span>
LUKS header information
Version:        2
...
Keyslots:
  0: luks2
...
1: luks2
      Key:        512 bits
      Priority:   normal
      Cipher:     aes-xts-plain64
...
      Tokens:
        0: clevis
              Keyslot:  1
...</pre><p class="simpara">
						In the previous example, the Clevis token is identified by <span class="emphasis"><em>0</em></span> and the associated key slot is <span class="emphasis"><em>1</em></span>.
					</p></li><li class="listitem"><p class="simpara">
						In case of LUKS2 encryption, remove the token:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup token remove --token-id <span class="emphasis"><em>0</em></span> <span class="emphasis"><em>/dev/sda2</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						If your device is encrypted by LUKS1, which is indicated by the <code class="literal">Version: 1</code> string in the output of the <code class="literal">cryptsetup luksDump</code> command, perform this additional step with the <code class="literal">luksmeta wipe</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>luksmeta wipe -d <span class="emphasis"><em>/dev/sda2</em></span> -s <span class="emphasis"><em>1</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Wipe the key slot containing the Clevis passphrase:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksKillSlot <span class="emphasis"><em>/dev/sda2</em></span> <span class="emphasis"><em>1</em></span></strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information, see the <code class="literal">clevis-luks-unbind(1)</code>, <code class="literal">cryptsetup(8)</code>, and <code class="literal">luksmeta(8)</code> man pages.
					</li></ul></div></section><section class="section" id="deploying-an-encryption-client-with-a-tpm-2-0-policy_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.7. Deploying an encryption client with a TPM 2.0 policy</h2></div></div></div><p>
				The following procedure contains steps to configure automated unlocking of an encrypted volume with a Trusted Platform Module 2.0 (TPM 2.0) policy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Clevis framework is installed. See <a class="link" href="index.html#installing-an-encryption-client-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="9.2. Installing an encryption client - Clevis">Installing an encryption client - Clevis</a>
					</li><li class="listitem">
						A system with the 64-bit Intel or 64-bit AMD architecture
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To deploy a client that encrypts using a TPM 2.0 chip, use the <code class="literal command">clevis encrypt tpm2</code> sub-command with the only argument in form of the JSON configuration object:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tpm2 '{}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span></pre><p class="simpara">
						To choose a different hierarchy, hash, and key algorithms, specify configuration properties, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tpm2 '{"hash":"sha1","key":"rsa"}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To decrypt the data, provide the ciphertext in the JSON Web Encryption (JWE) format:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis decrypt &lt; <span class="emphasis"><em>secret.jwe</em></span> &gt; <span class="emphasis"><em>output-plain.txt</em></span></strong></span></pre></li></ol></div><p>
				The pin also supports sealing data to a Platform Configuration Registers (PCR) state. That way, the data can only be unsealed if the PCRs hashes values match the policy used when sealing.
			</p><p>
				For example, to seal the data to the PCR with index 0 and 1 for the SHA-1 bank:
			</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tpm2 '{"pcr_bank":"sha1","pcr_ids":"0,1"}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span></pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information and the list of possible configuration properties, see the <code class="literal">clevis-encrypt-tpm2(1)</code> man page.
					</li></ul></div></section><section class="section" id="configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.8. Configuring manual enrollment of LUKS-encrypted volumes</h2></div></div></div><p>
				Use the following steps to configure unlocking of LUKS-encrypted volumes with NBDE.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisite</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A Tang server is running and available.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To automatically unlock an existing LUKS-encrypted volume, install the <code class="literal package">clevis-luks</code> subpackage:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install clevis-luks</strong></span></pre></li><li class="listitem"><p class="simpara">
						Identify the LUKS-encrypted volume for PBD. In the following example, the block device is referred as <span class="emphasis"><em>/dev/sda2</em></span>:
					</p><pre class="screen"># <span class="strong strong"><strong>lsblk</strong></span>
NAME                                          MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
sda                                             8:0    0    12G  0 disk
├─sda1                                          8:1    0     1G  0 part  /boot
└─sda2                                          8:2    0    11G  0 part
  └─luks-40e20552-2ade-4954-9d56-565aa7994fb6 253:0    0    11G  0 crypt
    ├─rhel-root                               253:0    0   9.8G  0 lvm   /
    └─rhel-swap                               253:1    0   1.2G  0 lvm   [SWAP]</pre></li><li class="listitem"><p class="simpara">
						Bind the volume to a Tang server using the <code class="literal command">clevis luks bind</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sda2</em></span> tang '{"url":"<span class="emphasis"><em>http://tang.srv</em></span>"}'</strong></span>
The advertisement contains the following signing keys:

_OsIk0T-E2l6qjfdDiwVmidoZjA

Do you wish to trust these keys? [ynYN] y
You are about to initialize a LUKS device for metadata storage.
Attempting to initialize it may result in data loss if data was
already written into the LUKS header gap in a different format.
A backup is advised before initialization is performed.

Do you wish to initialize /dev/sda2? [yn] y
Enter existing LUKS password:</pre><p class="simpara">
						This command performs four steps:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Creates a new key with the same entropy as the LUKS master key.
							</li><li class="listitem">
								Encrypts the new key with Clevis.
							</li><li class="listitem">
								Stores the Clevis JWE object in the LUKS2 header token or uses LUKSMeta if the non-default LUKS1 header is used.
							</li><li class="listitem"><p class="simpara">
								Enables the new key for use with LUKS.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The binding procedure assumes that there is at least one free LUKS password slot. The <code class="literal command">clevis luks bind</code> command takes one of the slots.
								</p></div></div></li></ol></div></li><li class="listitem">
						The volume can now be unlocked with your existing password as well as with the Clevis policy.
					</li><li class="listitem"><p class="simpara">
						To enable the early boot system to process the disk binding, enter the following commands on an already installed system:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install clevis-dracut</strong></span>
# <span class="strong strong"><strong>dracut -fv --regenerate-all</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To verify that the Clevis JWE object is successfully placed in a LUKS header, use the <code class="literal">clevis luks list</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks list -d <span class="emphasis"><em>/dev/sda2</em></span></strong></span>
1: tang '{"url":"http://tang.srv:port"}'</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					To use NBDE for clients with static IP configuration (without DHCP), pass your network configuration to the dracut tool manually, for example:
				</p><pre class="screen"># <span class="strong strong"><strong>dracut -fv --regenerate-all --kernel-cmdline "ip=192.0.2.10::192.0.2.1:255.255.255.0::ens3:none:192.0.2.45"</strong></span></pre><p>
					Alternatively, create a .conf file in the <code class="literal">/etc/dracut.conf.d/</code> directory with the static network information. For example:
				</p><pre class="screen"># <span class="strong strong"><strong>cat /etc/dracut.conf.d/static_ip.conf</strong></span>
kernel_cmdline="ip=192.0.2.10::192.0.2.1:255.255.255.0::ens3:none:192.0.2.45"</pre><p>
					Regenerate the initial RAM disk image:
				</p><pre class="screen"># <span class="strong strong"><strong>dracut -fv --regenerate-all</strong></span></pre></div></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					For more information, see the following man pages:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-bind(1)</code>
					</li><li class="listitem">
						<code class="literal">dracut.cmdline(7)</code>
					</li></ul></div></section><section class="section" id="configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.9. Configuring automated enrollment of LUKS-encrypted volumes using Kickstart</h2></div></div></div><p>
				Follow the steps in this procedure to configure an automated installation process that uses Clevis for enrollment of LUKS-encrypted volumes.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Instruct Kickstart to partition the disk such that the root partition has enabled LUKS encryption with a temporary password. The password is temporary for the enrollment process.
					</p><pre class="screen">part /boot --fstype="xfs" --ondisk=vda --size=256
part / --fstype="xfs" --ondisk=vda --grow --encrypted --passphrase=temppass</pre></li><li class="listitem"><p class="simpara">
						Install the related Clevis packages by listing them in the <code class="literal">%packages</code> section:
					</p><pre class="screen">%packages
clevis-dracut
%end</pre></li><li class="listitem"><p class="simpara">
						Call <code class="literal command">clevis luks bind</code> to perform binding in the <code class="literal">%post</code> section. Afterward, remove the temporary password:
					</p><pre class="screen">%post
curl -sfg http://tang.srv/adv -o adv.jws
clevis luks bind -f -k- -d /dev/vda2 \
tang '{"url":"http://tang.srv","adv":"adv.jws"}' \ &lt;&lt;&lt; "temppass"
cryptsetup luksRemoveKey /dev/vda2 &lt;&lt;&lt; "temppass"
%end</pre><p class="simpara">
						In the previous example, note that we download the advertisement from the Tang server as part of our binding configuration, enabling binding to be completely non-interactive.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							The <code class="literal">cryptsetup luksRemoveKey</code> command prevents any further administration of a LUKS2 device on which you apply it. You can recover a removed master key using the <code class="literal">dmsetup</code> command only for LUKS1 devices.
						</p></div></div></li></ol></div><p>
				You can use an analogous procedure when using a TPM 2.0 policy instead of a Tang server.
			</p><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">clevis(1)</code>, <code class="literal">clevis-luks-bind(1)</code>, <code class="literal">cryptsetup(8)</code>, and <code class="literal">dmsetup(8)</code> man pages
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_an_advanced_rhel_installation/index">Installing Red Hat Enterprise Linux 8 using Kickstart</a>
					</li></ul></div></section><section class="section" id="configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.10. Configuring automated unlocking of a LUKS-encrypted removable storage device</h2></div></div></div><p>
				Use this procedure to set up an automated unlocking process of a LUKS-encrypted USB storage device.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To automatically unlock a LUKS-encrypted removable storage device, such as a USB drive, install the <code class="literal package">clevis-udisks2</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install clevis-udisks2</strong></span></pre></li><li class="listitem"><p class="simpara">
						Reboot the system, and then perform the binding step using the <code class="literal command">clevis luks bind</code> command as described in <a class="link" href="index.html#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="9.8. Configuring manual enrollment of LUKS-encrypted volumes">Configuring manual enrollment of LUKS-encrypted volumes</a>, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sdb1</em></span> tang '{"url":"<span class="emphasis"><em>http://tang.srv</em></span>"}'</strong></span></pre></li><li class="listitem"><p class="simpara">
						The LUKS-encrypted removable device can be now unlocked automatically in your GNOME desktop session. The device bound to a Clevis policy can be also unlocked by the <code class="literal command">clevis luks unlock</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks unlock -d <span class="emphasis"><em>/dev/sdb1</em></span></strong></span></pre></li></ol></div><p>
				You can use an analogous procedure when using a TPM 2.0 policy instead of a Tang server.
			</p><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					For more information, see the following man page:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-unlockers(7)</code>
					</li></ul></div></section><section class="section" id="deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.11. Deploying high-availability NBDE systems</h2></div></div></div><p>
				Tang provides two methods for building a high-availability deployment:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Client redundancy (recommended)</span></dt><dd>
							Clients should be configured with the ability to bind to multiple Tang servers. In this setup, each Tang server has its own keys and clients can decrypt by contacting a subset of these servers. Clevis already supports this workflow through its <code class="literal">sss</code> plug-in. Red Hat recommends this method for a high-availability deployment.
						</dd><dt><span class="term">Key sharing</span></dt><dd>
							For redundancy purposes, more than one instance of Tang can be deployed. To set up a second or any subsequent instance, install the <code class="literal">tang</code> packages and copy the key directory to the new host using <code class="literal">rsync</code> over <code class="literal">SSH</code>. Note that Red Hat does not recommend this method because sharing keys increases the risk of key compromise and requires additional automation infrastructure.
						</dd></dl></div><section class="section" id="high_available_nbde_using_shamir_s_secret_sharing"><div class="titlepage"><div><div><h3 class="title">9.11.1. High-available NBDE using Shamir’s Secret Sharing</h3></div></div></div><p>
					Shamir’s Secret Sharing (SSS) is a cryptographic scheme that divides a secret into several unique parts. To reconstruct the secret, a number of parts is required. The number is called threshold and SSS is also referred to as a thresholding scheme.
				</p><p>
					Clevis provides an implementation of SSS. It creates a key and divides it into a number of pieces. Each piece is encrypted using another pin including even SSS recursively. Additionally, you define the threshold <code class="literal">t</code>. If an NBDE deployment decrypts at least <code class="literal">t</code> pieces, then it recovers the encryption key and the decryption process succeeds.
				</p><section class="section" id="example_1_redundancy_with_two_tang_servers"><div class="titlepage"><div><div><h4 class="title">9.11.1.1. Example 1: Redundancy with two Tang servers</h4></div></div></div><p>
						The following command decrypts a LUKS-encrypted device when at least one of two Tang servers is available:
					</p><pre class="screen"># clevis luks bind -d /dev/sda1 sss '{"t":1,"pins":{"tang":[{"url":"http://tang1.srv"},{"url":"http://tang2.srv"}]}}'</pre><p>
						The previous command used the following configuration scheme:
					</p><pre class="screen">{
    "t":1,
    "pins":{
        "tang":[
            {
                "url":"http://tang1.srv"
            },
            {
                "url":"http://tang2.srv"
            }
        ]
    }
}</pre><p>
						In this configuration, the SSS threshold <code class="literal">t</code> is set to <code class="literal">1</code> and the <code class="literal">clevis luks bind</code> command successfully reconstructs the secret if at least one from two listed <code class="literal">tang</code> servers is available.
					</p></section><section class="section" id="example_2_shared_secret_on_a_tang_server_and_a_tpm_device"><div class="titlepage"><div><div><h4 class="title">9.11.1.2. Example 2: Shared secret on a Tang server and a TPM device</h4></div></div></div><p>
						The following command successfully decrypts a LUKS-encrypted device when both the <code class="literal">tang</code> server and the <code class="literal">tpm2</code> device are available:
					</p><pre class="screen"># clevis luks bind -d /dev/sda1 sss '{"t":2,"pins":{"tang":[{"url":"http://tang1.srv"}], "tpm2": {"pcr_ids":"0,1"}}}'</pre><p>
						The configuration scheme with the SSS threshold 't' set to '2' is now:
					</p><pre class="screen">{
    "t":2,
    "pins":{
        "tang":[
            {
                "url":"http://tang1.srv"
            }
        ],
        "tpm2":{
            "pcr_ids":"0,1"
        }
    }
}</pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								For more information about the recommended high-availability NBDE setup, see the following man pages:
							</p><div class="informalexample"><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">tang(8)</code>, section <code class="literal">High Availability</code>
									</li><li class="listitem">
										<code class="literal">clevis(1)</code>, section <code class="literal">Shamir’s Secret Sharing</code>
									</li><li class="listitem">
										<code class="literal">clevis-encrypt-sss(1)</code>
									</li></ul></div></div></li></ul></div></section></section></section><section class="section" id="deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.12. Deployment of virtual machines in a NBDE network</h2></div></div></div><p>
				The <code class="literal command">clevis luks bind</code> command does not change the LUKS master key. This implies that if you create a LUKS-encrypted image for use in a virtual machine or cloud environment, all the instances that run this image will share a master key. This is extremely insecure and should be avoided at all times.
			</p><p>
				This is not a limitation of Clevis but a design principle of LUKS. If you wish to have encrypted root volumes in a cloud, you need to make sure that you perform the installation process (usually using Kickstart) for each instance of Red Hat Enterprise Linux in a cloud as well. The images cannot be shared without also sharing a LUKS master key.
			</p><p>
				If you intend to deploy automated unlocking in a virtualized environment, Red Hat strongly recommends that you use systems such as lorax or virt-install together with a Kickstart file (see <a class="link" href="index.html#configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="9.9. Configuring automated enrollment of LUKS-encrypted volumes using Kickstart">Configuring automated enrollment of LUKS-encrypted volumes using Kickstart</a>) or another automated provisioning tool to ensure that each encrypted VM has a unique master key.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Automated unlocking with a TPM 2.0 policy is not supported in a virtual machine.
				</p></div></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					For more information, see the following man page:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-bind(1)</code>
					</li></ul></div></section><section class="section" id="building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h2 class="title">9.13. Building automatically-enrollable VM images for cloud environments using NBDE</h2></div></div></div><p>
				Deploying automatically-enrollable encrypted images in a cloud environment can provide a unique set of challenges. Like other virtualization environments, it is recommended to reduce the number of instances started from a single image to avoid sharing the LUKS master key.
			</p><p>
				Therefore, the best practice is to create customized images that are not shared in any public repository and that provide a base for the deployment of a limited amount of instances. The exact number of instances to create should be defined by deployment’s security policies and based on the risk tolerance associated with the LUKS master key attack vector.
			</p><p>
				To build LUKS-enabled automated deployments, systems such as Lorax or virt-install together with a Kickstart file should be used to ensure master key uniqueness during the image building process.
			</p><p>
				Cloud environments enable two Tang server deployment options which we consider here. First, the Tang server can be deployed within the cloud environment itself. Second, the Tang server can be deployed outside of the cloud on independent infrastructure with a VPN link between the two infrastructures.
			</p><p>
				Deploying Tang natively in the cloud does allow for easy deployment. However, given that it shares infrastructure with the data persistence layer of ciphertext of other systems, it may be possible for both the Tang server’s private key and the Clevis metadata to be stored on the same physical disk. Access to this physical disk permits a full compromise of the ciphertext data.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					For this reason, Red Hat strongly recommends maintaining a physical separation between the location where the data is stored and the system where Tang is running. This separation between the cloud and the Tang server ensures that the Tang server’s private key cannot be accidentally combined with the Clevis metadata. It also provides local control of the Tang server if the cloud infrastructure is at risk.
				</p></div></div></section><section class="section" id="additional_resources"><div class="titlepage"><div><div><h2 class="title">9.14. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">tang(8)</code>, <code class="literal">clevis(1)</code>, <code class="literal">jose(1)</code>, and <code class="literal">clevis-luks-unlockers(7)</code> man pages.
					</li><li class="listitem">
						The <a class="link" href="https://access.redhat.com/articles/4500491">How to set up Network-Bound Disk Encryption with multiple LUKS devices (Clevis + Tang unlocking)</a> Knowledgebase article.
					</li></ul></div></section></section><section class="chapter" id="auditing-the-system_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Auditing the system</h1></div></div></div><p>
			Audit does not provide additional security to your system; rather, it can be used to discover violations of security policies used on your system. These violations can further be prevented by additional security measures such as SELinux.
		</p><section class="section" id="linux-audit_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.1. Linux Audit</h2></div></div></div><p>
				The Linux Audit system provides a way to track security-relevant information on your system. Based on pre-configured rules, Audit generates log entries to record as much information about the events that are happening on your system as possible. This information is crucial for mission-critical environments to determine the violator of the security policy and the actions they performed.
			</p><p>
				The following list summarizes some of the information that Audit is capable of recording in its log files:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Date and time, type, and outcome of an event.
					</li><li class="listitem">
						Sensitivity labels of subjects and objects.
					</li><li class="listitem">
						Association of an event with the identity of the user who triggered the event.
					</li><li class="listitem">
						All modifications to Audit configuration and attempts to access Audit log files.
					</li><li class="listitem">
						All uses of authentication mechanisms, such as SSH, Kerberos, and others.
					</li><li class="listitem">
						Changes to any trusted database, such as <code class="literal">/etc/passwd</code>.
					</li><li class="listitem">
						Attempts to import or export information into or from the system.
					</li><li class="listitem">
						Include or exclude events based on user identity, subject and object labels, and other attributes.
					</li></ul></div><p>
				The use of the Audit system is also a requirement for a number of security-related certifications. Audit is designed to meet or exceed the requirements of the following certifications or compliance guides:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Controlled Access Protection Profile (CAPP)
					</li><li class="listitem">
						Labeled Security Protection Profile (LSPP)
					</li><li class="listitem">
						Rule Set Base Access Control (RSBAC)
					</li><li class="listitem">
						National Industrial Security Program Operating Manual (NISPOM)
					</li><li class="listitem">
						Federal Information Security Management Act (FISMA)
					</li><li class="listitem">
						Payment Card Industry — Data Security Standard (PCI-DSS)
					</li><li class="listitem">
						Security Technical Implementation Guides (STIG)
					</li></ul></div><p>
				Audit has also been:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Evaluated by National Information Assurance Partnership (NIAP) and Best Security Industries (BSI).
					</li><li class="listitem">
						Certified to LSPP/CAPP/RSBAC/EAL4+ on Red Hat Enterprise Linux 5.
					</li><li class="listitem">
						Certified to Operating System Protection Profile / Evaluation Assurance Level 4+ (OSPP/EAL4+) on Red Hat Enterprise Linux 6.
					</li></ul></div><div class="variablelist"><p class="title"><strong>Use Cases</strong></p><dl class="variablelist"><dt><span class="term">Watching file access</span></dt><dd>
							Audit can track whether a file or a directory has been accessed, modified, executed, or the file’s attributes have been changed. This is useful, for example, to detect access to important files and have an Audit trail available in case one of these files is corrupted.
						</dd><dt><span class="term">Monitoring system calls</span></dt><dd>
							Audit can be configured to generate a log entry every time a particular system call is used. This can be used, for example, to track changes to the system time by monitoring the <code class="literal">settimeofday</code>, <code class="literal">clock_adjtime</code>, and other time-related system calls.
						</dd><dt><span class="term">Recording commands run by a user</span></dt><dd>
							Audit can track whether a file has been executed, so rules can be defined to record every execution of a particular command. For example, a rule can be defined for every executable in the <code class="literal">/bin</code> directory. The resulting log entries can then be searched by user ID to generate an audit trail of executed commands per user.
						</dd><dt><span class="term">Recording execution of system pathnames</span></dt><dd>
							Aside from watching file access which translates a path to an inode at rule invocation, Audit can now watch the execution of a path even if it does not exist at rule invocation, or if the file is replaced after rule invocation. This allows rules to continue to work after upgrading a program executable or before it is even installed.
						</dd><dt><span class="term">Recording security events</span></dt><dd>
							The <code class="literal">pam_faillock</code> authentication module is capable of recording failed login attempts. Audit can be set up to record failed login attempts as well and provides additional information about the user who attempted to log in.
						</dd><dt><span class="term">Searching for events</span></dt><dd>
							Audit provides the <code class="literal application">ausearch</code> utility, which can be used to filter the log entries and provide a complete audit trail based on several conditions.
						</dd><dt><span class="term">Running summary reports</span></dt><dd>
							The <code class="literal application">aureport</code> utility can be used to generate, among other things, daily reports of recorded events. A system administrator can then analyze these reports and investigate suspicious activity further.
						</dd><dt><span class="term">Monitoring network access</span></dt><dd>
							The <code class="literal application">iptables</code> and <code class="literal application">ebtables</code> utilities can be configured to trigger Audit events, allowing system administrators to monitor network access.
						</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					System performance may be affected depending on the amount of information that is collected by Audit.
				</p></div></div></section><section class="section" id="audit-system-architecture_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.2. Audit system architecture</h2></div></div></div><p>
				The Audit system consists of two main parts: the user-space applications and utilities, and the kernel-side system call processing. The kernel component receives system calls from user-space applications and filters them through one of the following filters: <span class="strong strong"><strong>user</strong></span>, <span class="strong strong"><strong>task</strong></span>, <span class="strong strong"><strong>fstype</strong></span>, or <span class="strong strong"><strong>exit</strong></span>.
			</p><p>
				Once a system call passes the <span class="strong strong"><strong>exclude</strong></span> filter, it is sent through one of the aforementioned filters, which, based on the Audit rule configuration, sends it to the Audit daemon for further processing.
			</p><p>
				The user-space Audit daemon collects the information from the kernel and creates entries in a log file. Other Audit user-space utilities interact with the Audit daemon, the kernel Audit component, or the Audit log files:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal application">auditctl</code> — the Audit control utility interacts with the kernel Audit component to manage rules and to control many settings and parameters of the event generation process.
					</li><li class="listitem">
						The remaining Audit utilities take the contents of the Audit log files as input and generate output based on user’s requirements. For example, the <code class="literal application">aureport</code> utility generates a report of all recorded events.
					</li></ul></div><p>
				In RHEL 8, the Audit dispatcher daemon (<code class="literal application">audisp</code>) functionality is integrated in the Audit daemon (<code class="literal">auditd</code>). Configuration files of plugins for the interaction of real-time analytical programs with Audit events are located in the <code class="literal filename">/etc/audit/plugins.d/</code> directory by default.
			</p></section><section class="section" id="configuring-auditd-for-a-secure-environment_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.3. Configuring auditd for a secure environment</h2></div></div></div><p>
				The default <code class="literal">auditd</code> configuration should be suitable for most environments. However, if your environment has to meet strict security policies, the following settings are suggested for the Audit daemon configuration in the <code class="literal filename">/etc/audit/auditd.conf</code> file:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">log_file</span></dt><dd>
							The directory that holds the Audit log files (usually <code class="literal filename">/var/log/audit/</code>) should reside on a separate mount point. This prevents other processes from consuming space in this directory and provides accurate detection of the remaining space for the Audit daemon.
						</dd><dt><span class="term">max_log_file</span></dt><dd>
							Specifies the maximum size of a single Audit log file, must be set to make full use of the available space on the partition that holds the Audit log files.
						</dd><dt><span class="term">max_log_file_action</span></dt><dd>
							Decides what action is taken once the limit set in <code class="literal">max_log_file</code> is reached, should be set to <code class="literal">keep_logs</code> to prevent Audit log files from being overwritten.
						</dd><dt><span class="term">space_left</span></dt><dd>
							Specifies the amount of free space left on the disk for which an action that is set in the <code class="literal">space_left_action</code> parameter is triggered. Must be set to a number that gives the administrator enough time to respond and free up disk space. The <code class="literal">space_left</code> value depends on the rate at which the Audit log files are generated.
						</dd><dt><span class="term">space_left_action</span></dt><dd>
							It is recommended to set the <code class="literal">space_left_action</code> parameter to <code class="literal">email</code> or <code class="literal">exec</code> with an appropriate notification method.
						</dd><dt><span class="term">admin_space_left</span></dt><dd>
							Specifies the absolute minimum amount of free space for which an action that is set in the <code class="literal">admin_space_left_action</code> parameter is triggered, must be set to a value that leaves enough space to log actions performed by the administrator.
						</dd><dt><span class="term">admin_space_left_action</span></dt><dd>
							Should be set to <code class="literal">single</code> to put the system into single-user mode and allow the administrator to free up some disk space.
						</dd><dt><span class="term">disk_full_action</span></dt><dd>
							Specifies an action that is triggered when no free space is available on the partition that holds the Audit log files, must be set to <code class="literal">halt</code> or <code class="literal">single</code>. This ensures that the system is either shut down or operating in single-user mode when Audit can no longer log events.
						</dd><dt><span class="term">disk_error_action</span></dt><dd>
							Specifies an action that is triggered in case an error is detected on the partition that holds the Audit log files, must be set to <code class="literal">syslog</code>, <code class="literal">single</code>, or <code class="literal">halt</code>, depending on your local security policies regarding the handling of hardware malfunctions.
						</dd><dt><span class="term">flush</span></dt><dd>
							Should be set to <code class="literal">incremental_async</code>. It works in combination with the <code class="literal">freq</code> parameter, which determines how many records can be sent to the disk before forcing a hard synchronization with the hard drive. The <code class="literal">freq</code> parameter should be set to <code class="literal">100</code>. These parameters assure that Audit event data is synchronized with the log files on the disk while keeping good performance for bursts of activity.
						</dd></dl></div><p>
				The remaining configuration options should be set according to your local security policy.
			</p></section><section class="section" id="starting-the-audit-service_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.4. Starting and controlling auditd</h2></div></div></div><p>
				Once <code class="literal">auditd</code> is configured, start the service to collect Audit information and store it in the log files. Use the following command as the root user to start <code class="literal">auditd</code>:
			</p><pre class="screen">~]# service auditd start</pre><p>
				To configure <code class="literal">auditd</code> to start at boot time:
			</p><pre class="screen">~]# systemctl enable auditd</pre><p>
				A number of other actions can be performed on <code class="literal">auditd</code> using the <code class="literal command">service auditd <span class="emphasis"><em>action</em></span></code> command, where <span class="emphasis"><em>action</em></span> can be one of the following:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal command">stop</code></span></dt><dd>
							Stops <code class="literal">auditd</code>.
						</dd><dt><span class="term"><code class="literal command">restart</code></span></dt><dd>
							Restarts <code class="literal">auditd</code>.
						</dd><dt><span class="term"><code class="literal command">reload</code> or <code class="literal command">force-reload</code></span></dt><dd>
							Reloads the configuration of <code class="literal application">auditd</code> from the <code class="literal">/etc/audit/auditd.conf</code> file.
						</dd><dt><span class="term"><code class="literal command">rotate</code></span></dt><dd>
							Rotates the log files in the <code class="literal">/var/log/audit/</code> directory.
						</dd><dt><span class="term"><code class="literal command">resume</code></span></dt><dd>
							Resumes logging of Audit events after it has been previously suspended, for example, when there is not enough free space on the disk partition that holds the Audit log files.
						</dd><dt><span class="term"><code class="literal command">condrestart</code> or <code class="literal command">try-restart</code></span></dt><dd>
							Restarts <code class="literal application">auditd</code> only if it is already running.
						</dd><dt><span class="term"><code class="literal command">status</code></span></dt><dd>
							Displays the running status of <code class="literal application">auditd</code>.
						</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal command">service</code> command is the only way to correctly interact with the <code class="literal">auditd</code> daemon. You need to use the <code class="literal command">service</code> command so that the <code class="literal">auid</code> value is properly recorded. You can use the <code class="literal command">systemctl</code> command only for two actions: <code class="literal command">enable</code> and <code class="literal command">status</code>.
				</p></div></div></section><section class="section" id="understanding-audit-log-files_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.5. Understanding Audit log files</h2></div></div></div><p>
				By default, the Audit system stores log entries in the <code class="literal filename">/var/log/audit/audit.log</code> file; if log rotation is enabled, rotated <code class="literal filename">audit.log</code> files are stored in the same directory.
			</p><p>
				Add the following Audit rule to log every attempt to read or modify the <code class="literal filename">/etc/ssh/sshd_config</code> file:
			</p><pre class="screen"># auditctl -w /etc/ssh/sshd_config -p warx -k sshd_config</pre><p>
				If the <code class="literal">auditd</code> daemon is running, for example, using the following command creates a new event in the Audit log file:
			</p><pre class="screen">$ cat /etc/ssh/sshd_config</pre><p>
				This event in the <code class="literal">audit.log</code> file looks as follows:
			</p><pre class="screen">type=SYSCALL msg=audit(1364481363.243:24287): arch=c000003e syscall=2 success=no exit=-13 a0=7fffd19c5592 a1=0 a2=7fffd19c4b50 a3=a items=1 ppid=2686 pid=3538 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=1 comm="cat" exe="/bin/cat" subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key="sshd_config"
type=CWD msg=audit(1364481363.243:24287):  cwd="/home/shadowman"
type=PATH msg=audit(1364481363.243:24287): item=0 name="/etc/ssh/sshd_config" inode=409248 dev=fd:00 mode=0100600 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:etc_t:s0  nametype=NORMAL cap_fp=none cap_fi=none cap_fe=0 cap_fver=0
type=PROCTITLE msg=audit(1364481363.243:24287) : proctitle=636174002F6574632F7373682F737368645F636F6E666967</pre><p>
				The above event consists of four records, which share the same time stamp and serial number. Records always start with the <code class="literal">type=</code> keyword. Each record consists of several <code class="literal"><span class="emphasis"><em>name</em></span>=<span class="emphasis"><em>value</em></span></code> pairs separated by a white space or a comma. A detailed analysis of the above event follows:
			</p><div class="variablelist"><p class="title"><strong>First Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=SYSCALL</code></span></dt><dd>
							The <code class="literal">type</code> field contains the type of the record. In this example, the <code class="literal">SYSCALL</code> value specifies that this record was triggered by a system call to the kernel.
						</dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287):</code></span></dt><dd><p class="simpara">
							The <code class="literal">msg</code> field records:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									a time stamp and a unique ID of the record in the form <code class="literal">audit(<span class="emphasis"><em>time_stamp</em></span>:<span class="emphasis"><em>ID</em></span>)</code>. Multiple records can share the same time stamp and ID if they were generated as part of the same Audit event. The time stamp is using the Unix time format - seconds since 00:00:00 UTC on 1 January 1970.
								</li><li class="listitem">
									various event-specific <code class="literal"><span class="emphasis"><em>name</em></span>=<span class="emphasis"><em>value</em></span></code> pairs provided by the kernel or user-space applications.
								</li></ul></div></dd><dt><span class="term"><code class="literal">arch=c000003e</code></span></dt><dd>
							The <code class="literal">arch</code> field contains information about the CPU architecture of the system. The value, <code class="literal">c000003e</code>, is encoded in hexadecimal notation. When searching Audit records with the <code class="literal command">ausearch</code> command, use the <code class="literal option">-i</code> or <code class="literal option">--interpret</code> option to automatically convert hexadecimal values into their human-readable equivalents. The <code class="literal">c000003e</code> value is interpreted as <code class="literal">x86_64</code>.
						</dd><dt><span class="term"><code class="literal">syscall=2</code></span></dt><dd>
							The <code class="literal">syscall</code> field records the type of the system call that was sent to the kernel. The value, <code class="literal">2</code>, can be matched with its human-readable equivalent in the <code class="literal">/usr/include/asm/unistd_64.h</code> file. In this case, <code class="literal">2</code> is the <code class="literal">open</code> system call. Note that the <code class="literal application">ausyscall</code> utility allows you to convert system call numbers to their human-readable equivalents. Use the <code class="literal command">ausyscall --dump</code> command to display a listing of all system calls along with their numbers. For more information, see the <code class="literal">ausyscall</code>(8) man page.
						</dd><dt><span class="term"><code class="literal">success=no</code></span></dt><dd>
							The <code class="literal">success</code> field records whether the system call recorded in that particular event succeeded or failed. In this case, the call did not succeed.
						</dd><dt><span class="term"><code class="literal">exit=-13</code></span></dt><dd><p class="simpara">
							The <code class="literal">exit</code> field contains a value that specifies the exit code returned by the system call. This value varies for a different system call. You can interpret the value to its human-readable equivalent with the following command:
						</p><pre class="screen">~]# ausearch --interpret --exit -13</pre><p class="simpara">
							Note that the previous example assumes that your Audit log contains an event that failed with exit code <code class="literal">-13</code>.
						</p></dd><dt><span class="term"><code class="literal">a0=7fffd19c5592</code>, <code class="literal">a1=0</code>, <code class="literal">a2=7fffd19c5592</code>, <code class="literal">a3=a</code></span></dt><dd>
							The <code class="literal">a0</code> to <code class="literal">a3</code> fields record the first four arguments, encoded in hexadecimal notation, of the system call in this event. These arguments depend on the system call that is used; they can be interpreted by the <code class="literal application">ausearch</code> utility.
						</dd><dt><span class="term"><code class="literal">items=1</code></span></dt><dd>
							The <code class="literal">items</code> field contains the number of PATH auxiliary records that follow the syscall record.
						</dd><dt><span class="term"><code class="literal">ppid=2686</code></span></dt><dd>
							The <code class="literal">ppid</code> field records the Parent Process ID (PPID). In this case, <code class="literal">2686</code> was the PPID of the parent process such as <code class="literal">bash</code>.
						</dd><dt><span class="term"><code class="literal">pid=3538</code></span></dt><dd>
							The <code class="literal">pid</code> field records the Process ID (PID). In this case, <code class="literal">3538</code> was the PID of the <code class="literal">cat</code> process.
						</dd><dt><span class="term"><code class="literal">auid=1000</code></span></dt><dd>
							The <code class="literal">auid</code> field records the Audit user ID, that is the loginuid. This ID is assigned to a user upon login and is inherited by every process even when the user’s identity changes, for example, by switching user accounts with the <code class="literal command">su - john</code> command.
						</dd><dt><span class="term"><code class="literal">uid=1000</code></span></dt><dd>
							The <code class="literal">uid</code> field records the user ID of the user who started the analyzed process. The user ID can be interpreted into user names with the following command: <code class="literal command">ausearch -i --uid <span class="emphasis"><em>UID</em></span></code>.
						</dd><dt><span class="term"><code class="literal">gid=1000</code></span></dt><dd>
							The <code class="literal">gid</code> field records the group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">euid=1000</code></span></dt><dd>
							The <code class="literal">euid</code> field records the effective user ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">suid=1000</code></span></dt><dd>
							The <code class="literal">suid</code> field records the set user ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">fsuid=1000</code></span></dt><dd>
							The <code class="literal">fsuid</code> field records the file system user ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">egid=1000</code></span></dt><dd>
							The <code class="literal">egid</code> field records the effective group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">sgid=1000</code></span></dt><dd>
							The <code class="literal">sgid</code> field records the set group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">fsgid=1000</code></span></dt><dd>
							The <code class="literal">fsgid</code> field records the file system group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">tty=pts0</code></span></dt><dd>
							The <code class="literal">tty</code> field records the terminal from which the analyzed process was invoked.
						</dd><dt><span class="term"><code class="literal">ses=1</code></span></dt><dd>
							The <code class="literal">ses</code> field records the session ID of the session from which the analyzed process was invoked.
						</dd><dt><span class="term"><code class="literal">comm="cat"</code></span></dt><dd>
							The <code class="literal">comm</code> field records the command-line name of the command that was used to invoke the analyzed process. In this case, the <code class="literal command">cat</code> command was used to trigger this Audit event.
						</dd><dt><span class="term"><code class="literal">exe="/bin/cat"</code></span></dt><dd>
							The <code class="literal">exe</code> field records the path to the executable that was used to invoke the analyzed process.
						</dd><dt><span class="term"><code class="literal">subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</code></span></dt><dd>
							The <code class="literal">subj</code> field records the SELinux context with which the analyzed process was labeled at the time of execution.
						</dd><dt><span class="term"><code class="literal">key="sshd_config"</code></span></dt><dd>
							The <code class="literal">key</code> field records the administrator-defined string associated with the rule that generated this event in the Audit log.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Second Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=CWD</code></span></dt><dd><p class="simpara">
							In the second record, the <code class="literal">type</code> field value is <code class="literal">CWD</code> — current working directory. This type is used to record the working directory from which the process that invoked the system call specified in the first record was executed.
						</p><p class="simpara">
							The purpose of this record is to record the current process’s location in case a relative path winds up being captured in the associated PATH record. This way the absolute path can be reconstructed.
						</p></dd><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287)</code></span></dt><dd>
							The <code class="literal">msg</code> field holds the same time stamp and ID value as the value in the first record. The time stamp is using the Unix time format - seconds since 00:00:00 UTC on 1 January 1970.
						</dd><dt><span class="term"><code class="literal">cwd="/home/<span class="emphasis"><em>user_name</em></span>"</code></span></dt><dd>
							The <code class="literal">cwd</code> field contains the path to the directory in which the system call was invoked.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Third Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=PATH</code></span></dt><dd>
							In the third record, the <code class="literal">type</code> field value is <code class="literal">PATH</code>. An Audit event contains a <code class="literal">PATH</code>-type record for every path that is passed to the system call as an argument. In this Audit event, only one path (<code class="literal filename">/etc/ssh/sshd_config</code>) was used as an argument.
						</dd><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287):</code></span></dt><dd>
							The <code class="literal">msg</code> field holds the same time stamp and ID value as the value in the first and second record.
						</dd><dt><span class="term"><code class="literal">item=0</code></span></dt><dd>
							The <code class="literal">item</code> field indicates which item, of the total number of items referenced in the <code class="literal">SYSCALL</code> type record, the current record is. This number is zero-based; a value of <code class="literal">0</code> means it is the first item.
						</dd><dt><span class="term"><code class="literal">name="/etc/ssh/sshd_config"</code></span></dt><dd>
							The <code class="literal">name</code> field records the path of the file or directory that was passed to the system call as an argument. In this case, it was the <code class="literal filename">/etc/ssh/sshd_config</code> file.
						</dd><dt><span class="term"><code class="literal">inode=409248</code></span></dt><dd><p class="simpara">
							The <code class="literal">inode</code> field contains the inode number associated with the file or directory recorded in this event. The following command displays the file or directory that is associated with the <code class="literal">409248</code> inode number:
						</p><pre class="screen">~]# find / -inum 409248 -print
/etc/ssh/sshd_config</pre></dd><dt><span class="term"><code class="literal">dev=fd:00</code></span></dt><dd>
							The <code class="literal">dev</code> field specifies the minor and major ID of the device that contains the file or directory recorded in this event. In this case, the value represents the <code class="literal">/dev/fd/0</code> device.
						</dd><dt><span class="term"><code class="literal">mode=0100600</code></span></dt><dd>
							The <code class="literal">mode</code> field records the file or directory permissions, encoded in numerical notation as returned by the <code class="literal command">stat</code> command in the <code class="literal">st_mode</code> field. See the <code class="literal">stat(2)</code> man page for more information. In this case, <code class="literal">0100600</code> can be interpreted as <code class="literal">-rw-------</code>, meaning that only the root user has read and write permissions to the <code class="literal filename">/etc/ssh/sshd_config</code> file.
						</dd><dt><span class="term"><code class="literal">ouid=0</code></span></dt><dd>
							The <code class="literal">ouid</code> field records the object owner’s user ID.
						</dd><dt><span class="term"><code class="literal">ogid=0</code></span></dt><dd>
							The <code class="literal">ogid</code> field records the object owner’s group ID.
						</dd><dt><span class="term"><code class="literal">rdev=00:00</code></span></dt><dd>
							The <code class="literal">rdev</code> field contains a recorded device identifier for special files only. In this case, it is not used as the recorded file is a regular file.
						</dd><dt><span class="term"><code class="literal">obj=system_u:object_r:etc_t:s0</code></span></dt><dd>
							The <code class="literal">obj</code> field records the SELinux context with which the recorded file or directory was labeled at the time of execution.
						</dd><dt><span class="term"><code class="literal">nametype=NORMAL</code></span></dt><dd>
							The <code class="literal">nametype</code> field records the intent of each path record’s operation in the context of a given syscall.
						</dd><dt><span class="term"><code class="literal">cap_fp=none</code></span></dt><dd>
							The <code class="literal">cap_fp</code> field records data related to the setting of a permitted file system-based capability of the file or directory object.
						</dd><dt><span class="term"><code class="literal">cap_fi=none</code></span></dt><dd>
							The <code class="literal">cap_fi</code> field records data related to the setting of an inherited file system-based capability of the file or directory object.
						</dd><dt><span class="term"><code class="literal">cap_fe=0</code></span></dt><dd>
							The <code class="literal">cap_fe</code> field records the setting of the effective bit of the file system-based capability of the file or directory object.
						</dd><dt><span class="term"><code class="literal">cap_fver=0</code></span></dt><dd>
							The <code class="literal">cap_fver</code> field records the version of the file system-based capability of the file or directory object.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Fourth Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=PROCTITLE</code></span></dt><dd>
							The <code class="literal">type</code> field contains the type of the record. In this example, the <code class="literal">PROCTITLE</code> value specifies that this record gives the full command-line that triggered this Audit event, triggered by a system call to the kernel.
						</dd><dt><span class="term"><code class="literal">proctitle=636174002F6574632F7373682F737368645F636F6E666967</code></span></dt><dd>
							The <code class="literal">proctitle</code> field records the full command-line of the command that was used to invoke the analyzed process. The field is encoded in hexadecimal notation to not allow the user to influence the Audit log parser. The text decodes to the command that triggered this Audit event. When searching Audit records with the <code class="literal command">ausearch</code> command, use the <code class="literal option">-i</code> or <code class="literal option">--interpret</code> option to automatically convert hexadecimal values into their human-readable equivalents. The <code class="literal">636174002F6574632F7373682F737368645F636F6E666967</code> value is interpreted as <code class="literal">cat /etc/ssh/sshd_config</code>.
						</dd></dl></div></section><section class="section" id="using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.6. Using auditctl for defining and executing Audit rules</h2></div></div></div><p>
				The Audit system operates on a set of rules that define what is captured in the log files. Audit rules can be set either on the command line using the <code class="literal">auditctl</code> utility or in the <code class="literal filename">/etc/audit/rules.d/</code> directory.
			</p><p>
				The auditctl command enables you to control the basic functionality of the Audit system and to define rules that decide which Audit events are logged.
			</p><div class="orderedlist"><p class="title"><strong>File-system rules examples</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To define a rule that logs all write access to, and every attribute change of, the /etc/passwd file:
					</p><pre class="screen"># auditctl -w /etc/passwd -p wa -k passwd_changes</pre></li><li class="listitem"><p class="simpara">
						To define a rule that logs all write access to, and every attribute change of, all the files in the <code class="literal">/etc/selinux/</code> directory:
					</p><pre class="screen"># auditctl -w /etc/selinux/ -p wa -k selinux_changes</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>System-call rules examples</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To define a rule that creates a log entry every time the <code class="literal">adjtimex</code> or <code class="literal">settimeofday</code> system calls are used by a program, and the system uses the 64-bit architecture:
					</p><pre class="screen"># auditctl -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time_change</pre></li><li class="listitem"><p class="simpara">
						To define a rule that creates a log entry every time a file is deleted or renamed by a system user whose ID is 1000 or larger:
					</p><pre class="screen"># auditctl -a always,exit -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=1000 -F auid!=4294967295 -k delete</pre><p class="simpara">
						Note that the <code class="literal">-F auid!=4294967295</code> option is used to exclude users whose login UID is not set.
					</p></li></ol></div><div class="formalpara"><p class="title"><strong>Executable-file rules</strong></p><p>
					To define a rule that logs all execution of the <code class="literal">/bin/id</code> program, execute the following command:
				</p></div><pre class="screen"># auditctl -a always,exit -F exe=/bin/id -F arch=b64 -S execve -k execution_bin_id</pre><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					See the <code class="literal">audictl(8)</code> man page for more information, performance tips, and additional examples of use.
				</p></div></section><section class="section" id="defining-persistent-audit-rules_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.7. Defining persistent Audit rules</h2></div></div></div><p>
				To define Audit rules that are persistent across reboots, you must either directly include them in the <code class="literal">/etc/audit/rules.d/audit.rules</code> file or use the <code class="literal">augenrules</code> program that reads rules located in the <code class="literal">/etc/audit/rules.d/</code> directory.
			</p><p>
				Note that the <code class="literal">/etc/audit/audit.rules</code> file is generated whenever the <code class="literal">auditd</code> service starts. Files in <code class="literal">/etc/audit/rules.d/</code> use the same <code class="literal">auditctl</code> command-line syntax to specify the rules. Empty lines and text following a hash sign (#) are ignored.
			</p><p>
				The <code class="literal">auditctl</code> command can also be used to read rules from a specified file using the -R option, for example:
			</p><pre class="screen"># auditctl -R /usr/share/doc/audit/rules/30-stig.rules</pre></section><section class="section" id="using-pre-configured-rules-files_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.8. Using pre-configured rules files</h2></div></div></div><p>
				In the <code class="literal filename">/usr/share/doc/audit/rules/</code> directory, the <code class="literal package">audit</code> package provides a set of pre-configured rules files according to various certification standards:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">30-nispom.rules</span></dt><dd>
							Audit rule configuration that meets the requirements specified in the Information System Security chapter of the National Industrial Security Program Operating Manual.
						</dd><dt><span class="term">30-ospp-v42.rules</span></dt><dd>
							Audit rule configuration that meets the requirements defined in the OSPP (Protection Profile for General Purpose Operating Systems) profile version 4.2.
						</dd><dt><span class="term">30-pci-dss-v31.rules</span></dt><dd>
							Audit rule configuration that meets the requirements set by Payment Card Industry Data Security Standard (PCI DSS) v3.1.
						</dd><dt><span class="term">30-stig.rules</span></dt><dd>
							Audit rule configuration that meets the requirements set by Security Technical Implementation Guides (STIG).
						</dd></dl></div><p>
				To use these configuration files, copy them to the <code class="literal filename">/etc/audit/rules.d/</code> directory and use the <code class="literal command">augenrules --load</code> command, for example:
			</p><pre class="screen"># cp /usr/share/doc/audit/rules/10-base-config.rules /usr/share/doc/audit/rules/30-stig.rules /usr/share/doc/audit/rules/31-privileged.rules /usr/share/doc/audit/rules/99-finalize.rules /etc/audit/rules.d/
# augenrules --load</pre><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					The Audit rules have a numbering scheme that allows them to be ordered. To learn more about the naming scheme, see the <code class="literal filename">/usr/share/doc/audit/rules/README-rules</code> file.
				</p></div><p>
				See the <code class="literal">audit.rules(7)</code> man page for more information, troubleshooting, and additional examples of use.
			</p></section><section class="section" id="using-augenrules-to-define-persistent-rules_auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.9. Using augenrules to define persistent rules</h2></div></div></div><p>
				The <code class="literal">augenrules</code> script reads rules located in the <code class="literal filename">/etc/audit/rules.d/</code> directory and compiles them into an <code class="literal filename">audit.rules</code> file. This script processes all files that end with <code class="literal">.rules</code> in a specific order based on their natural sort order. The files in this directory are organized into groups with the following meanings:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						10 - Kernel and auditctl configuration
					</li><li class="listitem">
						20 - Rules that could match general rules but you want a different match
					</li><li class="listitem">
						30 - Main rules
					</li><li class="listitem">
						40 - Optional rules
					</li><li class="listitem">
						50 - Server-specific rules
					</li><li class="listitem">
						70 - System local rules
					</li><li class="listitem">
						90 - Finalize (immutable)
					</li></ul></div><p>
				The rules are not meant to be used all at once. They are pieces of a policy that should be thought out and individual files copied to <code class="literal filename">/etc/audit/rules.d/</code>. For example, to set a system up in the STIG configuration, copy rules <code class="literal filename">10-base-config</code>, <code class="literal filename">30-stig</code>, <code class="literal filename">31-privileged</code>, and <code class="literal filename">99-finalize</code>.
			</p><p>
				Once you have the rules in the <code class="literal filename">/etc/audit/rules.d/</code> directory, load them by running the <code class="literal">augenrules</code> script with the <code class="literal option">--load</code> directive:
			</p><pre class="screen"># augenrules --load
/sbin/augenrules: No change
No rules
enabled 1
failure 1
pid 742
rate_limit 0
[trimmed for clarity]</pre><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
					For more information on the Audit rules and the <code class="literal">augenrules</code> script, see the <code class="literal">audit.rules(8)</code> and <code class="literal">augenrules(8)</code> man pages.
				</p></div></section><section class="section" id="related-information-auditing-the-system"><div class="titlepage"><div><div><h2 class="title">10.10. Related information</h2></div></div></div><p>
				For more information about the Audit system, see the following sources.
			</p><div class="itemizedlist"><p class="title"><strong>Online Sources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <a class="link" href="https://access.redhat.com/articles/4409591">RHEL Audit System Reference</a> Knowledgebase article.
					</li><li class="listitem">
						The <a class="link" href="https://access.redhat.com/articles/4494341">Auditd execution options in a container</a> Knowledgebase article.
					</li><li class="listitem">
						The <a class="link" href="https://github.com/linux-audit/audit-documentation/wiki">Linux Audit Documentation Project page</a>.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Installed Documentation</strong></p><p>
					Documentation provided by the <span class="strong strong"><strong><span class="package package">audit</span></strong></span> package can be found in the <code class="literal">/usr/share/doc/audit/</code> directory.
				</p></div><div class="itemizedlist"><p class="title"><strong>Manual Pages</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>audispd.conf</strong></span>(5)
					</li><li class="listitem">
						<span class="strong strong"><strong>auditd.conf</strong></span>(5)
					</li><li class="listitem">
						<span class="strong strong"><strong>ausearch-expression</strong></span>(5)
					</li><li class="listitem">
						<span class="strong strong"><strong>audit.rules</strong></span>(7)
					</li><li class="listitem">
						<span class="strong strong"><strong>audispd</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>auditctl</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>auditd</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>aulast</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>aulastlog</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>aureport</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>ausearch</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>ausyscall</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>autrace</strong></span>(8)
					</li><li class="listitem">
						<span class="strong strong"><strong>auvirt</strong></span>(8)
					</li></ul></div></section></section><section class="chapter" id="configuring-and-managing-application-whitelists_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Configuring and managing application whitelists</h1></div></div></div><p>
			Application whitelisting efficiently prevents the execution of unknown and potentially malicious software.
		</p><section class="section" id="application-whitelisting-in-rhel_configuring-and-managing-application-whitelists"><div class="titlepage"><div><div><h2 class="title">11.1. Application whitelisting in RHEL</h2></div></div></div><p>
				The <code class="literal">fapolicyd</code> software framework introduces a form of application whitelisting and blacklisting based on a user-defined policy. The application whitelisting feature provides one of the most efficient ways to prevent running untrusted and possibly malicious applications on the system.
			</p><p>
				The <code class="literal">fapolicyd</code> framework provides the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">fapolicyd</code> service
					</li><li class="listitem">
						<code class="literal">fapolicyd</code> command-line utilities
					</li><li class="listitem">
						<code class="literal">fapolicyd</code> YUM plugin
					</li><li class="listitem">
						<code class="literal">fapolicyd</code> rule language
					</li></ul></div><p>
				The administrator can define the <code class="literal">allow</code> and <code class="literal">deny</code> execution rules for any application with the possibility of auditing based on a path, hash, MIME type, or trust.
			</p><p>
				Application whitelisting introduces the concept of trust. An application is trusted when it is properly installed by the system package manager, and therefore it is registered in the system RPM database. The <code class="literal">fapolicyd</code> daemon uses the RPM database as a list of trusted binaries and scripts. The <code class="literal">fapolicyd</code> YUM plugin registers any system update that is handled by the YUM package manager. The plugin notifies the <code class="literal">fapolicyd</code> daemon about changes in this database.
			</p><p>
				An installation using the <code class="literal">rpm</code> utility requires a manual refresh of the database, and other ways of adding applications require the creation of custom rules and restarting the <code class="literal">fapolicyd</code> service.
			</p><p>
				The <code class="literal">fapolicyd</code> service configuration is located in the <code class="literal">/etc/fapolicyd/</code> directory with the following structure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">fapolicyd.rules</code> file contains <code class="literal">allow</code> and <code class="literal">deny</code> execution rules.
					</li><li class="listitem">
						The <code class="literal">fapolicyd.mounts</code> file contains a list of watched mount points.
					</li><li class="listitem">
						The <code class="literal">fapolicyd.conf</code> file contains daemon’s configuration options. This file is useful primarily for performance-tuning purposes.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">fapolicyd(8)</code>, <code class="literal">fapolicyd.rules(7)</code>, and <code class="literal">fapolicyd.conf(5)</code> man pages for more information.
					</li></ul></div></section><section class="section" id="deploying-application-whitelisting_configuring-and-managing-application-whitelists"><div class="titlepage"><div><div><h2 class="title">11.2. Deploying application whitelisting</h2></div></div></div><p>
				To deploy the <code class="literal">fapolicyd</code> framework in RHEL:
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">fapolicyd</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install fapolicyd</strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate an initial list of mount points for your system, for example:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>mount | egrep '^tmpfs| ext4| ext3| xfs' | awk '{ printf "%s\n", $3 }' &gt;&gt; /etc/fapolicyd/fapolicyd.mounts</strong></span></pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal">fapolicyd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now fapolicyd</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the <code class="literal">fapolicyd</code> service is running correctly:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>systemctl status fapolicyd</strong></span>
● fapolicyd.service - File Access Policy Daemon
   Loaded: loaded (/usr/lib/systemd/system/fapolicyd.service; enabled; vendor p&gt;
   Active: active (running) since Tue 2019-10-15 18:02:35 CEST; 55s ago
  Process: 8818 ExecStart=/usr/sbin/fapolicyd (code=exited, status=0/SUCCESS)
 Main PID: 8819 (fapolicyd)
    Tasks: 4 (limit: 11500)
   Memory: 78.2M
   CGroup: /system.slice/fapolicyd.service
           └─8819 /usr/sbin/fapolicyd

Oct 15 18:02:35 localhost.localdomain systemd[1]: Starting File Access Policy D&gt;
Oct 15 18:02:35 localhost.localdomain fapolicyd[8819]: Initialization of the da&gt;
Oct 15 18:02:35 localhost.localdomain fapolicyd[8819]: Reading RPMDB into memory
Oct 15 18:02:35 localhost.localdomain systemd[1]: Started File Access Policy Da&gt;
Oct 15 18:02:36 localhost.localdomain fapolicyd[8819]: Creating database</pre></li><li class="listitem"><p class="simpara">
						Check that application whitelisting is working, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /bin/ls /opt</strong></span>
# <span class="strong strong"><strong>cd /opt</strong></span>
# <span class="strong strong"><strong>./ls</strong></span>
-bash: ./ls: Operation not permitted</pre></li></ol></div></section><section class="section" id="adding-custom-rules-for-application-whitelisting_configuring-and-managing-application-whitelists"><div class="titlepage"><div><div><h2 class="title">11.3. Adding custom rules for application whitelisting</h2></div></div></div><p>
				The default set of rules in the <code class="literal">fapolicyd</code> package does not affect system functions. For custom scenarios, such as storing binaries and scripts in a non-standard directory or adding applications without the <code class="literal">yum</code> or <code class="literal">rpm</code> installers, you must modify existing or add new rules. The following steps demonstrate adding a new rule to whitelist a custom binary.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">fapolicyd</code> framework is deployed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy your custom binary to the required directory, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /bin/ls /opt</strong></span>
# <span class="strong strong"><strong>cd /opt</strong></span>
# <span class="strong strong"><strong>./ls</strong></span>
-bash: ./ls: Operation not permitted</pre></li><li class="listitem"><p class="simpara">
						Stop the <code class="literal">fapolicyd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop fapolicyd</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use debug mode to identify a corresponding rule. Because the output of the <code class="literal">fapolicyd --debug</code> command is verbose and you can stop it only by pressing <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span> or killing the corresponding process, redirect the error output to a file:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug 2&gt; <span class="emphasis"><em>fapolicy.output</em></span> &amp;</strong></span>
[1] <span class="emphasis"><em>16026</em></span></pre><p class="simpara">
						Alternatively, you can run <code class="literal">fapolicyd</code> debug mode in another terminal.
					</p></li><li class="listitem"><p class="simpara">
						Repeat the command that was not permitted:
					</p><pre class="screen"># <span class="strong strong"><strong>cd /opt</strong></span>
# <span class="strong strong"><strong>./ls</strong></span>
-bash: ./ls: Operation not permitted</pre></li><li class="listitem"><p class="simpara">
						Stop debug mode by resuming it in the foreground and pressing <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span>:
					</p><pre class="screen"># <span class="strong strong"><strong>fg</strong></span>
fapolicyd --debug
^Cshutting down...
Inter-thread max queue depth 1
Allowed accesses: 2
Denied accesses: 1
[...]</pre><p class="simpara">
						Alternatively, kill the process of <code class="literal">fapolicyd</code> debug mode:
					</p><pre class="screen"># <span class="strong strong"><strong>kill <span class="emphasis"><em>16026</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Find a rule that denies the execution of your application:
					</p><pre class="screen"># <span class="strong strong"><strong>cat <span class="emphasis"><em>fapolicy.output</em></span></strong></span>
[...]
rule:8 dec=deny_audit auid=1000 pid=29425 exe=/usr/bin/bash file=/opt/ls
[...]</pre></li><li class="listitem"><p class="simpara">
						Add a new <code class="literal">allow</code> rule <span class="emphasis"><em>before</em></span> the rule that denied the execution of your custom binary in the <code class="literal">/etc/fapolicyd/fapolicyd.rules</code> file:
					</p><pre class="screen">allow all path=/opt/ls</pre><p class="simpara">
						Alternatively, you can allow executions of all binaries in the <code class="literal">/opt</code> directory by adding the following rule in the <code class="literal">/etc/fapolicyd/fapolicyd.rules</code> file:
					</p><pre class="screen">allow all dir=/opt/</pre></li><li class="listitem"><p class="simpara">
						To prevent changes in the content of your custom binary, define the required rule using an SHA-256 checksum:
					</p><pre class="screen">$ <span class="strong strong"><strong>sha256sum /opt/ls</strong></span>
780b75c90b2d41ea41679fcb358c892b1251b68d1927c80fbc0d9d148b25e836  ls</pre><p class="simpara">
						Change the rule in the previous step to the following definition:
					</p><pre class="screen">allow all sha256hash=<span class="emphasis"><em>780b75c90b2d41ea41679fcb358c892b1251b68d1927c80fbc0d9d148b25e836</em></span></pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">fapolicyd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start fapolicyd</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that your custom binary can be now executed, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>./ls</strong></span>
ls</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">fapolicyd.rules(7)</code> man page for more information.
					</li></ul></div></section><section class="section" id="troubleshooting-rhel-application-whitelisting_configuring-and-managing-application-whitelists"><div class="titlepage"><div><div><h2 class="title">11.4. Troubleshooting RHEL application whitelisting</h2></div></div></div><p>
				The following section provides tips for basic troubleshooting of the <code class="literal">fapolicyd</code> application whitelisting framework and guidance for adding application using the <code class="literal">rpm</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Installing applications using <code class="literal">rpm</code></strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If you install an application using the <code class="literal">rpm</code> command, you have to perform a manual refresh of the <code class="literal">fapolicyd</code> RPM database:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Install your <span class="emphasis"><em>application</em></span>:
							</p><pre class="screen"># <span class="strong strong"><strong>rpm -i <span class="emphasis"><em>application</em></span>.rpm</strong></span></pre></li><li class="listitem"><p class="simpara">
								Refresh the database:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --update</strong></span></pre><p class="simpara">
								If you skip this step, the system can freeze and must be restarted.
							</p></li></ol></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Service status</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If <code class="literal">fapolicyd</code> does not work correctly, check the service status:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status fapolicyd</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Debug mode</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Debug mode provides detailed information about matched rules, database status, and more. To switch <code class="literal">fapolicyd</code> to debug mode:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Stop the <code class="literal">fapolicyd</code> service:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop fapolicyd</strong></span></pre></li><li class="listitem"><p class="simpara">
								Use debug mode to identify a corresponding rule:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug</strong></span></pre><p class="simpara">
								Because the output of the <code class="literal">fapolicyd --debug</code> command is verbose, you can redirect the error output to a file:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug 2&gt; fapolicy.output</strong></span></pre></li></ol></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Removing the <code class="literal">fapolicyd</code> database</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To solve problems related to the <code class="literal">fapolicyd</code> database, try to remove the database file:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop fapolicyd</strong></span>
# <span class="strong strong"><strong>rm -f /var/lib/fapolicyd/*</strong></span></pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not remove the <code class="literal">/var/lib/fapolicyd/</code> directory. The <code class="literal">fapolicyd</code> framework automatically restores only the database file in this directory.
						</p></div></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Application pipe</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						In rare cases, removing the <code class="literal">fapolicyd</code> pipe file can solve a lockup:
					</p><pre class="screen"># <span class="strong strong"><strong>rm -f /var/run/fapolicyd/fapolicyd.fifo</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">fapolicyd-cli(1)</code> man page for more information.
					</li></ul></div></section><section class="section" id="additional_resources_2"><div class="titlepage"><div><div><h2 class="title">11.5. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">fapolicyd</code>-related man pages listed using the <code class="literal">man -k fapolicyd</code> command for more information.
					</li></ul></div></section></section><section class="chapter" id="protecting-systems-against-intrusive-usb-devices_security-hardening"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Protecting systems against intrusive USB devices</h1></div></div></div><p>
			USB devices can be loaded with spyware, malware, or Trojans, which can steal your data or damage your system. As a Red Hat Enterprise Linux administrator, you can prevent such USB attacks with <span class="strong strong"><strong>USBGuard</strong></span>.
		</p><section class="section" id="usbguard_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h2 class="title">12.1. USBGuard</h2></div></div></div><p>
				The USBGuard software framework provides system protection against intrusive USB devices by implementing the basic whitelisting and blacklisting capabilities based on the USB device authorization feature in the kernel.
			</p><p>
				The USBGuard framework provides the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The system service component with an inter-process communication (IPC) interface for dynamic interaction and policy enforcement
					</li><li class="listitem">
						The command-line interface to interact with a running <code class="literal">usbguard</code> system service
					</li><li class="listitem">
						The rule language for writing USB device authorization policies
					</li><li class="listitem">
						The C++ API for interacting with the system service component implemented in a shared library
					</li></ul></div><p>
				The <code class="literal">usbguard</code> system service configuration file (<code class="literal">/etc/usbguard/usbguard-daemon.conf</code>) includes the options to authorize the users and groups to use the IPC interface.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The system service provides the USBGuard public IPC interface. In Red Hat Enterprise Linux, the access to this interface is limited to the root user only by default.
				</p><p>
					Consider setting either the <code class="literal">IPCAccessControlFiles</code> option (recommended) or the <code class="literal">IPCAllowedUsers</code> and <code class="literal">IPCAllowedGroups</code> options to limit access to the IPC interface.
				</p><p>
					Ensure that you do not leave the Access Control List (ACL) unconfigured as this exposes the IPC interface to all local users and allows them to manipulate the authorization state of USB devices and modify the USBGuard policy.
				</p></div></div></section><section class="section" id="installing-usbguard_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h2 class="title">12.2. Installing USBGuard</h2></div></div></div><p>
				Use this procedure to install and initiate the <code class="literal">USBGuard</code> framework.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">usbguard</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install usbguard</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an initial rule set:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard generate-policy &gt; /etc/usbguard/rules.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">usbguard</code> daemon and ensure that it starts automatically on boot:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now usbguard</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the <code class="literal">usbguard</code> service is running:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>systemctl status usbguard</strong></span>
● usbguard.service - USBGuard daemon
   Loaded: loaded (/usr/lib/systemd/system/usbguard.service; enabled; vendor preset: disabled)
   Active: active (running) since Thu 2019-11-07 09:44:07 CET; 3min 16s ago
     Docs: man:usbguard-daemon(8)
 Main PID: 6122 (usbguard-daemon)
    Tasks: 3 (limit: 11493)
   Memory: 1.2M
   CGroup: /system.slice/usbguard.service
           └─6122 /usr/sbin/usbguard-daemon -f -s -c /etc/usbguard/usbguard-daemon.conf

Nov 07 09:44:06 localhost.localdomain systemd[1]: Starting USBGuard daemon...
Nov 07 09:44:07 localhost.localdomain systemd[1]: Started USBGuard daemon.</pre></li><li class="listitem"><p class="simpara">
						List USB devices recognized by <code class="literal">USBGuard</code>:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>usbguard list-devices</strong></span>
4: allow id 1d6b:0002 serial "0000:02:00.0" name "xHCI Host Controller" hash...</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code> and <code class="literal">usbguard-daemon.conf(5)</code> man pages
					</li></ul></div></section><section class="section" id="blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h2 class="title">12.3. Blocking and authorizing a USB device using CLI</h2></div></div></div><p>
				This procedure outlines how to authorize and block a USB device using the <code class="literal">usbguard</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List USB devices recognized by <code class="literal">USBGuard</code>:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>usbguard list-devices</strong></span>
1: allow id 1d6b:0002 serial "0000:00:06.7" name "EHCI Host Controller" hash "JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=" parent-hash "4PHGcaDKWtPjKDwYpIRG722cB9SlGz9l9Iea93+Gt9c=" via-port "usb1" with-interface 09:00:00
...
<span class="emphasis"><em>6</em></span>: block id 1b1c:1ab1 serial "000024937962" name "Voyager" hash "CrXgiaWIf2bZAU+5WkzOE7y0rdSO82XMzubn7HDb95Q=" parent-hash "JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=" via-port "1-3" with-interface 08:06:50</pre></li><li class="listitem"><p class="simpara">
						Authorize the device <span class="emphasis"><em>6</em></span> to interact with the system:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard allow-device <span class="emphasis"><em>6</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Deauthorize and remove the device <span class="emphasis"><em>6</em></span>:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard reject-device <span class="emphasis"><em>6</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Deauthorize and retain the device <span class="emphasis"><em>6</em></span>:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard block-device <span class="emphasis"><em>6</em></span></strong></span></pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					<code class="literal">USBGuard</code> uses the <span class="emphasis"><em>block</em></span> and <span class="emphasis"><em>reject</em></span> terms with the following meanings:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="emphasis"><em>block</em></span>: do not interact with this device for now.
						</li><li class="listitem">
							<span class="emphasis"><em>reject</em></span>: ignore this device as if it does not exist.
						</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List all options of the <code class="literal">usbguard</code> command:
					</p><pre class="screen">$ <span class="strong strong"><strong>usbguard --help</strong></span></pre></li><li class="listitem">
						<code class="literal">usbguard(1)</code> man page
					</li></ul></div></section><section class="section" id="creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h2 class="title">12.4. Creating a custom policy for USB devices</h2></div></div></div><p>
				The following procedure contains steps for creating a rule set for USB devices that reflects the requirements of your scenario.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li><li class="listitem">
						The <code class="literal">/etc/usbguard/rules.conf</code> file contains an initial rule set generated by the <code class="literal">usbguard generate-policy</code> command.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a policy which authorizes the currently connected USB devices, and store the generated rules to the <code class="literal">rules.conf</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard generate-policy --no-hashes &gt; <span class="emphasis"><em>./rules.conf</em></span></strong></span></pre><p class="simpara">
						The <code class="literal">--no-hashes</code> option does not generate hash attributes for devices. Avoid hash attributes in your configuration settings because they are not persistent.
					</p></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal">rules.conf</code> file with a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi <span class="emphasis"><em>./rules.conf</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Add, remove, or edit the rules as required. For example, the following rule allows only devices with a single mass storage interface to interact with the system:
					</p><pre class="screen">allow with-interface equals { 08:*:* }</pre><p class="simpara">
						See the <code class="literal">usbguard-rules.conf(5)</code> man page for a detailed rule-language description and more examples.
					</p></li><li class="listitem"><p class="simpara">
						Install the updated policy:
					</p><pre class="screen"># <span class="strong strong"><strong>install -m 0600 -o root -g root <span class="emphasis"><em>rules.conf</em></span> /etc/usbguard/rules.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">usbguard</code> daemon to apply your changes:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart usbguard</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that your custom rules are in the active policy, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard list-rules</strong></span>
...
4: allow with-interface 08:*:*
...</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">usbguard-rules.conf(5)</code> man page
					</li></ul></div></section><section class="section" id="authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h2 class="title">12.5. Authorizing users and groups to use the USBGuard IPC interface</h2></div></div></div><p>
				Use this procedure to authorize a specific user or a group to use the USBGuard public IPC interface. By default, only the root user can use this interface.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li><li class="listitem">
						The <code class="literal">/etc/usbguard/rules.conf</code> file contains an initial rule set generated by the <code class="literal">usbguard generate-policy</code> command.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">/etc/usbguard/usbguard-daemon.conf</code> file with a text editor of your choice:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/usbguard/usbguard-daemon.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						For example, add a line with a rule that allows all users in the <code class="literal">wheel</code> group to use the IPC interface, and save the file:
					</p><pre class="screen">IPCAllowGroups=wheel</pre></li><li class="listitem"><p class="simpara">
						You can add users or groups also with the <code class="literal">usbguard</code> command. For example, the following command enables the <span class="emphasis"><em>joesec</em></span> user to have full access to the <code class="literal">Devices</code> and <code class="literal">Exceptions</code> sections. Furthermore, <span class="emphasis"><em>joesec</em></span> can list the current policy and listen to policy signals.
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard add-user <span class="emphasis"><em>joesec</em></span> --devices ALL --policy list,listen --exceptions ALL</strong></span></pre><p class="simpara">
						To remove the granted permissions for the <span class="emphasis"><em>joesec</em></span> user, use the <code class="literal">usbguard remove-user joesec</code> command.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">usbguard</code> daemon to apply your changes:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart usbguard</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code> and <code class="literal">usbguard-rules.conf(5)</code> man pages
					</li></ul></div></section><section class="section" id="logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h2 class="title">12.6. Logging USBguard authorization events to the Linux Audit log</h2></div></div></div><p>
				Use the following steps to integrate logging of USBguard authorization events to the standard Linux Audit log. By default, the <code class="literal">usbguard</code> daemon logs events to the <code class="literal">/var/log/usbguard/usbguard-audit.log</code> file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li><li class="listitem">
						The <code class="literal">auditd</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">usbguard-daemon.conf</code> file with a text editor of your choice:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/usbguard/usbguard-daemon.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the <code class="literal">AuditBackend</code> option from <code class="literal">FileAudit</code> to <code class="literal">LinuxAudit</code>:
					</p><pre class="screen">AuditBackend=LinuxAudit</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">usbguard</code> daemon to apply the configuration change:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart usbguard</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Query the <code class="literal">audit</code> daemon log for a USB authorization event, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -ts recent -m USER_DEVICE</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">usbguard-daemon.conf(5)</code> man page
					</li></ul></div></section><section class="section" id="additional_resources_3"><div class="titlepage"><div><div><h2 class="title">12.7. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code>, <code class="literal">usbguard-rules.conf(5)</code>, <code class="literal">usbguard-daemon(8)</code>, and <code class="literal">usbguard-daemon.conf(5)</code> man pages
					</li><li class="listitem">
						<a class="link" href="https://usbguard.github.io/">USBGuard Homepage</a>
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140715702067824"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2020 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div>
  
  </div>
  </div>
</div>
<div id="comments-footer" class="book-comments">
  </div>
<meta itemscope="" itemref="md1">

    <!-- Display: Next/Previous Nav -->
          
      </div>
</article>


  

            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="index.html#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

            <div role="navigation">
                <h3>Quick Links</h3>
                <ul>
                    <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li><a class="manage-subscriptions" href="https://access.redhat.com/management/subscriptions/#active">Subscriptions</a></li>
                    <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                    <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                    <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Help</h3>
                <ul>
                    <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                    <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                    <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Site Info</h3>
                <ul>
                  <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                  <li><a class="browser-support-policy" href="https://access.redhat.com/help/browsers/">Browser Support Policy</a></li>
                  <li><a class="accessibility" href="https://access.redhat.com/help/accessibility/">Accessibility</a></li>
                  <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                  <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Related Sites</h3>
                <ul>
                    <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                    <li><a href="https://www.openshift.com" class="openshift-com">openshift.com</a></li>
                    <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                    <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>About</h3>
                <ul>
                    <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                    <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                    <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                </ul>
            </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                          <span class="status-description"></span>
                          <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2020 Red Hat, Inc.</div>

                        <div role="navigation" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://access.redhat.com/help/terms/" class="terms-of-use">Customer Portal Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                      <img src="l_summit.png" alt="Red Hat Summit" />
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHatSupport" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>
                        <a href="https://www.facebook.com/RedHatSupport" class="sm-icon facebook"><span class="nicon-facebook"></span><span class="offscreen">Facebook</span></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--googleon: all-->
</div>
  
  <div id="formatHelp" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="formatTitle" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="formatTitle">Formatting Tips</h3>
    </div>
    <div class="modal-body">
      <p>Here are the common uses of Markdown.</p><dl class="formatting-help">
        <dt class="codeblock">Code blocks</dt><dd class="codeblock"><pre><code>~~~
Code surrounded in tildes is easier to read
~~~</code></pre></dd>
        <dt class="urls">Links/URLs</dt><dd class="urls"><code>[Red Hat Customer Portal](https://access.redhat.com)</code></dd>
       </dl>
    </div>
    <div class="modal-footer">
      <a target="_blank" href="https://access.redhat.com/help/markdown" class="btn btn-primary">Learn more</a>
      <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
  </div></div></div></body>
</html>
